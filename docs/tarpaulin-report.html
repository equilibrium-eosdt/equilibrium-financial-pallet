<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <style>html, body {
  margin: 0;
  padding: 0;
}

.app {
  margin: 10px;
  padding: 0;
}

.files-list {
  margin: 10px 0 0;
  width: 100%;
  border-collapse: collapse;
}
.files-list__head {
  border: 1px solid #999;
}
.files-list__head > tr > th {
  padding: 10px;
  border: 1px solid #999;
  text-align: left;
  font-weight: normal;
  background: #ddd;
}
.files-list__body {
}
.files-list__file {
  cursor: pointer;
}
.files-list__file:hover {
  background: #ccf;
}
.files-list__file > td {
  padding: 10px;
  border: 1px solid #999;
}
.files-list__file > td:first-child::before {
  content: '\01F4C4';
  margin-right: 1em;
}
.files-list__file_low {
  background: #fcc;
}
.files-list__file_medium {
  background: #ffc;
}
.files-list__file_high {
  background: #cfc;
}
.files-list__file_folder > td:first-child::before {
  content: '\01F4C1';
  margin-right: 1em;
}

.file-header {
  border: 1px solid #999;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.file-header__back {
  margin: 10px;
  cursor: pointer;
  flex-shrink: 0;
  flex-grow: 0;
  text-decoration: underline;
  color: #338;
}

.file-header__name {
  margin: 10px;
  flex-shrink: 2;
  flex-grow: 2;
}

.file-header__stat {
  margin: 10px;
  flex-shrink: 0;
  flex-grow: 0;
}

.file-content {
  margin: 10px 0 0;
  border: 1px solid #999;
  padding: 10px;
}

.code-line {
  margin: 0;
  padding: 0.3em;
  height: 1em;
}
.code-line_covered {
  background: #cfc;
}
.code-line_uncovered {
  background: #fcc;
}
</style>
</head>
<body>
    <div id="root"></div>
    <script>
        var data = {"files":[{"path":["/","home","rotor","work","src","polka","financial-pallet","common","src","lib.rs"],"content":"#![cfg_attr(not(feature = \"std\"), no_std)]\n\nuse core::slice::Iter;\nuse frame_support::codec::{Decode, Encode};\n#[cfg(feature = \"std\")]\nuse serde::{Deserialize, Serialize};\n\n#[derive(Encode, Decode, Debug, PartialEq, Eq, Clone, Copy, Hash, Ord, PartialOrd)]\n#[cfg_attr(feature = \"std\", derive(Serialize, Deserialize))]\npub enum Asset {\n    Unknown,\n    Usd,\n    Eq,\n    Eth,\n    Btc,\n    Eos,\n}\n\nimpl Default for Asset {\n    fn default() -\u003e Asset {\n        Asset::Unknown\n    }\n}\n\nimpl Asset {\n    pub fn iterator() -\u003e Iter\u003c'static, Asset\u003e {\n        static ASSETS: [Asset; 5] = [Asset::Usd, Asset::Eq, Asset::Eth, Asset::Btc, Asset::Eos];\n        ASSETS.iter()\n    }\n}\n\nimpl Asset {\n    pub fn value(\u0026self) -\u003e u8 {\n        match *self {\n            Asset::Unknown =\u003e 0x0,\n            Asset::Usd =\u003e 0x1,\n            Asset::Eq =\u003e 0x2,\n            Asset::Eth =\u003e 0x3,\n            Asset::Btc =\u003e 0x4,\n            Asset::Eos =\u003e 0x5,\n        }\n    }\n}\n","traces":[{"line":20,"address":[5463968],"length":1,"stats":{"Line":0},"fn_name":"default"},{"line":21,"address":[5463972],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[5463984],"length":1,"stats":{"Line":0},"fn_name":"iterator"},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[5463995],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[5464048],"length":1,"stats":{"Line":0},"fn_name":"value"},{"line":34,"address":[5464100,5464107,5464121,5464091,5464114],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[5447574],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":13},{"path":["/","home","rotor","work","src","polka","financial-pallet","financial-primitives","src","capvec.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nuse frame_support::codec::{Decode, Encode};\nuse sp_std::ops::Range;\nuse sp_std::prelude::Vec;\n\nenum OneOfThree\u003cT1, T2, T3\u003e {\n    First(T1),\n    Second(T2),\n    Third(T3),\n}\n\nfn split_range(\n    range: \u0026Range\u003cusize\u003e,\n    head: usize,\n    length: usize,\n) -\u003e OneOfThree\u003c(), Range\u003cusize\u003e, (Range\u003cusize\u003e, Range\u003cusize\u003e)\u003e {\n    assert!(\n        range.start \u003c= length,\n        \"range start index {} out of range for CapVec of length {}\",\n        range.start,\n        length\n    );\n    assert!(\n        range.end \u003c= length,\n        \"range end index {} out of range for CapVec of length {}\",\n        range.start,\n        length\n    );\n\n    if range.is_empty() {\n        OneOfThree::First(())\n    } else {\n        let upper_start = range.start + head;\n        let upper_end = range.end + head;\n\n        if upper_start \u003c length \u0026\u0026 upper_end \u003c= length {\n            // Range fits in the upper part\n            OneOfThree::Second(upper_start..upper_end)\n        } else {\n            let lower_start = upper_start % length;\n            let lower_end = upper_end % length;\n\n            if lower_start \u003c head \u0026\u0026 lower_end \u003c= head {\n                // Range fits in the lower part\n                OneOfThree::Second(lower_start..lower_end)\n            } else {\n                // Range located in both upper and lower parts\n                OneOfThree::Third((upper_start..length, 0..lower_end))\n            }\n        }\n    }\n}\n\n#[derive(Encode, Decode, Clone, Default, PartialEq, Eq, Debug)]\npub struct CapVec\u003cT\u003e {\n    head_index: u32,\n    len_cap: u32,\n    items: Vec\u003cT\u003e,\n}\n\nuse sp_std::fmt::Debug;\nimpl\u003cT\u003e CapVec\u003cT\u003e {\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// ```\n    pub fn new(length: u32) -\u003e CapVec\u003cT\u003e {\n        CapVec {\n            head_index: 0,\n            len_cap: length,\n            items: Vec::new(),\n        }\n    }\n\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// items.push(1);\n    /// ```\n    pub fn push(\u0026mut self, item: T) {\n        if self.items.len() \u003c (self.len_cap as usize) {\n            self.items.push(item);\n        } else {\n            self.items[self.head_index as usize] = item;\n            self.head_index = (self.head_index + 1) % (self.items.len() as u32);\n        }\n    }\n\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// items.push(1);\n    /// items.push(2);\n    /// items.push(3);\n    /// let items_vec: Vec\u003c_\u003e = items.iter().copied().collect();\n    /// assert_eq!(items_vec, vec![2, 3]);\n    /// ```\n    pub fn iter(\u0026self) -\u003e impl Iterator\u003cItem = \u0026T\u003e {\n        let head = self.head_index as usize;\n        let first_part = self.items[head..].iter();\n        let last_part = self.items[..head].iter();\n\n        first_part.chain(last_part)\n    }\n\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(4);\n    /// items.push(1);\n    /// items.push(2);\n    /// items.push(3);\n    /// items.push(4);\n    /// let items_vec: Vec\u003c_\u003e = items.iter_range(\u0026(1..3)).copied().collect();\n    /// assert_eq!(items_vec, vec![2, 3]);\n    /// ```\n    pub fn iter_range(\u0026self, range: \u0026Range\u003cusize\u003e) -\u003e impl Iterator\u003cItem = \u0026T\u003e {\n        let ranges = split_range(range, self.head_index as usize, self.items.len());\n        let (range1, range2) = match ranges {\n            OneOfThree::First(_) =\u003e ((0..0), (0..0)),\n            OneOfThree::Second(r) =\u003e (r, (0..0)),\n            OneOfThree::Third((r1, r2)) =\u003e (r1, r2),\n        };\n\n        let first_part = self.items[range1].iter();\n        let last_part = self.items[range2].iter();\n\n        first_part.chain(last_part)\n    }\n\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// assert_eq!(items.len_cap(), 2);\n    /// ```\n    pub fn len_cap(\u0026self) -\u003e u32 {\n        self.len_cap\n    }\n\n    pub fn len(\u0026self) -\u003e usize {\n        self.items.len()\n    }\n\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// assert_eq!(items.last(), None);\n    /// ```\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// items.push(1);\n    /// items.push(2);\n    /// items.push(3);\n    /// assert_eq!(items.last(), Some(\u00263));\n    /// ```\n    pub fn last(\u0026self) -\u003e Option\u003c\u0026T\u003e {\n        let len = self.items.len();\n\n        if len == 0 {\n            None\n        } else if len \u003c (self.len_cap as usize) {\n            Some(\u0026self.items[len - 1])\n        } else {\n            let index = (self.len_cap + self.head_index - 1) % (self.len_cap);\n            Some(\u0026self.items[index as usize])\n        }\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_empty() {\n        let capvec = CapVec::\u003cu32\u003e::new(5);\n\n        let actual: Vec\u003c_\u003e = capvec.iter().cloned().collect();\n        let expected: Vec\u003cu32\u003e = vec![];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_not_capped() {\n        let mut capvec = CapVec::\u003cu32\u003e::new(5);\n        capvec.push(1);\n        capvec.push(2);\n        capvec.push(3);\n\n        let actual: Vec\u003c_\u003e = capvec.iter().cloned().collect();\n        let expected: Vec\u003cu32\u003e = vec![1, 2, 3];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_capped() {\n        let mut capvec = CapVec::\u003cu32\u003e::new(5);\n        capvec.push(1);\n        capvec.push(2);\n        capvec.push(3);\n        capvec.push(4);\n        capvec.push(5);\n        capvec.push(6);\n\n        let actual: Vec\u003c_\u003e = capvec.iter().cloned().collect();\n        let expected: Vec\u003cu32\u003e = vec![2, 3, 4, 5, 6];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_last_empty() {\n        let capvec = CapVec::\u003cu32\u003e::new(5);\n\n        let actual = capvec.last();\n        let expected = None;\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_last_non_empty() {\n        let mut capvec = CapVec::\u003cu32\u003e::new(5);\n        capvec.push(1);\n        capvec.push(2);\n        capvec.push(3);\n        capvec.push(4);\n        capvec.push(5);\n        capvec.push(6);\n\n        let actual = capvec.last();\n        let expected = Some(\u00266);\n\n        assert_eq!(actual, expected);\n    }\n\n    fn from_vec\u003cT: Debug\u003e(cap: u32, items: Vec\u003cT\u003e) -\u003e CapVec\u003cT\u003e {\n        let mut capvec = CapVec::\u003cT\u003e::new(cap);\n        for item in items.into_iter() {\n            capvec.push(item);\n        }\n\n        capvec\n    }\n\n    #[test]\n    fn test_iter_range_full_range() {\n        let capvec = from_vec(5, vec![1, 2, 3, 4, 5]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(0..5)).copied().collect();\n        let expected = vec![1, 2, 3, 4, 5];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_iter_range_empty_range() {\n        let capvec = from_vec(5, vec![1, 2, 3, 4, 5]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(0..0)).copied().collect();\n        let expected = vec![];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_iter_range_first_part_range() {\n        let capvec = from_vec(6, vec![1, 2, 3, 4, 5, 6, 7, 8, 9]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(1..3)).copied().collect();\n        let expected = vec![5, 6];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_iter_range_second_part_range() {\n        let capvec = from_vec(6, vec![1, 2, 3, 4, 5, 6, 7, 8, 9]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(4..6)).copied().collect();\n        let expected = vec![8, 9];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_iter_range_both_parts_range() {\n        let capvec = from_vec(6, vec![1, 2, 3, 4, 5, 6, 7, 8, 9]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(2..5)).copied().collect();\n        let expected = vec![6, 7, 8];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_iter_range_small_range_start_on_zero() {\n        let capvec = from_vec(5, vec![1, 2, 3, 4, 5]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(1..3)).copied().collect();\n        let expected = vec![2, 3];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    #[should_panic(expected = \"index out of bounds: the len is 0 but the index is 0\")]\n    fn test_zero_cap() {\n        let mut capvec = CapVec::\u003cu32\u003e::new(0);\n        capvec.push(1);\n    }\n}\n","traces":[{"line":26,"address":[4243648],"length":1,"stats":{"Line":11},"fn_name":"split_range"},{"line":31,"address":[4243697,4243801],"length":1,"stats":{"Line":11},"fn_name":null},{"line":32,"address":[4243682],"length":1,"stats":{"Line":11},"fn_name":null},{"line":37,"address":[4244120,4243762],"length":1,"stats":{"Line":14},"fn_name":null},{"line":38,"address":[4243747],"length":1,"stats":{"Line":14},"fn_name":null},{"line":44,"address":[4244422,4245069,4244084,4244363],"length":1,"stats":{"Line":40},"fn_name":null},{"line":45,"address":[4244415],"length":1,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[4244385,4244432,4245087],"length":1,"stats":{"Line":26},"fn_name":null},{"line":48,"address":[4244456,4245117],"length":1,"stats":{"Line":13},"fn_name":null},{"line":50,"address":[4245067,4244652,4244497],"length":1,"stats":{"Line":25},"fn_name":null},{"line":52,"address":[4244592],"length":1,"stats":{"Line":11},"fn_name":null},{"line":54,"address":[4244556,4244662,4245147],"length":1,"stats":{"Line":4},"fn_name":null},{"line":55,"address":[4245177,4245207,4244682],"length":1,"stats":{"Line":2},"fn_name":null},{"line":57,"address":[4244756,4245000],"length":1,"stats":{"Line":3},"fn_name":null},{"line":59,"address":[4245007],"length":1,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[4244819],"length":1,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":32},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":19},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":115,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":120,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":135,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":142,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":179,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":195,"address":[4222376,4222352],"length":1,"stats":{"Line":3},"fn_name":"test_empty"},{"line":196,"address":[4222359],"length":1,"stats":{"Line":1},"fn_name":null},{"line":198,"address":[4222404,4222459],"length":1,"stats":{"Line":2},"fn_name":null},{"line":199,"address":[4222466],"length":1,"stats":{"Line":1},"fn_name":null},{"line":201,"address":[4222490,4222643,4222597],"length":1,"stats":{"Line":2},"fn_name":null},{"line":205,"address":[4223064,4223040],"length":1,"stats":{"Line":3},"fn_name":"test_not_capped"},{"line":206,"address":[4223047],"length":1,"stats":{"Line":1},"fn_name":null},{"line":207,"address":[4223089],"length":1,"stats":{"Line":1},"fn_name":null},{"line":208,"address":[4223106],"length":1,"stats":{"Line":1},"fn_name":null},{"line":209,"address":[4223135],"length":1,"stats":{"Line":1},"fn_name":null},{"line":211,"address":[4223155],"length":1,"stats":{"Line":1},"fn_name":null},{"line":212,"address":[4223215],"length":1,"stats":{"Line":1},"fn_name":null},{"line":214,"address":[4223428,4223288],"length":1,"stats":{"Line":1},"fn_name":null},{"line":218,"address":[4222037,4222032],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":219,"address":[4223847],"length":1,"stats":{"Line":1},"fn_name":null},{"line":220,"address":[4223889],"length":1,"stats":{"Line":1},"fn_name":null},{"line":221,"address":[4223906],"length":1,"stats":{"Line":1},"fn_name":null},{"line":222,"address":[4223935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":223,"address":[4223952],"length":1,"stats":{"Line":1},"fn_name":null},{"line":224,"address":[4223969],"length":1,"stats":{"Line":1},"fn_name":null},{"line":225,"address":[4223986],"length":1,"stats":{"Line":1},"fn_name":null},{"line":227,"address":[4224006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":228,"address":[4224066],"length":1,"stats":{"Line":1},"fn_name":null},{"line":230,"address":[4224153,4224293],"length":1,"stats":{"Line":1},"fn_name":null},{"line":234,"address":[4222069,4222064],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":235,"address":[4224711],"length":1,"stats":{"Line":1},"fn_name":null},{"line":237,"address":[4224748],"length":1,"stats":{"Line":1},"fn_name":null},{"line":238,"address":[4224773],"length":1,"stats":{"Line":1},"fn_name":null},{"line":240,"address":[4224916,4224895,4224793],"length":1,"stats":{"Line":2},"fn_name":null},{"line":244,"address":[4222101,4222096],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":245,"address":[4225271],"length":1,"stats":{"Line":1},"fn_name":null},{"line":246,"address":[4225313],"length":1,"stats":{"Line":1},"fn_name":null},{"line":247,"address":[4225330],"length":1,"stats":{"Line":1},"fn_name":null},{"line":248,"address":[4225359],"length":1,"stats":{"Line":1},"fn_name":null},{"line":249,"address":[4225376],"length":1,"stats":{"Line":1},"fn_name":null},{"line":250,"address":[4225393],"length":1,"stats":{"Line":1},"fn_name":null},{"line":251,"address":[4225410],"length":1,"stats":{"Line":1},"fn_name":null},{"line":253,"address":[4225422],"length":1,"stats":{"Line":1},"fn_name":null},{"line":254,"address":[4225447],"length":1,"stats":{"Line":1},"fn_name":null},{"line":256,"address":[4225578,4225470],"length":1,"stats":{"Line":1},"fn_name":null},{"line":259,"address":[4221456,4221519],"length":1,"stats":{"Line":6},"fn_name":"from_vec\u003ci32\u003e"},{"line":260,"address":[4221473],"length":1,"stats":{"Line":6},"fn_name":null},{"line":261,"address":[4221696,4221613,4221820,4221534,4221752],"length":1,"stats":{"Line":24},"fn_name":null},{"line":262,"address":[4221803],"length":1,"stats":{"Line":6},"fn_name":null},{"line":269,"address":[4222133,4222128],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":270,"address":[4225927,4226017],"length":1,"stats":{"Line":2},"fn_name":null},{"line":272,"address":[4226118,4226040],"length":1,"stats":{"Line":2},"fn_name":null},{"line":273,"address":[4226135],"length":1,"stats":{"Line":1},"fn_name":null},{"line":275,"address":[4226357,4226221],"length":1,"stats":{"Line":1},"fn_name":null},{"line":279,"address":[4222165,4222160],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":280,"address":[4226865,4226775],"length":1,"stats":{"Line":2},"fn_name":null},{"line":282,"address":[4226966,4226888],"length":1,"stats":{"Line":2},"fn_name":null},{"line":283,"address":[4226973],"length":1,"stats":{"Line":1},"fn_name":null},{"line":285,"address":[4227152,4227000,4227106],"length":1,"stats":{"Line":2},"fn_name":null},{"line":289,"address":[4222197,4222192],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":290,"address":[4227693,4227575],"length":1,"stats":{"Line":2},"fn_name":null},{"line":292,"address":[4227716,4227794],"length":1,"stats":{"Line":2},"fn_name":null},{"line":293,"address":[4227811],"length":1,"stats":{"Line":1},"fn_name":null},{"line":295,"address":[4228012,4227876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":299,"address":[4222224,4222229],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":300,"address":[4228423,4228541],"length":1,"stats":{"Line":2},"fn_name":null},{"line":302,"address":[4228564,4228642],"length":1,"stats":{"Line":2},"fn_name":null},{"line":303,"address":[4228659],"length":1,"stats":{"Line":1},"fn_name":null},{"line":305,"address":[4228860,4228724],"length":1,"stats":{"Line":1},"fn_name":null},{"line":309,"address":[4222256,4222261],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":310,"address":[4229271,4229389],"length":1,"stats":{"Line":2},"fn_name":null},{"line":312,"address":[4229412,4229490],"length":1,"stats":{"Line":2},"fn_name":null},{"line":313,"address":[4229507],"length":1,"stats":{"Line":1},"fn_name":null},{"line":315,"address":[4229579,4229715],"length":1,"stats":{"Line":1},"fn_name":null},{"line":319,"address":[4222288,4222293],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":320,"address":[4230135,4230225],"length":1,"stats":{"Line":2},"fn_name":null},{"line":322,"address":[4230248,4230326],"length":1,"stats":{"Line":2},"fn_name":null},{"line":323,"address":[4230343],"length":1,"stats":{"Line":1},"fn_name":null},{"line":325,"address":[4230544,4230408],"length":1,"stats":{"Line":1},"fn_name":null},{"line":330,"address":[4222320,4222325],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}"},{"line":331,"address":[4230966],"length":1,"stats":{"Line":1},"fn_name":null},{"line":332,"address":[4231000],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":126,"coverable":126},{"path":["/","home","rotor","work","src","polka","financial-pallet","financial-primitives","src","lib.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n//#![warn(missing_docs)]\n#![cfg_attr(not(feature = \"std\"), no_std)]\n\npub mod capvec;\n\nuse core::time::Duration;\nuse frame_support::dispatch::DispatchError;\nuse sp_std::convert::{From, TryFrom};\nuse sp_std::vec::Vec;\n\npub trait OnPriceSet {\n    type Asset;\n    type Price;\n\n    fn on_price_set(asset: Self::Asset, value: Self::Price) -\u003e Result\u003c(), DispatchError\u003e;\n}\n\npub trait BalanceAware {\n    type AccountId;\n    type Asset;\n    type Balance;\n\n    fn balances(\n        account_id: \u0026Self::AccountId,\n        assets: \u0026[Self::Asset],\n    ) -\u003e Result\u003cVec\u003cSelf::Balance\u003e, DispatchError\u003e;\n}\n\n#[derive(Debug, Eq, PartialEq)]\npub enum PricePeriodError {\n    DivisionByZero,\n    Overflow,\n}\n\npub type PricePeriodResult\u003cT\u003e = Result\u003cT, PricePeriodError\u003e;\n\npub struct PricePeriod(pub u32);\n\nimpl PricePeriod {\n    pub fn get_period_id(\u0026self, now: Duration) -\u003e Result\u003cu64, PricePeriodError\u003e {\n        let seconds = now.as_secs();\n        let period = self.0 as u64;\n\n        seconds\n            .checked_div(60)\n            .and_then(|x| x.checked_div(period))\n            .ok_or(PricePeriodError::DivisionByZero)\n    }\n\n    pub fn get_period_id_start(\u0026self, period_id: u64) -\u003e Result\u003cDuration, PricePeriodError\u003e {\n        let period = self.0 as u64;\n        let seconds: Result\u003c_, PricePeriodError\u003e = period_id\n            .checked_mul(60)\n            .and_then(|x| x.checked_mul(period))\n            .ok_or(PricePeriodError::Overflow);\n\n        Ok(Duration::from_secs(seconds?))\n    }\n\n    pub fn get_period_start(\u0026self, now: Duration) -\u003e Result\u003cDuration, PricePeriodError\u003e {\n        self.get_period_id_start(self.get_period_id(now)?)\n    }\n\n    pub fn is_valid_period_start(\u0026self, period_start: Duration) -\u003e PricePeriodResult\u003cbool\u003e {\n        Ok(period_start == self.get_period_start(period_start)?)\n    }\n}\n\n/// Indicates what returns will be used in calculations of volatilities, correlations, and value at\n/// risk: `Regular` or `Log` returns.\n///\n/// The choice of return type also governs the method for Value at Risk (VAR) calculation:\n/// * `Regular` type should be used when arithmetic returns are used and are assumed to be normally\n/// distributed;\n/// * `Log` normal type should be used when geometric returns (log returns) are used\n/// and are assumed to be normally distributed.\n///\n/// We suggest using the latter approach, as it doesn't\n/// lead to losses greater than a portfolio value unlike the normal VaR.\n#[derive(Copy, Clone, Debug)]\npub enum CalcReturnType {\n    /// Regular returns.\n    Regular,\n\n    /// Log returns.\n    Log,\n}\n\nimpl CalcReturnType {\n    pub const fn into_u32(\u0026self) -\u003e u32 {\n        match self {\n            CalcReturnType::Regular =\u003e 0,\n            CalcReturnType::Log =\u003e 1,\n        }\n    }\n}\n\nimpl TryFrom\u003cu32\u003e for CalcReturnType {\n    type Error = ();\n\n    fn try_from(value: u32) -\u003e Result\u003cSelf, Self::Error\u003e {\n        match value {\n            0 =\u003e Ok(CalcReturnType::Regular),\n            1 =\u003e Ok(CalcReturnType::Log),\n            _ =\u003e Err(()),\n        }\n    }\n}\n\nimpl From\u003cCalcReturnType\u003e for u32 {\n    fn from(value: CalcReturnType) -\u003e Self {\n        value.into_u32()\n    }\n}\n\n/// Indicates the method for calculating volatility: `Regular` or `Exponential`.\n#[derive(Copy, Clone, Debug)]\npub enum CalcVolatilityType {\n    /// Regular type is a standard statistical approach of calculating standard deviation of\n    /// returns using simple average.\n    Regular,\n\n    /// Exponentially weighted type gives more weight to most recent data given the decay value or\n    /// period of exponentially weighted moving average.\n    Exponential(u32),\n}\n\nimpl CalcVolatilityType {\n    pub const fn into_i64(\u0026self) -\u003e i64 {\n        match self {\n            CalcVolatilityType::Regular =\u003e -1,\n            CalcVolatilityType::Exponential(n) =\u003e *n as i64,\n        }\n    }\n}\n\nimpl TryFrom\u003ci64\u003e for CalcVolatilityType {\n    type Error = ();\n\n    fn try_from(value: i64) -\u003e Result\u003cSelf, Self::Error\u003e {\n        match value {\n            -1 =\u003e Ok(CalcVolatilityType::Regular),\n            n if n \u003e= 0 =\u003e Ok(CalcVolatilityType::Exponential(n as u32)),\n            _ =\u003e Err(()),\n        }\n    }\n}\n\nimpl From\u003cCalcVolatilityType\u003e for i64 {\n    fn from(value: CalcVolatilityType) -\u003e i64 {\n        value.into_i64()\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    #[cfg(test)]\n    mod price_period {\n        use super::super::*;\n        use chrono::prelude::*;\n\n        fn create_duration(\n            year: i32,\n            month: u32,\n            day: u32,\n            hour: u32,\n            minute: u32,\n            second: u32,\n        ) -\u003e Duration {\n            let timestamp = Utc\n                .ymd(year, month, day)\n                .and_hms(hour, minute, second)\n                .timestamp();\n            Duration::from_secs(timestamp as u64)\n        }\n\n        #[test]\n        fn period_id_are_same_within_period() {\n            let time1 = create_duration(2020, 9, 14, 12, 31, 0);\n            let time2 = create_duration(2020, 9, 14, 12, 54, 0);\n\n            // period is one hour\n            let period = PricePeriod(60);\n\n            let period_id_1 = period.get_period_id(time1);\n            let period_id_2 = period.get_period_id(time2);\n\n            assert!(period_id_1.is_ok());\n            assert!(period_id_2.is_ok());\n            assert_eq!(period_id_1, period_id_2);\n        }\n\n        #[test]\n        fn period_id_are_different_for_different_periods() {\n            let time1 = create_duration(2020, 9, 14, 12, 31, 0);\n            let time2 = create_duration(2020, 9, 14, 13, 2, 0);\n\n            // period is one hour\n            let period = PricePeriod(60);\n\n            let period_id_1 = period.get_period_id(time1);\n            let period_id_2 = period.get_period_id(time2);\n\n            assert!(period_id_1.is_ok());\n            assert!(period_id_2.is_ok());\n            assert!(period_id_1 != period_id_2);\n        }\n    }\n}\n","traces":[{"line":55,"address":[4240432],"length":1,"stats":{"Line":4},"fn_name":"get_period_id"},{"line":56,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":61,"address":[4213952,4213966],"length":1,"stats":{"Line":12},"fn_name":"{{closure}}"},{"line":62,"address":[4240569],"length":1,"stats":{"Line":4},"fn_name":null},{"line":65,"address":[4240624],"length":1,"stats":{"Line":2},"fn_name":"get_period_id_start"},{"line":66,"address":[4240650],"length":1,"stats":{"Line":2},"fn_name":null},{"line":67,"address":[4240737,4240702,4240664],"length":1,"stats":{"Line":6},"fn_name":null},{"line":69,"address":[4240692],"length":1,"stats":{"Line":6},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":120,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[4232368],"length":1,"stats":{"Line":2},"fn_name":"create_duration"},{"line":185,"address":[4232399],"length":1,"stats":{"Line":2},"fn_name":null},{"line":189,"address":[4232520],"length":1,"stats":{"Line":2},"fn_name":null},{"line":193,"address":[4231664,4231669],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":194,"address":[4232570],"length":1,"stats":{"Line":1},"fn_name":null},{"line":195,"address":[4232628],"length":1,"stats":{"Line":1},"fn_name":null},{"line":198,"address":[4232683],"length":1,"stats":{"Line":1},"fn_name":null},{"line":200,"address":[4232691],"length":1,"stats":{"Line":1},"fn_name":null},{"line":201,"address":[4232715],"length":1,"stats":{"Line":1},"fn_name":null},{"line":203,"address":[4232742,4232785],"length":1,"stats":{"Line":1},"fn_name":null},{"line":204,"address":[4232819,4232766,4232913],"length":1,"stats":{"Line":2},"fn_name":null},{"line":205,"address":[4232825,4232961,4232947],"length":1,"stats":{"Line":2},"fn_name":null},{"line":209,"address":[4231701,4231696],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":210,"address":[4233255],"length":1,"stats":{"Line":1},"fn_name":null},{"line":211,"address":[4233307],"length":1,"stats":{"Line":1},"fn_name":null},{"line":214,"address":[4233356],"length":1,"stats":{"Line":1},"fn_name":null},{"line":216,"address":[4233364],"length":1,"stats":{"Line":1},"fn_name":null},{"line":217,"address":[4233388],"length":1,"stats":{"Line":1},"fn_name":null},{"line":219,"address":[4233412,4233452],"length":1,"stats":{"Line":1},"fn_name":null},{"line":220,"address":[4233436,4233513,4233486],"length":1,"stats":{"Line":2},"fn_name":null},{"line":221,"address":[4233588,4233547,4233492,4233558],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":37,"coverable":59},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","integration-testing-macro","src","lib.rs"],"content":"extern crate proc_macro;\n\nuse proc_macro::{Literal, TokenStream, TokenTree};\nuse quote::quote;\nuse syn::parse::{Parse, ParseStream};\nuse syn::parse_macro_input;\nuse syn::punctuated::Punctuated;\nuse syn::{Expr, Token};\n\nstruct Input {\n    name: syn::Ident,\n    args: Punctuated\u003cExpr, Token![,]\u003e,\n}\n\nimpl Parse for Input {\n    fn parse(input: ParseStream) -\u003e syn::parse::Result\u003cSelf\u003e {\n        let name = input.parse()?;\n        input.parse::\u003csyn::Token![,]\u003e()?;\n        let args = Punctuated::\u003cExpr, Token![,]\u003e::parse_terminated(input)?;\n        Ok(Input { name, args })\n    }\n}\n\nfn tuple_read(name: syn::Ident, num: usize) -\u003e syn::Expr {\n    let num = Literal::usize_unsuffixed(num);\n    let num: TokenTree = num.into();\n    let num: TokenStream = num.into();\n    let num: syn::Lit = syn::parse(num).unwrap();\n    let gen = quote! {\n        #name.#num\n    };\n\n    let tokens: TokenStream = gen.into();\n\n    syn::parse(tokens).unwrap()\n}\n\n#[proc_macro]\npub fn tuple_to_vec(tokens: TokenStream) -\u003e TokenStream {\n    let input = parse_macro_input!(tokens as Input);\n    let name = input.name;\n\n    let vec_args: Punctuated\u003csyn::Expr, Token![,]\u003e = input\n        .args\n        .into_iter()\n        .enumerate()\n        .map(|(i, _)| tuple_read(name.clone(), i))\n        .collect();\n\n    let gen = quote! {\n        vec!(#vec_args)\n    };\n\n    gen.into()\n}\n","traces":[{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[4233747,4233696],"length":1,"stats":{"Line":0},"fn_name":"tuple_read"},{"line":25,"address":[4233766,4233714],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[4233784,4233830],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[4233851],"length":1,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[4233903],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[4233963,4234022],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[4234129],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[4234221],"length":1,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[4234449,4234384],"length":1,"stats":{"Line":0},"fn_name":"tuple_to_vec"},{"line":40,"address":[4234818,4234464,4234403],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[4234699],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[4234954,4234746,4234993],"length":1,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[4231612,4231600],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":50,"address":[4235047,4235116],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[4235355],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":20},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","financial.rs"],"content":"use codec::{Codec, Encode};\nuse common::Asset;\nuse core::marker::PhantomData;\nuse pallet_financial::{AssetMetrics, FinancialMetrics, PriceLog, PriceUpdate};\nuse sp_runtime::traits::Member;\nuse std::fmt::Debug;\nuse substrate_fixed::types::I64F64;\nuse substrate_subxt::system::{System, SystemEventsDecoder};\nuse substrate_subxt_proc_macro::{module, Call, Store};\n\npub type FixedNumber = I64F64;\npub type Price = FixedNumber;\n\n#[module]\npub trait Financial: System {\n    type Asset: Default + Codec + Member;\n    type FixedNumber: Default + Codec + Member;\n    type Price: Default + Codec + Member;\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct UpdatesStore\u003cT: Financial\u003e {\n    #[store(returns = Option\u003cPriceUpdate\u003cT::FixedNumber\u003e\u003e)]\n    pub asset: Asset,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct PriceLogsStore\u003cT: Financial\u003e {\n    #[store(returns = Option\u003cPriceLog\u003cT::FixedNumber\u003e\u003e)]\n    pub asset: Asset,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct MetricsStore\u003cT: Financial\u003e {\n    #[store(returns = Option\u003cFinancialMetrics\u003cT::Asset, T::Price\u003e\u003e)]\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct PerAssetMetricsStore\u003cT: Financial\u003e {\n    #[store(returns = Option\u003cAssetMetrics\u003cT::Asset, T::Price\u003e\u003e)]\n    pub asset: Asset,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, PartialEq, Call, Encode)]\npub struct RecalcAssetCall\u003cT: Financial\u003e {\n    pub asset: Asset,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, PartialEq, Call, Encode)]\npub struct RecalcCall\u003cT: Financial\u003e {\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","key.rs"],"content":"use crate::keyring::{KeyPair, Nonces, PubKey};\nuse arraystring::{error, typenum::U10, ArrayString};\nuse serde::ser::{Serialize, SerializeStruct, SerializeTupleVariant, Serializer};\nuse sp_core::crypto::Pair as CryptoPair;\nuse sp_core::sr25519::Pair;\nuse sp_runtime::traits::AccountIdConversion;\nuse sp_runtime::{AccountId32, ModuleId};\nuse std::cmp::Ordering;\nuse std::collections::HashMap;\n\n#[derive(Copy, Clone, Debug, Eq, PartialEq, Hash)]\npub enum AccountKey {\n    Keyring(sp_keyring::sr25519::Keyring),\n    Str(\u0026'static str),\n    Random(ArrayString10),\n}\n\nimpl AccountKey {\n    /// Constructs account key from random seed string.\n    pub fn generate_random() -\u003e Self {\n        let seed = generate_random_array_string().expect(\"should be short random string\");\n        AccountKey::Random(seed)\n    }\n\n    fn to_num(\u0026self) -\u003e usize {\n        match self {\n            \u0026AccountKey::Keyring(_) =\u003e 0,\n            \u0026AccountKey::Str(_) =\u003e 1,\n            \u0026AccountKey::Random(_) =\u003e 2,\n        }\n    }\n}\n\n/// Represents fixed-capacity string for testing AccountKey.\ntype ArrayString10 = ArrayString\u003cU10\u003e;\n\n/// Generates random array string with fixed length, otherwise returns an error.\n/// ```rust\n/// let s = generate_random_array_string();\n/// ```\nfn generate_random_array_string() -\u003e Result\u003cArrayString10, error::OutOfBounds\u003e {\n    use rand::{distributions::Alphanumeric, Rng};\n    let s: String = rand::thread_rng()\n        .sample_iter(\u0026Alphanumeric)\n        .take(10)\n        .collect();\n    ArrayString10::try_from_str(s)\n}\n\nfn keyring_to_string(keyring: sp_keyring::sr25519::Keyring) -\u003e \u0026'static str {\n    keyring.into()\n}\n\nimpl PartialOrd for AccountKey {\n    fn partial_cmp(\u0026self, other: \u0026AccountKey) -\u003e Option\u003cOrdering\u003e {\n        Some(self.cmp(other))\n    }\n}\n\nimpl Serialize for AccountKey {\n    fn serialize\u003cS\u003e(\u0026self, serializer: S) -\u003e Result\u003cS::Ok, S::Error\u003e\n    where\n        S: Serializer,\n    {\n        match self {\n            \u0026AccountKey::Keyring(kr) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"AccountKey\", 0, \"Keyring\", 1)?;\n                state.serialize_field(keyring_to_string(kr))?;\n                state.end()\n            }\n            \u0026AccountKey::Str(s) =\u003e {\n                let mut state = serializer.serialize_tuple_variant(\"AccountKey\", 1, \"Str\", 1)?;\n                state.serialize_field(s)?;\n                state.end()\n            }\n            \u0026AccountKey::Random(s) =\u003e {\n                let mut state = serializer.serialize_tuple_variant(\"AccountKey\", 2, \"Random\", 1)?;\n                state.serialize_field(s.as_str())?;\n                state.end()\n            }\n        }\n    }\n}\n\nimpl Ord for AccountKey {\n    fn cmp(\u0026self, other: \u0026AccountKey) -\u003e Ordering {\n        let num_ord = self.to_num().cmp(\u0026other.to_num());\n\n        if num_ord != Ordering::Equal {\n            num_ord\n        } else {\n            match (self, other) {\n                (\u0026AccountKey::Keyring(a), \u0026AccountKey::Keyring(b)) =\u003e {\n                    keyring_to_string(a).cmp(keyring_to_string(b))\n                }\n                (\u0026AccountKey::Str(a), \u0026AccountKey::Str(b)) =\u003e a.cmp(b),\n                _ =\u003e panic!(\"Not meant to be there\"),\n            }\n        }\n    }\n}\n\nimpl From\u003csp_keyring::sr25519::Keyring\u003e for AccountKey {\n    fn from(x: sp_keyring::sr25519::Keyring) -\u003e AccountKey {\n        AccountKey::Keyring(x)\n    }\n}\n\nimpl From\u003c\u0026'static str\u003e for AccountKey {\n    fn from(x: \u0026'static str) -\u003e AccountKey {\n        AccountKey::Str(x)\n    }\n}\n\nfn string_to_static_str(s: \u0026String) -\u003e \u0026'static str {\n    Box::leak(s.clone().into_boxed_str())\n}\n\nimpl From\u003c\u0026String\u003e for AccountKey {\n    fn from(x: \u0026String) -\u003e AccountKey {\n        let s: \u0026'static str = string_to_static_str(x);\n        AccountKey::Str(s)\n    }\n}\n\nimpl PubKey for AccountKey {\n    type AccountId = AccountId32;\n\n    fn acc_id(\u0026self) -\u003e Self::AccountId {\n        match self {\n            \u0026AccountKey::Keyring(k) =\u003e k.to_account_id(),\n            \u0026AccountKey::Str(s) =\u003e Pair::from_string(\u0026ensure_canonical_seed(s), None)\n                .unwrap()\n                .public()\n                .into(),\n            \u0026AccountKey::Random(s) =\u003e Pair::from_string(\u0026ensure_canonical_seed(s.as_str()), None)\n                .unwrap()\n                .public()\n                .into(),\n        }\n    }\n}\n\nimpl KeyPair for AccountKey {\n    fn key_pair(\u0026self) -\u003e sp_core::sr25519::Pair {\n        match self {\n            \u0026AccountKey::Keyring(k) =\u003e k.pair(),\n            \u0026AccountKey::Str(s) =\u003e Pair::from_string(\u0026ensure_canonical_seed(s), None).unwrap(),\n            \u0026AccountKey::Random(s) =\u003e {\n                Pair::from_string(\u0026ensure_canonical_seed(s.as_str()), None).unwrap()\n            }\n        }\n    }\n}\n\npub type DevNonces = Nonces\u003cAccountKey\u003e;\n\n#[derive(Clone, Copy, Debug, Eq, PartialEq, Hash, Ord, PartialOrd)]\npub enum DevPubKeyId {\n    ModuleId([u8; 8]),\n    AccKey(AccountKey),\n    External(u32),\n    WellKnown(\u0026'static str),\n}\n\nimpl DevPubKeyId {\n    pub fn is_internal(\u0026self) -\u003e bool {\n        match self {\n            \u0026DevPubKeyId::External(_) =\u003e false,\n            _ =\u003e true,\n        }\n    }\n}\n\nimpl serde::Serialize for DevPubKeyId {\n    fn serialize\u003cS\u003e(\u0026self, serializer: S) -\u003e Result\u003cS::Ok, S::Error\u003e\n    where\n        S: Serializer,\n    {\n        match self {\n            \u0026DevPubKeyId::ModuleId(bs) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"DevPubKeyId\", 0, \"ModuleId\", 1)?;\n                state.serialize_field(\u0026String::from_utf8_lossy(\u0026bs))?;\n                state.end()\n            }\n            \u0026DevPubKeyId::AccKey(k) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"DevPubKeyId\", 1, \"AccKey\", 1)?;\n                state.serialize_field(\u0026k)?;\n                state.end()\n            }\n            \u0026DevPubKeyId::External(e) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"DevPubKeyId\", 2, \"External\", 1)?;\n                state.serialize_field(\u0026e)?;\n                state.end()\n            }\n            \u0026DevPubKeyId::WellKnown(s) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"DevPubKeyId\", 3, \"WellKnown\", 1)?;\n                state.serialize_field(s)?;\n                state.end()\n            }\n        }\n    }\n}\n\n#[derive(Clone, Debug)]\npub struct DevPubKey {\n    id: DevPubKeyId,\n    acc_id: AccountId32,\n}\n\nimpl Serialize for DevPubKey {\n    fn serialize\u003cS\u003e(\u0026self, serializer: S) -\u003e Result\u003cS::Ok, S::Error\u003e\n    where\n        S: Serializer,\n    {\n        let mut state = serializer.serialize_struct(\"DevPubKey\", 2)?;\n        state.serialize_field(\"id\", \u0026self.id)?;\n        state.serialize_field(\"acc_id\", \u0026self.acc_id.to_string())?;\n        state.end()\n    }\n}\n\nimpl DevPubKey {\n    pub fn well_known(name: \u0026'static str, acc_id: AccountId32) -\u003e DevPubKey {\n        DevPubKey {\n            id: DevPubKeyId::WellKnown(name),\n            acc_id,\n        }\n    }\n\n    pub fn id(\u0026self) -\u003e DevPubKeyId {\n        self.id\n    }\n}\n\nimpl PubKey for DevPubKey {\n    type AccountId = AccountId32;\n\n    fn acc_id(\u0026self) -\u003e Self::AccountId {\n        self.acc_id.clone()\n    }\n}\n\nimpl From\u003cModuleId\u003e for DevPubKey {\n    fn from(x: ModuleId) -\u003e DevPubKey {\n        DevPubKey {\n            id: DevPubKeyId::ModuleId(x.0),\n            acc_id: x.into_account(),\n        }\n    }\n}\n\nimpl From\u003cAccountKey\u003e for DevPubKey {\n    fn from(x: AccountKey) -\u003e DevPubKey {\n        DevPubKey {\n            id: DevPubKeyId::AccKey(x),\n            acc_id: x.acc_id(),\n        }\n    }\n}\n\n#[derive(Eq, PartialEq)]\npub enum PubKeyStoreRegisterResult {\n    AddedNew,\n    ExistsNotModified,\n    ExistsReplaced,\n}\n\n#[derive(Debug)]\npub struct PubKeyStore {\n    items: HashMap\u003cAccountId32, DevPubKeyId\u003e,\n    next_id: u32,\n}\n\nimpl PubKeyStore {\n    pub fn new() -\u003e PubKeyStore {\n        PubKeyStore {\n            items: HashMap::new(),\n            next_id: 0,\n        }\n    }\n\n    pub fn register(\u0026mut self, pub_key: DevPubKey) -\u003e PubKeyStoreRegisterResult {\n        let DevPubKey { id, acc_id } = pub_key;\n        let item = self.items.get(\u0026acc_id);\n\n        if let Some(existing_id) = item {\n            match (existing_id, id) {\n                (_, DevPubKeyId::External(_)) =\u003e PubKeyStoreRegisterResult::ExistsNotModified,\n                _ =\u003e PubKeyStoreRegisterResult::ExistsReplaced,\n            }\n        } else {\n            self.items.insert(acc_id, id);\n            PubKeyStoreRegisterResult::AddedNew\n        }\n    }\n\n    pub fn register_external(\u0026mut self, acc_id: AccountId32) {\n        let id = DevPubKeyId::External(self.next_id);\n        let result = self.register(DevPubKey { id, acc_id });\n\n        if result == PubKeyStoreRegisterResult::AddedNew\n            || result == PubKeyStoreRegisterResult::ExistsReplaced\n        {\n            self.next_id = self.next_id + 1;\n        }\n    }\n\n    pub fn get_id(\u0026self, acc_id: \u0026AccountId32) -\u003e Option\u003cDevPubKeyId\u003e {\n        self.items.get(acc_id).map(|\u0026x| x)\n    }\n\n    pub fn dump(\u0026self) -\u003e Vec\u003cDevPubKey\u003e {\n        let mut items: Vec\u003c_\u003e = self\n            .items\n            .iter()\n            .map(|(acc_id, \u0026id)| DevPubKey {\n                id,\n                acc_id: acc_id.clone(),\n            })\n            .collect();\n\n        items.sort_by(|a, b| a.id.cmp(\u0026b.id));\n\n        items\n    }\n}\n\n/// Prepends \"//\" to the string if absent.\nfn ensure_canonical_seed(s: \u0026str) -\u003e String {\n    if !s.starts_with(\"//\") {\n        format!(\"//{}\", s)\n    } else {\n        String::from(s)\n    }\n}\n","traces":[{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[5767888],"length":1,"stats":{"Line":0},"fn_name":"generate_random_array_string"},{"line":43,"address":[5767905,5767928],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[5767916],"length":1,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[5767983],"length":1,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[5768048],"length":1,"stats":{"Line":0},"fn_name":"keyring_to_string"},{"line":51,"address":[5768057],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[5768672],"length":1,"stats":{"Line":0},"fn_name":"string_to_static_str"},{"line":117,"address":[5768681],"length":1,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":189,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":190,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":191,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":192,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":203,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":221,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":222,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":224,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":229,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":236,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":237,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":244,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":245,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":250,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":252,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":253,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":261,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":262,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":281,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":283,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":288,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":290,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":292,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":293,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":294,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":295,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":303,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":304,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":305,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":307,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":310,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":315,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":320,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":328,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":330,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[5772096],"length":1,"stats":{"Line":0},"fn_name":"ensure_canonical_seed"},{"line":336,"address":[5772123,5772381],"length":1,"stats":{"Line":0},"fn_name":null},{"line":337,"address":[5772206],"length":1,"stats":{"Line":0},"fn_name":null},{"line":339,"address":[5772174],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":131},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","keyring.rs"],"content":"use std::cmp::Eq;\nuse std::collections::HashMap;\nuse std::fmt::Debug;\nuse std::hash::Hash;\n\npub trait PubKey {\n    type AccountId;\n    fn acc_id(\u0026self) -\u003e Self::AccountId;\n}\n\npub trait KeyPair: PubKey {\n    fn key_pair(\u0026self) -\u003e sp_core::sr25519::Pair;\n}\n\npub struct Nonces\u003cK\u003e {\n    nonces: HashMap\u003cK, u32\u003e,\n}\n\nimpl\u003cK\u003e Nonces\u003cK\u003e {\n    pub fn new() -\u003e Nonces\u003cK\u003e {\n        Nonces {\n            nonces: HashMap::\u003cK, u32\u003e::new(),\n        }\n    }\n}\n\npub trait NonceManager {\n    type AccountKey: Copy + Debug;\n\n    fn is_initialized(\u0026self, key: Self::AccountKey) -\u003e bool;\n    fn init_nonce(\u0026mut self, key: Self::AccountKey, nonce: u32);\n    fn get_nonce_and_inc(\u0026mut self, key: Self::AccountKey) -\u003e u32;\n}\n\nimpl\u003cAccountKey: Copy + Debug + Eq + Hash\u003e NonceManager for Nonces\u003cAccountKey\u003e {\n    type AccountKey = AccountKey;\n\n    fn is_initialized(\u0026self, key: Self::AccountKey) -\u003e bool {\n        self.nonces.get(\u0026key).is_some()\n    }\n\n    fn init_nonce(\u0026mut self, key: Self::AccountKey, nonce: u32) {\n        if self.nonces.insert(key, nonce).is_some() {\n            panic!(\"nonce for key {:?} has already been initialized\", key);\n        }\n    }\n\n    fn get_nonce_and_inc(\u0026mut self, key: Self::AccountKey) -\u003e u32 {\n        let value = self.nonces.get_mut(\u0026key);\n\n        if let Some(value) = value {\n            let curr_nonce = *value;\n            *value = *value + 1;\n            curr_nonce\n        } else {\n            panic!(\"nonce for key {:?} is not initialized\", key);\n        }\n    }\n}\n","traces":[{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":14},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","main.rs"],"content":"#![recursion_limit = \"256\"]\n\npub mod financial;\npub mod key;\npub mod keyring;\npub mod manual_timestamp;\npub mod oracle;\npub mod requester;\npub mod runtime;\npub mod test;\npub mod test_context;\npub mod test_scripts;\npub mod timestamp;\n\nuse crate::key::{AccountKey, DevNonces, PubKeyStore};\nuse crate::keyring::PubKey;\nuse crate::test::init_nonce;\nuse crate::test_context::register_common_pub_keys;\n\nuse futures::lock::Mutex;\nuse log::{Level, Metadata, Record};\nuse log::{LevelFilter, SetLoggerError};\nuse runtime::TestRuntime;\nuse serde::{Deserialize, Serialize};\nuse sp_keyring::AccountKeyring;\nuse std::fs::File;\nuse std::io::BufReader;\nuse std::sync::Arc;\nuse substrate_subxt::ClientBuilder;\n#[allow(unused_imports)]\nuse test_scripts::test_financial::test_financial;\nuse test_scripts::test_oracle::test_oracle;\n\npub const ONE: u64 = 1_000_000_000;\n\n#[macro_use]\nextern crate lazy_static;\n\nstruct SimpleLogger;\nimpl log::Log for SimpleLogger {\n    fn enabled(\u0026self, metadata: \u0026Metadata) -\u003e bool {\n        metadata.level() \u003c= Level::Info\n    }\n\n    fn log(\u0026self, record: \u0026Record) {\n        if self.enabled(record.metadata()) {\n            println!(\"{} - {}\", record.level(), record.args());\n        }\n    }\n\n    fn flush(\u0026self) {}\n}\n\nstatic LOGGER: SimpleLogger = SimpleLogger;\n\npub fn init() -\u003e Result\u003c(), SetLoggerError\u003e {\n    log::set_logger(\u0026LOGGER).map(|()| log::set_max_level(LevelFilter::Info))\n}\n\n#[derive(Debug, Serialize, Deserialize, Clone)]\npub struct IntegrationTestConfig {\n    local: bool,\n    sudo: String,\n    endpoint: String,\n    tests_to_launch: Vec\u003cString\u003e,\n    validators: Vec\u003cString\u003e,\n}\n\npub fn read_integration_test_config() -\u003e IntegrationTestConfig {\n    let file = File::open(\"integration_test.json\").unwrap();\n    let reader = BufReader::new(file);\n    let conf: IntegrationTestConfig =\n        serde_json::from_reader(reader).expect(\"JSON was not well-formatted\");\n    println!(\"{:?}\", conf);\n    conf\n}\n\n#[async_std::main]\nasync fn main() -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    //init();\n    let config = read_integration_test_config();\n\n    let client = ClientBuilder::\u003cTestRuntime\u003e::new()\n        .set_page_size(1)\n        .set_url(\"ws://localhost:9944/\")\n        .build()\n        .await?;\n    let nonces = Arc::new(Mutex::new(DevNonces::new()));\n    let pub_key_store = Arc::new(Mutex::new(PubKeyStore::new()));\n    {\n        let mut store = pub_key_store.lock().await;\n        register_common_pub_keys(\u0026mut store);\n    }\n\n    let alice_acc = AccountKey::from(AccountKeyring::Alice);\n    println!(\"alice {:?}\", alice_acc.acc_id());\n    init_nonce(\u0026client, nonces.clone(), alice_acc).await?;\n\n    let sudo_acc = AccountKey::from(\u0026config.sudo);\n    println!(\"sudo {:?}\", sudo_acc.acc_id());\n    init_nonce(\u0026client, nonces.clone(), sudo_acc).await?;\n\n    if config\n        .tests_to_launch\n        .contains(\u0026\"test_financial\".to_string())\n    {\n        println!(\"\\n\\nRunning financial test \\n\\n\");\n        test_financial(\u0026client, nonces.clone()).await?;\n    }\n\n    if config.tests_to_launch.contains(\u0026\"test_oracle\".to_string()) {\n        println!(\"\\n\\nRunning oracle test \\n\\n\");\n        test_oracle(\u0026client, nonces.clone()).await?;\n    }\n\n    Ok(())\n}\n","traces":[{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[4454448,4454453,4454455],"length":1,"stats":{"Line":0},"fn_name":"flush"},{"line":56,"address":[4454464],"length":1,"stats":{"Line":0},"fn_name":"init"},{"line":57,"address":[5660992,5660996],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":69,"address":[4454544,4454595],"length":1,"stats":{"Line":0},"fn_name":"read_integration_test_config"},{"line":70,"address":[4454561,4454617],"length":1,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[4454641],"length":1,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[4454656],"length":1,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[4454764,4454915],"length":1,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[4456304,4456221,4456208,4456288],"length":1,"stats":{"Line":0},"fn_name":"main"},{"line":81,"address":[5669746],"length":1,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[5289060],"length":1,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[5670476,5670785,5670305,5670825],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[5670929,5670986,5670464,5670910],"length":1,"stats":{"Line":0},"fn_name":null},{"line":89,"address":[5671066,5671123,5670997],"length":1,"stats":{"Line":0},"fn_name":null},{"line":91,"address":[5289175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[5671538,5671566],"length":1,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[5671605],"length":1,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[5671705,5671645,5671781,5671849],"length":1,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[5289268],"length":1,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[5672431],"length":1,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[5672674,5672734,5672810,5672878],"length":1,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[5289297],"length":1,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[5673460,5673735,5673795,5674380],"length":1,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[5673751,5673772,5673661],"length":1,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[5673806],"length":1,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[5289324],"length":1,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[5674666,5675244,5674541,5674653,5674687],"length":1,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[5674718],"length":1,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[5289349],"length":1,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[5675370],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":35},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","manual_timestamp.rs"],"content":"use codec::Encode;\nuse core::marker::PhantomData;\nuse std::fmt::Debug;\nuse substrate_subxt::system::{System, SystemEventsDecoder};\nuse substrate_subxt_proc_macro::{module, Call, Store};\n\n#[module]\npub trait ManualTimestamp: System {}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct NowStore\u003cT: ManualTimestamp\u003e {\n    #[store(returns = u64)]\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, PartialEq, Call, Encode)]\npub struct AdvanceSecsCall\u003cT: ManualTimestamp\u003e {\n    pub secs: u32,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","oracle.rs"],"content":"use codec::{Codec, Encode};\nuse common::Asset;\nuse core::marker::PhantomData;\nuse sp_runtime::traits::Member;\nuse std::fmt::Debug;\nuse substrate_fixed::types::I64F64;\nuse substrate_subxt::system::{System, SystemEventsDecoder};\nuse substrate_subxt_proc_macro::{module, Call, Store};\n\npub type Price = I64F64;\n\n#[module]\npub trait Oracle: System {\n    type Asset: Default + Codec + Member;\n    type Price: Default + Codec + Member;\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct PricePointsStore\u003cT: Oracle\u003e {\n    #[store(returns = Price)]\n    pub asset: \u003cT as Oracle\u003e::Asset,\n}\n\n#[derive(Clone, Debug, PartialEq, Call, Encode)]\npub struct SetPriceCall\u003cT: Oracle\u003e {\n    pub asset: Asset,\n    pub value: Price,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","requester.rs"],"content":"use super::TestRuntime;\nuse crate::key::{AccountKey, DevNonces};\nuse crate::keyring::{KeyPair, NonceManager};\nuse crate::runtime::{AccountId, Balance};\nuse core::marker::PhantomData;\nuse futures::lock::Mutex;\nuse pallet_transaction_payment_rpc_runtime_api::RuntimeDispatchInfo;\nuse sp_keyring::AccountKeyring;\nuse std::collections::HashMap;\nuse std::sync::Arc;\nuse substrate_subxt::ExtrinsicSuccessWithFee;\nuse substrate_subxt::{sudo::SudoCall, Call, Client, PairSigner};\n\nlazy_static! {\n    pub static ref FEES: HashMap\u003cString, u64\u003e = vec![\n        (String::from(\"transfer_and_watch\"), 125_000_146),\n        (String::from(\"register_bailsman_and_watch\"), 125_000_105),\n        (String::from(\"unregister_bailsman_and_watch\"), 125_000_105),\n        (String::from(\"register_whitelist_and_watch\"), 125_000_139),\n        (String::from(\"unregister_whitelist_and_watch\"), 125_000_139),\n        (String::from(\"set_price_and_watch\"), 125_000_114),\n    ]\n    .into_iter()\n    .collect();\n}\n\npub struct Requester {\n    pub client: Client\u003csuper::TestRuntime\u003e,\n    nonces: HashMap\u003csuper::runtime::AccountId, u32\u003e,\n}\n\nimpl Requester {\n    pub fn new(client: Client\u003cTestRuntime\u003e) -\u003e Self {\n        Requester {\n            client,\n            nonces: HashMap::new(),\n        }\n    }\n\n    pub async fn with_sudo\u003cC: Call\u003cTestRuntime\u003e\u003e(\n        \u0026mut self,\n        call: C,\n    ) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n        let alice = AccountKeyring::Alice;\n        let mut signer = PairSigner::new(alice.pair()); //hardcode Alice as sudo signer\n        let sudo_nonce = self\n            .increment_nonce(AccountKeyring::Alice.to_account_id())\n            .await?;\n\n        signer.set_nonce(sudo_nonce);\n        let encoded = self.client.encode(call)?;\n        let sudo = SudoCall {\n            call: \u0026encoded,\n            _runtime: PhantomData,\n        };\n        let extrinsic = self.client.watch(sudo, \u0026signer).await?;\n        println!(\"with_sudo extrinsic {:?}\", extrinsic);\n        Ok(())\n    }\n\n    pub async fn increment_nonce(\n        \u0026mut self,\n        who: AccountId,\n    ) -\u003e Result\u003cu32, Box\u003cdyn std::error::Error\u003e\u003e {\n        let nonce = self\n            .nonces\n            .entry(who.clone())\n            .and_modify(|a| *a += 1)\n            .or_insert(\n                self.client\n                    .fetch_or_default(\n                        \u0026substrate_subxt::system::AccountStore { account_id: \u0026who },\n                        None,\n                    )\n                    .await\n                    .unwrap()\n                    .nonce,\n            );\n        println!(\"new nonce is {}\", nonce);\n        Ok(*nonce)\n    }\n}\n\npub type ChainCallSuccess = ExtrinsicSuccessWithFee\u003cTestRuntime, (AccountKey, Balance)\u003e;\npub type ChainCallResult = Result\u003cVec\u003cChainCallSuccess\u003e, Box\u003cdyn std::error::Error\u003e\u003e;\n\npub async fn call_chain\u003cC: Call\u003cTestRuntime\u003e + Send + Sync\u003e(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n    account_key: AccountKey,\n    call: C,\n) -\u003e Result\u003cVec\u003cChainCallSuccess\u003e, Box\u003cdyn std::error::Error\u003e\u003e {\n    let nonce = { nonces.lock().await.get_nonce_and_inc(account_key) };\n    println!(\"Current nonce for {:?} is {}\", account_key, nonce);\n\n    let mut signer = PairSigner::new(account_key.key_pair());\n    signer.set_nonce(nonce);\n    let extrinsic = client.create_signed(call, \u0026signer).await?;\n    let decoder = TestRuntime::create_decoder(client.metadata().clone());\n    let success = client\n        .submit_and_watch_extrinsic_with_fee::\u003cBalance\u003e(extrinsic, decoder)\n        .await?;\n    let fee = success\n        .dispatch_info\n        .as_ref()\n        .map(|x| x.partial_fee)\n        .unwrap_or(0);\n\n    println!(\"incoming fee for {:?}: {}\", account_key, fee);\n\n    Ok(vec![ExtrinsicSuccessWithFee {\n        block: success.block,\n        extrinsic: success.extrinsic,\n        events: success.events,\n        dispatch_info: success.dispatch_info.map(|x| RuntimeDispatchInfo {\n            weight: x.weight,\n            class: x.class,\n            partial_fee: (account_key, x.partial_fee),\n        }),\n    }])\n}\n\npub async fn sudo_call_chain\u003cC: Call\u003cTestRuntime\u003e + Send + Sync\u003e(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n    call: C,\n) -\u003e Result\u003cVec\u003cChainCallSuccess\u003e, Box\u003cdyn std::error::Error\u003e\u003e {\n    let encoded = client.encode(call)?;\n    let sudo_call = SudoCall {\n        call: \u0026encoded,\n        _runtime: PhantomData,\n    };\n\n    call_chain(client, nonces, AccountKeyring::Alice.into(), sudo_call).await\n}\n\npub async fn call_chain_unsigned\u003cC: Call\u003cTestRuntime\u003e + Send + Sync\u003e(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    call: C,\n) -\u003e Result\u003cVec\u003cChainCallSuccess\u003e, Box\u003cdyn std::error::Error\u003e\u003e {\n    let extrinsic = client.create_unsigned(call)?;\n    let decoder = TestRuntime::create_decoder(client.metadata().clone());\n    let success = client\n        .submit_and_watch_extrinsic(extrinsic, decoder)\n        .await?;\n\n    Ok(vec![ExtrinsicSuccessWithFee {\n        block: success.block,\n        extrinsic: success.extrinsic,\n        events: success.events,\n        dispatch_info: Option::None,\n    }])\n}\n\n#[macro_export]\nmacro_rules! join_chain_calls {\n    ( $($tokens:tt)* ) =\u003e {{\n        let join_result = try_join!($($tokens)*)?;\n\n        let vec_vec = tuple_to_vec!(join_result, $($tokens)*);\n\n        let flatten: Vec\u003c_\u003e = vec_vec.into_iter().flatten().collect();\n\n        flatten\n    }};\n}\n","traces":[{"line":15,"address":[5235057,5234883,5235371,5235234,5234970,5235450,5234777,5235144],"length":1,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[5234794],"length":1,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[5234899,5234856],"length":1,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[5234943,5234986],"length":1,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[5235030,5235073],"length":1,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[5235160,5235117],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[5235204,5235390],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[4493256,4493120],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":36,"address":[4493175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[5697568,5697792,5697680],"length":1,"stats":{"Line":0},"fn_name":"call_chain\u003cintegration_testing::manual_timestamp::AdvanceSecsCall\u003cintegration_testing::runtime::TestRuntime\u003e\u003e"},{"line":93,"address":[5245682,5284018,5248738],"length":1,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[5699248,5705215,5699475,5711390,5705542,5699575,5711490,5705442,5711163],"length":1,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[5705569,5699602,5711517],"length":1,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[5711582,5699667,5705634],"length":1,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[5711891,5700269,5700769,5706201,5712155,5700005,5715344,5705752,5700434,5712320,5711706,5711767,5709390,5699820,5706366,5699881,5711623,5699931,5705937,5703458,5705813,5705863,5712655,5699708,5705675,5711817,5706701],"length":1,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[5700913,5700404,5706336,5712799,5712828,5700942,5706874,5712290,5706845],"length":1,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[5284217,5245881,5248937],"length":1,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[5706893,5712847,5700961],"length":1,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[5702031,5707646,5713917,5701714,5707963,5702317,5708249,5713600,5714203],"length":1,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[5708372,5714326,5702440,5714261,5713889,5702375,5714216,5702330,5702003,5708307,5707935,5708262],"length":1,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[5698000,5697968,5697977,5698009,5697945,5697936],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cintegration_testing::financial::RecalcCall\u003cintegration_testing::runtime::TestRuntime\u003e\u003e"},{"line":109,"address":[5702645,5708577,5702733,5708665,5708393,5714347,5702461,5714619,5714531],"length":1,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[5709124,5708694,5703192,5714648,5714848,5702762,5715110,5702962,5703224,5709156,5715078,5708894],"length":1,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[5702775,5708707,5714661],"length":1,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[5714693,5702807,5708739],"length":1,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[5702839,5714725,5708771],"length":1,"stats":{"Line":0},"fn_name":null},{"line":115,"address":[5702879,5698106,5698234,5698362,5698032,5698288,5708811,5714765,5698160],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cintegration_testing::financial::RecalcCall\u003cintegration_testing::runtime::TestRuntime\u003e\u003e"},{"line":116,"address":[5698300,5698044,5698172],"length":1,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[5698303,5698175,5698047],"length":1,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[5698307,5698051,5698179],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":55},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","runtime.rs"],"content":"use super::{financial, manual_timestamp, oracle, timestamp};\nuse crate::financial::FinancialEventsDecoder;\nuse crate::manual_timestamp::ManualTimestampEventsDecoder;\nuse crate::oracle::OracleEventsDecoder;\nuse crate::timestamp::TimestampEventsDecoder;\nuse common::Asset;\nuse sp_runtime::traits::{BlakeTwo256, IdentifyAccount, Verify};\nuse sp_runtime::{generic, MultiSignature, OpaqueExtrinsic};\nuse substrate_fixed::types::I64F64;\nuse substrate_subxt::{\n    balances::{AccountData, Balances, BalancesEventsDecoder}, // needed for sign extra\n    extrinsic::DefaultExtra,\n    sudo::Sudo,\n    system::{System, SystemEventsDecoder},\n    EventsDecoder,\n    Metadata,\n    Runtime,\n};\n\n#[derive(Clone, PartialEq, Debug)]\npub struct TestRuntime;\n\nimpl TestRuntime {\n    pub fn create_decoder(metadata: Metadata) -\u003e EventsDecoder\u003cTestRuntime\u003e {\n        let mut decoder = EventsDecoder::\u003cTestRuntime\u003e::new(metadata);\n        decoder.with_system();\n        decoder.with_balances();\n        decoder.with_oracle();\n        decoder.with_timestamp();\n        decoder.with_financial();\n        decoder.with_manual_timestamp();\n\n        decoder.register_type_size::\u003cu64\u003e(\"u64\");\n\n        decoder\n    }\n}\n\nimpl Eq for TestRuntime {}\n\ntype Signature = MultiSignature;\n\nimpl Runtime for TestRuntime {\n    type Signature = Signature;\n    type Extra = DefaultExtra\u003cSelf\u003e;\n}\n\npub type AccountId = \u003c\u003cMultiSignature as Verify\u003e::Signer as IdentifyAccount\u003e::AccountId;\n\npub type Address = AccountId;\n\npub type FixedNumber = I64F64;\npub type Price = I64F64;\n\nimpl System for TestRuntime {\n    type Index = u32;\n    type BlockNumber = u32;\n    type Hash = sp_core::H256;\n    type Hashing = BlakeTwo256;\n    type AccountId = AccountId;\n    type Address = Self::AccountId;\n    type Header = generic::Header\u003cSelf::BlockNumber, BlakeTwo256\u003e;\n    type Extrinsic = OpaqueExtrinsic;\n    type AccountData = AccountData\u003c\u003cSelf as Balances\u003e::Balance\u003e;\n}\n\npub type Balance = u128;\n\nimpl Balances for TestRuntime {\n    type Balance = Balance;\n}\n\nimpl timestamp::Timestamp for TestRuntime {\n    type Moment = u64;\n}\n\nimpl Sudo for TestRuntime {}\n\nimpl oracle::Oracle for TestRuntime {\n    type Asset = Asset;\n    type Price = FixedNumber;\n}\n\nimpl financial::Financial for TestRuntime {\n    type Asset = Asset;\n    type FixedNumber = FixedNumber;\n    type Price = FixedNumber;\n}\n\nimpl manual_timestamp::ManualTimestamp for TestRuntime {}\n","traces":[{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":10},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","test.rs"],"content":"use crate::key::{AccountKey, DevNonces};\nuse crate::keyring::{NonceManager, PubKey};\nuse crate::runtime::TestRuntime;\nuse futures::lock::Mutex;\nuse sp_arithmetic::FixedI64;\nuse std::sync::Arc;\nuse substrate_subxt::Client;\n\npub fn i128_to_u64(n: i128) -\u003e Option\u003cu64\u003e {\n    if n \u003c 0 || n \u003e u64::MAX as i128 {\n        return None;\n    }\n    Some(n as u64)\n}\n\npub fn i128_to_fixedi64(n: i128) -\u003e Option\u003cFixedI64\u003e {\n    if n \u003c i64::MIN as i128 || n \u003e i64::MAX as i128 {\n        return None;\n    }\n\n    Some(FixedI64::from_inner(n as i64))\n}\n\npub async fn init_nonce(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n    account_key: AccountKey,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    let mut nonces = nonces.lock().await;\n\n    if nonces.is_initialized(account_key) {\n        Ok(())\n    } else {\n        let id = account_key.acc_id();\n        let initial_nonce = client\n            .fetch_or_default(\n                \u0026substrate_subxt::system::AccountStore { account_id: \u0026id },\n                None,\n            )\n            .await\n            .unwrap()\n            .nonce;\n\n        nonces.init_nonce(account_key, initial_nonce);\n\n        println!(\"Initial nonce for {:?} is {}\", account_key, initial_nonce);\n\n        Ok(())\n    }\n}\n","traces":[{"line":9,"address":[5584864],"length":1,"stats":{"Line":0},"fn_name":"i128_to_u64"},{"line":10,"address":[5584878],"length":1,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[5584946],"length":1,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[5584930],"length":1,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[5584976],"length":1,"stats":{"Line":0},"fn_name":"i128_to_fixedi64"},{"line":17,"address":[5585000],"length":1,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[5585105],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[5585134,5585089],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[5585152],"length":1,"stats":{"Line":0},"fn_name":"init_nonce"},{"line":29,"address":[5292132],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[5310820,5310930,5310987],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[5310975],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[5310946],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[5292203],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[5311004],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[5311035],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[5311615,5311583],"length":1,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[5311945,5311858,5311800,5311673],"length":1,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[5311964],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":19},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","test_context.rs"],"content":"use super::runtime::AccountId;\nuse crate::financial::{PerAssetMetricsStoreExt, PriceLogsStoreExt, UpdatesStoreExt};\nuse crate::key::{AccountKey, DevPubKey, DevPubKeyId, PubKeyStore};\nuse crate::manual_timestamp::NowStoreExt;\nuse crate::oracle::PricePointsStoreExt;\nuse crate::runtime::{FixedNumber, Price, TestRuntime};\nuse common::Asset;\nuse pallet_financial::{AssetMetrics, PriceLog, PriceUpdate};\nuse serde::ser::SerializeTupleVariant;\nuse serde::{Serialize, Serializer};\nuse sp_keyring::sr25519::Keyring;\nuse sp_runtime::{AccountId32, ModuleId};\nuse std::collections::HashMap;\nuse std::fmt::Debug;\nuse std::{cell::RefCell, hash::Hash, str::FromStr};\nuse substrate_subxt::Client;\n\n// Used for selfless traits implementations\nthread_local! {\n    static SAVED_TD: RefCell\u003cOption\u003cTestData\u003e\u003e = RefCell::new(Option::None)\n}\n\n#[derive(Debug, PartialEq, Eq, Ord, PartialOrd)]\npub enum AccountName {\n    Id(DevPubKeyId),\n    Unknown(AccountId),\n}\n\nimpl Serialize for AccountName {\n    fn serialize\u003cS\u003e(\u0026self, serializer: S) -\u003e Result\u003cS::Ok, S::Error\u003e\n    where\n        S: Serializer,\n    {\n        match self.clone() {\n            AccountName::Id(id) =\u003e {\n                let mut state = serializer.serialize_tuple_variant(\"AccountName\", 0, \"Id\", 1)?;\n                state.serialize_field(\u0026id)?;\n                state.end()\n            }\n            AccountName::Unknown(u) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"AccountName\", 1, \"Unknown\", 1)?;\n                state.serialize_field(\u0026u)?;\n                state.end()\n            }\n        }\n    }\n}\n\npub fn get_known_modules() -\u003e Vec\u003cDevPubKey\u003e {\n    vec![]\n        .into_iter()\n        .map(|\u0026x| DevPubKey::from(ModuleId(x)))\n        .collect()\n}\n\npub fn register_common_pub_keys(pub_key_store: \u0026mut PubKeyStore) {\n    for k in Keyring::iter() {\n        let acc_key = AccountKey::from(k);\n        pub_key_store.register(acc_key.into());\n    }\n\n    let known_modules: Vec\u003c_\u003e = get_known_modules();\n\n    for m in known_modules {\n        pub_key_store.register(m);\n    }\n\n    let known_pub_keys: Vec\u003c_\u003e = vec![(\n        \"Alice//stash\",\n        \"0xbe5ddb1579b72e84524fc29e78609e3caf42e85aa118ebfe0b0ad404b5bdd25f\",\n    )]\n    .into_iter()\n    .map(|(name, acc_id_str)| {\n        DevPubKey::well_known(name, AccountId32::from_str(acc_id_str).unwrap())\n    })\n    .collect();\n\n    for k in known_pub_keys {\n        pub_key_store.register(k);\n    }\n}\n\n#[derive(Debug, Clone)]\npub struct TestData {\n    pub price_points: HashMap\u003cAsset, FixedNumber\u003e,\n    pub updates: HashMap\u003cAsset, Option\u003cPriceUpdate\u003cFixedNumber\u003e\u003e\u003e,\n    pub price_logs: HashMap\u003cAsset, Option\u003cPriceLog\u003cFixedNumber\u003e\u003e\u003e,\n    pub per_asset_metrics: HashMap\u003cAsset, Option\u003cAssetMetrics\u003cAsset, Price\u003e\u003e\u003e,\n    pub now: u64,\n}\n\nimpl TestData {\n    pub fn new() -\u003e Self {\n        TestData {\n            price_points: HashMap::new(),\n            updates: HashMap::new(),\n            price_logs: HashMap::new(),\n            per_asset_metrics: HashMap::new(),\n            now: 0,\n        }\n    }\n\n    pub fn clear(\u0026mut self) {\n        self.price_points.clear();\n        self.updates.clear();\n        self.price_logs.clear();\n        self.per_asset_metrics.clear();\n        self.now = 0;\n    }\n\n    pub fn to_static(\u0026self) {\n        SAVED_TD.with(|td_ref| {\n            td_ref.replace(Some(self.clone()));\n        });\n    }\n\n    pub fn get_static() -\u003e Self {\n        SAVED_TD.with(|td_ref| {\n            let result = td_ref.borrow().clone();\n            match result {\n                Some(td) =\u003e td,\n                None =\u003e panic!(\"Error during attempt to access LTS TestData - no data\"),\n            }\n        })\n    }\n}\n\npub const EPS: i64 = 1_0;\n\npub trait EqWithEps {\n    fn eq_with_eps(\u0026self, other: \u0026Self) -\u003e bool;\n}\n\nimpl EqWithEps for u64 {\n    fn eq_with_eps(\u0026self, other: \u0026Self) -\u003e bool {\n        (*self as i64 - *other as i64).abs() \u003c EPS\n    }\n}\n\nimpl\u003cK, V\u003e EqWithEps for HashMap\u003cK, V\u003e\nwhere\n    K: Eq + Hash,\n    V: EqWithEps,\n{\n    fn eq_with_eps(\u0026self, other: \u0026Self) -\u003e bool {\n        self.len() == other.len()\n            \u0026\u0026 self\n                .iter()\n                .all(|(k, v)| (*other).get(k).map_or(false, |v2| v.eq_with_eps(v2)))\n    }\n}\n\npub struct TestContext {}\n\nimpl TestContext {\n    pub async fn read_storage(\n        client: \u0026Client\u003cTestRuntime\u003e,\n    ) -\u003e Result\u003cTestData, Box\u003cdyn std::error::Error\u003e\u003e {\n        let mut data = TestData::new();\n\n        for asset in Asset::iterator() {\n            let price_points = client.price_points(*asset, Option::None).await;\n            data.price_points.insert(*asset, price_points.unwrap());\n\n            let updates = client.updates(*asset, Option::None).await;\n            data.updates.insert(*asset, updates.unwrap());\n\n            let price_logs = client.price_logs(*asset, Option::None).await;\n            data.price_logs.insert(*asset, price_logs.unwrap());\n\n            let metrics = client.per_asset_metrics(*asset, Option::None).await;\n            data.per_asset_metrics.insert(*asset, metrics.unwrap());\n        }\n        data.now = client.now(Option::None).await.unwrap();\n\n        Ok(data)\n    }\n}\n","traces":[{"line":20,"address":[4389578],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[4387120],"length":1,"stats":{"Line":0},"fn_name":"get_known_modules"},{"line":51,"address":[4387127],"length":1,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[4348705,4348688],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":57,"address":[4387216,4387249],"length":1,"stats":{"Line":0},"fn_name":"register_common_pub_keys"},{"line":58,"address":[4387236,4387269,4387339,4387451],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[4387366],"length":1,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[4387379],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[4387324],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[4387671,4387630,4387456,4388013],"length":1,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[4387929],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[4388018],"length":1,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[4348783,4348768],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":75,"address":[4348827],"length":1,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[4388218,4388775,4388433,4388392],"length":1,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[4388691],"length":1,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":120,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":160,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":66},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","test_scripts","mod.rs"],"content":"pub use super::*;\n\npub mod test_financial;\npub mod test_oracle;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","test_scripts","test_financial.rs"],"content":"use crate::financial::{MetricsStoreExt, RecalcCall, UpdatesStoreExt};\nuse crate::key::{AccountKey, DevNonces};\nuse crate::manual_timestamp::{AdvanceSecsCall, NowStoreExt};\nuse crate::oracle::{PricePointsStoreExt, SetPriceCall};\nuse crate::runtime::FixedNumber;\nuse crate::test::init_nonce;\nuse crate::{join_chain_calls, requester::call_chain, TestRuntime};\nuse approx::assert_abs_diff_eq;\nuse common::Asset;\nuse core::time::Duration;\nuse futures::{lock::Mutex, try_join};\nuse integration_testing_macro::tuple_to_vec;\nuse itertools::izip;\nuse pallet_financial::FinancialMetrics;\nuse sp_keyring::AccountKeyring;\nuse std::{marker::PhantomData, sync::Arc};\nuse substrate_fixed::traits::LossyInto;\nuse substrate_subxt::Client;\n\npub async fn test_financial(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    println!(\"Start recalc asset test\");\n    let alice_key = AccountKey::from(AccountKeyring::Alice);\n    init_nonce(client, nonces.clone(), alice_key).await?;\n    let secs_to_move = 86400;\n\n    // ------------------------------------ Setting prices ------------------------------------\n\n    set_prices_and_move_time(client, alice_key, nonces.clone(), secs_to_move).await?;\n\n    // ------------------------------- Recalc financial pallet -------------------------------\n\n    println!(\"Recalc financial pallet for every asset\");\n    call_chain(\n        client,\n        nonces.clone(),\n        alice_key,\n        RecalcCall {\n            _runtime: PhantomData,\n        },\n    )\n    .await?;\n\n    // ---------------------------------- Assert chain state ----------------------------------\n\n    assert_first_recalc_chain_state(client).await?;\n\n    // -------------------- Setting prices 1 day after month prices setted --------------------\n\n    set_prices_after_month(client, alice_key, nonces.clone(), secs_to_move).await?;\n\n    // ------------------------------- Recalc financial pallet -------------------------------\n\n    println!(\"Recalc financial pallet for every asset\");\n    call_chain(\n        client,\n        nonces.clone(),\n        alice_key,\n        RecalcCall {\n            _runtime: PhantomData,\n        },\n    )\n    .await?;\n\n    // ---------------------------------- Assert chain state ----------------------------------\n\n    assert_second_recalc_chain_state(client).await?;\n\n    // ------------------------------------ Test assertion ------------------------------------\n\n    println!(\"Assertion successful, test passed\");\n\n    Ok(())\n}\n\nfn assert_vectors_with_epsilon(\n    step_name: \u0026str,\n    actual_vec: Vec\u003cFixedNumber\u003e,\n    expected_vec: Vec\u003cFixedNumber\u003e,\n) {\n    println!(\"Assert vectors elements. {}\", step_name);\n    let actual: Vec\u003cf64\u003e = actual_vec.into_iter().map(|x| x.lossy_into()).collect();\n    let expected: Vec\u003cf64\u003e = expected_vec.into_iter().map(|x| x.lossy_into()).collect();\n\n    for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n        assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n    }\n}\n\nfn assert_metrics_assets(metrics: \u0026FinancialMetrics\u003cAsset, FixedNumber\u003e) {\n    for (actual, expect) in metrics.clone().assets.into_iter().zip(Asset::iterator()) {\n        assert!(actual.value() == expect.value());\n    }\n}\n\nasync fn assert_second_recalc_chain_state(\n    client: \u0026Client\u003cTestRuntime\u003e,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    let metrics = client.metrics(Option::None).await?.unwrap();\n\n    assert_metrics_assets(\u0026metrics);\n\n    let expected_volatilities: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(0.0),               // usd\n        FixedNumber::from_num(0.041212132650566), // eq\n        FixedNumber::from_num(0.026979767511806), // eth\n        FixedNumber::from_num(0.019530767671752), // btc\n        FixedNumber::from_num(0.022172261805909), // eos\n    ];\n\n    assert_vectors_with_epsilon(\n        \"Assert assets volatilities\",\n        metrics.volatilities,\n        expected_volatilities,\n    );\n\n    let expected_correlations: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.58314744717848),\n        FixedNumber::from_num(0.5055289438838),\n        FixedNumber::from_num(-0.14858602369776),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.58314744717848),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.72688913085808),\n        FixedNumber::from_num(0.33944301098853),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.5055289438838),\n        FixedNumber::from_num(0.72688913085808),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.18143650586153),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(-0.14858602369776),\n        FixedNumber::from_num(0.33944301098853),\n        FixedNumber::from_num(0.18143650586153),\n        FixedNumber::from_num(1),\n    ];\n\n    let expected_covariances: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.001698439877608),\n        FixedNumber::from_num(0.00064839800627),\n        FixedNumber::from_num(0.00040690256633),\n        FixedNumber::from_num(-0.00013577288546),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.00064839800627),\n        FixedNumber::from_num(0.000727907854991),\n        FixedNumber::from_num(0.0003830237393),\n        FixedNumber::from_num(0.00020305564717),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.00040690256633),\n        FixedNumber::from_num(0.0003830237393),\n        FixedNumber::from_num(0.000381450885848),\n        FixedNumber::from_num(0.00007856949929),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(-0.00013577288546),\n        FixedNumber::from_num(0.00020305564717),\n        FixedNumber::from_num(0.00007856949929),\n        FixedNumber::from_num(0.00049160919359),\n    ];\n\n    let actual_correlations: Vec\u003cFixedNumber\u003e = metrics.correlations;\n    let actual_covariances: Vec\u003cFixedNumber\u003e = metrics.covariances;\n\n    assert_vectors_with_epsilon(\n        \"Assert correlations matrix\",\n        actual_correlations,\n        expected_correlations,\n    );\n\n    assert_vectors_with_epsilon(\n        \"Assert covariances matrix\",\n        actual_covariances,\n        expected_covariances,\n    );\n\n    // let actual_btc_metrics = client\n    //     .per_asset_metrics(Asset::Btc, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eos_metrics = client\n    //     .per_asset_metrics(Asset::Eos, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eth_metrics = client\n    //     .per_asset_metrics(Asset::Eth, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eq_metrics = client\n    //     .per_asset_metrics(Asset::Eq, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_usd_metrics = client\n    //     .per_asset_metrics(Asset::Usd, Option::None)\n    //     .await?\n    //     .unwrap();\n\n    // let expected_btc_log_return = vec![\n    //     FixedNumber::from_num(-0.017851775539992),\n    //     FixedNumber::from_num(0.006485899505049),\n    //     FixedNumber::from_num(0.023702618762709),\n    //     FixedNumber::from_num(0.011824769398687),\n    //     FixedNumber::from_num(0.021735125114429),\n    //     FixedNumber::from_num(0.006526171853234),\n    //     FixedNumber::from_num(0.014313388019069),\n    //     FixedNumber::from_num(-0.009840284915377),\n    //     FixedNumber::from_num(0.000175008750884),\n    //     FixedNumber::from_num(0.006888460773841),\n    //     FixedNumber::from_num(-0.015941477997688),\n    //     FixedNumber::from_num(0.003701423103186),\n    //     FixedNumber::from_num(0.012674440896728),\n    //     FixedNumber::from_num(0.020971976194077),\n    //     FixedNumber::from_num(0.013936624912131),\n    //     FixedNumber::from_num(0.072074847729704),\n    //     FixedNumber::from_num(0.013719550155069),\n    //     FixedNumber::from_num(-0.004088407746743),\n    //     FixedNumber::from_num(0.014503573115766),\n    //     FixedNumber::from_num(-0.006496755376766),\n    //     FixedNumber::from_num(0.002144772940134),\n    //     FixedNumber::from_num(0.043203424778333),\n    //     FixedNumber::from_num(-0.026735589150183),\n    //     FixedNumber::from_num(0.013160052345472),\n    //     FixedNumber::from_num(0.007695760935366),\n    //     FixedNumber::from_num(0.017319297317554),\n    //     FixedNumber::from_num(-0.002974789061153),\n    //     FixedNumber::from_num(-0.013976007681055),\n    //     FixedNumber::from_num(0.0328349845197),\n    // ];\n\n    // let expected_eos_log_return = vec![\n    //     FixedNumber::from_num(0.063945225362233),\n    //     FixedNumber::from_num(-0.018342269805096),\n    //     FixedNumber::from_num(-0.014076701910362),\n    //     FixedNumber::from_num(0.013698844358162),\n    //     FixedNumber::from_num(-0.00151285959263),\n    //     FixedNumber::from_num(0.006789916693474),\n    //     FixedNumber::from_num(-0.004899199548643),\n    //     FixedNumber::from_num(-0.002648006086739),\n    //     FixedNumber::from_num(-0.011045627441233),\n    //     FixedNumber::from_num(-0.004606534057638),\n    //     FixedNumber::from_num(-0.023750386367157),\n    //     FixedNumber::from_num(-0.004739345363897),\n    //     FixedNumber::from_num(0.008671713781618),\n    //     FixedNumber::from_num(0.014029848210439),\n    //     FixedNumber::from_num(-0.021514618232527),\n    //     FixedNumber::from_num(0.032292243726357),\n    //     FixedNumber::from_num(0.022336722713639),\n    //     FixedNumber::from_num(-0.01091672802769),\n    //     FixedNumber::from_num(0.007917100731662),\n    //     FixedNumber::from_num(0.017126256271163),\n    //     FixedNumber::from_num(-0.028455682588786),\n    //     FixedNumber::from_num(0.014703375160227),\n    //     FixedNumber::from_num(-0.006382600980497),\n    //     FixedNumber::from_num(-0.006423600398779),\n    //     FixedNumber::from_num(-0.049738301151431),\n    //     FixedNumber::from_num(0.006750075262365),\n    //     FixedNumber::from_num(-0.003567892783902),\n    //     FixedNumber::from_num(-0.033518179087602),\n    //     FixedNumber::from_num(-0.027901039512794),\n    // ];\n\n    // let expected_eth_log_return = vec![\n    //     FixedNumber::from_num(-0.037176219300342),\n    //     FixedNumber::from_num(0.003105046726959),\n    //     FixedNumber::from_num(0.026808317225208),\n    //     FixedNumber::from_num(0.039664149077215),\n    //     FixedNumber::from_num(0.014858549313211),\n    //     FixedNumber::from_num(0.009366053036486),\n    //     FixedNumber::from_num(0.032947494656537),\n    //     FixedNumber::from_num(-0.014317195829359),\n    //     FixedNumber::from_num(-0.006048511576352),\n    //     FixedNumber::from_num(-0.003726170720288),\n    //     FixedNumber::from_num(-0.032615096229953),\n    //     FixedNumber::from_num(0.008362550947202),\n    //     FixedNumber::from_num(0.026209855400584),\n    //     FixedNumber::from_num(0.002559874723751),\n    //     FixedNumber::from_num(-0.02852562591775),\n    //     FixedNumber::from_num(0.059791550432133),\n    //     FixedNumber::from_num(0.057189635500972),\n    //     FixedNumber::from_num(-0.011965145719892),\n    //     FixedNumber::from_num(0.007249581694894),\n    //     FixedNumber::from_num(-0.015117944327008),\n    //     FixedNumber::from_num(-0.033149995299452),\n    //     FixedNumber::from_num(0.02668163550439),\n    //     FixedNumber::from_num(-0.037783197312849),\n    //     FixedNumber::from_num(-0.003168839842996),\n    //     FixedNumber::from_num(-0.012410908361374),\n    //     FixedNumber::from_num(0.010422040197932),\n    //     FixedNumber::from_num(0.025476158297524),\n    //     FixedNumber::from_num(-0.033679947915332),\n    //     FixedNumber::from_num(0.011842738081395),\n    // ];\n\n    // let expected_usd_log_return = vec![\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    // ];\n\n    // let expected_eq_log_return = vec![\n    //     FixedNumber::from_num(-0.104400822685896),\n    //     FixedNumber::from_num(0.027852562402598),\n    //     FixedNumber::from_num(0.065930399912786),\n    //     FixedNumber::from_num(0.033634655314806),\n    //     FixedNumber::from_num(-0.003995774502009),\n    //     FixedNumber::from_num(0.00070629785161),\n    //     FixedNumber::from_num(0.014254242982982),\n    //     FixedNumber::from_num(-0.012608152076313),\n    //     FixedNumber::from_num(-0.01395976768789),\n    //     FixedNumber::from_num(-0.02411498578672),\n    //     FixedNumber::from_num(-0.04569512959085),\n    //     FixedNumber::from_num(0.013954304827044),\n    //     FixedNumber::from_num(0.035152134114813),\n    //     FixedNumber::from_num(-0.030125734992472),\n    //     FixedNumber::from_num(-0.018980703949385),\n    //     FixedNumber::from_num(0.05686029412138),\n    //     FixedNumber::from_num(0.030193664145268),\n    //     FixedNumber::from_num(-0.000937207191374),\n    //     FixedNumber::from_num(0.021795437311784),\n    //     FixedNumber::from_num(-0.006442728222199),\n    //     FixedNumber::from_num(0.083021433280261),\n    //     FixedNumber::from_num(-0.00575265248945),\n    //     FixedNumber::from_num(-0.069221835426132),\n    //     FixedNumber::from_num(-0.073632490279114),\n    //     FixedNumber::from_num(0.00712271217112),\n    //     FixedNumber::from_num(0.023462196064631),\n    //     FixedNumber::from_num(0.009280256966068),\n    //     FixedNumber::from_num(-0.044807107555325),\n    //     FixedNumber::from_num(-0.001983635661594),\n    // ];\n\n    // assert_vectors_with_epsilon(\n    //     \"BTC log return\",\n    //     actual_btc_metrics.returns,\n    //     expected_btc_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"EOS log return\",\n    //     actual_eos_metrics.returns,\n    //     expected_eos_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"ETH log return\",\n    //     actual_eth_metrics.returns,\n    //     expected_eth_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"USD log return\",\n    //     actual_usd_metrics.returns,\n    //     expected_usd_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"EQ log return\",\n    //     actual_eq_metrics.returns,\n    //     expected_eq_log_return,\n    // );\n\n    Ok(())\n}\n\nasync fn assert_first_recalc_chain_state(\n    client: \u0026Client\u003cTestRuntime\u003e,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    let metrics = client.metrics(Option::None).await?.unwrap();\n\n    assert_metrics_assets(\u0026metrics);\n\n    let expected_volatilities: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(0.0),              // usd\n        FixedNumber::from_num(0.04121390630829), // eq\n        FixedNumber::from_num(0.02692861833717), // eth\n        FixedNumber::from_num(0.01899396779000), // btc\n        FixedNumber::from_num(0.02163976358360), // eos\n    ];\n\n    assert_vectors_with_epsilon(\n        \"Assert assets volatilities\",\n        metrics.volatilities,\n        expected_volatilities,\n    );\n\n    let expected_correlations: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.58444399870037),\n        FixedNumber::from_num(0.52044196493031),\n        FixedNumber::from_num(-0.15357736293063),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.58444399870037),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.73404325427508),\n        FixedNumber::from_num(0.36263027397808),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.52044196493031),\n        FixedNumber::from_num(0.73404325427508),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.24738115822628),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(-0.15357736293063),\n        FixedNumber::from_num(0.36263027397808),\n        FixedNumber::from_num(0.24738115822628),\n        FixedNumber::from_num(1),\n    ];\n\n    let expected_covariances: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.001698586073),\n        FixedNumber::from_num(0.0006486355597),\n        FixedNumber::from_num(0.00040741009369),\n        FixedNumber::from_num(-0.00013696938233),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.0006486355597),\n        FixedNumber::from_num(0.0007251504855),\n        FixedNumber::from_num(0.0003754494048),\n        FixedNumber::from_num(0.00021131515315),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.00040741009369),\n        FixedNumber::from_num(0.0003754494048),\n        FixedNumber::from_num(0.00036077081241),\n        FixedNumber::from_num(0.00010167983375),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(-0.00013696938233),\n        FixedNumber::from_num(0.00021131515315),\n        FixedNumber::from_num(0.00010167983375),\n        FixedNumber::from_num(0.000468279368),\n    ];\n\n    let actual_correlations: Vec\u003cFixedNumber\u003e = metrics.correlations;\n    let actual_covariances: Vec\u003cFixedNumber\u003e = metrics.covariances;\n\n    assert_vectors_with_epsilon(\n        \"Assert correlations matrix\",\n        actual_correlations,\n        expected_correlations,\n    );\n\n    assert_vectors_with_epsilon(\n        \"Assert covariances matrix\",\n        actual_covariances,\n        expected_covariances,\n    );\n\n    // let actual_btc_metrics = client\n    //     .per_asset_metrics(Asset::Btc, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eos_metrics = client\n    //     .per_asset_metrics(Asset::Eos, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eth_metrics = client\n    //     .per_asset_metrics(Asset::Eth, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eq_metrics = client\n    //     .per_asset_metrics(Asset::Eq, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_usd_metrics = client\n    //     .per_asset_metrics(Asset::Usd, Option::None)\n    //     .await?\n    //     .unwrap();\n\n    // let expected_btc_log_return = vec![\n    //     FixedNumber::from_num(0.011084832424493),\n    //     FixedNumber::from_num(-0.017851775539992),\n    //     FixedNumber::from_num(0.006485899505049),\n    //     FixedNumber::from_num(0.023702618762709),\n    //     FixedNumber::from_num(0.011824769398687),\n    //     FixedNumber::from_num(0.021735125114429),\n    //     FixedNumber::from_num(0.006526171853234),\n    //     FixedNumber::from_num(0.014313388019069),\n    //     FixedNumber::from_num(-0.009840284915377),\n    //     FixedNumber::from_num(0.000175008750884),\n    //     FixedNumber::from_num(0.006888460773841),\n    //     FixedNumber::from_num(-0.015941477997688),\n    //     FixedNumber::from_num(0.003701423103186),\n    //     FixedNumber::from_num(0.012674440896728),\n    //     FixedNumber::from_num(0.020971976194077),\n    //     FixedNumber::from_num(0.013936624912131),\n    //     FixedNumber::from_num(0.072074847729704),\n    //     FixedNumber::from_num(0.013719550155069),\n    //     FixedNumber::from_num(-0.004088407746743),\n    //     FixedNumber::from_num(0.014503573115766),\n    //     FixedNumber::from_num(-0.006496755376766),\n    //     FixedNumber::from_num(0.002144772940134),\n    //     FixedNumber::from_num(0.043203424778333),\n    //     FixedNumber::from_num(-0.026735589150183),\n    //     FixedNumber::from_num(0.013160052345472),\n    //     FixedNumber::from_num(0.007695760935366),\n    //     FixedNumber::from_num(0.017319297317554),\n    //     FixedNumber::from_num(-0.002974789061153),\n    //     FixedNumber::from_num(-0.013976007681055),\n    // ];\n\n    // let expected_eos_log_return = vec![\n    //     FixedNumber::from_num(0.003961970317355),\n    //     FixedNumber::from_num(0.063945225362233),\n    //     FixedNumber::from_num(-0.018342269805096),\n    //     FixedNumber::from_num(-0.014076701910362),\n    //     FixedNumber::from_num(0.013698844358162),\n    //     FixedNumber::from_num(-0.00151285959263),\n    //     FixedNumber::from_num(0.006789916693474),\n    //     FixedNumber::from_num(-0.004899199548643),\n    //     FixedNumber::from_num(-0.002648006086739),\n    //     FixedNumber::from_num(-0.011045627441233),\n    //     FixedNumber::from_num(-0.004606534057638),\n    //     FixedNumber::from_num(-0.023750386367157),\n    //     FixedNumber::from_num(-0.004739345363897),\n    //     FixedNumber::from_num(0.008671713781618),\n    //     FixedNumber::from_num(0.014029848210439),\n    //     FixedNumber::from_num(-0.021514618232527),\n    //     FixedNumber::from_num(0.032292243726357),\n    //     FixedNumber::from_num(0.022336722713639),\n    //     FixedNumber::from_num(-0.01091672802769),\n    //     FixedNumber::from_num(0.007917100731662),\n    //     FixedNumber::from_num(0.017126256271163),\n    //     FixedNumber::from_num(-0.028455682588786),\n    //     FixedNumber::from_num(0.014703375160227),\n    //     FixedNumber::from_num(-0.006382600980497),\n    //     FixedNumber::from_num(-0.006423600398779),\n    //     FixedNumber::from_num(-0.049738301151431),\n    //     FixedNumber::from_num(0.006750075262365),\n    //     FixedNumber::from_num(-0.003567892783902),\n    //     FixedNumber::from_num(-0.033518179087602),\n    // ];\n\n    // let expected_eth_log_return = vec![\n    //     FixedNumber::from_num(0.003256086798801),\n    //     FixedNumber::from_num(-0.037176219300342),\n    //     FixedNumber::from_num(0.003105046726959),\n    //     FixedNumber::from_num(0.026808317225208),\n    //     FixedNumber::from_num(0.039664149077215),\n    //     FixedNumber::from_num(0.014858549313211),\n    //     FixedNumber::from_num(0.009366053036486),\n    //     FixedNumber::from_num(0.032947494656537),\n    //     FixedNumber::from_num(-0.014317195829359),\n    //     FixedNumber::from_num(-0.006048511576352),\n    //     FixedNumber::from_num(-0.003726170720288),\n    //     FixedNumber::from_num(-0.032615096229953),\n    //     FixedNumber::from_num(0.008362550947202),\n    //     FixedNumber::from_num(0.026209855400584),\n    //     FixedNumber::from_num(0.002559874723751),\n    //     FixedNumber::from_num(-0.02852562591775),\n    //     FixedNumber::from_num(0.059791550432133),\n    //     FixedNumber::from_num(0.057189635500972),\n    //     FixedNumber::from_num(-0.011965145719892),\n    //     FixedNumber::from_num(0.007249581694894),\n    //     FixedNumber::from_num(-0.015117944327008),\n    //     FixedNumber::from_num(-0.033149995299452),\n    //     FixedNumber::from_num(0.02668163550439),\n    //     FixedNumber::from_num(-0.037783197312849),\n    //     FixedNumber::from_num(-0.003168839842996),\n    //     FixedNumber::from_num(-0.012410908361374),\n    //     FixedNumber::from_num(0.010422040197932),\n    //     FixedNumber::from_num(0.025476158297524),\n    //     FixedNumber::from_num(-0.033679947915332),\n    // ];\n\n    // let expected_usd_log_return = vec![\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    // ];\n\n    // let expected_eq_log_return = vec![\n    //     FixedNumber::from_num(-0.003354903697885),\n    //     FixedNumber::from_num(-0.104400822685896),\n    //     FixedNumber::from_num(0.027852562402598),\n    //     FixedNumber::from_num(0.065930399912786),\n    //     FixedNumber::from_num(0.033634655314806),\n    //     FixedNumber::from_num(-0.003995774502009),\n    //     FixedNumber::from_num(0.00070629785161),\n    //     FixedNumber::from_num(0.014254242982982),\n    //     FixedNumber::from_num(-0.012608152076313),\n    //     FixedNumber::from_num(-0.01395976768789),\n    //     FixedNumber::from_num(-0.02411498578672),\n    //     FixedNumber::from_num(-0.04569512959085),\n    //     FixedNumber::from_num(0.013954304827044),\n    //     FixedNumber::from_num(0.035152134114813),\n    //     FixedNumber::from_num(-0.030125734992472),\n    //     FixedNumber::from_num(-0.018980703949385),\n    //     FixedNumber::from_num(0.05686029412138),\n    //     FixedNumber::from_num(0.030193664145268),\n    //     FixedNumber::from_num(-0.000937207191374),\n    //     FixedNumber::from_num(0.021795437311784),\n    //     FixedNumber::from_num(-0.006442728222199),\n    //     FixedNumber::from_num(0.083021433280261),\n    //     FixedNumber::from_num(-0.00575265248945),\n    //     FixedNumber::from_num(-0.069221835426132),\n    //     FixedNumber::from_num(-0.073632490279114),\n    //     FixedNumber::from_num(0.00712271217112),\n    //     FixedNumber::from_num(0.023462196064631),\n    //     FixedNumber::from_num(0.009280256966068),\n    //     FixedNumber::from_num(-0.044807107555325),\n    // ];\n\n    // assert_vectors_with_epsilon(\n    //     \"BTC log return\",\n    //     actual_btc_metrics.returns,\n    //     expected_btc_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"EOS log return\",\n    //     actual_eos_metrics.returns,\n    //     expected_eos_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"ETH log return\",\n    //     actual_eth_metrics.returns,\n    //     expected_eth_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"USD log return\",\n    //     actual_usd_metrics.returns,\n    //     expected_usd_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"EQ log return\",\n    //     actual_eq_metrics.returns,\n    //     expected_eq_log_return,\n    // );\n\n    Ok(())\n}\n\nasync fn set_prices_after_month(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    alice_key: AccountKey,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n    secs_to_move: i32,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    println!(\"Setting prices 1 day after month\");\n    let usd_price: FixedNumber = FixedNumber::from_num(1);\n    let eq_price: FixedNumber = FixedNumber::from_num(0.68493);\n    let eth_price: FixedNumber = FixedNumber::from_num(388.18);\n    let btc_price: FixedNumber = FixedNumber::from_num(14024);\n    let eos_price: FixedNumber = FixedNumber::from_num(2.368);\n\n    let initial_timestamp: u64 = client.now(Option::None).await?;\n\n    join_chain_calls!(\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Usd,\n                value: usd_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eq,\n                value: eq_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eth,\n                value: eth_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Btc,\n                value: btc_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eos,\n                value: eos_price,\n                _runtime: PhantomData,\n            },\n        ),\n    );\n\n    let curr_btc = client.price_points(Asset::Btc, Option::None).await?;\n    let curr_eos = client.price_points(Asset::Eos, Option::None).await?;\n    let curr_eth = client.price_points(Asset::Eth, Option::None).await?;\n    let curr_eq = client.price_points(Asset::Eq, Option::None).await?;\n    let curr_usd = client.price_points(Asset::Usd, Option::None).await?;\n\n    assert!(curr_btc == btc_price);\n    assert!(curr_eos == eos_price);\n    assert!(curr_eth == eth_price);\n    assert!(curr_eq == eq_price);\n    assert!(curr_usd == usd_price);\n\n    let btc_update = client.updates(Asset::Btc, Option::None).await?.unwrap();\n    let eos_update = client.updates(Asset::Eos, Option::None).await?.unwrap();\n    let eth_update = client.updates(Asset::Eth, Option::None).await?.unwrap();\n    let eq_update = client.updates(Asset::Eq, Option::None).await?.unwrap();\n    let usd_update = client.updates(Asset::Usd, Option::None).await?.unwrap();\n\n    assert!(btc_update.price == btc_price);\n    assert!(eos_update.price == eos_price);\n    assert!(eth_update.price == eth_price);\n    assert!(eq_update.price == eq_price);\n    assert!(usd_update.price == usd_price);\n\n    assert!(btc_update.time == Duration::from_millis(initial_timestamp));\n    assert!(eos_update.time == Duration::from_millis(initial_timestamp));\n    assert!(eth_update.time == Duration::from_millis(initial_timestamp));\n    assert!(eq_update.time == Duration::from_millis(initial_timestamp));\n    assert!(usd_update.time == Duration::from_millis(initial_timestamp));\n\n    println!(\"Moving time\");\n    call_chain(\n        client,\n        nonces.clone(),\n        alice_key,\n        AdvanceSecsCall {\n            _runtime: PhantomData,\n            secs: (secs_to_move as u32),\n        },\n    )\n    .await?;\n\n    let actual_timestamp = client.now(Option::None).await?;\n    let expected_timestamp = initial_timestamp + 1000 * (secs_to_move as u64);\n\n    assert!(actual_timestamp == expected_timestamp);\n\n    Ok(())\n}\n\nasync fn set_prices_and_move_time(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    alice_key: AccountKey,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n    secs_to_move: i32,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    let btc_prices: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(10676),\n        FixedNumber::from_num(10795),\n        FixedNumber::from_num(10604),\n        FixedNumber::from_num(10673),\n        FixedNumber::from_num(10929),\n        FixedNumber::from_num(11059),\n        FixedNumber::from_num(11302),\n        FixedNumber::from_num(11376),\n        FixedNumber::from_num(11540),\n        FixedNumber::from_num(11427),\n        FixedNumber::from_num(11429),\n        FixedNumber::from_num(11508),\n        FixedNumber::from_num(11326),\n        FixedNumber::from_num(11368),\n        FixedNumber::from_num(11513),\n        FixedNumber::from_num(11757),\n        FixedNumber::from_num(11922),\n        FixedNumber::from_num(12813),\n        FixedNumber::from_num(12990),\n        FixedNumber::from_num(12937),\n        FixedNumber::from_num(13126),\n        FixedNumber::from_num(13041),\n        FixedNumber::from_num(13069),\n        FixedNumber::from_num(13646),\n        FixedNumber::from_num(13286),\n        FixedNumber::from_num(13462),\n        FixedNumber::from_num(13566),\n        FixedNumber::from_num(13803),\n        FixedNumber::from_num(13762),\n        FixedNumber::from_num(13571),\n    ];\n\n    let eos_prices: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(2.519),\n        FixedNumber::from_num(2.529),\n        FixedNumber::from_num(2.696),\n        FixedNumber::from_num(2.647),\n        FixedNumber::from_num(2.61),\n        FixedNumber::from_num(2.646),\n        FixedNumber::from_num(2.642),\n        FixedNumber::from_num(2.66),\n        FixedNumber::from_num(2.647),\n        FixedNumber::from_num(2.64),\n        FixedNumber::from_num(2.611),\n        FixedNumber::from_num(2.599),\n        FixedNumber::from_num(2.538),\n        FixedNumber::from_num(2.526),\n        FixedNumber::from_num(2.548),\n        FixedNumber::from_num(2.584),\n        FixedNumber::from_num(2.529),\n        FixedNumber::from_num(2.612),\n        FixedNumber::from_num(2.671),\n        FixedNumber::from_num(2.642),\n        FixedNumber::from_num(2.663),\n        FixedNumber::from_num(2.709),\n        FixedNumber::from_num(2.633),\n        FixedNumber::from_num(2.672),\n        FixedNumber::from_num(2.655),\n        FixedNumber::from_num(2.638),\n        FixedNumber::from_num(2.51),\n        FixedNumber::from_num(2.527),\n        FixedNumber::from_num(2.518),\n        FixedNumber::from_num(2.435),\n    ];\n\n    let usd_prices: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n    ];\n\n    let eth_prices: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(352.61),\n        FixedNumber::from_num(353.76),\n        FixedNumber::from_num(340.85),\n        FixedNumber::from_num(341.91),\n        FixedNumber::from_num(351.2),\n        FixedNumber::from_num(365.41),\n        FixedNumber::from_num(370.88),\n        FixedNumber::from_num(374.37),\n        FixedNumber::from_num(386.91),\n        FixedNumber::from_num(381.41),\n        FixedNumber::from_num(379.11),\n        FixedNumber::from_num(377.7),\n        FixedNumber::from_num(365.58),\n        FixedNumber::from_num(368.65),\n        FixedNumber::from_num(378.44),\n        FixedNumber::from_num(379.41),\n        FixedNumber::from_num(368.74),\n        FixedNumber::from_num(391.46),\n        FixedNumber::from_num(414.5),\n        FixedNumber::from_num(409.57),\n        FixedNumber::from_num(412.55),\n        FixedNumber::from_num(406.36),\n        FixedNumber::from_num(393.11),\n        FixedNumber::from_num(403.74),\n        FixedNumber::from_num(388.77),\n        FixedNumber::from_num(387.54),\n        FixedNumber::from_num(382.76),\n        FixedNumber::from_num(386.77),\n        FixedNumber::from_num(396.75),\n        FixedNumber::from_num(383.61),\n    ];\n\n    let eq_prices: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(0.7106),\n        FixedNumber::from_num(0.70822),\n        FixedNumber::from_num(0.63801),\n        FixedNumber::from_num(0.65603),\n        FixedNumber::from_num(0.70074),\n        FixedNumber::from_num(0.72471),\n        FixedNumber::from_num(0.72182),\n        FixedNumber::from_num(0.72233),\n        FixedNumber::from_num(0.7327),\n        FixedNumber::from_num(0.72352),\n        FixedNumber::from_num(0.71349),\n        FixedNumber::from_num(0.69649),\n        FixedNumber::from_num(0.66538),\n        FixedNumber::from_num(0.67473),\n        FixedNumber::from_num(0.69887),\n        FixedNumber::from_num(0.67813),\n        FixedNumber::from_num(0.66538),\n        FixedNumber::from_num(0.70431),\n        FixedNumber::from_num(0.7259),\n        FixedNumber::from_num(0.72522),\n        FixedNumber::from_num(0.7412),\n        FixedNumber::from_num(0.73644),\n        FixedNumber::from_num(0.80019),\n        FixedNumber::from_num(0.7956),\n        FixedNumber::from_num(0.74239),\n        FixedNumber::from_num(0.68969),\n        FixedNumber::from_num(0.69462),\n        FixedNumber::from_num(0.71111),\n        FixedNumber::from_num(0.71774),\n        FixedNumber::from_num(0.68629),\n    ];\n\n    assert!(\n        btc_prices.len() == eos_prices.len()\n            \u0026\u0026 eos_prices.len() == usd_prices.len()\n            \u0026\u0026 usd_prices.len() == eth_prices.len()\n            \u0026\u0026 eth_prices.len() == eq_prices.len()\n            \u0026\u0026 btc_prices.len() == 30\n    );\n\n    let prices_tuple = izip!(usd_prices, eq_prices, eth_prices, btc_prices, eos_prices);\n\n    println!(\"Setting initial monthly prices\");\n\n    let mut counter = 1;\n    for (usd, eq, eth, btc, eos) in prices_tuple {\n        println!(\"Setting prices on iteration #{}\", counter);\n        let initial_timestamp: u64 = client.now(Option::None).await?;\n\n        join_chain_calls!(\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Usd,\n                    value: usd,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eq,\n                    value: eq,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eth,\n                    value: eth,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Btc,\n                    value: btc,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eos,\n                    value: eos,\n                    _runtime: PhantomData,\n                },\n            ),\n        );\n\n        let curr_btc = client.price_points(Asset::Btc, Option::None).await?;\n        let curr_eos = client.price_points(Asset::Eos, Option::None).await?;\n        let curr_eth = client.price_points(Asset::Eth, Option::None).await?;\n        let curr_eq = client.price_points(Asset::Eq, Option::None).await?;\n        let curr_usd = client.price_points(Asset::Usd, Option::None).await?;\n\n        assert!(curr_btc == btc);\n        assert!(curr_eos == eos);\n        assert!(curr_eth == eth);\n        assert!(curr_eq == eq);\n        assert!(curr_usd == usd);\n\n        let btc_update = client.updates(Asset::Btc, Option::None).await?.unwrap();\n        let eos_update = client.updates(Asset::Eos, Option::None).await?.unwrap();\n        let eth_update = client.updates(Asset::Eth, Option::None).await?.unwrap();\n        let eq_update = client.updates(Asset::Eq, Option::None).await?.unwrap();\n        let usd_update = client.updates(Asset::Usd, Option::None).await?.unwrap();\n\n        assert!(btc_update.price == btc);\n        assert!(eos_update.price == eos);\n        assert!(eth_update.price == eth);\n        assert!(eq_update.price == eq);\n        assert!(usd_update.price == usd);\n\n        assert!(btc_update.time == Duration::from_millis(initial_timestamp));\n        assert!(eos_update.time == Duration::from_millis(initial_timestamp));\n        assert!(eth_update.time == Duration::from_millis(initial_timestamp));\n        assert!(eq_update.time == Duration::from_millis(initial_timestamp));\n        assert!(usd_update.time == Duration::from_millis(initial_timestamp));\n\n        println!(\"Moving time\");\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            AdvanceSecsCall {\n                _runtime: PhantomData,\n                secs: (secs_to_move as u32),\n            },\n        )\n        .await?;\n\n        let actual_timestamp = client.now(Option::None).await?;\n        let expected_timestamp = initial_timestamp + 1000 * (secs_to_move as u64);\n\n        assert!(actual_timestamp == expected_timestamp);\n\n        counter = counter + 1;\n    }\n\n    Ok(())\n}\n","traces":[{"line":20,"address":[5363696],"length":1,"stats":{"Line":0},"fn_name":"test_financial"},{"line":24,"address":[4508974],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[4509087],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[4509881,4509255,4509133,4509735,4509302,4509921,4509352,4509426,4509177,4514102],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[4509667],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[4509674,4509978,4510036,4510133,4510083,4510207,4510601,4510482,4514123],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[4510440,4510630],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[4510664],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[4510668],"length":1,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[4510706],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[4511133,4511227,4511356,4511239],"length":1,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[4511393,4511612,4511483,4512033,4511538,4511914,4514165],"length":1,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[4512128,4512070,4512299,4512693,4511853,4514186,4512574,4512225,4512175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[4512532,4512722],"length":1,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[4512756],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[4512760],"length":1,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[4512798],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[4513313,4513418,4513219,4513322],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[4513594,4514005,4514228,4513452,4513659,4513542,4513907],"length":1,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[4513868,4514031],"length":1,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[4514057],"length":1,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[5363776,5363980],"length":1,"stats":{"Line":0},"fn_name":"assert_vectors_with_epsilon"},{"line":83,"address":[5363804,5364085,5364003],"length":1,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[4515651,4515632],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":85,"address":[4515680,4515699],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":87,"address":[5364887,5364336,5365887,5364613,5364648],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[5364892,5364730],"length":1,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[5366016,5366067],"length":1,"stats":{"Line":0},"fn_name":"assert_metrics_assets"},{"line":93,"address":[5366375,5366082,5366310,5366031,5366544,5366506,5366704],"length":1,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[5366437,5366511],"length":1,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[5366960],"length":1,"stats":{"Line":0},"fn_name":"assert_second_recalc_chain_state"},{"line":101,"address":[4516111,4516940,4516185,4517033,4515918,4516057,4516980,4516453,4521533],"length":1,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[4517065],"length":1,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[4517143,4517219,4517335],"length":1,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[4517159],"length":1,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[4517192],"length":1,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[4517244],"length":1,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[4517277],"length":1,"stats":{"Line":0},"fn_name":null},{"line":110,"address":[4517310],"length":1,"stats":{"Line":0},"fn_name":null},{"line":115,"address":[4517500],"length":1,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[4517540],"length":1,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[4517702,4518481,4519228,4517617],"length":1,"stats":{"Line":0},"fn_name":null},{"line":120,"address":[4517635],"length":1,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[4517667],"length":1,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[4517721],"length":1,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[4517748],"length":1,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[4517775],"length":1,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[4517802],"length":1,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[4517832],"length":1,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[4517868],"length":1,"stats":{"Line":0},"fn_name":null},{"line":128,"address":[4517904],"length":1,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[4517940],"length":1,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[4517970],"length":1,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[4518006],"length":1,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[4518039],"length":1,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[4518075],"length":1,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[4518111],"length":1,"stats":{"Line":0},"fn_name":null},{"line":135,"address":[4518141],"length":1,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[4518177],"length":1,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[4518213],"length":1,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[4518246],"length":1,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[4518282],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[4518312],"length":1,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[4518348],"length":1,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[4518384],"length":1,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[4518420],"length":1,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[4518453],"length":1,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[4519246,4520092,4520790,4519350],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[4519261],"length":1,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[4519286],"length":1,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[4519369],"length":1,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[4519396],"length":1,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[4519423],"length":1,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[4519450],"length":1,"stats":{"Line":0},"fn_name":null},{"line":154,"address":[4519483],"length":1,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[4519519],"length":1,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[4519555],"length":1,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[4519591],"length":1,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[4519621],"length":1,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[4519657],"length":1,"stats":{"Line":0},"fn_name":null},{"line":160,"address":[4519693],"length":1,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[4519729],"length":1,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[4519765],"length":1,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[4519795],"length":1,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[4519831],"length":1,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[4519867],"length":1,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[4519897],"length":1,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[4519927],"length":1,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[4519951],"length":1,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[4519981],"length":1,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[4520011],"length":1,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[4520041],"length":1,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[4520071],"length":1,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[4520798],"length":1,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[4520838],"length":1,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[4520886],"length":1,"stats":{"Line":0},"fn_name":null},{"line":181,"address":[4520918],"length":1,"stats":{"Line":0},"fn_name":null},{"line":186,"address":[4520993],"length":1,"stats":{"Line":0},"fn_name":null},{"line":187,"address":[4521033],"length":1,"stats":{"Line":0},"fn_name":null},{"line":397,"address":[4521163],"length":1,"stats":{"Line":0},"fn_name":null},{"line":400,"address":[5367008],"length":1,"stats":{"Line":0},"fn_name":"assert_first_recalc_chain_state"},{"line":403,"address":[4523529,4523262,4523455,4523797,4524284,4524377,4528877,4523401,4524324],"length":1,"stats":{"Line":0},"fn_name":null},{"line":405,"address":[4524409],"length":1,"stats":{"Line":0},"fn_name":null},{"line":407,"address":[4524487,4524679,4524563],"length":1,"stats":{"Line":0},"fn_name":null},{"line":408,"address":[4524503],"length":1,"stats":{"Line":0},"fn_name":null},{"line":409,"address":[4524536],"length":1,"stats":{"Line":0},"fn_name":null},{"line":410,"address":[4524588],"length":1,"stats":{"Line":0},"fn_name":null},{"line":411,"address":[4524621],"length":1,"stats":{"Line":0},"fn_name":null},{"line":412,"address":[4524654],"length":1,"stats":{"Line":0},"fn_name":null},{"line":417,"address":[4524844],"length":1,"stats":{"Line":0},"fn_name":null},{"line":418,"address":[4524884],"length":1,"stats":{"Line":0},"fn_name":null},{"line":421,"address":[4525046,4525825,4526572,4524961],"length":1,"stats":{"Line":0},"fn_name":null},{"line":422,"address":[4524979],"length":1,"stats":{"Line":0},"fn_name":null},{"line":423,"address":[4525011],"length":1,"stats":{"Line":0},"fn_name":null},{"line":424,"address":[4525065],"length":1,"stats":{"Line":0},"fn_name":null},{"line":425,"address":[4525092],"length":1,"stats":{"Line":0},"fn_name":null},{"line":426,"address":[4525119],"length":1,"stats":{"Line":0},"fn_name":null},{"line":427,"address":[4525146],"length":1,"stats":{"Line":0},"fn_name":null},{"line":428,"address":[4525176],"length":1,"stats":{"Line":0},"fn_name":null},{"line":429,"address":[4525212],"length":1,"stats":{"Line":0},"fn_name":null},{"line":430,"address":[4525248],"length":1,"stats":{"Line":0},"fn_name":null},{"line":431,"address":[4525284],"length":1,"stats":{"Line":0},"fn_name":null},{"line":432,"address":[4525314],"length":1,"stats":{"Line":0},"fn_name":null},{"line":433,"address":[4525350],"length":1,"stats":{"Line":0},"fn_name":null},{"line":434,"address":[4525383],"length":1,"stats":{"Line":0},"fn_name":null},{"line":435,"address":[4525419],"length":1,"stats":{"Line":0},"fn_name":null},{"line":436,"address":[4525455],"length":1,"stats":{"Line":0},"fn_name":null},{"line":437,"address":[4525485],"length":1,"stats":{"Line":0},"fn_name":null},{"line":438,"address":[4525521],"length":1,"stats":{"Line":0},"fn_name":null},{"line":439,"address":[4525557],"length":1,"stats":{"Line":0},"fn_name":null},{"line":440,"address":[4525590],"length":1,"stats":{"Line":0},"fn_name":null},{"line":441,"address":[4525626],"length":1,"stats":{"Line":0},"fn_name":null},{"line":442,"address":[4525656],"length":1,"stats":{"Line":0},"fn_name":null},{"line":443,"address":[4525692],"length":1,"stats":{"Line":0},"fn_name":null},{"line":444,"address":[4525728],"length":1,"stats":{"Line":0},"fn_name":null},{"line":445,"address":[4525764],"length":1,"stats":{"Line":0},"fn_name":null},{"line":446,"address":[4525797],"length":1,"stats":{"Line":0},"fn_name":null},{"line":449,"address":[4528134,4526694,4527436,4526590],"length":1,"stats":{"Line":0},"fn_name":null},{"line":450,"address":[4526605],"length":1,"stats":{"Line":0},"fn_name":null},{"line":451,"address":[4526630],"length":1,"stats":{"Line":0},"fn_name":null},{"line":452,"address":[4526713],"length":1,"stats":{"Line":0},"fn_name":null},{"line":453,"address":[4526740],"length":1,"stats":{"Line":0},"fn_name":null},{"line":454,"address":[4526767],"length":1,"stats":{"Line":0},"fn_name":null},{"line":455,"address":[4526794],"length":1,"stats":{"Line":0},"fn_name":null},{"line":456,"address":[4526827],"length":1,"stats":{"Line":0},"fn_name":null},{"line":457,"address":[4526863],"length":1,"stats":{"Line":0},"fn_name":null},{"line":458,"address":[4526899],"length":1,"stats":{"Line":0},"fn_name":null},{"line":459,"address":[4526935],"length":1,"stats":{"Line":0},"fn_name":null},{"line":460,"address":[4526965],"length":1,"stats":{"Line":0},"fn_name":null},{"line":461,"address":[4527001],"length":1,"stats":{"Line":0},"fn_name":null},{"line":462,"address":[4527037],"length":1,"stats":{"Line":0},"fn_name":null},{"line":463,"address":[4527073],"length":1,"stats":{"Line":0},"fn_name":null},{"line":464,"address":[4527109],"length":1,"stats":{"Line":0},"fn_name":null},{"line":465,"address":[4527139],"length":1,"stats":{"Line":0},"fn_name":null},{"line":466,"address":[4527175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":467,"address":[4527211],"length":1,"stats":{"Line":0},"fn_name":null},{"line":468,"address":[4527241],"length":1,"stats":{"Line":0},"fn_name":null},{"line":469,"address":[4527271],"length":1,"stats":{"Line":0},"fn_name":null},{"line":470,"address":[4527295],"length":1,"stats":{"Line":0},"fn_name":null},{"line":471,"address":[4527325],"length":1,"stats":{"Line":0},"fn_name":null},{"line":472,"address":[4527355],"length":1,"stats":{"Line":0},"fn_name":null},{"line":473,"address":[4527385],"length":1,"stats":{"Line":0},"fn_name":null},{"line":474,"address":[4527415],"length":1,"stats":{"Line":0},"fn_name":null},{"line":477,"address":[4528142],"length":1,"stats":{"Line":0},"fn_name":null},{"line":478,"address":[4528182],"length":1,"stats":{"Line":0},"fn_name":null},{"line":482,"address":[4528230],"length":1,"stats":{"Line":0},"fn_name":null},{"line":483,"address":[4528262],"length":1,"stats":{"Line":0},"fn_name":null},{"line":488,"address":[4528337],"length":1,"stats":{"Line":0},"fn_name":null},{"line":489,"address":[4528377],"length":1,"stats":{"Line":0},"fn_name":null},{"line":699,"address":[4528507],"length":1,"stats":{"Line":0},"fn_name":null},{"line":702,"address":[5367056],"length":1,"stats":{"Line":0},"fn_name":"set_prices_after_month"},{"line":708,"address":[4534469],"length":1,"stats":{"Line":0},"fn_name":null},{"line":709,"address":[4534593],"length":1,"stats":{"Line":0},"fn_name":null},{"line":710,"address":[4534672],"length":1,"stats":{"Line":0},"fn_name":null},{"line":711,"address":[4534754],"length":1,"stats":{"Line":0},"fn_name":null},{"line":712,"address":[4534836],"length":1,"stats":{"Line":0},"fn_name":null},{"line":713,"address":[4534915],"length":1,"stats":{"Line":0},"fn_name":null},{"line":715,"address":[4535096,4535626,4535000,4535937,4535558,4535225,4535151,4535977,4553245],"length":1,"stats":{"Line":0},"fn_name":null},{"line":717,"address":[4553043,4536034,4536939,4537261,4553266,4552998,4536976,4536728,4536691,4537559,4536995,4536449,4536747,4536178,4535589,4537187,4536244,4537222,4537609,4538083,4538858,4539050,4539059,4536486,4536263,4536505,4537683,4538948],"length":1,"stats":{"Line":0},"fn_name":null},{"line":770,"address":[4539326,4539400,4539733,4540130,4539271,4553287,4539849,4539159],"length":1,"stats":{"Line":0},"fn_name":null},{"line":771,"address":[4540674,4540790,4540341,4553308,4541071,4540267,4539787,4540212,4540175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":772,"address":[4540728,4541208,4541153,4541282,4542012,4553329,4541116,4541731,4541615],"length":1,"stats":{"Line":0},"fn_name":null},{"line":773,"address":[4541669,4542953,4542149,4542556,4542057,4542094,4542223,4542672,4553350],"length":1,"stats":{"Line":0},"fn_name":null},{"line":774,"address":[4543497,4543090,4553371,4543164,4542610,4543593,4543035,4543874,4542998],"length":1,"stats":{"Line":0},"fn_name":null},{"line":776,"address":[4543910,4543551,4543974],"length":1,"stats":{"Line":0},"fn_name":null},{"line":777,"address":[4543933,4544077,4544016],"length":1,"stats":{"Line":0},"fn_name":null},{"line":778,"address":[4544180,4544039,4544119],"length":1,"stats":{"Line":0},"fn_name":null},{"line":779,"address":[4544142,4544222,4544283],"length":1,"stats":{"Line":0},"fn_name":null},{"line":780,"address":[4544245,4544325,4544407],"length":1,"stats":{"Line":0},"fn_name":null},{"line":782,"address":[4544962,4544495,4544348,4553392,4544458,4544552,4544626,4545418],"length":1,"stats":{"Line":0},"fn_name":null},{"line":783,"address":[4545567,4545455,4545624,4545698,4546034,4546490,4553413],"length":1,"stats":{"Line":0},"fn_name":null},{"line":784,"address":[4546770,4547562,4547106,4546639,4546696,4553434,4546527],"length":1,"stats":{"Line":0},"fn_name":null},{"line":785,"address":[4547711,4547842,4547599,4553455,4548634,4547768,4548178],"length":1,"stats":{"Line":0},"fn_name":null},{"line":786,"address":[4548783,4548671,4548914,4549250,4549706,4548840,4553476],"length":1,"stats":{"Line":0},"fn_name":null},{"line":788,"address":[4549743,4549852],"length":1,"stats":{"Line":0},"fn_name":null},{"line":789,"address":[4549955,4549894,4549811],"length":1,"stats":{"Line":0},"fn_name":null},{"line":790,"address":[4549997,4549917,4550058],"length":1,"stats":{"Line":0},"fn_name":null},{"line":791,"address":[4550020,4550161,4550100],"length":1,"stats":{"Line":0},"fn_name":null},{"line":792,"address":[4550277,4550203,4550123],"length":1,"stats":{"Line":0},"fn_name":null},{"line":794,"address":[4550388,4550226,4550453,4550320],"length":1,"stats":{"Line":0},"fn_name":null},{"line":795,"address":[4550402,4550564,4550629,4550496],"length":1,"stats":{"Line":0},"fn_name":null},{"line":796,"address":[4550578,4550672,4550805,4550740],"length":1,"stats":{"Line":0},"fn_name":null},{"line":797,"address":[4550754,4550848,4550981,4550916],"length":1,"stats":{"Line":0},"fn_name":null},{"line":798,"address":[4550930,4551092,4551137,4551024],"length":1,"stats":{"Line":0},"fn_name":null},{"line":800,"address":[4551098,4551172],"length":1,"stats":{"Line":0},"fn_name":null},{"line":802,"address":[4551206],"length":1,"stats":{"Line":0},"fn_name":null},{"line":803,"address":[4551210],"length":1,"stats":{"Line":0},"fn_name":null},{"line":804,"address":[4551248],"length":1,"stats":{"Line":0},"fn_name":null},{"line":805,"address":[4551278],"length":1,"stats":{"Line":0},"fn_name":null},{"line":807,"address":[4551272],"length":1,"stats":{"Line":0},"fn_name":null},{"line":810,"address":[4551795,4551701,4551909,4551807],"length":1,"stats":{"Line":0},"fn_name":null},{"line":812,"address":[4551943,4553518,4552143,4552029,4552078,4552827,4552567,4552476],"length":1,"stats":{"Line":0},"fn_name":null},{"line":813,"address":[4552899,4552863,4552508,4556911],"length":1,"stats":{"Line":0},"fn_name":null},{"line":815,"address":[4552912,4552963],"length":1,"stats":{"Line":0},"fn_name":null},{"line":817,"address":[4552926],"length":1,"stats":{"Line":0},"fn_name":null},{"line":820,"address":[5367184],"length":1,"stats":{"Line":0},"fn_name":"set_prices_and_move_time"},{"line":826,"address":[4563301,4562389,4561315,4561457],"length":1,"stats":{"Line":0},"fn_name":null},{"line":827,"address":[4561333],"length":1,"stats":{"Line":0},"fn_name":null},{"line":828,"address":[4561361],"length":1,"stats":{"Line":0},"fn_name":null},{"line":829,"address":[4561479],"length":1,"stats":{"Line":0},"fn_name":null},{"line":830,"address":[4561509],"length":1,"stats":{"Line":0},"fn_name":null},{"line":831,"address":[4561539],"length":1,"stats":{"Line":0},"fn_name":null},{"line":832,"address":[4561569],"length":1,"stats":{"Line":0},"fn_name":null},{"line":833,"address":[4561602],"length":1,"stats":{"Line":0},"fn_name":null},{"line":834,"address":[4561635],"length":1,"stats":{"Line":0},"fn_name":null},{"line":835,"address":[4561668],"length":1,"stats":{"Line":0},"fn_name":null},{"line":836,"address":[4561701],"length":1,"stats":{"Line":0},"fn_name":null},{"line":837,"address":[4561734],"length":1,"stats":{"Line":0},"fn_name":null},{"line":838,"address":[4561767],"length":1,"stats":{"Line":0},"fn_name":null},{"line":839,"address":[4561800],"length":1,"stats":{"Line":0},"fn_name":null},{"line":840,"address":[4561833],"length":1,"stats":{"Line":0},"fn_name":null},{"line":841,"address":[4561866],"length":1,"stats":{"Line":0},"fn_name":null},{"line":842,"address":[4561899],"length":1,"stats":{"Line":0},"fn_name":null},{"line":843,"address":[4561932],"length":1,"stats":{"Line":0},"fn_name":null},{"line":844,"address":[4561965],"length":1,"stats":{"Line":0},"fn_name":null},{"line":845,"address":[4561998],"length":1,"stats":{"Line":0},"fn_name":null},{"line":846,"address":[4562031],"length":1,"stats":{"Line":0},"fn_name":null},{"line":847,"address":[4562064],"length":1,"stats":{"Line":0},"fn_name":null},{"line":848,"address":[4562097],"length":1,"stats":{"Line":0},"fn_name":null},{"line":849,"address":[4562130],"length":1,"stats":{"Line":0},"fn_name":null},{"line":850,"address":[4562163],"length":1,"stats":{"Line":0},"fn_name":null},{"line":851,"address":[4562196],"length":1,"stats":{"Line":0},"fn_name":null},{"line":852,"address":[4562229],"length":1,"stats":{"Line":0},"fn_name":null},{"line":853,"address":[4562262],"length":1,"stats":{"Line":0},"fn_name":null},{"line":854,"address":[4562295],"length":1,"stats":{"Line":0},"fn_name":null},{"line":855,"address":[4562328],"length":1,"stats":{"Line":0},"fn_name":null},{"line":856,"address":[4562361],"length":1,"stats":{"Line":0},"fn_name":null},{"line":859,"address":[4565383,4564471,4563318,4563455],"length":1,"stats":{"Line":0},"fn_name":null},{"line":860,"address":[4563339],"length":1,"stats":{"Line":0},"fn_name":null},{"line":861,"address":[4563370],"length":1,"stats":{"Line":0},"fn_name":null},{"line":862,"address":[4563480],"length":1,"stats":{"Line":0},"fn_name":null},{"line":863,"address":[4563513],"length":1,"stats":{"Line":0},"fn_name":null},{"line":864,"address":[4563546],"length":1,"stats":{"Line":0},"fn_name":null},{"line":865,"address":[4563579],"length":1,"stats":{"Line":0},"fn_name":null},{"line":866,"address":[4563615],"length":1,"stats":{"Line":0},"fn_name":null},{"line":867,"address":[4563651],"length":1,"stats":{"Line":0},"fn_name":null},{"line":868,"address":[4563687],"length":1,"stats":{"Line":0},"fn_name":null},{"line":869,"address":[4563723],"length":1,"stats":{"Line":0},"fn_name":null},{"line":870,"address":[4563759],"length":1,"stats":{"Line":0},"fn_name":null},{"line":871,"address":[4563795],"length":1,"stats":{"Line":0},"fn_name":null},{"line":872,"address":[4563831],"length":1,"stats":{"Line":0},"fn_name":null},{"line":873,"address":[4563867],"length":1,"stats":{"Line":0},"fn_name":null},{"line":874,"address":[4563903],"length":1,"stats":{"Line":0},"fn_name":null},{"line":875,"address":[4563939],"length":1,"stats":{"Line":0},"fn_name":null},{"line":876,"address":[4563975],"length":1,"stats":{"Line":0},"fn_name":null},{"line":877,"address":[4564011],"length":1,"stats":{"Line":0},"fn_name":null},{"line":878,"address":[4564047],"length":1,"stats":{"Line":0},"fn_name":null},{"line":879,"address":[4564083],"length":1,"stats":{"Line":0},"fn_name":null},{"line":880,"address":[4564119],"length":1,"stats":{"Line":0},"fn_name":null},{"line":881,"address":[4564155],"length":1,"stats":{"Line":0},"fn_name":null},{"line":882,"address":[4564191],"length":1,"stats":{"Line":0},"fn_name":null},{"line":883,"address":[4564227],"length":1,"stats":{"Line":0},"fn_name":null},{"line":884,"address":[4564263],"length":1,"stats":{"Line":0},"fn_name":null},{"line":885,"address":[4564299],"length":1,"stats":{"Line":0},"fn_name":null},{"line":886,"address":[4564335],"length":1,"stats":{"Line":0},"fn_name":null},{"line":887,"address":[4564371],"length":1,"stats":{"Line":0},"fn_name":null},{"line":888,"address":[4564407],"length":1,"stats":{"Line":0},"fn_name":null},{"line":889,"address":[4564443],"length":1,"stats":{"Line":0},"fn_name":null},{"line":892,"address":[4565531,4567375,4565400,4566463],"length":1,"stats":{"Line":0},"fn_name":null},{"line":893,"address":[4565418],"length":1,"stats":{"Line":0},"fn_name":null},{"line":894,"address":[4565446],"length":1,"stats":{"Line":0},"fn_name":null},{"line":895,"address":[4565553],"length":1,"stats":{"Line":0},"fn_name":null},{"line":896,"address":[4565583],"length":1,"stats":{"Line":0},"fn_name":null},{"line":897,"address":[4565613],"length":1,"stats":{"Line":0},"fn_name":null},{"line":898,"address":[4565643],"length":1,"stats":{"Line":0},"fn_name":null},{"line":899,"address":[4565676],"length":1,"stats":{"Line":0},"fn_name":null},{"line":900,"address":[4565709],"length":1,"stats":{"Line":0},"fn_name":null},{"line":901,"address":[4565742],"length":1,"stats":{"Line":0},"fn_name":null},{"line":902,"address":[4565775],"length":1,"stats":{"Line":0},"fn_name":null},{"line":903,"address":[4565808],"length":1,"stats":{"Line":0},"fn_name":null},{"line":904,"address":[4565841],"length":1,"stats":{"Line":0},"fn_name":null},{"line":905,"address":[4565874],"length":1,"stats":{"Line":0},"fn_name":null},{"line":906,"address":[4565907],"length":1,"stats":{"Line":0},"fn_name":null},{"line":907,"address":[4565940],"length":1,"stats":{"Line":0},"fn_name":null},{"line":908,"address":[4565973],"length":1,"stats":{"Line":0},"fn_name":null},{"line":909,"address":[4566006],"length":1,"stats":{"Line":0},"fn_name":null},{"line":910,"address":[4566039],"length":1,"stats":{"Line":0},"fn_name":null},{"line":911,"address":[4566072],"length":1,"stats":{"Line":0},"fn_name":null},{"line":912,"address":[4566105],"length":1,"stats":{"Line":0},"fn_name":null},{"line":913,"address":[4566138],"length":1,"stats":{"Line":0},"fn_name":null},{"line":914,"address":[4566171],"length":1,"stats":{"Line":0},"fn_name":null},{"line":915,"address":[4566204],"length":1,"stats":{"Line":0},"fn_name":null},{"line":916,"address":[4566237],"length":1,"stats":{"Line":0},"fn_name":null},{"line":917,"address":[4566270],"length":1,"stats":{"Line":0},"fn_name":null},{"line":918,"address":[4566303],"length":1,"stats":{"Line":0},"fn_name":null},{"line":919,"address":[4566336],"length":1,"stats":{"Line":0},"fn_name":null},{"line":920,"address":[4566369],"length":1,"stats":{"Line":0},"fn_name":null},{"line":921,"address":[4566402],"length":1,"stats":{"Line":0},"fn_name":null},{"line":922,"address":[4566435],"length":1,"stats":{"Line":0},"fn_name":null},{"line":925,"address":[4568545,4567392,4569459,4567529],"length":1,"stats":{"Line":0},"fn_name":null},{"line":926,"address":[4567413],"length":1,"stats":{"Line":0},"fn_name":null},{"line":927,"address":[4567444],"length":1,"stats":{"Line":0},"fn_name":null},{"line":928,"address":[4567554],"length":1,"stats":{"Line":0},"fn_name":null},{"line":929,"address":[4567587],"length":1,"stats":{"Line":0},"fn_name":null},{"line":930,"address":[4567620],"length":1,"stats":{"Line":0},"fn_name":null},{"line":931,"address":[4567653],"length":1,"stats":{"Line":0},"fn_name":null},{"line":932,"address":[4567689],"length":1,"stats":{"Line":0},"fn_name":null},{"line":933,"address":[4567725],"length":1,"stats":{"Line":0},"fn_name":null},{"line":934,"address":[4567761],"length":1,"stats":{"Line":0},"fn_name":null},{"line":935,"address":[4567797],"length":1,"stats":{"Line":0},"fn_name":null},{"line":936,"address":[4567833],"length":1,"stats":{"Line":0},"fn_name":null},{"line":937,"address":[4567869],"length":1,"stats":{"Line":0},"fn_name":null},{"line":938,"address":[4567905],"length":1,"stats":{"Line":0},"fn_name":null},{"line":939,"address":[4567941],"length":1,"stats":{"Line":0},"fn_name":null},{"line":940,"address":[4567977],"length":1,"stats":{"Line":0},"fn_name":null},{"line":941,"address":[4568013],"length":1,"stats":{"Line":0},"fn_name":null},{"line":942,"address":[4568049],"length":1,"stats":{"Line":0},"fn_name":null},{"line":943,"address":[4568085],"length":1,"stats":{"Line":0},"fn_name":null},{"line":944,"address":[4568121],"length":1,"stats":{"Line":0},"fn_name":null},{"line":945,"address":[4568157],"length":1,"stats":{"Line":0},"fn_name":null},{"line":946,"address":[4568193],"length":1,"stats":{"Line":0},"fn_name":null},{"line":947,"address":[4568229],"length":1,"stats":{"Line":0},"fn_name":null},{"line":948,"address":[4568265],"length":1,"stats":{"Line":0},"fn_name":null},{"line":949,"address":[4568301],"length":1,"stats":{"Line":0},"fn_name":null},{"line":950,"address":[4568337],"length":1,"stats":{"Line":0},"fn_name":null},{"line":951,"address":[4568373],"length":1,"stats":{"Line":0},"fn_name":null},{"line":952,"address":[4568409],"length":1,"stats":{"Line":0},"fn_name":null},{"line":953,"address":[4568445],"length":1,"stats":{"Line":0},"fn_name":null},{"line":954,"address":[4568481],"length":1,"stats":{"Line":0},"fn_name":null},{"line":955,"address":[4568517],"length":1,"stats":{"Line":0},"fn_name":null},{"line":958,"address":[4569476,4569613,4571543,4570629],"length":1,"stats":{"Line":0},"fn_name":null},{"line":959,"address":[4569497],"length":1,"stats":{"Line":0},"fn_name":null},{"line":960,"address":[4569528],"length":1,"stats":{"Line":0},"fn_name":null},{"line":961,"address":[4569638],"length":1,"stats":{"Line":0},"fn_name":null},{"line":962,"address":[4569671],"length":1,"stats":{"Line":0},"fn_name":null},{"line":963,"address":[4569704],"length":1,"stats":{"Line":0},"fn_name":null},{"line":964,"address":[4569737],"length":1,"stats":{"Line":0},"fn_name":null},{"line":965,"address":[4569773],"length":1,"stats":{"Line":0},"fn_name":null},{"line":966,"address":[4569809],"length":1,"stats":{"Line":0},"fn_name":null},{"line":967,"address":[4569845],"length":1,"stats":{"Line":0},"fn_name":null},{"line":968,"address":[4569881],"length":1,"stats":{"Line":0},"fn_name":null},{"line":969,"address":[4569917],"length":1,"stats":{"Line":0},"fn_name":null},{"line":970,"address":[4569953],"length":1,"stats":{"Line":0},"fn_name":null},{"line":971,"address":[4569989],"length":1,"stats":{"Line":0},"fn_name":null},{"line":972,"address":[4570025],"length":1,"stats":{"Line":0},"fn_name":null},{"line":973,"address":[4570061],"length":1,"stats":{"Line":0},"fn_name":null},{"line":974,"address":[4570097],"length":1,"stats":{"Line":0},"fn_name":null},{"line":975,"address":[4570133],"length":1,"stats":{"Line":0},"fn_name":null},{"line":976,"address":[4570169],"length":1,"stats":{"Line":0},"fn_name":null},{"line":977,"address":[4570205],"length":1,"stats":{"Line":0},"fn_name":null},{"line":978,"address":[4570241],"length":1,"stats":{"Line":0},"fn_name":null},{"line":979,"address":[4570277],"length":1,"stats":{"Line":0},"fn_name":null},{"line":980,"address":[4570313],"length":1,"stats":{"Line":0},"fn_name":null},{"line":981,"address":[4570349],"length":1,"stats":{"Line":0},"fn_name":null},{"line":982,"address":[4570385],"length":1,"stats":{"Line":0},"fn_name":null},{"line":983,"address":[4570421],"length":1,"stats":{"Line":0},"fn_name":null},{"line":984,"address":[4570457],"length":1,"stats":{"Line":0},"fn_name":null},{"line":985,"address":[4570493],"length":1,"stats":{"Line":0},"fn_name":null},{"line":986,"address":[4570529],"length":1,"stats":{"Line":0},"fn_name":null},{"line":987,"address":[4570565],"length":1,"stats":{"Line":0},"fn_name":null},{"line":988,"address":[4570601],"length":1,"stats":{"Line":0},"fn_name":null},{"line":991,"address":[4572258,4571618],"length":1,"stats":{"Line":0},"fn_name":null},{"line":992,"address":[4572060,4571982,4571550,4571640,4571740,4571795,4572138,4572170,4571910,4571685],"length":1,"stats":{"Line":0},"fn_name":null},{"line":993,"address":[4571770,4571934,4571976],"length":1,"stats":{"Line":0},"fn_name":null},{"line":994,"address":[4572007,4572054,4571715],"length":1,"stats":{"Line":0},"fn_name":null},{"line":995,"address":[4571658,4572085,4572132],"length":1,"stats":{"Line":0},"fn_name":null},{"line":996,"address":[4572163,4571593],"length":1,"stats":{"Line":0},"fn_name":null},{"line":999,"address":[4572646,4572410,4572198,4572488,4572666,4572563,4572304,4557056],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1001,"address":[4572673,4572717],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1003,"address":[4572791],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1004,"address":[4572801,4591925,4573048,4572952,4572978],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1005,"address":[4573619,4573448],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1006,"address":[4573739,4573646,4574211,4573868,4574640,4574600,4574279,4573794,4592464],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1008,"address":[4577807,4575227,4574763,4574979,4575475,4576008,4577816,4574913,4575190,4575969,4575742,4575934,4576430,4577705,4574242,4575246,4575494,4575686,4575723,4576840,4575438,4577615,4592217,4574998,4576306,4592262,4576356,4592485],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1061,"address":[4592506,4578500,4577916,4578616,4578897,4578083,4578157,4578028],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1062,"address":[4578942,4578979,4579567,4579848,4592527,4579034,4578554,4579451,4579108],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1063,"address":[4580518,4580799,4592548,4579930,4579505,4580059,4579893,4580402,4579985],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1064,"address":[4592569,4580456,4580844,4580881,4581010,4581353,4580936,4581469,4581750],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1065,"address":[4582402,4582683,4581407,4581961,4581832,4581887,4582304,4581795,4592590],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1067,"address":[4582783,4582719,4582358],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1068,"address":[4582742,4582825,4582889],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1069,"address":[4582931,4582995,4582848],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1070,"address":[4583037,4583101,4582954],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1071,"address":[4583060,4583225,4583143],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1073,"address":[4583313,4583370,4583444,4583166,4583790,4592611,4584246,4583276],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1074,"address":[4584526,4585328,4584395,4584283,4592632,4584452,4584872],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1075,"address":[4592653,4585365,4585534,4585477,4586410,4585954,4585608],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1076,"address":[4586447,4586616,4587036,4587492,4586690,4592674,4586559],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1077,"address":[4587529,4588574,4587772,4588118,4587698,4592695,4587641],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1079,"address":[4588611,4588723],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1080,"address":[4588829,4588765,4588682],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1081,"address":[4588871,4588935,4588788],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1082,"address":[4588977,4588894,4589041],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1083,"address":[4589083,4589157,4589000],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1085,"address":[4589106,4589333,4589268,4589200],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1086,"address":[4589509,4589376,4589282,4589444],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1087,"address":[4589685,4589620,4589458,4589552],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1088,"address":[4589728,4589634,4589861,4589796],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1089,"address":[4589810,4589904,4590017,4589972],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1091,"address":[4589978,4590052],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1093,"address":[4590086],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1094,"address":[4590090],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1095,"address":[4590128],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1096,"address":[4590158],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1098,"address":[4590152],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1101,"address":[4590685,4590591,4590808,4590697],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1103,"address":[4590845,4591739,4591045,4591388,4590980,4592737,4590931,4591479],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1104,"address":[4599670,4591775,4591811,4591420],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1106,"address":[4591824,4591872],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1108,"address":[4591919,4591846,4599796],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1111,"address":[4591935],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":421},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","test_scripts","test_oracle.rs"],"content":"use crate::key::{AccountKey, DevNonces};\nuse crate::oracle::SetPriceCall;\nuse crate::runtime::FixedNumber;\nuse crate::test::init_nonce;\nuse crate::test_context::TestContext;\nuse crate::{join_chain_calls, requester::call_chain, TestRuntime};\nuse common::Asset;\nuse futures::{lock::Mutex, try_join};\nuse integration_testing_macro::tuple_to_vec;\nuse sp_keyring::AccountKeyring;\nuse std::{marker::PhantomData, sync::Arc};\nuse substrate_subxt::Client;\n\npub async fn test_oracle(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    println!(\"Start oracle test\");\n    let alice_key = AccountKey::from(AccountKeyring::Alice);\n    init_nonce(client, nonces.clone(), alice_key).await?;\n\n    let btc_price = FixedNumber::from_num(20_000);\n    let eth_price = FixedNumber::from_num(250);\n    let eq_price = FixedNumber::from_num(25);\n    let eos_price = FixedNumber::from_num(3);\n\n    // ---------------------------------- Setting initial prices ----------------------------------\n\n    println!(\"Initial price set\");\n    join_chain_calls!(\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Btc,\n                value: btc_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eth,\n                value: eth_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eq,\n                value: eq_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eos,\n                value: eos_price,\n                _runtime: PhantomData,\n            },\n        ),\n    );\n\n    // ------------------------------------ Storing chain state ------------------------------------\n\n    let initial_state = TestContext::read_storage(client).await?;\n    let curr_btc = initial_state.price_points.get(\u0026Asset::Btc).unwrap();\n    let curr_eth = initial_state.price_points.get(\u0026Asset::Eth).unwrap();\n    let curr_eq = initial_state.price_points.get(\u0026Asset::Eq).unwrap();\n    let curr_eos = initial_state.price_points.get(\u0026Asset::Eos).unwrap();\n\n    assert!(curr_btc == \u0026btc_price);\n    assert!(curr_eth == \u0026eth_price);\n    assert!(curr_eq == \u0026eq_price);\n    assert!(curr_eos == \u0026eos_price);\n\n    // -------------------------------- Iteratively changing prices --------------------------------\n\n    let iterations: i64 = 30;\n\n    for i in 1..=iterations {\n        // price_q slowly increases from ~1 to 1.5\n        let price_q = FixedNumber::from_num(1)\n            + (FixedNumber::from_num(i) / FixedNumber::from_num(iterations * 2));\n\n        println!(\"Setting prices, iteration #{}\", i);\n        join_chain_calls!(\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Btc,\n                    value: btc_price * price_q,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eth,\n                    value: eth_price / price_q,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eq,\n                    value: eq_price * price_q,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eos,\n                    value: eos_price / price_q,\n                    _runtime: PhantomData,\n                },\n            ),\n        );\n\n        let iteration_state = TestContext::read_storage(client).await?;\n        let curr_btc = iteration_state.price_points.get(\u0026Asset::Btc).unwrap();\n        let curr_eth = iteration_state.price_points.get(\u0026Asset::Eth).unwrap();\n        let curr_eq = iteration_state.price_points.get(\u0026Asset::Eq).unwrap();\n        let curr_eos = iteration_state.price_points.get(\u0026Asset::Eos).unwrap();\n\n        assert!(curr_btc == \u0026(btc_price * price_q));\n        assert!(curr_eth == \u0026(eth_price / price_q));\n        assert!(curr_eq == \u0026(eq_price * price_q));\n        assert!(curr_eos == \u0026(eos_price / price_q));\n    }\n\n    // ------------------------------------ Test assertion ------------------------------------\n\n    println!(\"Assertion successful, test passed\");\n\n    Ok(())\n}\n","traces":[{"line":14,"address":[4798640],"length":1,"stats":{"Line":0},"fn_name":"test_oracle"},{"line":18,"address":[5734209],"length":1,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[5734325],"length":1,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[5269111],"length":1,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[5735208,5734911],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[5735231],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[5735310],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[5735389],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[5735460],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[5269158,5269197],"length":1,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[5269254],"length":1,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[5738804,5739001,5739092],"length":1,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[5739103,5739207],"length":1,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[5739218,5739322],"length":1,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[5739333,5739437],"length":1,"stats":{"Line":0},"fn_name":null},{"line":81,"address":[5739448,5739581],"length":1,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[5739697,5739530,5739623],"length":1,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[5739739,5739813,5739646],"length":1,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[5739855,5739916,5739762],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[5739878],"length":1,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[5740178,5739967,5739889,5739983,5745773],"length":1,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[5740439,5740224],"length":1,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[5740292,5740347,5740255,5747850,5740408],"length":1,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[5740539,5740714],"length":1,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[5269295,5269334],"length":1,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[5269416],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[5744583,5744777,5744834],"length":1,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[5744842,5744916],"length":1,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[5744992,5744924],"length":1,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[5745062,5745000],"length":1,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[5745207,5745260,5745078],"length":1,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[5745377,5745430,5745221,5745300],"length":1,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[5745470,5745600,5745547,5745391],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[5745640,5745717,5745561,5745738],"length":1,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[5745778,5740136],"length":1,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[5745804],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":36},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","timestamp.rs"],"content":"use codec::Encode;\nuse core::marker::PhantomData;\nuse frame_support::Parameter;\nuse sp_runtime::traits::{AtLeast32Bit, Member, Scale};\nuse std::fmt::Debug;\nuse substrate_subxt::system::{System, SystemEventsDecoder};\nuse substrate_subxt_proc_macro::{module, Store};\n\n#[module]\npub trait Timestamp: System {\n    type Moment: Parameter\n        + Default\n        + AtLeast32Bit\n        + Member\n        + Scale\u003cSelf::BlockNumber, Output = Self::Moment\u003e\n        + Copy;\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct NowStore\u003cT: Timestamp\u003e {\n    #[store(returns = T::Moment)]\n    /// Runtime marker.\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","build.rs"],"content":"use substrate_build_script_utils::{generate_cargo_keys, rerun_if_git_head_changed};\n\nfn main() {\n    generate_cargo_keys();\n\n    rerun_if_git_head_changed();\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","chain_spec.rs"],"content":"use common::Asset;\nuse core::time::Duration;\nuse financial_primitives::PricePeriod;\nuse node_template_runtime::{\n    AccountId, AuraConfig, BalancesConfig, FinancialConfig, FixedNumber, GenesisConfig,\n    GrandpaConfig, ManualTimestampConfig, OracleConfig, Signature, SudoConfig, SystemConfig,\n    WASM_BINARY,\n};\nuse sc_service::ChainType;\nuse sp_consensus_aura::sr25519::AuthorityId as AuraId;\nuse sp_core::{sr25519, Pair, Public};\nuse sp_finality_grandpa::AuthorityId as GrandpaId;\nuse sp_runtime::traits::{IdentifyAccount, Verify};\nuse std::convert::TryInto;\nuse std::time::{SystemTime, UNIX_EPOCH};\nuse substrate_fixed::traits::LossyFrom;\n\n// The URL for the telemetry server.\n// const STAGING_TELEMETRY_URL: \u0026str = \"wss://telemetry.polkadot.io/submit/\";\n\n/// Specialized `ChainSpec`. This is a specialization of the general Substrate ChainSpec type.\npub type ChainSpec = sc_service::GenericChainSpec\u003cGenesisConfig\u003e;\n\n/// Generate a crypto pair from seed.\npub fn get_from_seed\u003cTPublic: Public\u003e(seed: \u0026str) -\u003e \u003cTPublic::Pair as Pair\u003e::Public {\n    TPublic::Pair::from_string(\u0026format!(\"//{}\", seed), None)\n        .expect(\"static values are valid; qed\")\n        .public()\n}\n\ntype AccountPublic = \u003cSignature as Verify\u003e::Signer;\n\n/// Generate an account ID from seed.\npub fn get_account_id_from_seed\u003cTPublic: Public\u003e(seed: \u0026str) -\u003e AccountId\nwhere\n    AccountPublic: From\u003c\u003cTPublic::Pair as Pair\u003e::Public\u003e,\n{\n    AccountPublic::from(get_from_seed::\u003cTPublic\u003e(seed)).into_account()\n}\n\n/// Generate an Aura authority key.\npub fn authority_keys_from_seed(s: \u0026str) -\u003e (AuraId, GrandpaId) {\n    (get_from_seed::\u003cAuraId\u003e(s), get_from_seed::\u003cGrandpaId\u003e(s))\n}\n\npub fn development_config() -\u003e Result\u003cChainSpec, String\u003e {\n    let wasm_binary = WASM_BINARY.ok_or(\"Development wasm binary not available\".to_string())?;\n\n    Ok(ChainSpec::from_genesis(\n        // Name\n        \"Development\",\n        // ID\n        \"dev\",\n        ChainType::Development,\n        move || {\n            testnet_genesis(\n                wasm_binary,\n                // Initial PoA authorities\n                vec![authority_keys_from_seed(\"Alice\")],\n                // Sudo account\n                get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice\"),\n                // Pre-funded accounts\n                vec![\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Bob\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Bob//stash\"),\n                ],\n                true,\n                vec![\n                    // (Asset::Usd, 1),\n                    // (Asset::Eq, 25),\n                    // (Asset::Eth, 250),\n                    // (Asset::Btc, 10_000),\n                    // (Asset::Eos, 3),\n                ], // .into_iter()\n                   // .map(|(a, x)| (a, FixedNumber::lossy_from(x)))\n                   // .collect()\n            )\n        },\n        // Bootnodes\n        vec![],\n        // Telemetry\n        None,\n        // Protocol ID\n        None,\n        // Properties\n        None,\n        // Extensions\n        None,\n    ))\n}\n\npub fn local_testnet_config() -\u003e Result\u003cChainSpec, String\u003e {\n    let wasm_binary = WASM_BINARY.ok_or(\"Development wasm binary not available\".to_string())?;\n\n    Ok(ChainSpec::from_genesis(\n        // Name\n        \"Local Testnet\",\n        // ID\n        \"local_testnet\",\n        ChainType::Local,\n        move || {\n            testnet_genesis(\n                wasm_binary,\n                // Initial PoA authorities\n                vec![\n                    authority_keys_from_seed(\"Alice\"),\n                    authority_keys_from_seed(\"Bob\"),\n                ],\n                // Sudo account\n                get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice\"),\n                // Pre-funded accounts\n                vec![\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Bob\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Charlie\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Dave\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Eve\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Ferdie\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Bob//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Charlie//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Dave//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Eve//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Ferdie//stash\"),\n                ],\n                true,\n                vec![\n                    (Asset::Usd, 1),\n                    (Asset::Eq, 25),\n                    (Asset::Eth, 250),\n                    (Asset::Btc, 10_000),\n                    (Asset::Eos, 3),\n                ]\n                .into_iter()\n                .map(|(a, x)| (a, FixedNumber::lossy_from(x)))\n                .collect(),\n            )\n        },\n        // Bootnodes\n        vec![],\n        // Telemetry\n        None,\n        // Protocol ID\n        None,\n        // Properties\n        None,\n        // Extensions\n        None,\n    ))\n}\n\nfn get_prev_period_start(now: Duration, price_period: u32) -\u003e Duration {\n    let price_period = PricePeriod(price_period);\n    let now_period_id = price_period\n        .get_period_id(now)\n        .expect(\"Unable to get current period id\");\n    let prev_period_id = now_period_id\n        .checked_sub(1)\n        .expect(\"Unable to get previous period id\");\n    let prev_period_start = price_period\n        .get_period_id_start(prev_period_id)\n        .expect(\"Unable to get previous period Unix timestamp\");\n\n    prev_period_start\n}\n\n/// Configure initial storage state for FRAME modules.\nfn testnet_genesis(\n    wasm_binary: \u0026[u8],\n    initial_authorities: Vec\u003c(AuraId, GrandpaId)\u003e,\n    root_key: AccountId,\n    endowed_accounts: Vec\u003cAccountId\u003e,\n    _enable_println: bool,\n    prices: Vec\u003c(Asset, FixedNumber)\u003e,\n) -\u003e GenesisConfig {\n    let now = SystemTime::now()\n        .duration_since(UNIX_EPOCH)\n        .expect(\"Unable to get current Unix timestamp\");\n    let prev_period_start = get_prev_period_start(now, node_template_runtime::PricePeriod::get());\n    GenesisConfig {\n        frame_system: Some(SystemConfig {\n            // Add Wasm runtime to storage.\n            code: wasm_binary.to_vec(),\n            changes_trie_config: Default::default(),\n        }),\n        pallet_balances: Some(BalancesConfig {\n            // Configure endowed accounts with initial balance of 1 \u003c\u003c 60.\n            balances: endowed_accounts\n                .iter()\n                .cloned()\n                .map(|k| (k, 1 \u003c\u003c 60))\n                .collect(),\n        }),\n        pallet_aura: Some(AuraConfig {\n            authorities: initial_authorities.iter().map(|x| (x.0.clone())).collect(),\n        }),\n        pallet_grandpa: Some(GrandpaConfig {\n            authorities: initial_authorities\n                .iter()\n                .map(|x| (x.1.clone(), 1))\n                .collect(),\n        }),\n        pallet_sudo: Some(SudoConfig {\n            // Assign network admin rights.\n            key: root_key,\n        }),\n        oracle: Some(OracleConfig {\n            prices: prices.iter().cloned().collect(),\n        }),\n        financial_pallet: Some(FinancialConfig {\n            prices: prices\n                .iter()\n                .cloned()\n                .map(|(a, p)| (a, vec![p], prev_period_start))\n                .collect(),\n        }),\n        manual_timestamp: Some(ManualTimestampConfig {\n            timestamp: now.as_millis().try_into().expect(\"Too much milliseconds\"),\n        }),\n    }\n}\n","traces":[{"line":25,"address":[18143862,18143760,18144358,18143366,18144256,18143264],"length":1,"stats":{"Line":0},"fn_name":"get_from_seed\u003csp_finality_grandpa::app::Public\u003e"},{"line":26,"address":[18143787,18144103,18144283,18144599,18143386,18143607,18143291,18143882,18144378],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[18144768],"length":1,"stats":{"Line":0},"fn_name":"get_account_id_from_seed\u003csp_core::sr25519::Public\u003e"},{"line":38,"address":[18144785],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[17078256],"length":1,"stats":{"Line":0},"fn_name":"authority_keys_from_seed"},{"line":43,"address":[17078273],"length":1,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[17078477,17078416],"length":1,"stats":{"Line":0},"fn_name":"development_config"},{"line":47,"address":[17078433,17078653,17078766,17078492],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[17078819,17078986],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[17078598],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[17078618],"length":1,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[18145348],"length":1,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[18144866],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[18144905,18144975,18145457],"length":1,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[18145032],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[18145069,18145510,18145190],"length":1,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[18145082],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[18145109],"length":1,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[18145136],"length":1,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[18145163],"length":1,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[18145329],"length":1,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[17078634],"length":1,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[17078775],"length":1,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[17078787],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[17078799],"length":1,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[17078811],"length":1,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[17079120,17079181],"length":1,"stats":{"Line":0},"fn_name":"local_testnet_config"},{"line":95,"address":[17079196,17079137,17079357,17079470],"length":1,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[17079523,17079690],"length":1,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[17079302],"length":1,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[17079322],"length":1,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[18147103],"length":1,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[18145746],"length":1,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[18145882,18145785,18147212],"length":1,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[18145816],"length":1,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[18145855],"length":1,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[18145990],"length":1,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[18146027,18146364,18147265],"length":1,"stats":{"Line":0},"fn_name":null},{"line":115,"address":[18146040],"length":1,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[18146067],"length":1,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[18146094],"length":1,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[18146121],"length":1,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[18146148],"length":1,"stats":{"Line":0},"fn_name":null},{"line":120,"address":[18146175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[18146202],"length":1,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[18146229],"length":1,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[18146256],"length":1,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[18146283],"length":1,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[18146310],"length":1,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[18146337],"length":1,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[18146753,18147050,18146893],"length":1,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[18146758],"length":1,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[18146785],"length":1,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[18146812],"length":1,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[18146839],"length":1,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[18146866],"length":1,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[18145650,18145632],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":142,"address":[17079338],"length":1,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[17079479],"length":1,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[17079491],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[17079503],"length":1,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[17079515],"length":1,"stats":{"Line":0},"fn_name":null},{"line":154,"address":[17079824],"length":1,"stats":{"Line":0},"fn_name":"get_prev_period_start"},{"line":155,"address":[17079853],"length":1,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[17079857],"length":1,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[17079947],"length":1,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[17080031],"length":1,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[17080128,17080274],"length":1,"stats":{"Line":0},"fn_name":"testnet_genesis"},{"line":178,"address":[17080297,17080183,17080429],"length":1,"stats":{"Line":0},"fn_name":null},{"line":181,"address":[17080512],"length":1,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[17080708],"length":1,"stats":{"Line":0},"fn_name":null},{"line":188,"address":[17081035],"length":1,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[17081258],"length":1,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[17081481],"length":1,"stats":{"Line":0},"fn_name":null},{"line":205,"address":[17081576],"length":1,"stats":{"Line":0},"fn_name":null},{"line":209,"address":[17081785],"length":1,"stats":{"Line":0},"fn_name":null},{"line":212,"address":[17082027],"length":1,"stats":{"Line":0},"fn_name":null},{"line":219,"address":[17082214],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":78},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","cli.rs"],"content":"use sc_cli::{RunCmd, Subcommand};\nuse structopt::StructOpt;\n\n#[derive(Debug, StructOpt)]\npub struct Cli {\n    #[structopt(subcommand)]\n    pub subcommand: Option\u003cSubcommand\u003e,\n\n    #[structopt(flatten)]\n    pub run: RunCmd,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","command.rs"],"content":"// This file is part of Substrate.\n\n// Copyright (C) 2017-2020 Parity Technologies (UK) Ltd.\n// SPDX-License-Identifier: Apache-2.0\n\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// \thttp://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nuse crate::chain_spec;\nuse crate::cli::Cli;\nuse crate::service;\nuse crate::service::new_partial;\nuse sc_cli::{ChainSpec, Role, RuntimeVersion, SubstrateCli};\nuse sc_service::PartialComponents;\n\nimpl SubstrateCli for Cli {\n    fn impl_name() -\u003e String {\n        \"Substrate Node\".into()\n    }\n\n    fn impl_version() -\u003e String {\n        env!(\"SUBSTRATE_CLI_IMPL_VERSION\").into()\n    }\n\n    fn description() -\u003e String {\n        env!(\"CARGO_PKG_DESCRIPTION\").into()\n    }\n\n    fn author() -\u003e String {\n        env!(\"CARGO_PKG_AUTHORS\").into()\n    }\n\n    fn support_url() -\u003e String {\n        \"support.anonymous.an\".into()\n    }\n\n    fn copyright_start_year() -\u003e i32 {\n        2017\n    }\n\n    fn load_spec(\u0026self, id: \u0026str) -\u003e Result\u003cBox\u003cdyn sc_service::ChainSpec\u003e, String\u003e {\n        Ok(match id {\n            \"dev\" =\u003e Box::new(chain_spec::development_config()?),\n            \"\" | \"local\" =\u003e Box::new(chain_spec::local_testnet_config()?),\n            path =\u003e Box::new(chain_spec::ChainSpec::from_json_file(\n                std::path::PathBuf::from(path),\n            )?),\n        })\n    }\n\n    fn native_runtime_version(_: \u0026Box\u003cdyn ChainSpec\u003e) -\u003e \u0026'static RuntimeVersion {\n        \u0026node_template_runtime::VERSION\n    }\n}\n\n/// Parse and run command line arguments\npub fn run() -\u003e sc_cli::Result\u003c()\u003e {\n    let cli = Cli::from_args();\n\n    match cli.subcommand {\n        Some(ref subcommand) =\u003e {\n            let runner = cli.create_runner(subcommand)?;\n            runner.run_subcommand(subcommand, |config| {\n                let PartialComponents {\n                    client,\n                    backend,\n                    task_manager,\n                    import_queue,\n                    ..\n                } = new_partial(\u0026config)?;\n                Ok((client, backend, import_queue, task_manager))\n            })\n        }\n        None =\u003e {\n            let runner = cli.create_runner(\u0026cli.run)?;\n            runner.run_node_until_exit(|config| match config.role {\n                Role::Light =\u003e service::new_light(config),\n                _ =\u003e service::new_full(config),\n            })\n        }\n    }\n}\n","traces":[{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[12950059],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[12950096],"length":1,"stats":{"Line":0},"fn_name":"impl_version"},{"line":31,"address":[12950107],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[12950144],"length":1,"stats":{"Line":0},"fn_name":"description"},{"line":35,"address":[12950155],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[4828144,4828210],"length":1,"stats":{"Line":0},"fn_name":"run"},{"line":67,"address":[4828160],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[4828285,4828874],"length":1,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[4828225,4828295],"length":1,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[4828311,4828797,4828373,4828845,4828630],"length":1,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[4828526],"length":1,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[16079055],"length":1,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[16079071],"length":1,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[16079087],"length":1,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[16079123],"length":1,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[16079187,16079757,16078842,16078899,16079369,16078922],"length":1,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[16079441],"length":1,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[4828251,4829106,4829267,4828895],"length":1,"stats":{"Line":0},"fn_name":null},{"line":85,"address":[4829031],"length":1,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[16080150,16080074],"length":1,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[16080096],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":36},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","lib.rs"],"content":"pub mod chain_spec;\npub mod rpc;\npub mod service;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","main.rs"],"content":"//! Substrate Node Template CLI library.\n#![warn(missing_docs)]\n\nmod chain_spec;\n#[macro_use]\nmod service;\nmod cli;\nmod command;\nmod rpc;\n\nfn main() -\u003e sc_cli::Result\u003c()\u003e {\n    command::run()\n}\n","traces":[{"line":11,"address":[18340432],"length":1,"stats":{"Line":0},"fn_name":"main"},{"line":12,"address":[18340440],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":2},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","rpc.rs"],"content":"//! A collection of node-specific RPC methods.\n//! Substrate provides the `sc-rpc` crate, which defines the core RPC layer\n//! used by Substrate nodes. This file extends those RPC definitions with\n//! capabilities that are specific to this project's runtime configuration.\n\n#![warn(missing_docs)]\n\nuse std::sync::Arc;\n\nuse node_template_runtime::{opaque::Block, AccountId, Balance, Index};\npub use sc_rpc_api::DenyUnsafe;\nuse sp_api::ProvideRuntimeApi;\nuse sp_block_builder::BlockBuilder;\nuse sp_blockchain::{Error as BlockChainError, HeaderBackend, HeaderMetadata};\nuse sp_transaction_pool::TransactionPool;\n\n/// Full client dependencies.\npub struct FullDeps\u003cC, P\u003e {\n    /// The client instance to use.\n    pub client: Arc\u003cC\u003e,\n    /// Transaction pool instance.\n    pub pool: Arc\u003cP\u003e,\n    /// Whether to deny unsafe calls\n    pub deny_unsafe: DenyUnsafe,\n}\n\n/// Instantiate all full RPC extensions.\npub fn create_full\u003cC, P\u003e(deps: FullDeps\u003cC, P\u003e) -\u003e jsonrpc_core::IoHandler\u003csc_rpc::Metadata\u003e\nwhere\n    C: ProvideRuntimeApi\u003cBlock\u003e,\n    C: HeaderBackend\u003cBlock\u003e + HeaderMetadata\u003cBlock, Error = BlockChainError\u003e + 'static,\n    C: Send + Sync + 'static,\n    C::Api: substrate_frame_rpc_system::AccountNonceApi\u003cBlock, AccountId, Index\u003e,\n    C::Api: pallet_transaction_payment_rpc::TransactionPaymentRuntimeApi\u003cBlock, Balance\u003e,\n    C::Api: BlockBuilder\u003cBlock\u003e,\n    P: TransactionPool + 'static,\n{\n    use pallet_transaction_payment_rpc::{TransactionPayment, TransactionPaymentApi};\n    use substrate_frame_rpc_system::{FullSystem, SystemApi};\n\n    let mut io = jsonrpc_core::IoHandler::default();\n    let FullDeps {\n        client,\n        pool,\n        deny_unsafe,\n    } = deps;\n\n    io.extend_with(SystemApi::to_delegate(FullSystem::new(\n        client.clone(),\n        pool,\n        deny_unsafe,\n    )));\n\n    io.extend_with(TransactionPaymentApi::to_delegate(TransactionPayment::new(\n        client.clone(),\n    )));\n\n    // Extend this RPC with a custom API by using the following syntax.\n    // `YourRpcStruct` should have a reference to a client, which is needed\n    // to call into the runtime.\n    // `io.extend_with(YourRpcTrait::to_delegate(YourRpcStruct::new(ReferenceToClient, ...)));`\n\n    io\n}\n","traces":[{"line":28,"address":[25290273,25289840],"length":1,"stats":{"Line":0},"fn_name":"create_full\u003csc_service::client::client::Client\u003csc_client_db::Backend\u003csp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e, sc_service::client::call_executor::LocalCallExecutor\u003csc_client_db::Backend\u003csp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e, sc_executor::native_executor::NativeExecutor\u003cnode_template::service::Executor\u003e\u003e, sp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e, node_template_runtime::RuntimeApi\u003e,sc_transaction_pool::BasicPool\u003csc_transaction_pool::api::FullChainApi\u003csc_service::client::client::Client\u003csc_client_db::Backend\u003csp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e, sc_service::client::call_executor::LocalCallExecutor\u003csc_client_db::Backend\u003csp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e, sc_executor::native_executor::NativeExecutor\u003cnode_template::service::Executor\u003e\u003e, sp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e, node_template_runtime::RuntimeApi\u003e, sp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e, sp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e\u003e"},{"line":41,"address":[25289850],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[25289920],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[25289949],"length":1,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[25289974],"length":1,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[25289993,25290070],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[25290010],"length":1,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[25290053],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[25290172,25290138],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[25290155],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[25290224],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":11},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","service.rs"],"content":"//! Service and ServiceFactory implementation. Specialized wrapper over substrate service.\n\nuse node_template_runtime::{self, opaque::Block, RuntimeApi};\nuse sc_client_api::{ExecutorProvider, RemoteBackend};\nuse sc_executor::native_executor_instance;\npub use sc_executor::NativeExecutor;\nuse sc_finality_grandpa::{\n    FinalityProofProvider as GrandpaFinalityProofProvider, SharedVoterState,\n};\nuse sc_service::{error::Error as ServiceError, Configuration, TaskManager};\nuse sp_consensus_aura::sr25519::AuthorityPair as AuraPair;\nuse sp_inherents::InherentDataProviders;\nuse std::sync::Arc;\nuse std::time::Duration;\n\n// Our native executor instance.\nnative_executor_instance!(\n    pub Executor,\n    node_template_runtime::api::dispatch,\n    node_template_runtime::native_version,\n);\n\ntype FullClient = sc_service::TFullClient\u003cBlock, RuntimeApi, Executor\u003e;\ntype FullBackend = sc_service::TFullBackend\u003cBlock\u003e;\ntype FullSelectChain = sc_consensus::LongestChain\u003cFullBackend, Block\u003e;\n\npub fn new_partial(\n    config: \u0026Configuration,\n) -\u003e Result\u003c\n    sc_service::PartialComponents\u003c\n        FullClient,\n        FullBackend,\n        FullSelectChain,\n        sp_consensus::DefaultImportQueue\u003cBlock, FullClient\u003e,\n        sc_transaction_pool::FullPool\u003cBlock, FullClient\u003e,\n        (\n            sc_consensus_aura::AuraBlockImport\u003c\n                Block,\n                FullClient,\n                sc_finality_grandpa::GrandpaBlockImport\u003c\n                    FullBackend,\n                    Block,\n                    FullClient,\n                    FullSelectChain,\n                \u003e,\n                AuraPair,\n            \u003e,\n            sc_finality_grandpa::LinkHalf\u003cBlock, FullClient, FullSelectChain\u003e,\n        ),\n    \u003e,\n    ServiceError,\n\u003e {\n    let inherent_data_providers = sp_inherents::InherentDataProviders::new();\n\n    let (client, backend, keystore, task_manager) =\n        sc_service::new_full_parts::\u003cBlock, RuntimeApi, Executor\u003e(\u0026config)?;\n    let client = Arc::new(client);\n\n    let select_chain = sc_consensus::LongestChain::new(backend.clone());\n\n    let transaction_pool = sc_transaction_pool::BasicPool::new_full(\n        config.transaction_pool.clone(),\n        config.prometheus_registry(),\n        task_manager.spawn_handle(),\n        client.clone(),\n    );\n\n    let (grandpa_block_import, grandpa_link) = sc_finality_grandpa::block_import(\n        client.clone(),\n        \u0026(client.clone() as Arc\u003c_\u003e),\n        select_chain.clone(),\n    )?;\n\n    let aura_block_import = sc_consensus_aura::AuraBlockImport::\u003c_, _, _, AuraPair\u003e::new(\n        grandpa_block_import.clone(),\n        client.clone(),\n    );\n\n    let import_queue = sc_consensus_aura::import_queue::\u003c_, _, _, AuraPair, _, _\u003e(\n        sc_consensus_aura::slot_duration(\u0026*client)?,\n        aura_block_import.clone(),\n        Some(Box::new(grandpa_block_import.clone())),\n        None,\n        client.clone(),\n        inherent_data_providers.clone(),\n        \u0026task_manager.spawn_handle(),\n        config.prometheus_registry(),\n        sp_consensus::CanAuthorWithNativeVersion::new(client.executor().clone()),\n    )?;\n\n    Ok(sc_service::PartialComponents {\n        client,\n        backend,\n        task_manager,\n        import_queue,\n        keystore,\n        select_chain,\n        transaction_pool,\n        inherent_data_providers,\n        other: (aura_block_import, grandpa_link),\n    })\n}\n\n/// Builds a new service for a full client.\npub fn new_full(config: Configuration) -\u003e Result\u003cTaskManager, ServiceError\u003e {\n    let sc_service::PartialComponents {\n        client,\n        backend,\n        mut task_manager,\n        import_queue,\n        keystore,\n        select_chain,\n        transaction_pool,\n        inherent_data_providers,\n        other: (block_import, grandpa_link),\n    } = new_partial(\u0026config)?;\n\n    let finality_proof_provider =\n        GrandpaFinalityProofProvider::new_for_service(backend.clone(), client.clone());\n\n    let (network, network_status_sinks, system_rpc_tx, network_starter) =\n        sc_service::build_network(sc_service::BuildNetworkParams {\n            config: \u0026config,\n            client: client.clone(),\n            transaction_pool: transaction_pool.clone(),\n            spawn_handle: task_manager.spawn_handle(),\n            import_queue,\n            on_demand: None,\n            block_announce_validator_builder: None,\n            finality_proof_request_builder: None,\n            finality_proof_provider: Some(finality_proof_provider.clone()),\n        })?;\n\n    if config.offchain_worker.enabled {\n        sc_service::build_offchain_workers(\n            \u0026config,\n            backend.clone(),\n            task_manager.spawn_handle(),\n            client.clone(),\n            network.clone(),\n        );\n    }\n\n    let role = config.role.clone();\n    let force_authoring = config.force_authoring;\n    let name = config.network.node_name.clone();\n    let enable_grandpa = !config.disable_grandpa;\n    let prometheus_registry = config.prometheus_registry().cloned();\n    let telemetry_connection_sinks = sc_service::TelemetryConnectionSinks::default();\n\n    let rpc_extensions_builder = {\n        let client = client.clone();\n        let pool = transaction_pool.clone();\n\n        Box::new(move |deny_unsafe, _| {\n            let deps = crate::rpc::FullDeps {\n                client: client.clone(),\n                pool: pool.clone(),\n                deny_unsafe,\n            };\n\n            crate::rpc::create_full(deps)\n        })\n    };\n\n    sc_service::spawn_tasks(sc_service::SpawnTasksParams {\n        network: network.clone(),\n        client: client.clone(),\n        keystore: keystore.clone(),\n        task_manager: \u0026mut task_manager,\n        transaction_pool: transaction_pool.clone(),\n        telemetry_connection_sinks: telemetry_connection_sinks.clone(),\n        rpc_extensions_builder: rpc_extensions_builder,\n        on_demand: None,\n        remote_blockchain: None,\n        backend,\n        network_status_sinks,\n        system_rpc_tx,\n        config,\n    })?;\n\n    if role.is_authority() {\n        let proposer = sc_basic_authorship::ProposerFactory::new(\n            client.clone(),\n            transaction_pool,\n            prometheus_registry.as_ref(),\n        );\n\n        let can_author_with =\n            sp_consensus::CanAuthorWithNativeVersion::new(client.executor().clone());\n\n        let aura = sc_consensus_aura::start_aura::\u003c_, _, _, _, _, AuraPair, _, _, _\u003e(\n            sc_consensus_aura::slot_duration(\u0026*client)?,\n            client.clone(),\n            select_chain,\n            block_import,\n            proposer,\n            network.clone(),\n            inherent_data_providers.clone(),\n            force_authoring,\n            keystore.clone(),\n            can_author_with,\n        )?;\n\n        // the AURA authoring task is considered essential, i.e. if it\n        // fails we take down the service with it.\n        task_manager\n            .spawn_essential_handle()\n            .spawn_blocking(\"aura\", aura);\n    }\n\n    // if the node isn't actively participating in consensus then it doesn't\n    // need a keystore, regardless of which protocol we use below.\n    let keystore = if role.is_authority() {\n        Some(keystore as sp_core::traits::BareCryptoStorePtr)\n    } else {\n        None\n    };\n\n    let grandpa_config = sc_finality_grandpa::Config {\n        // FIXME #1578 make this available through chainspec\n        gossip_duration: Duration::from_millis(333),\n        justification_period: 512,\n        name: Some(name),\n        observer_enabled: false,\n        keystore,\n        is_authority: role.is_network_authority(),\n    };\n\n    if enable_grandpa {\n        // start the full GRANDPA voter\n        // NOTE: non-authorities could run the GRANDPA observer protocol, but at\n        // this point the full voter should provide better guarantees of block\n        // and vote data availability than the observer. The observer has not\n        // been tested extensively yet and having most nodes in a network run it\n        // could lead to finality stalls.\n        let grandpa_config = sc_finality_grandpa::GrandpaParams {\n            config: grandpa_config,\n            link: grandpa_link,\n            network,\n            inherent_data_providers,\n            telemetry_on_connect: Some(telemetry_connection_sinks.on_connect_stream()),\n            voting_rule: sc_finality_grandpa::VotingRulesBuilder::default().build(),\n            prometheus_registry,\n            shared_voter_state: SharedVoterState::empty(),\n        };\n\n        // the GRANDPA voter task is considered infallible, i.e.\n        // if it fails we take down the service with it.\n        task_manager.spawn_essential_handle().spawn_blocking(\n            \"grandpa-voter\",\n            sc_finality_grandpa::run_grandpa_voter(grandpa_config)?,\n        );\n    } else {\n        sc_finality_grandpa::setup_disabled_grandpa(client, \u0026inherent_data_providers, network)?;\n    }\n\n    network_starter.start_network();\n    Ok(task_manager)\n}\n\n/// Builds a new service for a light client.\npub fn new_light(config: Configuration) -\u003e Result\u003cTaskManager, ServiceError\u003e {\n    let (client, backend, keystore, mut task_manager, on_demand) =\n        sc_service::new_light_parts::\u003cBlock, RuntimeApi, Executor\u003e(\u0026config)?;\n\n    let transaction_pool = Arc::new(sc_transaction_pool::BasicPool::new_light(\n        config.transaction_pool.clone(),\n        config.prometheus_registry(),\n        task_manager.spawn_handle(),\n        client.clone(),\n        on_demand.clone(),\n    ));\n\n    let grandpa_block_import = sc_finality_grandpa::light_block_import(\n        client.clone(),\n        backend.clone(),\n        \u0026(client.clone() as Arc\u003c_\u003e),\n        Arc::new(on_demand.checker().clone()) as Arc\u003c_\u003e,\n    )?;\n    let finality_proof_import = grandpa_block_import.clone();\n    let finality_proof_request_builder =\n        finality_proof_import.create_finality_proof_request_builder();\n\n    let import_queue = sc_consensus_aura::import_queue::\u003c_, _, _, AuraPair, _, _\u003e(\n        sc_consensus_aura::slot_duration(\u0026*client)?,\n        grandpa_block_import,\n        None,\n        Some(Box::new(finality_proof_import)),\n        client.clone(),\n        InherentDataProviders::new(),\n        \u0026task_manager.spawn_handle(),\n        config.prometheus_registry(),\n        sp_consensus::NeverCanAuthor,\n    )?;\n\n    let finality_proof_provider =\n        GrandpaFinalityProofProvider::new_for_service(backend.clone(), client.clone());\n\n    let (network, network_status_sinks, system_rpc_tx, network_starter) =\n        sc_service::build_network(sc_service::BuildNetworkParams {\n            config: \u0026config,\n            client: client.clone(),\n            transaction_pool: transaction_pool.clone(),\n            spawn_handle: task_manager.spawn_handle(),\n            import_queue,\n            on_demand: Some(on_demand.clone()),\n            block_announce_validator_builder: None,\n            finality_proof_request_builder: Some(finality_proof_request_builder),\n            finality_proof_provider: Some(finality_proof_provider),\n        })?;\n\n    if config.offchain_worker.enabled {\n        sc_service::build_offchain_workers(\n            \u0026config,\n            backend.clone(),\n            task_manager.spawn_handle(),\n            client.clone(),\n            network.clone(),\n        );\n    }\n\n    sc_service::spawn_tasks(sc_service::SpawnTasksParams {\n        remote_blockchain: Some(backend.remote_blockchain()),\n        transaction_pool,\n        task_manager: \u0026mut task_manager,\n        on_demand: Some(on_demand),\n        rpc_extensions_builder: Box::new(|_, _| ()),\n        telemetry_connection_sinks: sc_service::TelemetryConnectionSinks::default(),\n        config,\n        client,\n        keystore,\n        backend,\n        network,\n        network_status_sinks,\n        system_rpc_tx,\n    })?;\n\n    network_starter.start_network();\n\n    Ok(task_manager)\n}\n","traces":[{"line":27,"address":[16502048,16502240],"length":1,"stats":{"Line":0},"fn_name":"new_partial"},{"line":53,"address":[16502072],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[16502449],"length":1,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[16503011,16502611],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[16503035],"length":1,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[16503097],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[16503127],"length":1,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[16503154],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[16503197],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[16503307],"length":1,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[16503354],"length":1,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[16503424],"length":1,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[16504367],"length":1,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[16504390],"length":1,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[16504532,16504460,16504558,16504608,16504834],"length":1,"stats":{"Line":0},"fn_name":null},{"line":81,"address":[16504839,16504598],"length":1,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[16504968,16504863],"length":1,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[16505007],"length":1,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[16505035,16505084],"length":1,"stats":{"Line":0},"fn_name":null},{"line":85,"address":[16505108,16505154],"length":1,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[16505170],"length":1,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[16505220],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[16505279,16505385],"length":1,"stats":{"Line":0},"fn_name":null},{"line":91,"address":[16506748],"length":1,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[16506074],"length":1,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[16506090],"length":1,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[16506106],"length":1,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[16506196],"length":1,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[16506260],"length":1,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[16506276],"length":1,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[16506292],"length":1,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[16506308],"length":1,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[16506324],"length":1,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[16508208,16508571],"length":1,"stats":{"Line":0},"fn_name":"new_full"},{"line":106,"address":[16509266,16509455,16508602,16508225],"length":1,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[16508745],"length":1,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[16508769],"length":1,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[16508793],"length":1,"stats":{"Line":0},"fn_name":null},{"line":110,"address":[16508840],"length":1,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[16508912],"length":1,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[16508936],"length":1,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[16508960],"length":1,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[16508984],"length":1,"stats":{"Line":0},"fn_name":null},{"line":115,"address":[16509008],"length":1,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[16509248,16509638,16518264],"length":1,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[16510535,16510073,16510503,16510784],"length":1,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[16509755],"length":1,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[16509794,16509835],"length":1,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[16509843],"length":1,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[16509885],"length":1,"stats":{"Line":0},"fn_name":null},{"line":128,"address":[16509957],"length":1,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[16509969],"length":1,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[16509981],"length":1,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[16510001,16510042],"length":1,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[16511271,16511562,16510766],"length":1,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[16511284],"length":1,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[16511323],"length":1,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[16511366],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[16511413],"length":1,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[16511572],"length":1,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[16511602],"length":1,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[16511615],"length":1,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[16511666],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[16511738,16511682],"length":1,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[16511777],"length":1,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[16511816],"length":1,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[16511905,16511863],"length":1,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[16512073,16511913],"length":1,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[19910210],"length":1,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[19910169,19910115],"length":1,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[19910179],"length":1,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[19910241],"length":1,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[16512914,16512564,16512943,16512989],"length":1,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[16512105],"length":1,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[16512186,16512144],"length":1,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[16512202,16512240],"length":1,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[16512256,16512294],"length":1,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[16512310],"length":1,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[16512340],"length":1,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[16512356],"length":1,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[16512368],"length":1,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[16512380],"length":1,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[16512396],"length":1,"stats":{"Line":0},"fn_name":null},{"line":178,"address":[16512412],"length":1,"stats":{"Line":0},"fn_name":null},{"line":179,"address":[16512452],"length":1,"stats":{"Line":0},"fn_name":null},{"line":182,"address":[16513338],"length":1,"stats":{"Line":0},"fn_name":null},{"line":184,"address":[16513390],"length":1,"stats":{"Line":0},"fn_name":null},{"line":185,"address":[16513429],"length":1,"stats":{"Line":0},"fn_name":null},{"line":186,"address":[16513469],"length":1,"stats":{"Line":0},"fn_name":null},{"line":189,"address":[16513590],"length":1,"stats":{"Line":0},"fn_name":null},{"line":193,"address":[16513773,16513690,16513823,16514056],"length":1,"stats":{"Line":0},"fn_name":null},{"line":194,"address":[16513805,16514069],"length":1,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[16514085],"length":1,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[16514117],"length":1,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[16514261],"length":1,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[16514317],"length":1,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[16514438,16514364],"length":1,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[16514462],"length":1,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[16514477],"length":1,"stats":{"Line":0},"fn_name":null},{"line":207,"address":[16515211,16514921],"length":1,"stats":{"Line":0},"fn_name":null},{"line":209,"address":[16515254,16515162],"length":1,"stats":{"Line":0},"fn_name":null},{"line":214,"address":[16515316,16515375],"length":1,"stats":{"Line":0},"fn_name":null},{"line":215,"address":[16515384],"length":1,"stats":{"Line":0},"fn_name":null},{"line":217,"address":[16515355],"length":1,"stats":{"Line":0},"fn_name":null},{"line":222,"address":[16515429],"length":1,"stats":{"Line":0},"fn_name":null},{"line":224,"address":[16515466],"length":1,"stats":{"Line":0},"fn_name":null},{"line":227,"address":[16515578],"length":1,"stats":{"Line":0},"fn_name":null},{"line":230,"address":[16517296,16515799,16517240],"length":1,"stats":{"Line":0},"fn_name":null},{"line":242,"address":[16516091],"length":1,"stats":{"Line":0},"fn_name":null},{"line":243,"address":[16516158,16516253],"length":1,"stats":{"Line":0},"fn_name":null},{"line":245,"address":[16516308],"length":1,"stats":{"Line":0},"fn_name":null},{"line":250,"address":[16516606,16516935],"length":1,"stats":{"Line":0},"fn_name":null},{"line":252,"address":[16516652,16516981,16516812,16516790,16516767],"length":1,"stats":{"Line":0},"fn_name":null},{"line":255,"address":[16517301,16515825,16517261],"length":1,"stats":{"Line":0},"fn_name":null},{"line":258,"address":[16517452],"length":1,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[16517479],"length":1,"stats":{"Line":0},"fn_name":null},{"line":263,"address":[16521091,16520816],"length":1,"stats":{"Line":0},"fn_name":"new_light"},{"line":264,"address":[16521630,16521441,16520833,16521122],"length":1,"stats":{"Line":0},"fn_name":null},{"line":267,"address":[16521857,16521952],"length":1,"stats":{"Line":0},"fn_name":null},{"line":268,"address":[16521408],"length":1,"stats":{"Line":0},"fn_name":null},{"line":269,"address":[16521725],"length":1,"stats":{"Line":0},"fn_name":null},{"line":270,"address":[16521752],"length":1,"stats":{"Line":0},"fn_name":null},{"line":271,"address":[16521795],"length":1,"stats":{"Line":0},"fn_name":null},{"line":272,"address":[16521842],"length":1,"stats":{"Line":0},"fn_name":null},{"line":276,"address":[16521999],"length":1,"stats":{"Line":0},"fn_name":null},{"line":277,"address":[16522038],"length":1,"stats":{"Line":0},"fn_name":null},{"line":278,"address":[16522077,16522118],"length":1,"stats":{"Line":0},"fn_name":null},{"line":279,"address":[16522274,16522203,16522165],"length":1,"stats":{"Line":0},"fn_name":null},{"line":281,"address":[16522927],"length":1,"stats":{"Line":0},"fn_name":null},{"line":282,"address":[16522950],"length":1,"stats":{"Line":0},"fn_name":null},{"line":286,"address":[16523107,16523535,16523021,16523592,16523346],"length":1,"stats":{"Line":0},"fn_name":null},{"line":287,"address":[16523123],"length":1,"stats":{"Line":0},"fn_name":null},{"line":288,"address":[16523187],"length":1,"stats":{"Line":0},"fn_name":null},{"line":289,"address":[16523207,16523597],"length":1,"stats":{"Line":0},"fn_name":null},{"line":290,"address":[16523644,16523739],"length":1,"stats":{"Line":0},"fn_name":null},{"line":291,"address":[16523755],"length":1,"stats":{"Line":0},"fn_name":null},{"line":292,"address":[16523790],"length":1,"stats":{"Line":0},"fn_name":null},{"line":293,"address":[16523851],"length":1,"stats":{"Line":0},"fn_name":null},{"line":297,"address":[16524620,16528537],"length":1,"stats":{"Line":0},"fn_name":null},{"line":300,"address":[16525620],"length":1,"stats":{"Line":0},"fn_name":null},{"line":303,"address":[16524768],"length":1,"stats":{"Line":0},"fn_name":null},{"line":304,"address":[16524807],"length":1,"stats":{"Line":0},"fn_name":null},{"line":305,"address":[16524838],"length":1,"stats":{"Line":0},"fn_name":null},{"line":306,"address":[16524883],"length":1,"stats":{"Line":0},"fn_name":null},{"line":307,"address":[16524963,16525001],"length":1,"stats":{"Line":0},"fn_name":null},{"line":308,"address":[16525009],"length":1,"stats":{"Line":0},"fn_name":null},{"line":309,"address":[16525021],"length":1,"stats":{"Line":0},"fn_name":null},{"line":310,"address":[16525061],"length":1,"stats":{"Line":0},"fn_name":null},{"line":313,"address":[16525756,16526334,16526043],"length":1,"stats":{"Line":0},"fn_name":null},{"line":316,"address":[16526056],"length":1,"stats":{"Line":0},"fn_name":null},{"line":317,"address":[16526095],"length":1,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[16526138],"length":1,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[16526185],"length":1,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[16527270,16526834,16527224],"length":1,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[16526344],"length":1,"stats":{"Line":0},"fn_name":null},{"line":325,"address":[16526422],"length":1,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[16526446],"length":1,"stats":{"Line":0},"fn_name":null},{"line":328,"address":[16526568],"length":1,"stats":{"Line":0},"fn_name":null},{"line":329,"address":[16526591],"length":1,"stats":{"Line":0},"fn_name":null},{"line":330,"address":[16526621],"length":1,"stats":{"Line":0},"fn_name":null},{"line":331,"address":[16526698],"length":1,"stats":{"Line":0},"fn_name":null},{"line":332,"address":[16526714],"length":1,"stats":{"Line":0},"fn_name":null},{"line":333,"address":[16526730],"length":1,"stats":{"Line":0},"fn_name":null},{"line":334,"address":[16526746],"length":1,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[16526762],"length":1,"stats":{"Line":0},"fn_name":null},{"line":336,"address":[16526778],"length":1,"stats":{"Line":0},"fn_name":null},{"line":339,"address":[16527480],"length":1,"stats":{"Line":0},"fn_name":null},{"line":341,"address":[16527507],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":168},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","financial","src","lib.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n//! # Financial Pallet Module\n//! ## Overview\n//!\n//! Equilibrium's Financial Pallet is an open-source substrate module that subscribes to external\n//! price feed/oracle, gathers asset prices and calculates financial metrics based on the\n//! information collected.\n//!\n//! ## Genesis Config\n//!\n//! You can provide initial price logs for the assets using [`GenesisConfig`](./struct.GenesisConfig.html).\n\n#![warn(missing_docs)]\n#![cfg_attr(not(feature = \"std\"), no_std)]\n\nuse core::ops::{AddAssign, BitOrAssign, ShlAssign};\nuse core::time::Duration;\nuse financial_primitives::capvec::CapVec;\nuse financial_primitives::{\n    BalanceAware, CalcReturnType, CalcVolatilityType, OnPriceSet, PricePeriod, PricePeriodError,\n};\nuse frame_support::codec::{Decode, Encode, FullCodec};\nuse frame_support::dispatch::{DispatchError, Parameter};\nuse frame_support::storage::{IterableStorageMap, StorageMap};\nuse frame_support::traits::{Get, UnixTime};\nuse frame_support::{decl_error, decl_event, decl_module, decl_storage, dispatch, ensure};\nuse frame_system::ensure_signed;\nuse math::{\n    calc_return_func, calc_return_iter, covariance, decay, demeaned, exp_corr, from_num,\n    last_recurrent_ewma, log_value_at_risk, mean, mul, regular_corr, regular_value_at_risk,\n    regular_vola, squared, sum, ConstType, MathError, MathResult,\n};\nuse sp_std::cmp::{max, min};\nuse sp_std::convert::{TryFrom, TryInto};\nuse sp_std::iter::Iterator;\nuse sp_std::ops::Range;\nuse sp_std::prelude::Vec;\nuse sp_std::vec;\nuse substrate_fixed::traits::{Fixed, FixedSigned, ToFixed};\nuse substrate_fixed::transcendental::sqrt;\n\npub use math::CalcCorrelationType;\n\nmod math;\n\n#[cfg(test)]\nmod mock;\n\n#[cfg(test)]\nmod tests;\n\n/// The module configuration trait.\npub trait Trait: frame_system::Trait {\n    /// The overarching event type.\n    type Event: From\u003cEvent\u003cSelf\u003e\u003e + Into\u003c\u003cSelf as frame_system::Trait\u003e::Event\u003e;\n    /// Implementation for the current unix timestamp provider. The\n    /// [`pallet_timestamp`](https://crates.parity.io/pallet_timestamp/index.html) is\n    /// right choice in most cases.\n    type UnixTime: UnixTime;\n    /// Number of price data points stored and used for calculations.\n    type PriceCount: Get\u003cu32\u003e;\n    /// The period of the collected prices in minutes.\n    type PricePeriod: Get\u003cu32\u003e;\n    /// Default type of calculation for return: Regular or Log.\n    type ReturnType: Get\u003cu32\u003e;\n    /// Default type of calculation for volatility and correlation: Regular or Exponential.\n    type VolCorType: Get\u003ci64\u003e;\n    /// System wide type for representing various assets such as BTC, ETH, EOS, etc.\n    type Asset: Parameter + Copy + Ord + Eq;\n    /// Primitive integer type that [`FixedNumber`](#associatedtype.FixedNumber) based on.\n    type FixedNumberBits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign;\n    /// Fixed point data type with a required precision that used for all financial calculations.\n    type FixedNumber: Clone\n        + Copy\n        + FullCodec\n        + FixedSigned\u003cBits = Self::FixedNumberBits\u003e\n        + PartialOrd\u003cConstType\u003e\n        + From\u003cConstType\u003e;\n    /// System wide type for representing price values. It must be convertable to and\n    /// from [`FixedNumber`](#associatedtype.FixedNumber).\n    type Price: Parameter + Clone + From\u003cSelf::FixedNumber\u003e + Into\u003cSelf::FixedNumber\u003e;\n    /// Type that gets user balances for a given AccountId\n    type Balances: BalanceAware\u003c\n        AccountId = Self::AccountId,\n        Asset = Self::Asset,\n        Balance = Self::Price,\n    \u003e;\n}\n\n/// Information about latest price update.\n#[derive(Encode, Decode, Clone, Default, PartialEq, Eq, Debug)]\npub struct PriceUpdate\u003cP\u003e {\n    /// Timestamp of the price period start for the latest price received.\n    pub period_start: Duration,\n    /// Latest price timestamp.\n    pub time: Duration,\n    /// Latest price value.\n    pub price: P,\n}\n\nimpl\u003cP\u003e PriceUpdate\u003cP\u003e {\n    #[cfg(test)]\n    fn new(period_start: Duration, time: Duration, price: P) -\u003e PriceUpdate\u003cP\u003e {\n        PriceUpdate {\n            period_start,\n            time,\n            price,\n        }\n    }\n}\n\n/// History of price changes for asset\n#[derive(Encode, Decode, Clone, Default, PartialEq, Eq, Debug)]\npub struct PriceLog\u003cF\u003e {\n    /// Timestamp of the latest point in the log.\n    pub latest_timestamp: Duration,\n    /// History of prices changes for last [`PriceCount`](./trait.Trait.html#associatedtype.PriceCount) periods in succesion.\n    pub prices: CapVec\u003cF\u003e,\n}\n\n/// Financial metrics for asset\n#[derive(Encode, Decode, Clone, Default, PartialEq, Eq, Debug)]\npub struct AssetMetrics\u003cA, P\u003e {\n    /// Start of the period inclusive for which metrics were calculated.\n    pub period_start: Duration,\n    /// End of the period exclusive for which metrics were calculated.\n    pub period_end: Duration,\n    /// Log returns\n    pub returns: Vec\u003cP\u003e,\n    /// Volatility\n    pub volatility: P,\n    /// Correlations for all assets\n    pub correlations: Vec\u003c(A, P)\u003e,\n}\n\n/// Financial metrics for all assets\n#[derive(Encode, Decode, Clone, Default, PartialEq, Eq, Debug)]\npub struct FinancialMetrics\u003cA, P\u003e {\n    /// Start of the period inclusive for which metrics were calculated.\n    pub period_start: Duration,\n    /// End of the period exclusive for which metrics were calculated.\n    pub period_end: Duration,\n\n    /// Assets for which metrics were calculated.\n    pub assets: Vec\u003cA\u003e,\n\n    /// Mean returns for all assets. Mean returns are in the same order as the assets in the `assets` field.\n    pub mean_returns: Vec\u003cP\u003e,\n\n    /// Volatilities for all assets. Volatilities are in the same order as the assets in the `assets` field.\n    pub volatilities: Vec\u003cP\u003e,\n\n    /// Correlation matrix for all assets.\n    /// Rows and columns are in the same order as the assets in the `assets` field.\n    /// Matrix is stored by rows. For example, let matrix A =\n    ///\n    /// ```pseudocode\n    /// a11 a12 a13\n    /// a21 a22 a21\n    /// a31 a32 a33\n    /// ```\n    ///\n    /// Then vector for this matrix will be:\n    ///\n    /// ```pseudocode\n    /// vec![a11, a12, a13, a21, a22, a23, a31, a32, a33]\n    /// ```\n    pub correlations: Vec\u003cP\u003e,\n\n    /// Covariance matrix for all assets.\n    /// Rows and columns are in the same order as the assets in the `assets` field.\n    /// Matrix is stored by rows. See example for `correlations` field.\n    pub covariances: Vec\u003cP\u003e,\n}\n\ndecl_storage! {\n    trait Store for Module\u003cT: Trait\u003e as FinancialModule {\n        /// Latest price updates on per asset basis.\n        pub Updates get(fn updates): map hasher(blake2_128_concat) T::Asset =\u003e Option\u003cPriceUpdate\u003cT::FixedNumber\u003e\u003e;\n\n        /// Price log on per asset basis.\n        pub PriceLogs get(fn price_logs): map hasher(blake2_128_concat) T::Asset =\u003e Option\u003cPriceLog\u003cT::FixedNumber\u003e\u003e;\n\n        /// Financial metrics on per asset basis.\n        pub PerAssetMetrics get(fn per_asset_metrics): map hasher(blake2_128_concat) T::Asset =\u003e Option\u003cAssetMetrics\u003cT::Asset, T::Price\u003e\u003e;\n\n        /// Financial metrics for all known assets.\n        pub Metrics get(fn metrics): Option\u003cFinancialMetrics\u003cT::Asset, T::Price\u003e\u003e;\n    }\n\n    add_extra_genesis {\n        /// Initial price logs on per asset basis.\n        config(prices): Vec\u003c(T::Asset, Vec\u003cT::Price\u003e, Duration)\u003e;\n\n        build(|config| {\n            let max_price_count = 180;\n            // Limit max value of `PricePeriod` to 7 days\n            let max_price_period = 7 * 24 * 60;\n\n            let price_count = T::PriceCount::get();\n            assert!(price_count \u003c= max_price_count, \"PriceCount can not be greater than {}\", max_price_count);\n\n            let price_period = T::PricePeriod::get();\n            assert!(price_period \u003c= max_price_period, \"PricePeriod can not be greater than {}\", max_price_period);\n\n            // We assume that each config item for a given asset contains prices of the past perionds going in\n            // succession. Timestamp of the last period is specified in `latest_timestamp`.\n            for (asset, values, latest_timestamp) in config.prices.iter() {\n                let mut prices = CapVec::\u003cT::FixedNumber\u003e::new(price_count);\n\n                assert!(values.len() \u003e 0, \"Initial price vector can not be empty. Asset: {:?}.\");\n\n                for v in values.iter() {\n                    prices.push(v.clone().into());\n                }\n\n                PriceLogs::\u003cT\u003e::insert(asset, PriceLog {\n                    latest_timestamp: *latest_timestamp,\n                    prices\n                });\n            }\n        });\n    }\n}\n\ndecl_event!(\n    pub enum Event\u003cT\u003e\n    where\n        Asset = \u003cT as Trait\u003e::Asset,\n    {\n        /// Financial metrics for the specified asset have been recalculeted\n        Recalculated(Asset),\n        /// Financial metrics for all assets have been recalculeted\n        MetricsRecalculated(),\n    }\n);\n\ndecl_error! {\n    /// Error for the Financial Pallet module.\n    pub enum Error for Module\u003cT: Trait\u003e {\n        /// Timestamp of the received price is in the past.\n        PeriodIsInThePast,\n        /// Overflow occured during financial calculation process.\n        Overflow,\n        /// Division by zero occured during financial calculation process.\n        DivisionByZero,\n        /// Price log is not long enough to calculate required value.\n        NotEnoughPoints,\n        /// Required functionality is not implemented.\n        NotImplemented,\n        /// Storage of the pallet is in an unexpected state.\n        InvalidStorage,\n        /// Specified period start timestamp is invalid for current\n        /// [`PricePeriod`](./trait.Trait.html#associatedtype.PricePeriod) value.\n        InvalidPeriodStart,\n        /// An invalid argument passed to the transcendental function (i.e. log, sqrt, etc.)\n        /// during financial calculation process.\n        Transcendental,\n        /// An invalid argument passed to the function.\n        InvalidArgument,\n        /// Default return type or default correlation type is initialized with a value that can\n        /// not be converted to type `CalcReturnType` or `CalcVolatilityType` respectively.\n        InvalidConstant,\n    }\n}\n\ndecl_module! {\n    /// Financial Pallet module declaration.\n    pub struct Module\u003cT: Trait\u003e for enum Call where origin: T::Origin {\n        type Error = Error\u003cT\u003e;\n\n        fn deposit_event() = default;\n\n        const PriceCount: u32 = T::PriceCount::get();\n        const PricePeriod: u32 = T::PricePeriod::get();\n\n        /// Recalculates financial metrics for a given asset\n        #[weight = 10_000 + T::DbWeight::get().writes(1)]\n        pub fn recalc_asset(origin, asset: T::Asset) -\u003e dispatch::DispatchResult {\n            ensure_signed(origin)?;\n\n            let return_type = CalcReturnType::try_from(T::ReturnType::get()).map_err(|_| Error::\u003cT\u003e::InvalidConstant)?;\n            let vol_cor_type = CalcVolatilityType::try_from(T::VolCorType::get()).map_err(|_| Error::\u003cT\u003e::InvalidConstant)?;\n\n            let mut correlations = vec![];\n\n            let mut asset_logs: Vec\u003c_\u003e = PriceLogs::\u003cT\u003e::iter().collect();\n            ensure!(asset_logs.len() \u003e 0, Error::\u003cT\u003e::NotEnoughPoints);\n            asset_logs.sort_by(|(a1, _), (a2, _)| a1.cmp(a2));\n\n            let price_period = PricePeriod(T::PricePeriod::get());\n            let ranges = asset_logs.iter().map(|(_, l)| get_period_id_range(\u0026price_period, l.prices.len(), l.latest_timestamp)).collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e().map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n            // Ensure that all correlations calculated for the same period\n            let intersection = get_range_intersection(ranges.iter()).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n            let (log1, period_id_range1) = asset_logs.iter().zip(ranges.iter()).find_map(|((a, l), r)| if *a == asset {Some((l, r))} else {None}).ok_or(Error::\u003cT\u003e::NotEnoughPoints)?;\n            let range1 = get_index_range(period_id_range1, \u0026intersection).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n            let prices1 = log1.prices.iter_range(\u0026range1).copied().collect::\u003cVec\u003c_\u003e\u003e();\n\n            let ret1 = Ret::\u003cT::FixedNumber\u003e::new(\u0026prices1, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n            let vol1 = Vol::\u003cT::FixedNumber\u003e::new(\u0026ret1, vol_cor_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n            for ((asset2, log2), period_id_range2) in asset_logs.iter().zip(ranges.iter()) {\n                if *asset2 == asset {\n                    // Correlation for any asset with itself sould be 1\n                    correlations.push((*asset2, from_num::\u003cT::FixedNumber\u003e(1).into()));\n                } else {\n                    let range2 = get_index_range(period_id_range2, \u0026intersection).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n                    let prices2 = log2.prices.iter_range(\u0026range2).copied().collect::\u003cVec\u003c_\u003e\u003e();\n\n                    let ret2 = Ret::\u003cT::FixedNumber\u003e::new(\u0026prices2, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n                    let vol2 = Vol::\u003cT::FixedNumber\u003e::new(\u0026ret2, vol_cor_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n                    let corre = cor(\u0026ret1, \u0026vol1, \u0026ret2, \u0026vol2).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n                    correlations.push((*asset2, corre.into()));\n                }\n            }\n\n            let temporal_range = Range {\n                start: price_period.get_period_id_start(intersection.start).map_err(Into::\u003cMathError\u003e::into).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?,\n                end: price_period.get_period_id_start(intersection.end).map_err(Into::\u003cMathError\u003e::into).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?,\n            };\n\n            let returns: Vec\u003cT::Price\u003e = ret1.ret.into_iter().map(|x| x.into()).collect();\n            let volatility: T::Price = vol1.vol.into();\n\n            PerAssetMetrics::\u003cT\u003e::insert(\u0026asset, AssetMetrics {\n                    period_start: temporal_range.start,\n                    period_end: temporal_range.end,\n                    returns,\n                    volatility,\n                    correlations,\n                }\n            );\n\n            Self::deposit_event(RawEvent::Recalculated(asset));\n\n            Ok(())\n        }\n\n        /// Recalculates financial metrics for all known assets.\n        #[weight = 10_000 + T::DbWeight::get().writes(1)]\n        pub fn recalc(origin) -\u003e dispatch::DispatchResult {\n            ensure_signed(origin)?;\n\n            let return_type = CalcReturnType::try_from(T::ReturnType::get()).map_err(|_| Error::\u003cT\u003e::InvalidConstant)?;\n            let vol_cor_type = CalcVolatilityType::try_from(T::VolCorType::get()).map_err(|_| Error::\u003cT\u003e::InvalidConstant)?;\n\n            let price_period = PricePeriod(T::PricePeriod::get());\n\n            let mut asset_logs: Vec\u003c_\u003e = PriceLogs::\u003cT\u003e::iter().collect();\n            ensure!(asset_logs.len() \u003e 0, Error::\u003cT\u003e::NotEnoughPoints);\n            asset_logs.sort_by(|(a1, _), (a2, _)| a1.cmp(a2));\n\n            let metrics = financial_metrics::\u003cT::Asset, T::FixedNumber, T::Price\u003e(return_type, vol_cor_type, \u0026price_period, \u0026asset_logs).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n            Metrics::\u003cT\u003e::put(metrics);\n\n            Self::deposit_event(RawEvent::MetricsRecalculated());\n\n            Ok(())\n        }\n    }\n}\n\n#[derive(Debug, Eq, PartialEq)]\nenum GetNewPricesError {\n    Overflow,\n}\n\nfn get_new_prices\u003cP: Clone\u003e(\n    last_price: P,\n    new_price: P,\n    empty_periods: u32,\n    max_periods: u32,\n) -\u003e Result\u003cVec\u003cP\u003e, GetNewPricesError\u003e {\n    // Calculate how many values to pre-populate the array with\n    // We will pre-fill up to `max_periods` elements (leaving out one for the new price)\n    let prices_size = min(\n        empty_periods,\n        max_periods\n            .checked_sub(1)\n            .ok_or(GetNewPricesError::Overflow)?,\n    ) as usize;\n\n    // Init the vector filled with last_price\n    let mut new_prices = vec![last_price.clone(); prices_size];\n\n    new_prices.push(new_price);\n\n    Ok(new_prices)\n}\n\nimpl\u003cT: Trait\u003e From\u003cGetNewPricesError\u003e for Error\u003cT\u003e {\n    fn from(error: GetNewPricesError) -\u003e Self {\n        match error {\n            GetNewPricesError::Overflow =\u003e Error::\u003cT\u003e::Overflow,\n        }\n    }\n}\n\n#[derive(Debug, Eq, PartialEq)]\nenum PricePeriodAction {\n    RemainsUnchanged,\n    StartedNew(u32),\n}\n\n#[derive(Debug, Eq, PartialEq)]\nstruct PricePeriodChange {\n    pub period_start: Duration,\n    pub action: PricePeriodAction,\n}\n\n#[derive(Debug, Eq, PartialEq)]\nenum PricePeriodChangeError {\n    DivisionByZero,\n    Overflow,\n    PeriodIsInThePast,\n    InvalidPeriodStart,\n}\n\nimpl From\u003cPricePeriodError\u003e for PricePeriodChangeError {\n    fn from(error: PricePeriodError) -\u003e Self {\n        match error {\n            PricePeriodError::DivisionByZero =\u003e PricePeriodChangeError::DivisionByZero,\n            PricePeriodError::Overflow =\u003e PricePeriodChangeError::Overflow,\n        }\n    }\n}\n\nimpl\u003cT: Trait\u003e From\u003cPricePeriodChangeError\u003e for Error\u003cT\u003e {\n    fn from(error: PricePeriodChangeError) -\u003e Self {\n        match error {\n            PricePeriodChangeError::DivisionByZero =\u003e Error::\u003cT\u003e::DivisionByZero,\n            PricePeriodChangeError::Overflow =\u003e Error::\u003cT\u003e::Overflow,\n            PricePeriodChangeError::PeriodIsInThePast =\u003e Error::\u003cT\u003e::PeriodIsInThePast,\n            PricePeriodChangeError::InvalidPeriodStart =\u003e Error::\u003cT\u003e::InvalidPeriodStart,\n        }\n    }\n}\n\n/// Calculates start timestamp of the period which contains `now` timestamp.\n/// Also  calculates number of periods elapsed since `prev_start` timestamp up until `now` timestamp.\nfn get_curr_period_info(\n    price_period: \u0026PricePeriod,\n    prev_start: Duration,\n    now: Duration,\n) -\u003e Result\u003c(Duration, i32), PricePeriodError\u003e {\n    let prev_period_id = price_period.get_period_id(prev_start)?;\n    let curr_period_id = price_period.get_period_id(now)?;\n\n    let prev: i32 = prev_period_id\n        .try_into()\n        .map_err(|_| PricePeriodError::Overflow)?;\n    let curr: i32 = curr_period_id\n        .try_into()\n        .map_err(|_| PricePeriodError::Overflow)?;\n    let delta: Result\u003c_, PricePeriodError\u003e =\n        curr.checked_sub(prev).ok_or(PricePeriodError::Overflow);\n    Ok((price_period.get_period_id_start(curr_period_id)?, delta?))\n}\n\n/// Dicides if the period change took place.\nfn get_period_change(\n    price_period: \u0026PricePeriod,\n    period_start: Option\u003cDuration\u003e,\n    now: Duration,\n) -\u003e Result\u003cPricePeriodChange, PricePeriodChangeError\u003e {\n    if let Some(period_start) = period_start {\n        ensure!(\n            price_period.is_valid_period_start(period_start)?,\n            PricePeriodChangeError::InvalidPeriodStart\n        );\n    }\n\n    match period_start {\n        // No `period_start` exists. It means that we received price update for the first time.\n        None =\u003e {\n            let period_start = price_period.get_period_start(now)?;\n\n            Ok(PricePeriodChange {\n                period_start,\n                action: PricePeriodAction::StartedNew(0),\n            })\n        }\n        Some(last_start) =\u003e {\n            let (current_start, periods_elapsed) =\n                get_curr_period_info(price_period, last_start, now)?;\n\n            if periods_elapsed \u003c 0 {\n                // Current period is in the past\n\n                Err(PricePeriodChangeError::PeriodIsInThePast)\n            } else if periods_elapsed == 0 {\n                // Period is not changed\n\n                Ok(PricePeriodChange {\n                    period_start: last_start,\n                    action: PricePeriodAction::RemainsUnchanged,\n                })\n            } else {\n                // Period is changed\n\n                let empty_periods = (periods_elapsed - 1) as u32;\n\n                Ok(PricePeriodChange {\n                    period_start: current_start,\n                    action: PricePeriodAction::StartedNew(empty_periods),\n                })\n            }\n        }\n    }\n}\n\nimpl\u003cT: Trait\u003e OnPriceSet for Module\u003cT\u003e {\n    type Asset = T::Asset;\n    type Price = T::Price;\n\n    fn on_price_set(asset: T::Asset, value: T::Price) -\u003e Result\u003c(), DispatchError\u003e {\n        let value: T::FixedNumber = value.into();\n        let now = T::UnixTime::now();\n        let price_count = T::PriceCount::get();\n\n        let update = Self::updates(asset);\n        let log = Self::price_logs(asset);\n\n        // If `PriceLog` for a given asset is not empty then it must contain fully initialized `CapVec`. It's `cap_len` should be equal to `PriceCount`.\n        if let Some(ref log) = log {\n            ensure!(\n                log.prices.len_cap() == price_count,\n                Error::\u003cT\u003e::InvalidStorage\n            );\n        }\n\n        let period_start = update.map(|x| x.period_start);\n        let price_period = PricePeriod(T::PricePeriod::get());\n        let period_change =\n            get_period_change(\u0026price_period, period_start, now).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let period_start = period_change.period_start;\n\n        // Every point received is stores to the `Update`.\n        // Meanwhile only first point received in the current period is stored in the price log.\n        match period_change.action {\n            PricePeriodAction::RemainsUnchanged =\u003e {\n                Updates::\u003cT\u003e::insert(\n                    \u0026asset,\n                    PriceUpdate {\n                        period_start: period_start,\n                        time: now,\n                        price: value,\n                    },\n                );\n            }\n            PricePeriodAction::StartedNew(empty_periods) =\u003e {\n                let log_to_insert = if let Some(mut existing_log) = log {\n                    existing_log.latest_timestamp = now;\n\n                    // If `PriceLog` for a given asset is not empty, then it should contain at\n                    // least one price value. It was set during prevoius `on_price_update` call or\n                    // during genesis state generation routine.\n                    let last_price = existing_log\n                        .prices\n                        .last()\n                        .copied()\n                        .ok_or(Error::\u003cT\u003e::InvalidStorage)?;\n\n                    let new_prices = get_new_prices(last_price, value, empty_periods, price_count)\n                        .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n                    for p in new_prices {\n                        existing_log.prices.push(p);\n                    }\n\n                    existing_log\n                } else {\n                    let mut new_prices = CapVec::\u003cT::FixedNumber\u003e::new(price_count);\n                    new_prices.push(value);\n\n                    PriceLog {\n                        latest_timestamp: now,\n                        prices: new_prices,\n                    }\n                };\n\n                Updates::\u003cT\u003e::insert(\n                    \u0026asset,\n                    PriceUpdate {\n                        period_start: period_start,\n                        time: now,\n                        price: value,\n                    },\n                );\n                PriceLogs::\u003cT\u003e::insert(\u0026asset, log_to_insert);\n            }\n        }\n\n        Ok(())\n    }\n}\n\n/// Important financial functions that uses [`prices`](./struct.Module.html#method.prices) as a data source.\npub trait Financial {\n    /// System wide type for representing various assets such as BTC, ETH, EOS, etc.\n    type Asset;\n    /// System wide type for representing price values.\n    type Price;\n    /// System wide type for representing account id.\n    type AccountId;\n\n    /// Calculates return.\n    fn calc_return(\n        return_type: CalcReturnType,\n        asset: Self::Asset,\n    ) -\u003e Result\u003cVec\u003cSelf::Price\u003e, DispatchError\u003e;\n    /// Calculates volatility.\n    fn calc_vol(\n        return_type: CalcReturnType,\n        volatility_type: CalcVolatilityType,\n        asset: Self::Asset,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e;\n    /// Calculates pairwise correlation between two specified assets.\n    fn calc_corr(\n        return_type: CalcReturnType,\n        correlation_type: CalcVolatilityType,\n        asset1: Self::Asset,\n        asset2: Self::Asset,\n    ) -\u003e Result\u003c(Self::Price, Range\u003cDuration\u003e), DispatchError\u003e;\n    /// Calculates portfolio volatility.\n    fn calc_portf_vol(\n        return_type: CalcReturnType,\n        vol_cor_type: CalcVolatilityType,\n        account_id: Self::AccountId,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e;\n    /// Calculates portfolio value at risk.\n    fn calc_portf_var(\n        return_type: CalcReturnType,\n        vol_cor_type: CalcVolatilityType,\n        account_id: Self::AccountId,\n        z_score: u32,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e;\n}\n\n#[derive(Debug)]\nstruct Ret\u003c'prices, F\u003e {\n    prices: \u0026'prices [F],\n    return_type: CalcReturnType,\n    ret: Vec\u003cF\u003e,\n}\n\nimpl\u003c'prices, F\u003e Ret\u003c'prices, F\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    fn new(prices: \u0026'prices [F], return_type: CalcReturnType) -\u003e MathResult\u003cRet\u003c'prices, F\u003e\u003e {\n        let ret = calc_return_iter(prices, calc_return_func(return_type))\n            .collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()?;\n        Ok(Ret {\n            prices,\n            return_type,\n            ret,\n        })\n    }\n}\n\n#[derive(Debug)]\nstruct Vol\u003cF\u003e {\n    volatility_type: CalcVolatilityType,\n    mean_return: F,\n    demeaned_return: Vec\u003cF\u003e,\n    decay: Option\u003cF\u003e,\n    vol: F,\n}\n\nimpl\u003cF\u003e Vol\u003cF\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    fn new\u003c'prices\u003e(\n        ret: \u0026Ret\u003c'prices, F\u003e,\n        volatility_type: CalcVolatilityType,\n    ) -\u003e MathResult\u003cVol\u003cF\u003e\u003e {\n        let mean_return: F = mean(\u0026ret.ret)?;\n\n        let demeaned_return =\n            demeaned(ret.ret.iter(), mean_return).collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()?;\n        let squared_demeaned_return = squared(demeaned_return.iter().copied().map(Ok));\n\n        match volatility_type {\n            CalcVolatilityType::Regular =\u003e {\n                let vol: F = sqrt(regular_vola(ret.ret.len(), sum(squared_demeaned_return)?)?)\n                    .map_err(|_| MathError::Transcendental)?;\n\n                Ok(Vol {\n                    volatility_type,\n                    mean_return,\n                    demeaned_return,\n                    decay: None,\n                    vol,\n                })\n            }\n            CalcVolatilityType::Exponential(ewma_length) =\u003e {\n                let decay = decay(ewma_length)?;\n                let var = last_recurrent_ewma(squared_demeaned_return, decay)?;\n                let vol = sqrt(var).map_err(|_| MathError::Transcendental)?;\n\n                Ok(Vol {\n                    volatility_type: CalcVolatilityType::Exponential(ewma_length),\n                    mean_return,\n                    demeaned_return,\n                    decay: Some(decay),\n                    vol,\n                })\n            }\n        }\n    }\n}\n\nfn cor\u003c'prices, F\u003e(\n    ret1: \u0026Ret\u003c'prices, F\u003e,\n    volatility1: \u0026Vol\u003cF\u003e,\n    ret2: \u0026Ret\u003c'prices, F\u003e,\n    volatility2: \u0026Vol\u003cF\u003e,\n) -\u003e MathResult\u003cF\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    let zero = from_num::\u003cF\u003e(0);\n\n    match (\u0026volatility1, \u0026volatility2) {\n        (Vol { vol: vol1, .. }, _) if *vol1 == zero =\u003e Ok(zero),\n        (_, Vol { vol: vol2, .. }) if *vol2 == zero =\u003e Ok(zero),\n        (\n            Vol {\n                volatility_type: CalcVolatilityType::Regular,\n                demeaned_return: dr1,\n                vol: vol1,\n                ..\n            },\n            Vol {\n                volatility_type: CalcVolatilityType::Regular,\n                demeaned_return: dr2,\n                vol: vol2,\n                ..\n            },\n        ) =\u003e {\n            let demeaned_returns_product = mul(dr1.iter().copied(), dr2.iter().copied());\n\n            let products_sum = sum(demeaned_returns_product)?;\n            let products_len = min(ret1.ret.len(), ret2.ret.len());\n            let result = regular_corr(products_len, products_sum, *vol1, *vol2)?;\n            Ok(result)\n        }\n        (\n            Vol {\n                volatility_type: CalcVolatilityType::Exponential(n1),\n                demeaned_return: dr1,\n                decay: Some(d1),\n                vol: vol1,\n                ..\n            },\n            Vol {\n                volatility_type: CalcVolatilityType::Exponential(n2),\n                demeaned_return: dr2,\n                vol: vol2,\n                ..\n            },\n        ) if n1 == n2 =\u003e {\n            let demeaned_returns_product = mul(dr1.iter().copied(), dr2.iter().copied());\n\n            let decay = *d1;\n            let last_covar = last_recurrent_ewma(demeaned_returns_product, decay)?;\n            let result = exp_corr(last_covar, *vol1, *vol2)?;\n            Ok(result)\n        }\n        _ =\u003e Err(MathError::InvalidArgument),\n    }\n}\n\nfn financial_metrics\u003cA, F, P\u003e(\n    return_type: CalcReturnType,\n    vol_cor_type: CalcVolatilityType,\n    price_period: \u0026PricePeriod,\n    asset_logs: \u0026[(A, PriceLog\u003cF\u003e)],\n) -\u003e MathResult\u003cFinancialMetrics\u003cA, P\u003e\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n    F: Into\u003cP\u003e,\n    A: Eq + Copy,\n{\n    ensure!(asset_logs.len() \u003e 0, MathError::NotEnoughPoints);\n\n    let mut mean_returns = Vec::with_capacity(asset_logs.len());\n    let mut volatilities = Vec::with_capacity(asset_logs.len());\n    let mut correlations = Vec::with_capacity(asset_logs.len() * asset_logs.len());\n\n    let period_id_ranges = asset_logs\n        .iter()\n        .map(|(_, l)| get_period_id_range(\u0026price_period, l.prices.len(), l.latest_timestamp))\n        .collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()?;\n\n    // Ensure that all correlations calculated for the same period\n    let intersection = get_range_intersection(period_id_ranges.iter())?;\n\n    for ((asset1, log1), period_id_range1) in asset_logs.iter().zip(period_id_ranges.iter()) {\n        let range1 = get_index_range(period_id_range1, \u0026intersection)?;\n        let prices1 = log1.prices.iter_range(\u0026range1).copied().collect::\u003cVec\u003c_\u003e\u003e();\n\n        let ret1 = Ret::\u003cF\u003e::new(\u0026prices1, return_type)?;\n        let vol1 = Vol::\u003cF\u003e::new(\u0026ret1, vol_cor_type)?;\n\n        mean_returns.push(vol1.mean_return);\n        volatilities.push(vol1.vol);\n\n        for ((asset2, log2), period_id_range2) in asset_logs.iter().zip(period_id_ranges.iter()) {\n            if *asset2 == *asset1 {\n                // Correlation for any asset with itself sould be 1\n                correlations.push(from_num::\u003cF\u003e(1));\n            } else {\n                let range2 = get_index_range(period_id_range2, \u0026intersection)?;\n                let prices2 = log2.prices.iter_range(\u0026range2).copied().collect::\u003cVec\u003c_\u003e\u003e();\n\n                let ret2 = Ret::\u003cF\u003e::new(\u0026prices2, return_type)?;\n                let vol2 = Vol::\u003cF\u003e::new(\u0026ret2, vol_cor_type)?;\n\n                let corre = cor(\u0026ret1, \u0026vol1, \u0026ret2, \u0026vol2)?;\n\n                correlations.push(corre);\n            }\n        }\n    }\n\n    let covariances = covariance(\u0026correlations, \u0026volatilities)\n        .map(|x| x.map(|y| y.into()))\n        .collect::\u003cMathResult\u003cVec\u003cP\u003e\u003e\u003e()?;\n\n    let temporal_range = Range {\n        start: price_period.get_period_id_start(intersection.start)?,\n        end: price_period.get_period_id_start(intersection.end)?,\n    };\n\n    Ok(FinancialMetrics {\n        period_start: temporal_range.start,\n        period_end: temporal_range.end,\n        assets: asset_logs.iter().map(|(a, _)| a).copied().collect(),\n        mean_returns: mean_returns.into_iter().map(|x| x.into()).collect(),\n        volatilities: volatilities.into_iter().map(|x| x.into()).collect(),\n        correlations: correlations.into_iter().map(|x| x.into()).collect(),\n        covariances: covariances,\n    })\n}\n\nfn latest_prices\u003c'logs, A, F\u003e(\n    asset_logs: \u0026'logs [(A, PriceLog\u003cF\u003e)],\n) -\u003e impl Iterator\u003cItem = MathResult\u003cF\u003e\u003e + 'logs\nwhere\n    F: Copy,\n{\n    asset_logs.iter().map(|(_, l)| {\n        l.prices\n            .last()\n            .map(|\u0026x| x)\n            .ok_or(MathError::NotEnoughPoints)\n    })\n}\n\nfn weights\u003cF\u003e(quantity: \u0026[F], prices: \u0026[F]) -\u003e MathResult\u003cVec\u003cF\u003e\u003e\nwhere\n    F: Fixed,\n{\n    let products =\n        mul(quantity.iter().copied(), prices.iter().copied()).collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()?;\n    let sum_product = sum(products.iter().copied().map(Ok))?;\n\n    products\n        .iter()\n        .copied()\n        .map(|x| x.checked_div(sum_product).ok_or(MathError::DivisionByZero))\n        .collect()\n}\n\nfn portfolio_vol\u003cF\u003e(weights: \u0026[F], cov: \u0026[F]) -\u003e MathResult\u003cF\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    let n = weights.len();\n    ensure!(cov.len() == n * n, MathError::InvalidArgument);\n\n    let matrix_1xn = cov\n        .chunks(n)\n        .map(|cov_row| sum(mul(weights.iter().copied(), cov_row.iter().copied())))\n        .collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()?;\n\n    let matrix_1x1 = sum(mul(matrix_1xn.into_iter(), weights.iter().copied()))?;\n\n    sqrt(matrix_1x1).map_err(|_| MathError::Transcendental)\n}\n\nimpl From\u003cPricePeriodError\u003e for MathError {\n    fn from(error: PricePeriodError) -\u003e Self {\n        match error {\n            PricePeriodError::DivisionByZero =\u003e MathError::DivisionByZero,\n            PricePeriodError::Overflow =\u003e MathError::Overflow,\n        }\n    }\n}\n\nimpl\u003cT: Trait\u003e From\u003cMathError\u003e for Error\u003cT\u003e {\n    fn from(error: MathError) -\u003e Self {\n        match error {\n            MathError::NotEnoughPoints =\u003e Error::\u003cT\u003e::NotEnoughPoints,\n            MathError::Overflow =\u003e Error::\u003cT\u003e::Overflow,\n            MathError::DivisionByZero =\u003e Error::\u003cT\u003e::DivisionByZero,\n            MathError::Transcendental =\u003e Error::\u003cT\u003e::Transcendental,\n            MathError::InvalidArgument =\u003e Error::\u003cT\u003e::InvalidArgument,\n        }\n    }\n}\n\n/// Calculates price period range for a given `items_length` periods elapsed number\n/// up to `latest_timestamp`.\nfn get_period_id_range(\n    price_period: \u0026PricePeriod,\n    items_length: usize,\n    latest_timestamp: Duration,\n) -\u003e MathResult\u003cRange\u003cu64\u003e\u003e {\n    let last_period_id = price_period.get_period_id(latest_timestamp)?;\n    let next_after_last_period_id = last_period_id.checked_add(1).ok_or(MathError::Overflow)?;\n    let items_length: u64 = items_length.try_into().map_err(|_| MathError::Overflow)?;\n    let first_period_id = next_after_last_period_id\n        .checked_sub(items_length)\n        .ok_or(MathError::Overflow)?;\n\n    Ok(Range {\n        start: first_period_id,\n        end: next_after_last_period_id,\n    })\n}\n\nfn get_range_intersection2\u003cT\u003e(range1: \u0026Range\u003cT\u003e, range2: \u0026Range\u003cT\u003e) -\u003e Range\u003cT\u003e\nwhere\n    T: Ord + Copy,\n{\n    let start = max(range1.start, range2.start);\n    let end = min(range1.end, range2.end);\n\n    Range { start, end }\n}\n\nfn get_range_intersection\u003c'a, T, I\u003e(mut ranges: I) -\u003e MathResult\u003cRange\u003cT\u003e\u003e\nwhere\n    T: 'a + Ord + Copy,\n    I: Iterator\u003cItem = \u0026'a Range\u003cT\u003e\u003e,\n{\n    let intersection = ranges.try_fold::\u003cOption\u003cRange\u003cT\u003e\u003e, _, Option\u003c_\u003e\u003e(None, |acc, r| {\n        if let Some(i) = acc {\n            let new_intersection = get_range_intersection2(\u0026i, r);\n            if new_intersection.is_empty() {\n                None\n            } else {\n                Some(Some(new_intersection))\n            }\n        } else {\n            Some(Some(r.clone()))\n        }\n    });\n\n    intersection\n        .and_then(|i| i)\n        .ok_or(MathError::NotEnoughPoints)\n}\n\n/// Calculates price log indices for the subrange `intersection` of the price period range `range`.\n/// Price log contains only prices within range `range`.\nfn get_index_range(range: \u0026Range\u003cu64\u003e, intersection: \u0026Range\u003cu64\u003e) -\u003e MathResult\u003cRange\u003cusize\u003e\u003e {\n    if intersection.is_empty() {\n        Ok(Range { start: 0, end: 0 })\n    } else {\n        ensure!(\n            range.start \u003c= intersection.start \u0026\u0026 range.end \u003e= intersection.end,\n            MathError::InvalidArgument\n        );\n        let offset = range.start;\n        let start = intersection.start - offset;\n        let end = intersection.end - offset;\n\n        let start: usize = start.try_into().map_err(|_| MathError::Overflow)?;\n        let end: usize = end.try_into().map_err(|_| MathError::Overflow)?;\n        Ok(Range { start, end })\n    }\n}\n\n/// Gets prices for two given assets `asset1` and `asset2` only for those price periods that\n/// are present in both price logs.\n/// Returns tuple which contains respectively prices from the log for `asset1`, prices from the log\n/// to `asset2`, a time range which is common for both `asset1` and `asset2` price logs.\nfn get_prices_for_common_periods\u003cT: Trait\u003e(\n    asset1: T::Asset,\n    asset2: T::Asset,\n) -\u003e MathResult\u003c(Vec\u003cT::FixedNumber\u003e, Vec\u003cT::FixedNumber\u003e, Range\u003cDuration\u003e)\u003e {\n    let price_period = PricePeriod(T::PricePeriod::get());\n\n    let log1 = PriceLogs::\u003cT\u003e::get(asset1).ok_or(MathError::NotEnoughPoints)?;\n    let period_id_range1 =\n        get_period_id_range(\u0026price_period, log1.prices.len(), log1.latest_timestamp)?;\n\n    let log2 = PriceLogs::\u003cT\u003e::get(asset2).ok_or(MathError::NotEnoughPoints)?;\n    let period_id_range2 =\n        get_period_id_range(\u0026price_period, log2.prices.len(), log2.latest_timestamp)?;\n\n    let intersection = get_range_intersection2(\u0026period_id_range1, \u0026period_id_range2);\n\n    let index_range1 = get_index_range(\u0026period_id_range1, \u0026intersection)?;\n    let prices1: Vec\u003c_\u003e = log1.prices.iter_range(\u0026index_range1).copied().collect();\n\n    let index_range2 = get_index_range(\u0026period_id_range2, \u0026intersection)?;\n    let prices2: Vec\u003c_\u003e = log2.prices.iter_range(\u0026index_range2).copied().collect();\n    let temporal_range = Range {\n        start: price_period.get_period_id_start(intersection.start)?,\n        end: price_period.get_period_id_start(intersection.end)?,\n    };\n\n    Ok((prices1, prices2, temporal_range))\n}\n\nimpl\u003cT: Trait\u003e Financial for Module\u003cT\u003e {\n    type Asset = T::Asset;\n    type Price = T::Price;\n    type AccountId = \u003cT as frame_system::Trait\u003e::AccountId;\n\n    fn calc_return(\n        return_type: CalcReturnType,\n        asset: T::Asset,\n    ) -\u003e Result\u003cVec\u003cT::Price\u003e, DispatchError\u003e {\n        let log = PriceLogs::\u003cT\u003e::get(asset).ok_or(Error::\u003cT\u003e::NotEnoughPoints)?;\n        let prices: Vec\u003c_\u003e = log.prices.iter().cloned().collect();\n\n        let ret =\n            Ret::\u003cT::FixedNumber\u003e::new(\u0026prices, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n        let result: Vec\u003cT::Price\u003e = ret.ret.into_iter().map(|x| x.into()).collect();\n\n        if result.len() == 0 {\n            Err(Error::\u003cT\u003e::NotEnoughPoints.into())\n        } else {\n            Ok(result)\n        }\n    }\n\n    fn calc_vol(\n        return_type: CalcReturnType,\n        volatility_type: CalcVolatilityType,\n        asset: T::Asset,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e {\n        let log = PriceLogs::\u003cT\u003e::get(asset).ok_or(Error::\u003cT\u003e::NotEnoughPoints)?;\n        let prices: Vec\u003c_\u003e = log.prices.iter().cloned().collect();\n\n        let returns =\n            Ret::\u003cT::FixedNumber\u003e::new(\u0026prices, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n        let result = Vol::\u003cT::FixedNumber\u003e::new(\u0026returns, volatility_type)\n            .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        Ok(result.vol.into())\n    }\n\n    fn calc_corr(\n        return_type: CalcReturnType,\n        correlation_type: CalcVolatilityType,\n        asset1: T::Asset,\n        asset2: T::Asset,\n    ) -\u003e Result\u003c(Self::Price, Range\u003cDuration\u003e), DispatchError\u003e {\n        // We should only use those points for which price periods are present in both price logs\n        let (prices1, prices2, temporal_range) =\n            get_prices_for_common_periods::\u003cT\u003e(asset1, asset2).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let ret1 =\n            Ret::\u003cT::FixedNumber\u003e::new(\u0026prices1, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n        let vol1 =\n            Vol::\u003cT::FixedNumber\u003e::new(\u0026ret1, correlation_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let ret2 =\n            Ret::\u003cT::FixedNumber\u003e::new(\u0026prices2, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n        let vol2 =\n            Vol::\u003cT::FixedNumber\u003e::new(\u0026ret2, correlation_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let corre = cor(\u0026ret1, \u0026vol1, \u0026ret2, \u0026vol2).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        Ok((corre.into(), temporal_range))\n    }\n\n    fn calc_portf_vol(\n        return_type: CalcReturnType,\n        vol_cor_type: CalcVolatilityType,\n        account_id: Self::AccountId,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e {\n        let price_period = PricePeriod(T::PricePeriod::get());\n\n        let mut asset_logs: Vec\u003c_\u003e = PriceLogs::\u003cT\u003e::iter().collect();\n        ensure!(asset_logs.len() \u003e 0, Error::\u003cT\u003e::NotEnoughPoints);\n        asset_logs.sort_by(|(a1, _), (a2, _)| a1.cmp(a2));\n\n        let metrics = financial_metrics::\u003cT::Asset, T::FixedNumber, T::FixedNumber\u003e(\n            return_type,\n            vol_cor_type,\n            \u0026price_period,\n            \u0026asset_logs,\n        )\n        .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let prices = latest_prices::\u003cT::Asset, T::FixedNumber\u003e(\u0026asset_logs)\n            .collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()\n            .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let balances = T::Balances::balances(\u0026account_id, \u0026metrics.assets)?\n            .into_iter()\n            .map(|x| x.into())\n            .collect::\u003cVec\u003c_\u003e\u003e();\n\n        let ws = weights(\u0026balances, \u0026prices).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let vol = portfolio_vol(\u0026ws, \u0026metrics.covariances).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        Ok(vol.into())\n    }\n\n    fn calc_portf_var(\n        return_type: CalcReturnType,\n        vol_cor_type: CalcVolatilityType,\n        account_id: Self::AccountId,\n        z_score: u32,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e {\n        let price_period = PricePeriod(T::PricePeriod::get());\n\n        let mut asset_logs: Vec\u003c_\u003e = PriceLogs::\u003cT\u003e::iter().collect();\n        ensure!(asset_logs.len() \u003e 0, Error::\u003cT\u003e::NotEnoughPoints);\n        asset_logs.sort_by(|(a1, _), (a2, _)| a1.cmp(a2));\n\n        let metrics = financial_metrics::\u003cT::Asset, T::FixedNumber, T::FixedNumber\u003e(\n            return_type,\n            vol_cor_type,\n            \u0026price_period,\n            \u0026asset_logs,\n        )\n        .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let prices = latest_prices::\u003cT::Asset, T::FixedNumber\u003e(\u0026asset_logs)\n            .collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()\n            .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let balances = T::Balances::balances(\u0026account_id, \u0026metrics.assets)?\n            .into_iter()\n            .map(|x| x.into())\n            .collect::\u003cVec\u003c_\u003e\u003e();\n\n        let ws = weights(\u0026balances, \u0026prices).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let vol = portfolio_vol(\u0026ws, \u0026metrics.covariances).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n        let total_weighted_mean_return = sum(mul(ws.into_iter(), metrics.mean_returns.into_iter()))\n            .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        match return_type {\n            CalcReturnType::Regular =\u003e {\n                let portf_var = regular_value_at_risk(z_score, vol, total_weighted_mean_return)\n                    .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n                Ok(portf_var.into())\n            }\n            CalcReturnType::Log =\u003e {\n                let portf_var = log_value_at_risk(z_score, vol, total_weighted_mean_return)\n                    .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n                Ok(portf_var.into())\n            }\n        }\n    }\n}\n","traces":[{"line":117,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":190,"address":[4615644,4617392,4617312,4617632,4617504,4615584,4615632,4617136,4617424,4617520,4617185,4615680,4617216,4615697,4617404,4617319,4617527,4617612,4617600,4615596,4617296],"length":1,"stats":{"Line":38},"fn_name":"updates\u003cfinancial_pallet::mock::Test,financial_pallet::mock::Asset\u003e"},{"line":209,"address":[4615828,4617148,4615744],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Test\u003e"},{"line":210,"address":[4615767],"length":1,"stats":{"Line":2},"fn_name":null},{"line":212,"address":[4615786],"length":1,"stats":{"Line":2},"fn_name":null},{"line":214,"address":[4615807],"length":1,"stats":{"Line":2},"fn_name":null},{"line":215,"address":[4615899,4615850],"length":1,"stats":{"Line":2},"fn_name":null},{"line":217,"address":[4615868],"length":1,"stats":{"Line":2},"fn_name":null},{"line":218,"address":[4616090,4616152],"length":1,"stats":{"Line":2},"fn_name":null},{"line":222,"address":[4616352,4616116,4616490,4617067],"length":1,"stats":{"Line":6},"fn_name":null},{"line":223,"address":[4616559],"length":1,"stats":{"Line":2},"fn_name":null},{"line":225,"address":[4616661,4616607],"length":1,"stats":{"Line":2},"fn_name":null},{"line":227,"address":[4616950,4616644,4616704,4617054],"length":1,"stats":{"Line":6},"fn_name":null},{"line":228,"address":[4616984],"length":1,"stats":{"Line":2},"fn_name":null},{"line":231,"address":[4616883],"length":1,"stats":{"Line":2},"fn_name":null},{"line":232,"address":[4616837],"length":1,"stats":{"Line":2},"fn_name":null},{"line":233,"address":[4616843],"length":1,"stats":{"Line":2},"fn_name":null},{"line":240,"address":[5101038],"length":1,"stats":{"Line":0},"fn_name":null},{"line":246,"address":[5112384,5112080,5111789],"length":1,"stats":{"Line":0},"fn_name":null},{"line":288,"address":[5074086],"length":1,"stats":{"Line":0},"fn_name":null},{"line":289,"address":[5074150],"length":1,"stats":{"Line":0},"fn_name":null},{"line":292,"address":[5116002,5116687,5116717],"length":1,"stats":{"Line":0},"fn_name":null},{"line":294,"address":[5080986,5081216,5080877,5081009],"length":1,"stats":{"Line":0},"fn_name":null},{"line":296,"address":[5081265,5088576,5088580,5081472],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":297,"address":[5088356,5088352,5081713,5081457,5081538],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":299,"address":[5081706],"length":1,"stats":{"Line":0},"fn_name":null},{"line":301,"address":[5081779],"length":1,"stats":{"Line":0},"fn_name":null},{"line":302,"address":[5081833,5081922,5082042],"length":1,"stats":{"Line":0},"fn_name":null},{"line":303,"address":[5082063,5081899,5088403,5088384],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":305,"address":[5082070],"length":1,"stats":{"Line":0},"fn_name":null},{"line":306,"address":[5088465,5088448,5082106,5082411],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":309,"address":[5082511,5082785,5082388,5082709],"length":1,"stats":{"Line":0},"fn_name":null},{"line":311,"address":[5088192,5088211,5082806,5082686,5083244],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":312,"address":[5083324,5083170,5083459],"length":1,"stats":{"Line":0},"fn_name":null},{"line":313,"address":[5083429,5083541],"length":1,"stats":{"Line":0},"fn_name":null},{"line":315,"address":[5083957,5083579,5083680,5083875],"length":1,"stats":{"Line":0},"fn_name":null},{"line":316,"address":[5083997,5084366,5084274,5083868],"length":1,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[5084251,5084405,5084760,5086496],"length":1,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[5084849,5085070,5086494],"length":1,"stats":{"Line":0},"fn_name":null},{"line":321,"address":[5084940],"length":1,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[5084894,5085223,5085091,5085301],"length":1,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[5085193,5085322],"length":1,"stats":{"Line":0},"fn_name":null},{"line":326,"address":[5085449,5085360,5085636,5085712],"length":1,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[5085629,5086044,5085751,5086120],"length":1,"stats":{"Line":0},"fn_name":null},{"line":329,"address":[5086037,5086159,5086295,5086369],"length":1,"stats":{"Line":0},"fn_name":null},{"line":331,"address":[5086378,5086264],"length":1,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[5086869],"length":1,"stats":{"Line":0},"fn_name":null},{"line":336,"address":[5086677,5084722,5086517],"length":1,"stats":{"Line":0},"fn_name":null},{"line":337,"address":[5086619,5086759,5086969],"length":1,"stats":{"Line":0},"fn_name":null},{"line":340,"address":[5088147,5088128,5086903,5087049],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":341,"address":[5087087],"length":1,"stats":{"Line":0},"fn_name":null},{"line":343,"address":[5087255],"length":1,"stats":{"Line":0},"fn_name":null},{"line":344,"address":[5087144],"length":1,"stats":{"Line":0},"fn_name":null},{"line":345,"address":[5087159],"length":1,"stats":{"Line":0},"fn_name":null},{"line":346,"address":[5087175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":348,"address":[5087215],"length":1,"stats":{"Line":0},"fn_name":null},{"line":352,"address":[5087389],"length":1,"stats":{"Line":0},"fn_name":null},{"line":354,"address":[5087426],"length":1,"stats":{"Line":0},"fn_name":null},{"line":358,"address":[5116657,5116324],"length":1,"stats":{"Line":0},"fn_name":null},{"line":360,"address":[5091021,5090912,5091251,5091044],"length":1,"stats":{"Line":0},"fn_name":null},{"line":362,"address":[5091300,5091507,5092848,5092852],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":363,"address":[5091573,5091492,5091744,5092816,5092820],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":365,"address":[5091733,5091814],"length":1,"stats":{"Line":0},"fn_name":null},{"line":367,"address":[5091829],"length":1,"stats":{"Line":0},"fn_name":null},{"line":368,"address":[5092033,5091867,5091944],"length":1,"stats":{"Line":0},"fn_name":null},{"line":369,"address":[5092880,5092899,5092048,5091927],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":371,"address":[5092394,5092063,5092461],"length":1,"stats":{"Line":0},"fn_name":null},{"line":373,"address":[5092330],"length":1,"stats":{"Line":0},"fn_name":null},{"line":375,"address":[5092485],"length":1,"stats":{"Line":0},"fn_name":null},{"line":377,"address":[5092516],"length":1,"stats":{"Line":0},"fn_name":null},{"line":387,"address":[4576637,4576544,4577172,4577056],"length":1,"stats":{"Line":3},"fn_name":"get_new_prices\u003cu32\u003e"},{"line":395,"address":[4577108,4577346,4577277,4576742,4576811,4576580],"length":1,"stats":{"Line":12},"fn_name":null},{"line":397,"address":[4576660,4577134,4576606,4576685,4576763,4577266,4576731,4577195,4577220,4577298],"length":1,"stats":{"Line":13},"fn_name":null},{"line":399,"address":[4576716,4577251,4577300,4577325,4576765,4576790],"length":1,"stats":{"Line":5},"fn_name":null},{"line":403,"address":[4577368,4576833],"length":1,"stats":{"Line":6},"fn_name":null},{"line":405,"address":[4577413,4576869],"length":1,"stats":{"Line":3},"fn_name":null},{"line":407,"address":[4576897,4577446],"length":1,"stats":{"Line":6},"fn_name":null},{"line":411,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":412,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":413,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":439,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":440,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":441,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":442,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":449,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":450,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":451,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":452,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":453,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":460,"address":[5506624],"length":1,"stats":{"Line":2},"fn_name":"get_curr_period_info"},{"line":465,"address":[5506673,5506867,5506809],"length":1,"stats":{"Line":2},"fn_name":null},{"line":466,"address":[5506774,5506889,5506979],"length":1,"stats":{"Line":4},"fn_name":null},{"line":468,"address":[5506964,5507058,5507188,5507143],"length":1,"stats":{"Line":6},"fn_name":null},{"line":470,"address":[4577732,4577728],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":471,"address":[5507173,5507267,5507352,5507394],"length":1,"stats":{"Line":6},"fn_name":null},{"line":473,"address":[4577764,4577760],"length":1,"stats":{"Line":5},"fn_name":"{{closure}}"},{"line":474,"address":[5507463,5507373],"length":1,"stats":{"Line":4},"fn_name":null},{"line":476,"address":[5507520,5507861],"length":1,"stats":{"Line":2},"fn_name":null},{"line":480,"address":[5507936],"length":1,"stats":{"Line":2},"fn_name":"get_period_change"},{"line":485,"address":[5508203,5507970],"length":1,"stats":{"Line":4},"fn_name":null},{"line":486,"address":[5508210,5508124],"length":1,"stats":{"Line":3},"fn_name":null},{"line":487,"address":[5508132,5508191,5508043],"length":1,"stats":{"Line":3},"fn_name":null},{"line":488,"address":[5508205],"length":1,"stats":{"Line":1},"fn_name":null},{"line":492,"address":[5508558,5509179,5508342],"length":1,"stats":{"Line":4},"fn_name":null},{"line":494,"address":[5508246],"length":1,"stats":{"Line":2},"fn_name":null},{"line":495,"address":[5508344,5508563],"length":1,"stats":{"Line":2},"fn_name":null},{"line":497,"address":[5508471],"length":1,"stats":{"Line":2},"fn_name":null},{"line":499,"address":[5508449],"length":1,"stats":{"Line":2},"fn_name":null},{"line":502,"address":[5508261],"length":1,"stats":{"Line":2},"fn_name":null},{"line":503,"address":[5508759],"length":1,"stats":{"Line":2},"fn_name":null},{"line":506,"address":[5509177,5508803,5508914],"length":1,"stats":{"Line":5},"fn_name":null},{"line":509,"address":[5508894],"length":1,"stats":{"Line":1},"fn_name":null},{"line":510,"address":[5508887,5509050],"length":1,"stats":{"Line":3},"fn_name":null},{"line":513,"address":[5508958],"length":1,"stats":{"Line":1},"fn_name":null},{"line":515,"address":[5508942],"length":1,"stats":{"Line":1},"fn_name":null},{"line":520,"address":[5509184,5509214,5509055,5508923],"length":1,"stats":{"Line":4},"fn_name":null},{"line":522,"address":[5509085],"length":1,"stats":{"Line":2},"fn_name":null},{"line":524,"address":[5509062],"length":1,"stats":{"Line":2},"fn_name":null},{"line":535,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":536,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":537,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":538,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":540,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":541,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":544,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":545,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":546,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":547,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":551,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":552,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":553,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":554,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":556,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":560,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":561,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":563,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":564,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":565,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":566,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":567,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":571,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":572,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":573,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":578,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":579,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":582,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":584,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":585,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":587,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":588,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":591,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":593,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":594,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":603,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":604,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":605,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":606,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":607,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":610,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":614,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":672,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":673,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":675,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":676,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":677,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":678,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":697,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":701,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":703,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":704,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":705,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":707,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":708,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":709,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":710,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":712,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":713,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":714,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":715,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":716,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":717,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":720,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":721,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":722,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":723,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":725,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":726,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":727,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":728,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":729,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":730,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":737,"address":[4584032],"length":1,"stats":{"Line":6},"fn_name":"cor\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":747,"address":[4584085],"length":1,"stats":{"Line":6},"fn_name":null},{"line":749,"address":[4584512,4586500,4584390,4585479,4584133,4584291],"length":1,"stats":{"Line":13},"fn_name":null},{"line":750,"address":[4584165,4584349],"length":1,"stats":{"Line":7},"fn_name":null},{"line":751,"address":[4584395],"length":1,"stats":{"Line":6},"fn_name":null},{"line":754,"address":[4584517],"length":1,"stats":{"Line":4},"fn_name":null},{"line":755,"address":[4584575],"length":1,"stats":{"Line":2},"fn_name":null},{"line":756,"address":[4584600],"length":1,"stats":{"Line":2},"fn_name":null},{"line":760,"address":[4584236],"length":1,"stats":{"Line":2},"fn_name":null},{"line":761,"address":[4584626],"length":1,"stats":{"Line":2},"fn_name":null},{"line":762,"address":[4584652],"length":1,"stats":{"Line":2},"fn_name":null},{"line":766,"address":[4584678],"length":1,"stats":{"Line":2},"fn_name":null},{"line":768,"address":[4584948,4585213,4585149],"length":1,"stats":{"Line":5},"fn_name":null},{"line":769,"address":[4585108,4585235],"length":1,"stats":{"Line":4},"fn_name":null},{"line":770,"address":[4585303,4585484],"length":1,"stats":{"Line":2},"fn_name":null},{"line":771,"address":[4585468],"length":1,"stats":{"Line":3},"fn_name":null},{"line":775,"address":[4585707],"length":1,"stats":{"Line":2},"fn_name":null},{"line":776,"address":[4585543],"length":1,"stats":{"Line":2},"fn_name":null},{"line":777,"address":[4585754,4584296],"length":1,"stats":{"Line":4},"fn_name":null},{"line":778,"address":[4585584],"length":1,"stats":{"Line":2},"fn_name":null},{"line":782,"address":[4585803,4584314],"length":1,"stats":{"Line":4},"fn_name":null},{"line":783,"address":[4585625],"length":1,"stats":{"Line":2},"fn_name":null},{"line":784,"address":[4585666],"length":1,"stats":{"Line":2},"fn_name":null},{"line":787,"address":[4585915,4585852],"length":1,"stats":{"Line":2},"fn_name":null},{"line":788,"address":[4585884,4585936],"length":1,"stats":{"Line":4},"fn_name":null},{"line":790,"address":[4586082],"length":1,"stats":{"Line":2},"fn_name":null},{"line":791,"address":[4586338,4586113],"length":1,"stats":{"Line":2},"fn_name":null},{"line":792,"address":[4586502,4586271,4586393],"length":1,"stats":{"Line":4},"fn_name":null},{"line":793,"address":[4586489],"length":1,"stats":{"Line":2},"fn_name":null},{"line":795,"address":[4584262],"length":1,"stats":{"Line":0},"fn_name":null},{"line":799,"address":[4586560,4586736],"length":1,"stats":{"Line":1},"fn_name":"financial_metrics\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":811,"address":[4586866,4586759,4586637,4586805],"length":1,"stats":{"Line":3},"fn_name":null},{"line":813,"address":[4586790,4586874],"length":1,"stats":{"Line":4},"fn_name":null},{"line":814,"address":[4586919],"length":1,"stats":{"Line":2},"fn_name":null},{"line":815,"address":[4586981,4592978],"length":1,"stats":{"Line":2},"fn_name":null},{"line":817,"address":[4587115,4587263,4587154,4587361],"length":1,"stats":{"Line":6},"fn_name":null},{"line":819,"address":[4587146,4593376,4593393],"length":1,"stats":{"Line":6},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":823,"address":[4587736,4587813,4587335,4587553],"length":1,"stats":{"Line":4},"fn_name":null},{"line":825,"address":[4587713,4588146,4587858,4591172],"length":1,"stats":{"Line":7},"fn_name":null},{"line":826,"address":[4588251,4588416],"length":1,"stats":{"Line":2},"fn_name":null},{"line":827,"address":[4588386,4588499],"length":1,"stats":{"Line":4},"fn_name":null},{"line":829,"address":[4588802,4588537,4588638,4588879],"length":1,"stats":{"Line":4},"fn_name":null},{"line":830,"address":[4589249,4589172,4588795,4588918],"length":1,"stats":{"Line":4},"fn_name":null},{"line":832,"address":[4589141],"length":1,"stats":{"Line":2},"fn_name":null},{"line":833,"address":[4589272],"length":1,"stats":{"Line":2},"fn_name":null},{"line":835,"address":[4589319,4589654,4591137],"length":1,"stats":{"Line":4},"fn_name":null},{"line":836,"address":[4589735,4589879,4591135],"length":1,"stats":{"Line":7},"fn_name":null},{"line":838,"address":[4589825],"length":1,"stats":{"Line":2},"fn_name":null},{"line":840,"address":[4589900,4590012,4589813,4590089],"length":1,"stats":{"Line":4},"fn_name":null},{"line":841,"address":[4590110,4589982],"length":1,"stats":{"Line":4},"fn_name":null},{"line":843,"address":[4590148,4590413,4590249,4590490],"length":1,"stats":{"Line":4},"fn_name":null},{"line":844,"address":[4590799,4590876,4590406,4590529],"length":1,"stats":{"Line":4},"fn_name":null},{"line":846,"address":[4590915,4591085,4590792,4591010],"length":1,"stats":{"Line":5},"fn_name":null},{"line":848,"address":[4590997],"length":1,"stats":{"Line":3},"fn_name":null},{"line":853,"address":[4591380,4591217,4588120,4591479],"length":1,"stats":{"Line":10},"fn_name":null},{"line":854,"address":[4593564,4593504,4593552,4593518],"length":1,"stats":{"Line":12},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":858,"address":[4591556,4591690,4591444,4591764],"length":1,"stats":{"Line":6},"fn_name":null},{"line":859,"address":[4591632,4591769,4591976],"length":1,"stats":{"Line":6},"fn_name":null},{"line":862,"address":[4592532],"length":1,"stats":{"Line":4},"fn_name":null},{"line":863,"address":[4591887],"length":1,"stats":{"Line":2},"fn_name":null},{"line":864,"address":[4591902],"length":1,"stats":{"Line":4},"fn_name":null},{"line":865,"address":[4593629,4591931,4592048,4593616],"length":1,"stats":{"Line":12},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":866,"address":[4592117,4593648,4592237,4593667],"length":1,"stats":{"Line":12},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":867,"address":[4592244,4593731,4592338,4593712],"length":1,"stats":{"Line":12},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":868,"address":[4593795,4592368,4592465,4593776],"length":1,"stats":{"Line":12},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":869,"address":[4592495],"length":1,"stats":{"Line":2},"fn_name":null},{"line":873,"address":[4593840],"length":1,"stats":{"Line":1},"fn_name":"latest_prices\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":879,"address":[4593968,4593985,4593854],"length":1,"stats":{"Line":5},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":880,"address":[4593997,4594057],"length":1,"stats":{"Line":8},"fn_name":null},{"line":882,"address":[4593929,4593920],"length":1,"stats":{"Line":6},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":883,"address":[4594052],"length":1,"stats":{"Line":2},"fn_name":null},{"line":887,"address":[4594215,4594112],"length":1,"stats":{"Line":2},"fn_name":"weights\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":891,"address":[4594593,4594246,4594162,4594541],"length":1,"stats":{"Line":3},"fn_name":null},{"line":893,"address":[4594641,4594852,4594524,4594919],"length":1,"stats":{"Line":3},"fn_name":null},{"line":895,"address":[4594993,4594835,4594934],"length":1,"stats":{"Line":10},"fn_name":null},{"line":898,"address":[4595120,4595142,4594985],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":902,"address":[4595264,4595384],"length":1,"stats":{"Line":2},"fn_name":"portfolio_vol\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":907,"address":[4595306],"length":1,"stats":{"Line":1},"fn_name":null},{"line":908,"address":[4596335,4595505,4595557,4595409],"length":1,"stats":{"Line":2},"fn_name":null},{"line":910,"address":[4595475,4595581,4595679,4595814],"length":1,"stats":{"Line":10},"fn_name":null},{"line":912,"address":[4596432,4595565,4596466],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":915,"address":[4596158,4595900,4596220,4595751,4596294],"length":1,"stats":{"Line":6},"fn_name":null},{"line":917,"address":[4596130,4596656,4596660,4596248],"length":1,"stats":{"Line":6},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":921,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":922,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":923,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":924,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":930,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":931,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":932,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":933,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":934,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":935,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":936,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":943,"address":[5509216],"length":1,"stats":{"Line":2},"fn_name":"get_period_id_range"},{"line":948,"address":[5509436,5509258,5509377],"length":1,"stats":{"Line":2},"fn_name":null},{"line":949,"address":[5509352,5509579,5509448],"length":1,"stats":{"Line":5},"fn_name":null},{"line":950,"address":[4596784,4596788],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}"},{"line":951,"address":[5509956,5509723,5509803,5509874],"length":1,"stats":{"Line":6},"fn_name":null},{"line":953,"address":[5509958,5509795,5509855],"length":1,"stats":{"Line":2},"fn_name":null},{"line":955,"address":[5509898],"length":1,"stats":{"Line":2},"fn_name":null},{"line":961,"address":[4596816,4596928],"length":1,"stats":{"Line":7},"fn_name":"get_range_intersection2\u003ci32\u003e"},{"line":965,"address":[4596830,4596942],"length":1,"stats":{"Line":9},"fn_name":null},{"line":966,"address":[4596985,4596867],"length":1,"stats":{"Line":7},"fn_name":null},{"line":971,"address":[4597056,4597119,4597232,4597295],"length":1,"stats":{"Line":3},"fn_name":"get_range_intersection\u003ci32,core::slice::Iter\u003ccore::ops::range::Range\u003ci32\u003e\u003e\u003e"},{"line":976,"address":[4597424,4597252,4597076,4597728],"length":1,"stats":{"Line":6},"fn_name":"{{closure}}\u003cu64,core::slice::Iter\u003ccore::ops::range::Range\u003cu64\u003e\u003e\u003e"},{"line":977,"address":[4597802,4597920,4597450,4597506,4597647,4597745],"length":1,"stats":{"Line":9},"fn_name":null},{"line":978,"address":[4597826,4597534],"length":1,"stats":{"Line":5},"fn_name":null},{"line":979,"address":[4597633,4597549,4597839,4597907],"length":1,"stats":{"Line":9},"fn_name":null},{"line":980,"address":[4597914,4597640],"length":1,"stats":{"Line":1},"fn_name":null},{"line":982,"address":[4597863,4597573],"length":1,"stats":{"Line":4},"fn_name":null},{"line":985,"address":[4597782,4597481,4597926,4597654],"length":1,"stats":{"Line":6},"fn_name":null},{"line":989,"address":[4597131,4597310,4597173,4597360],"length":1,"stats":{"Line":6},"fn_name":null},{"line":990,"address":[4598020,4597984,4597988,4598016],"length":1,"stats":{"Line":6},"fn_name":"{{closure}}\u003ci32,core::slice::Iter\u003ccore::ops::range::Range\u003ci32\u003e\u003e\u003e"},{"line":991,"address":[4597168,4597352],"length":1,"stats":{"Line":3},"fn_name":null},{"line":996,"address":[5510016],"length":1,"stats":{"Line":7},"fn_name":"get_index_range"},{"line":997,"address":[5510047,5510154,5510719],"length":1,"stats":{"Line":17},"fn_name":null},{"line":998,"address":[5510104],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1000,"address":[5510206,5510280,5510321],"length":1,"stats":{"Line":10},"fn_name":null},{"line":1001,"address":[5510089,5510159],"length":1,"stats":{"Line":9},"fn_name":null},{"line":1002,"address":[5510272],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1004,"address":[5510224],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1005,"address":[5510334,5510776,5510240],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1006,"address":[5510347,5510836,5510806],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1008,"address":[4598048,4598052],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}"},{"line":1009,"address":[4598080,4598084],"length":1,"stats":{"Line":16},"fn_name":"{{closure}}"},{"line":1010,"address":[5510671],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1018,"address":[4598167,4598112],"length":1,"stats":{"Line":1},"fn_name":"get_prices_for_common_periods\u003cfinancial_pallet::mock::Test\u003e"},{"line":1022,"address":[4598186,4598156],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1024,"address":[4598454,4598190,4598405],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1025,"address":[4598393,4598491,4598644,4598710],"length":1,"stats":{"Line":5},"fn_name":null},{"line":1028,"address":[4598626,4598715,4598917],"length":1,"stats":{"Line":4},"fn_name":null},{"line":1029,"address":[4599223,4598905,4598991,4599155],"length":1,"stats":{"Line":5},"fn_name":null},{"line":1032,"address":[4599138,4599233],"length":1,"stats":{"Line":10},"fn_name":null},{"line":1034,"address":[4599406,4599278],"length":1,"stats":{"Line":7},"fn_name":null},{"line":1035,"address":[4599480,4599375],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1037,"address":[4599582,4599680,4599534,4599748],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1038,"address":[4599649,4599769],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1040,"address":[4600051,4599980,4599876,4599799],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1041,"address":[4600449,4599925,4600056],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1044,"address":[4600174],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1052,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1056,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1057,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1059,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1060,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1061,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1063,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1064,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1066,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1070,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1075,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1076,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1078,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1079,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1080,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1081,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1083,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1086,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1093,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":1094,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1096,"address":[],"length":0,"stats":{"Line":18},"fn_name":null},{"line":1097,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1098,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":1099,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1101,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":1102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1103,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":1104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1106,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":1108,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1111,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1116,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1118,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1119,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1120,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1123,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1124,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1125,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1126,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1128,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1130,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1132,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1134,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1136,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1139,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1141,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1143,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1146,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1152,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1154,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1155,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1156,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1159,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1160,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1161,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1162,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1164,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1166,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":1168,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1170,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":1172,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1175,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1177,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1178,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":1179,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1181,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1182,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1183,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1184,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1185,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1187,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1188,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1189,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1190,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":307,"coverable":407},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","financial","src","math.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nuse core::ops::{AddAssign, BitOrAssign, ShlAssign};\nuse financial_primitives::CalcReturnType;\nuse substrate_fixed::traits::{Fixed, FixedSigned, ToFixed};\nuse substrate_fixed::transcendental::{exp, ln};\nuse substrate_fixed::types::I9F23;\n\n// Type of constants for transcendental operations declared in substrate_fixed crate\npub type ConstType = I9F23;\n\n#[derive(Debug, Eq, PartialEq, Clone, Copy)]\npub enum MathError {\n    Overflow,\n    DivisionByZero,\n    Transcendental,\n    NotEnoughPoints,\n    InvalidArgument,\n}\n\npub type MathResult\u003cT\u003e = Result\u003cT, MathError\u003e;\n\n/// Indicates the method for calculating correlations: `Regular` or `Exponential`.\n///\n/// * `Regular` type is a standard statistical approach of calculating Pearson correlation coefficient between\n/// two return series;\n/// * `Exponential` type uses exponentially weighted moving average\n/// to give more weights to most recent observations of pair of returns.\n///\n/// Note: correlations on lower periods are more susceptible to data noise and reflect actual\n/// dependencies between returns poorly. For robustness we recommend to use daily or weekly periods\n/// for correlations.\n#[derive(Copy, Clone)]\npub enum CalcCorrelationType {\n    /// Regular correlation type.\n    Regular,\n    /// Exponentially weighted correlation type.\n    Exponential(u32),\n}\n\npub fn calc_return\u003cF: Fixed\u003e(x1: F, x2: F) -\u003e Result\u003cF, MathError\u003e {\n    let ratio = x2.checked_div(x1).ok_or(MathError::DivisionByZero)?;\n\n    ratio.checked_sub(F::from_num(1)).ok_or(MathError::Overflow)\n}\n\npub fn calc_log_return\u003cF\u003e(x1: F, x2: F) -\u003e Result\u003cF, MathError\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    let ratio = x2.checked_div(x1).ok_or(MathError::DivisionByZero)?;\n    ln(ratio).map_err(|_| MathError::Transcendental)\n}\n\npub fn calc_return_func\u003cF\u003e(return_type: CalcReturnType) -\u003e impl Fn(F, F) -\u003e MathResult\u003cF\u003e + Copy\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    match return_type {\n        CalcReturnType::Regular =\u003e calc_return,\n        CalcReturnType::Log =\u003e calc_log_return,\n    }\n}\n\npub fn calc_return_iter\u003c'a, T: Copy, F: 'a + Fn(T, T) -\u003e MathResult\u003cT\u003e\u003e(\n    items: \u0026'a [T],\n    return_func: F,\n) -\u003e impl Iterator\u003cItem = MathResult\u003cT\u003e\u003e + 'a {\n    items.windows(2).map(move |x| return_func(x[0], x[1]))\n}\n\npub fn decay\u003cF: Fixed\u003e(ewma_length: u32) -\u003e MathResult\u003cF\u003e {\n    let nom = F::from_num(2);\n    let denom = F::from_num(1)\n        .checked_add(F::from_num(ewma_length))\n        .ok_or(MathError::Overflow)?;\n\n    nom.checked_div(denom).ok_or(MathError::DivisionByZero)\n}\n\nfn recurrent_ewma_step\u003cF: Fixed\u003e(\n    diff: MathResult\u003cF\u003e,\n    decay: F,\n    prev_var: MathResult\u003cF\u003e,\n) -\u003e MathResult\u003cF\u003e {\n    let diff = diff?;\n    let prev_var = prev_var?;\n\n    let a = diff.checked_mul(decay).ok_or(MathError::Overflow)?;\n    let b = F::from_num(1)\n        .checked_sub(decay)\n        .ok_or(MathError::Overflow)?;\n    let c = b.checked_mul(prev_var).ok_or(MathError::Overflow)?;\n\n    a.checked_add(c).ok_or(MathError::Overflow)\n}\n\npub fn last_recurrent_ewma\u003cF: Fixed, I: Iterator\u003cItem = MathResult\u003cF\u003e\u003e\u003e(\n    diffs: I,\n    decay: F,\n) -\u003e MathResult\u003cF\u003e {\n    diffs\n        .fold(None, move |state, diff| {\n            if let Some(prev_var) = state {\n                let var = recurrent_ewma_step(diff, decay, prev_var);\n                Some(var)\n            } else {\n                Some(diff)\n            }\n        })\n        .ok_or(MathError::NotEnoughPoints)\n        .and_then(|x| x)\n}\n\npub fn sum\u003c'a, F: 'a + Fixed, I: 'a + Iterator\u003cItem = MathResult\u003cF\u003e\u003e\u003e(\n    mut iter: I,\n) -\u003e MathResult\u003cF\u003e {\n    Ok(iter.try_fold(F::from_num(0), |acc, x| {\n        let x = x?;\n        acc.checked_add(x).ok_or(MathError::Overflow)\n    })?)\n}\n\npub fn mean\u003cF: Fixed\u003e(items: \u0026[F]) -\u003e MathResult\u003cF\u003e {\n    let sum = sum(items.iter().map(|\u0026x| Ok(x)))?;\n    sum.checked_div(F::from_num(items.len()))\n        .ok_or(MathError::DivisionByZero)\n}\n\npub fn demeaned\u003c'a, F: 'a + Fixed, I: 'a + Iterator\u003cItem = \u0026'a F\u003e\u003e(\n    iter: I,\n    mean: F,\n) -\u003e impl Iterator\u003cItem = MathResult\u003cF\u003e\u003e + 'a {\n    iter.map(move |\u0026x| x.checked_sub(mean).ok_or(MathError::Overflow))\n}\n\npub fn squared\u003c'a, F: 'a + Fixed, I: 'a + Iterator\u003cItem = MathResult\u003cF\u003e\u003e\u003e(\n    iter: I,\n) -\u003e impl Iterator\u003cItem = MathResult\u003cF\u003e\u003e + 'a {\n    iter.map(|x| x.and_then(|y| y.checked_mul(y).ok_or(MathError::Overflow)))\n}\n\npub fn regular_vola\u003cF: Fixed\u003e(n: usize, sum: F) -\u003e MathResult\u003cF\u003e {\n    let a = n.checked_sub(1).ok_or(MathError::Overflow)?;\n    let b = F::from_num(1)\n        .checked_div(F::from_num(a))\n        .ok_or(MathError::DivisionByZero)?;\n    let c = b.checked_mul(sum).ok_or(MathError::Overflow)?;\n    Ok(c)\n}\n\npub fn mul\u003c'a, F, I1, I2\u003e(iter1: I1, iter2: I2) -\u003e impl Iterator\u003cItem = MathResult\u003cF\u003e\u003e + 'a\nwhere\n    F: 'a + Fixed,\n    I1: 'a + Iterator\u003cItem = F\u003e,\n    I2: 'a + Iterator\u003cItem = F\u003e,\n{\n    iter1\n        .zip(iter2)\n        .map(|(x1, x2)| x1.checked_mul(x2).ok_or(MathError::Overflow))\n}\n\npub fn regular_corr\u003cF: Fixed\u003e(n: usize, sum: F, vol1: F, vol2: F) -\u003e MathResult\u003cF\u003e {\n    let a = n.checked_sub(1).ok_or(MathError::Overflow)?;\n    let b = F::from_num(1)\n        .checked_div(F::from_num(a))\n        .ok_or(MathError::DivisionByZero)?;\n    let c = b.checked_mul(sum).ok_or(MathError::Overflow)?;\n    let d = c.checked_div(vol1).ok_or(MathError::DivisionByZero)?;\n    let e = d.checked_div(vol2).ok_or(MathError::DivisionByZero)?;\n    Ok(e)\n}\n\npub fn exp_corr\u003cF: Fixed\u003e(covariance: F, vol1: F, vol2: F) -\u003e MathResult\u003cF\u003e {\n    let d = covariance\n        .checked_div(vol1)\n        .ok_or(MathError::DivisionByZero)?;\n    let e = d.checked_div(vol2).ok_or(MathError::DivisionByZero)?;\n    Ok(e)\n}\n\npub fn from_num\u003cF: Fixed\u003e(n: i8) -\u003e F {\n    F::from_num(n)\n}\n\npub fn covariance\u003c'a, F\u003e(\n    correlation_matrix: \u0026'a [F],\n    volatilities: \u0026'a [F],\n) -\u003e impl Iterator\u003cItem = MathResult\u003cF\u003e\u003e + 'a\nwhere\n    F: Fixed,\n{\n    volatilities\n        .iter()\n        .copied()\n        .flat_map(move |v1| volatilities.iter().map(move |v2| (v1, v2)))\n        .zip(correlation_matrix.iter())\n        .map(|((v1, \u0026v2), \u0026c)| {\n            v1.checked_mul(v2)\n                .and_then(|v1v2| v1v2.checked_mul(c))\n                .ok_or(MathError::Overflow)\n        })\n}\n\npub fn regular_value_at_risk\u003cF\u003e(\n    z_score: u32,\n    portfolio_volatility: F,\n    total_weighted_mean_return: F,\n) -\u003e MathResult\u003cF\u003e\nwhere\n    F: Fixed,\n{\n    let a = portfolio_volatility\n        .checked_mul(F::from_num(z_score))\n        .ok_or(MathError::Overflow)?;\n    a.checked_sub(total_weighted_mean_return)\n        .ok_or(MathError::Overflow)\n}\n\npub fn log_value_at_risk\u003cF\u003e(\n    z_score: u32,\n    portfolio_volatility: F,\n    total_weighted_mean_return: F,\n) -\u003e MathResult\u003cF\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    let a = portfolio_volatility\n        .checked_mul(F::from_num(z_score))\n        .ok_or(MathError::Overflow)?;\n    let b = total_weighted_mean_return\n        .checked_sub(a)\n        .ok_or(MathError::Overflow)?;\n    let c = exp::\u003cF, F\u003e(b).map_err(|_| MathError::Transcendental)?;\n\n    F::from_num(1).checked_sub(c).ok_or(MathError::Overflow)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use approx::assert_abs_diff_eq;\n    use frame_support::assert_ok;\n    use substrate_fixed::traits::LossyInto;\n    use substrate_fixed::types::I64F64;\n\n    pub type FixedNumber = I64F64;\n\n    #[test]\n    fn squared_example() {\n        let diffs: Vec\u003c_\u003e = vec![\n            312.51, 121.18, 19.04, 109.93, 115.73, 11.46, 993.98, -142.49, 206.22, 123.83, -91.13,\n            15.18, 90.42, 265.69, 682.76, -108.85, -248.77, -837.47, -154.63, 202.68, 465.51,\n            463.73, -405.52, 48.81, 293.73, 55.83, 2.47, -206.06, -441.22,\n        ]\n        .into_iter()\n        .map(|x| Ok(FixedNumber::from_num(x)))\n        .collect();\n\n        let actual: MathResult\u003cVec\u003c_\u003e\u003e = squared(diffs.into_iter()).collect();\n        assert_ok!(\u0026actual);\n        let actual: Vec\u003cf64\u003e = actual\n            .unwrap()\n            .into_iter()\n            .map(|x| x.lossy_into())\n            .collect();\n\n        let expected: Vec\u003c_\u003e = vec![\n            97662.5001000001,\n            14684.5923999999,\n            362.5216000000,\n            12084.6049000001,\n            13393.4329000001,\n            131.3316000000,\n            987996.2404000010,\n            20303.4001000005,\n            42526.6884000005,\n            15333.8689000000,\n            8304.6769000002,\n            230.4324000000,\n            8175.7764000000,\n            70591.1761000003,\n            466161.2176000000,\n            11848.3225000001,\n            61886.5129000002,\n            701356.0008999990,\n            23910.4369000003,\n            41079.1824000001,\n            216699.5601000000,\n            215045.5129000000,\n            164446.4703999990,\n            2382.4161000000,\n            86277.3128999997,\n            3116.9889000000,\n            6.1009000000,\n            42460.7236000005,\n            194675.0883999990,\n        ];\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    }\n\n    #[test]\n    fn last_recurrent_ewma_example() {\n        let squared_diffs: Vec\u003c_\u003e = vec![\n            97662.50010000010000,\n            14684.59239999990000,\n            362.52159999999900,\n            12084.60490000010000,\n            13393.43290000010000,\n            131.33160000000100,\n            987996.24040000100000,\n            20303.40010000050000,\n            42526.68840000050000,\n            15333.86890000000000,\n            8304.67690000019000,\n            230.43240000000900,\n            8175.77640000001000,\n            70591.17610000030000,\n            466161.21760000000000,\n            11848.32250000010000,\n            61886.51290000020000,\n            701356.00089999900000,\n            23910.43690000030000,\n            41079.18240000010000,\n            216699.56010000000000,\n            215045.51290000000000,\n            164446.47039999900000,\n            2382.41609999995000,\n            86277.31289999970000,\n            3116.98889999999000,\n            6.10090000000575,\n            42460.72360000050000,\n            194675.08839999900000,\n        ]\n        .into_iter()\n        .map(|x| Ok(FixedNumber::from_num(x)))\n        .collect();\n        let decay = FixedNumber::from_num(0.0540540540540541);\n\n        let actual = last_recurrent_ewma(squared_diffs.into_iter(), decay);\n        assert_ok!(\u0026actual);\n        let actual: f64 = actual.unwrap().lossy_into();\n\n        let expected = 114954.3177623650;\n        assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n    }\n\n    #[test]\n    fn recurrent_ewma_step_example() {\n        let diff = Ok(FixedNumber::from_num(14684.59239999990000));\n        let decay = FixedNumber::from_num(0.0540540540540541);\n        let prev_var = Ok(FixedNumber::from_num(97662.5001000001));\n        let actual = recurrent_ewma_step(diff, decay, prev_var);\n        assert_ok!(\u0026actual);\n        let actual: f64 = actual.unwrap().lossy_into();\n        let expected = 93177.2077918920;\n\n        assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n    }\n\n    #[cfg(test)]\n    mod recurrent_ewma_step {\n        use super::super::*;\n        use super::FixedNumber;\n        use approx::assert_abs_diff_eq;\n        use frame_support::assert_ok;\n        use substrate_fixed::traits::LossyInto;\n\n        #[test]\n        fn recurrent_ewma_step_diff_is_zero() {\n            let diff = Ok(FixedNumber::from_num(0));\n            let decay = FixedNumber::from_num(0.054);\n            let prev_var = Ok(FixedNumber::from_num(9762.51));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            assert_ok!(\u0026actual);\n            let actual: f64 = actual.unwrap().lossy_into();\n            let expected = 9235.33446;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn recurrent_ewma_step_mul_overflow() {\n            let diff = Ok(FixedNumber::max_value());\n            let decay = FixedNumber::from_num(2);\n            let prev_var = Ok(FixedNumber::from_num(9762.51));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            let expected = Err(MathError::Overflow);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn recurrent_ewma_step_add_overflow() {\n            let diff = Ok(FixedNumber::from_num(2));\n            let decay = FixedNumber::max_value();\n            let prev_var = Ok(FixedNumber::from_num(9762.51));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            let expected = Err(MathError::Overflow);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn recurrent_ewma_step_valid_negative() {\n            let diff = Ok(FixedNumber::from_num(-0.051));\n            let decay = FixedNumber::from_num(-0.054);\n            let prev_var = Ok(FixedNumber::from_num(-976.51));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            assert_ok!(\u0026actual);\n            let actual: f64 = actual.unwrap().lossy_into();\n            let expected = -1029.238786;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn recurrent_ewma_step_valid_zero() {\n            let diff = Ok(FixedNumber::from_num(0.0));\n            let decay = FixedNumber::from_num(0.0);\n            let prev_var = Ok(FixedNumber::from_num(0.0));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            assert_ok!(\u0026actual);\n            let actual: f64 = actual.unwrap().lossy_into();\n            let expected = 0.0;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn recurrent_ewma_step_example() {\n            let diff = Ok(FixedNumber::from_num(14684.59239999990000));\n            let decay = FixedNumber::from_num(0.0540540540540541);\n            let prev_var = Ok(FixedNumber::from_num(97662.5001000001));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            assert_ok!(\u0026actual);\n            let actual: f64 = actual.unwrap().lossy_into();\n            let expected = 93177.2077918920;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n    }\n\n    #[cfg(test)]\n    mod decay {\n        use super::super::*;\n        use super::FixedNumber;\n        use approx::assert_abs_diff_eq;\n        use frame_support::assert_ok;\n        use substrate_fixed::traits::LossyInto;\n\n        #[test]\n        fn decay_zero() {\n            let actual = decay(0);\n            assert_ok!(actual);\n            let actual: FixedNumber = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 2.0;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn decay_simple() {\n            let actual = decay(1);\n            assert_ok!(actual);\n            let actual: FixedNumber = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 1.0;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn decay_expample() {\n            let actual = decay(36);\n            assert_ok!(actual);\n            let actual: FixedNumber = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.05405405405;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n    }\n\n    #[cfg(test)]\n    mod calc_return {\n        use super::super::*;\n        use super::FixedNumber;\n        use approx::assert_abs_diff_eq;\n        use frame_support::assert_ok;\n        use substrate_fixed::traits::LossyInto;\n\n        #[test]\n        fn calc_return_valid() {\n            let x1 = FixedNumber::from_num(8);\n            let x2 = FixedNumber::from_num(6);\n            let actual = calc_return(x1, x2);\n            let expected = Ok(FixedNumber::from_num(-0.25));\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_return_valid_positive() {\n            let x1 = FixedNumber::from_num(8);\n            let x2 = FixedNumber::from_num(10);\n            let actual = calc_return(x1, x2);\n            let expected = Ok(FixedNumber::from_num(0.25));\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_return_x1_is_zero() {\n            let x1 = FixedNumber::from_num(0);\n            let x2 = FixedNumber::from_num(6);\n            let actual = calc_return(x1, x2);\n            let expected = Err(MathError::DivisionByZero);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_log_return_valid() {\n            let x1 = FixedNumber::from_num(8);\n            let x2 = FixedNumber::from_num(6);\n            let actual: f64 = calc_log_return(x1, x2).unwrap().lossy_into();\n            let expected = -0.287682072452;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn calc_log_return_x1_is_zero() {\n            let x1 = FixedNumber::from_num(0);\n            let x2 = FixedNumber::from_num(6);\n            let actual = calc_log_return(x1, x2);\n            let expected = Err(MathError::DivisionByZero);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_log_return_x1_is_negative() {\n            let x1 = FixedNumber::from_num(-3);\n            let x2 = FixedNumber::from_num(6);\n            let actual = calc_log_return(x1, x2);\n            let expected = Err(MathError::Transcendental);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_return_iter_empty() {\n            let prices: Vec\u003cFixedNumber\u003e = Vec::new();\n            let func = calc_return_func(CalcReturnType::Regular);\n\n            let actual: MathResult\u003cVec\u003cFixedNumber\u003e\u003e = calc_return_iter(\u0026prices, func).collect();\n            let expected = Ok(vec![]);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_return_vec_one_item() {\n            let prices: Vec\u003cFixedNumber\u003e =\n                vec![1.5].into_iter().map(FixedNumber::from_num).collect();\n            let func = calc_return_func(CalcReturnType::Regular);\n\n            let actual: MathResult\u003cVec\u003cFixedNumber\u003e\u003e = calc_return_iter(\u0026prices, func).collect();\n            let expected = Ok(vec![]);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_return_vec_regular_valid() {\n            let prices: Vec\u003cFixedNumber\u003e = vec![\n                7_117.21, 7_429.72, 7_550.90, 7_569.94, 7_679.87, 7_795.60, 7_807.06, 8_801.04,\n                8_658.55, 8_864.77,\n            ]\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n            let func = calc_return_func(CalcReturnType::Regular);\n\n            let actual: MathResult\u003cVec\u003cFixedNumber\u003e\u003e = calc_return_iter(\u0026prices, func).collect();\n            assert_ok!(\u0026actual);\n            let actual: Vec\u003cf64\u003e = actual\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n\n            let expected: Vec\u003cf64\u003e = vec![\n                0.04390906,\n                0.01631017,\n                0.00252155,\n                0.01452191,\n                0.01506927,\n                0.00147006,\n                0.12731809,\n                -0.01619013,\n                0.02381692,\n            ];\n\n            assert_eq!(actual.len(), expected.len());\n            for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n                assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n            }\n        }\n\n        #[test]\n        fn calc_return_vec_log_valid() {\n            let prices: Vec\u003cFixedNumber\u003e = vec![\n                7_117.21, 7_429.72, 7_550.90, 7_569.94, 7_679.87, 7_795.60, 7_807.06, 8_801.04,\n                8_658.55, 8_864.77,\n            ]\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n            let func = calc_return_func(CalcReturnType::Log);\n\n            let actual: MathResult\u003cVec\u003cFixedNumber\u003e\u003e = calc_return_iter(\u0026prices, func).collect();\n            assert_ok!(\u0026actual);\n            let actual: Vec\u003cf64\u003e = actual\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n\n            let expected: Vec\u003cf64\u003e = vec![\n                0.042972378,\n                0.016178588,\n                0.002518380,\n                0.014417479,\n                0.014956852,\n                0.001468981,\n                0.119841444,\n                -0.016322624,\n                0.023537722,\n            ];\n\n            assert_eq!(actual.len(), expected.len());\n            for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n                assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n            }\n        }\n    }\n}\n","traces":[{"line":54,"address":[5373920],"length":1,"stats":{"Line":2},"fn_name":"calc_return\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":55,"address":[5374182,5373967,5374231],"length":1,"stats":{"Line":4},"fn_name":null},{"line":57,"address":[5374150,5374261],"length":1,"stats":{"Line":4},"fn_name":null},{"line":60,"address":[5374336],"length":1,"stats":{"Line":1},"fn_name":"calc_log_return\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":65,"address":[5374383,5374582,5374631],"length":1,"stats":{"Line":2},"fn_name":null},{"line":66,"address":[5374676,5374554,5374661,5374672],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":69,"address":[5374704],"length":1,"stats":{"Line":3},"fn_name":"calc_return_func\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":74,"address":[5374743],"length":1,"stats":{"Line":1},"fn_name":null},{"line":75,"address":[5374747,5374717],"length":1,"stats":{"Line":3},"fn_name":null},{"line":76,"address":[5374731],"length":1,"stats":{"Line":1},"fn_name":null},{"line":80,"address":[5374784,5374854],"length":1,"stats":{"Line":1},"fn_name":"calc_return_iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,fn(substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e) -\u003e core::result::Result\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, financial_pallet::math::MathError\u003e\u003e"},{"line":84,"address":[5374806,5374944,5374866,5374972],"length":1,"stats":{"Line":7},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,fn(substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e) -\u003e core::result::Result\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, financial_pallet::math::MathError\u003e\u003e"},{"line":87,"address":[5375216],"length":1,"stats":{"Line":2},"fn_name":"decay\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":88,"address":[5375246],"length":1,"stats":{"Line":2},"fn_name":null},{"line":90,"address":[5375318],"length":1,"stats":{"Line":2},"fn_name":null},{"line":91,"address":[5375441,5375598,5375373,5375545],"length":1,"stats":{"Line":4},"fn_name":null},{"line":93,"address":[5375518,5375608],"length":1,"stats":{"Line":4},"fn_name":null},{"line":96,"address":[5375664],"length":1,"stats":{"Line":7},"fn_name":"recurrent_ewma_step\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":101,"address":[5376005,5375690,5375941],"length":1,"stats":{"Line":7},"fn_name":null},{"line":102,"address":[5376017,5375867,5376169],"length":1,"stats":{"Line":14},"fn_name":null},{"line":104,"address":[5376409,5376127,5376230],"length":1,"stats":{"Line":14},"fn_name":null},{"line":107,"address":[5376510,5376691,5376578],"length":1,"stats":{"Line":10},"fn_name":null},{"line":108,"address":[5376744,5376917,5376645],"length":1,"stats":{"Line":8},"fn_name":null},{"line":110,"address":[5376970,5376892],"length":1,"stats":{"Line":10},"fn_name":null},{"line":113,"address":[5377392,5377024,5377216],"length":1,"stats":{"Line":7},"fn_name":"last_recurrent_ewma\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Map\u003ccore::iter::adapters::zip::Zip\u003ccore::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e, core::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e\u003e, closure-0\u003e\u003e"},{"line":117,"address":[5377280,5377100,5377050,5377495,5377242,5377340,5377163,5377449],"length":1,"stats":{"Line":17},"fn_name":null},{"line":118,"address":[5378320,5377259,5377076,5377552,5377434,5377936],"length":1,"stats":{"Line":13},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,alloc::vec::IntoIter\u003ccore::result::Result\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, financial_pallet::math::MathError\u003e\u003e\u003e"},{"line":119,"address":[5377960,5377708,5378476,5378092,5378344,5377576],"length":1,"stats":{"Line":14},"fn_name":null},{"line":120,"address":[5378124,5378508,5377740],"length":1,"stats":{"Line":7},"fn_name":null},{"line":121,"address":[5378214,5377830,5378598],"length":1,"stats":{"Line":7},"fn_name":null},{"line":123,"address":[5378401,5377633,5378017],"length":1,"stats":{"Line":7},"fn_name":null},{"line":126,"address":[5377155,5377490,5377332],"length":1,"stats":{"Line":7},"fn_name":null},{"line":127,"address":[5378704,5378736,5378740,5378708,5378768,5378772],"length":1,"stats":{"Line":14},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Map\u003ccore::iter::adapters::zip::Zip\u003ccore::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e, core::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e\u003e, closure-0\u003e\u003e"},{"line":130,"address":[5379328,5379630,5379902,5379856,5379072,5380163,5378846,5380112,5379584,5378800,5379123,5379379],"length":1,"stats":{"Line":25},"fn_name":"sum\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Map\u003ccore::iter::adapters::zip::Zip\u003calloc::vec::IntoIter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e, alloc::vec::IntoIter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e, closure-0\u003e\u003e"},{"line":133,"address":[5379411,5379197,5379430,5379601,5379662,5379768,5380139,5380656,5378878,5378817,5379934,5381232,5379099,5379953,5379174,5380214,5380020,5380195,5378930,5379155,5379355,5380368,5379976,5379691,5380281,5378907,5381808,5379453,5379497,5380237,5379714,5379873,5380944,5381520,5379241,5378984],"length":1,"stats":{"Line":113},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Map\u003ccore::iter::adapters::zip::Zip\u003calloc::vec::IntoIter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e, core::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e\u003e, closure-0\u003e\u003e"},{"line":134,"address":[5381996,5380687,5380844,5380556,5381420,5381263,5381839,5380975,5381469,5382045,5381551,5381132,5380893,5380605,5380399,5381181,5381708,5381757],"length":1,"stats":{"Line":25},"fn_name":null},{"line":135,"address":[5381479,5380819,5381683,5381971,5381107,5382055,5381767,5381395,5380531,5380903,5380615,5381191],"length":1,"stats":{"Line":46},"fn_name":null},{"line":139,"address":[5382096],"length":1,"stats":{"Line":8},"fn_name":"mean\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":140,"address":[5382334,5382512,5382389,5382130,5382528],"length":1,"stats":{"Line":24},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":141,"address":[5382404,5382322,5382466],"length":1,"stats":{"Line":24},"fn_name":null},{"line":142,"address":[5382458],"length":1,"stats":{"Line":8},"fn_name":null},{"line":145,"address":[5382576],"length":1,"stats":{"Line":8},"fn_name":"demeaned\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e"},{"line":149,"address":[5382656,5382673,5382603],"length":1,"stats":{"Line":24},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e"},{"line":152,"address":[5382800,5382880],"length":1,"stats":{"Line":9},"fn_name":"squared\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,alloc::vec::IntoIter\u003ccore::result::Result\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, financial_pallet::math::MathError\u003e\u003e\u003e"},{"line":155,"address":[5383078,5382950,5383260,5382928,5382807,5383056,5383248,5383184,5382894,5383196],"length":1,"stats":{"Line":33},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Map\u003ccore::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e, fn(substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e) -\u003e core::result::Result\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, financial_pallet::math::MathError\u003e\u003e\u003e"},{"line":158,"address":[5383312],"length":1,"stats":{"Line":4},"fn_name":"regular_vola\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":159,"address":[5383531,5383589,5383354],"length":1,"stats":{"Line":4},"fn_name":null},{"line":161,"address":[5383606],"length":1,"stats":{"Line":4},"fn_name":null},{"line":162,"address":[5383842,5383661,5383729],"length":1,"stats":{"Line":8},"fn_name":null},{"line":163,"address":[5383796,5384054,5383895],"length":1,"stats":{"Line":8},"fn_name":null},{"line":164,"address":[5384038],"length":1,"stats":{"Line":4},"fn_name":null},{"line":167,"address":[5384352,5384112,5384272],"length":1,"stats":{"Line":10},"fn_name":"mul\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,alloc::vec::IntoIter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e,alloc::vec::IntoIter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e"},{"line":173,"address":[5384204,5384299,5384122,5384375],"length":1,"stats":{"Line":13},"fn_name":null},{"line":174,"address":[5384157],"length":1,"stats":{"Line":3},"fn_name":null},{"line":175,"address":[5384752,5384784,5384464,5384496,5384608,5384640],"length":1,"stats":{"Line":16},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e,core::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e\u003e"},{"line":178,"address":[5384896],"length":1,"stats":{"Line":2},"fn_name":"regular_corr\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":179,"address":[5385264,5384970,5385200],"length":1,"stats":{"Line":2},"fn_name":null},{"line":181,"address":[5385284],"length":1,"stats":{"Line":3},"fn_name":null},{"line":182,"address":[5385538,5385425,5385357],"length":1,"stats":{"Line":8},"fn_name":null},{"line":183,"address":[5385492,5385770,5385591],"length":1,"stats":{"Line":10},"fn_name":null},{"line":184,"address":[5385726,5386004,5385825],"length":1,"stats":{"Line":4},"fn_name":null},{"line":185,"address":[5385960,5386059,5386218],"length":1,"stats":{"Line":6},"fn_name":null},{"line":186,"address":[5386202],"length":1,"stats":{"Line":3},"fn_name":null},{"line":189,"address":[5386272],"length":1,"stats":{"Line":2},"fn_name":"exp_corr\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":190,"address":[5386465,5386343,5386545,5386398],"length":1,"stats":{"Line":6},"fn_name":null},{"line":192,"address":[5386547,5386390,5386449,5386594],"length":1,"stats":{"Line":4},"fn_name":null},{"line":193,"address":[5386507,5386762,5386606],"length":1,"stats":{"Line":4},"fn_name":null},{"line":194,"address":[5386746],"length":1,"stats":{"Line":2},"fn_name":null},{"line":197,"address":[5386816],"length":1,"stats":{"Line":6},"fn_name":"from_num\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":198,"address":[5386825],"length":1,"stats":{"Line":6},"fn_name":null},{"line":201,"address":[5386864],"length":1,"stats":{"Line":4},"fn_name":"covariance\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":208,"address":[5387008,5387071,5386911],"length":1,"stats":{"Line":12},"fn_name":null},{"line":211,"address":[5387136,5387150,5387200,5386987,5387222],"length":1,"stats":{"Line":20},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":212,"address":[5387057],"length":1,"stats":{"Line":4},"fn_name":null},{"line":213,"address":[5387423,5387408],"length":1,"stats":{"Line":5},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":214,"address":[5387592,5387547,5387496],"length":1,"stats":{"Line":6},"fn_name":null},{"line":215,"address":[5387347,5387542,5387328],"length":1,"stats":{"Line":10},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":216,"address":[5387587],"length":1,"stats":{"Line":4},"fn_name":null},{"line":220,"address":[5387648],"length":1,"stats":{"Line":3},"fn_name":"regular_value_at_risk\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":228,"address":[5387764,5387792,5387951,5387865],"length":1,"stats":{"Line":9},"fn_name":null},{"line":229,"address":[5387702],"length":1,"stats":{"Line":3},"fn_name":null},{"line":230,"address":[5387953,5387784,5387849,5388000],"length":1,"stats":{"Line":6},"fn_name":null},{"line":231,"address":[5387913,5388018],"length":1,"stats":{"Line":6},"fn_name":null},{"line":232,"address":[5388010],"length":1,"stats":{"Line":3},"fn_name":null},{"line":235,"address":[5388064],"length":1,"stats":{"Line":0},"fn_name":"log_value_at_risk\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":244,"address":[5388430,5388253,5388216,5388341],"length":1,"stats":{"Line":0},"fn_name":null},{"line":245,"address":[5388121],"length":1,"stats":{"Line":0},"fn_name":null},{"line":246,"address":[5388488,5388432,5388322,5388245],"length":1,"stats":{"Line":0},"fn_name":null},{"line":247,"address":[5388663,5388587,5388405,5388508],"length":1,"stats":{"Line":0},"fn_name":null},{"line":249,"address":[5388665,5388500,5388568],"length":1,"stats":{"Line":0},"fn_name":null},{"line":250,"address":[5389028,5388635,5389024,5388741,5388866],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":266,"address":[5124254,5123504],"length":1,"stats":{"Line":3},"fn_name":"squared_example"},{"line":267,"address":[5123516,5124269],"length":1,"stats":{"Line":2},"fn_name":null},{"line":273,"address":[5732080,5732108],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":276,"address":[5124332],"length":1,"stats":{"Line":1},"fn_name":null},{"line":277,"address":[5124451],"length":1,"stats":{"Line":1},"fn_name":null},{"line":278,"address":[5124708],"length":1,"stats":{"Line":1},"fn_name":null},{"line":281,"address":[5732160,5732179],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":284,"address":[5124865,5125356],"length":1,"stats":{"Line":2},"fn_name":null},{"line":315,"address":[5125616,5125364],"length":1,"stats":{"Line":1},"fn_name":null},{"line":316,"address":[5126199,5125985,5125550,5126234,5126473,5127447],"length":1,"stats":{"Line":4},"fn_name":null},{"line":317,"address":[5126316,5126478],"length":1,"stats":{"Line":1},"fn_name":null},{"line":322,"address":[5127584,5128310],"length":1,"stats":{"Line":3},"fn_name":"last_recurrent_ewma_example"},{"line":323,"address":[5127596,5128325],"length":1,"stats":{"Line":2},"fn_name":null},{"line":355,"address":[5732268,5732240],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":357,"address":[5128404],"length":1,"stats":{"Line":1},"fn_name":null},{"line":359,"address":[5128459],"length":1,"stats":{"Line":1},"fn_name":null},{"line":360,"address":[5128561],"length":1,"stats":{"Line":1},"fn_name":null},{"line":361,"address":[5128818],"length":1,"stats":{"Line":1},"fn_name":null},{"line":363,"address":[5128948],"length":1,"stats":{"Line":1},"fn_name":null},{"line":364,"address":[5128964,5129142],"length":1,"stats":{"Line":1},"fn_name":null},{"line":368,"address":[5130032],"length":1,"stats":{"Line":3},"fn_name":"recurrent_ewma_step_example"},{"line":369,"address":[5130054],"length":1,"stats":{"Line":1},"fn_name":null},{"line":370,"address":[5130123],"length":1,"stats":{"Line":1},"fn_name":null},{"line":371,"address":[5130174],"length":1,"stats":{"Line":1},"fn_name":null},{"line":372,"address":[5130235],"length":1,"stats":{"Line":1},"fn_name":null},{"line":373,"address":[5130376],"length":1,"stats":{"Line":1},"fn_name":null},{"line":374,"address":[5130654],"length":1,"stats":{"Line":1},"fn_name":null},{"line":375,"address":[5130772],"length":1,"stats":{"Line":1},"fn_name":null},{"line":377,"address":[5130962,5130781],"length":1,"stats":{"Line":1},"fn_name":null},{"line":389,"address":[4688165,4688160],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":390,"address":[5704288],"length":1,"stats":{"Line":1},"fn_name":null},{"line":391,"address":[5704357],"length":1,"stats":{"Line":1},"fn_name":null},{"line":392,"address":[5704408],"length":1,"stats":{"Line":1},"fn_name":null},{"line":393,"address":[5704469],"length":1,"stats":{"Line":1},"fn_name":null},{"line":394,"address":[5704610],"length":1,"stats":{"Line":1},"fn_name":null},{"line":395,"address":[5704888],"length":1,"stats":{"Line":1},"fn_name":null},{"line":396,"address":[5705006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":398,"address":[5705015,5705196],"length":1,"stats":{"Line":1},"fn_name":null},{"line":402,"address":[4688192,4688197],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":403,"address":[5705831],"length":1,"stats":{"Line":1},"fn_name":null},{"line":404,"address":[5705885],"length":1,"stats":{"Line":1},"fn_name":null},{"line":405,"address":[5705930],"length":1,"stats":{"Line":1},"fn_name":null},{"line":406,"address":[5705979],"length":1,"stats":{"Line":1},"fn_name":null},{"line":407,"address":[5706114],"length":1,"stats":{"Line":1},"fn_name":null},{"line":409,"address":[5706251,5706144],"length":1,"stats":{"Line":1},"fn_name":null},{"line":413,"address":[4688224,4688229],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":414,"address":[5706551],"length":1,"stats":{"Line":1},"fn_name":null},{"line":415,"address":[5706605],"length":1,"stats":{"Line":1},"fn_name":null},{"line":416,"address":[5706650],"length":1,"stats":{"Line":1},"fn_name":null},{"line":417,"address":[5706699],"length":1,"stats":{"Line":1},"fn_name":null},{"line":418,"address":[5706834],"length":1,"stats":{"Line":1},"fn_name":null},{"line":420,"address":[5706971,5706864],"length":1,"stats":{"Line":1},"fn_name":null},{"line":424,"address":[4688261,4688256],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":425,"address":[5707286],"length":1,"stats":{"Line":1},"fn_name":null},{"line":426,"address":[5707355],"length":1,"stats":{"Line":1},"fn_name":null},{"line":427,"address":[5707406],"length":1,"stats":{"Line":1},"fn_name":null},{"line":428,"address":[5707467],"length":1,"stats":{"Line":1},"fn_name":null},{"line":429,"address":[5707608],"length":1,"stats":{"Line":1},"fn_name":null},{"line":430,"address":[5707886],"length":1,"stats":{"Line":1},"fn_name":null},{"line":431,"address":[5708004],"length":1,"stats":{"Line":1},"fn_name":null},{"line":433,"address":[5708194,5708013],"length":1,"stats":{"Line":1},"fn_name":null},{"line":437,"address":[4688288,4688293],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":438,"address":[5708846],"length":1,"stats":{"Line":1},"fn_name":null},{"line":439,"address":[5708913],"length":1,"stats":{"Line":1},"fn_name":null},{"line":440,"address":[5708956],"length":1,"stats":{"Line":1},"fn_name":null},{"line":441,"address":[5709020],"length":1,"stats":{"Line":1},"fn_name":null},{"line":442,"address":[5709161],"length":1,"stats":{"Line":1},"fn_name":null},{"line":443,"address":[5709439],"length":1,"stats":{"Line":1},"fn_name":null},{"line":444,"address":[5709549],"length":1,"stats":{"Line":1},"fn_name":null},{"line":446,"address":[5709561,5709742],"length":1,"stats":{"Line":1},"fn_name":null},{"line":450,"address":[4688320,4688325],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":451,"address":[5710406],"length":1,"stats":{"Line":1},"fn_name":null},{"line":452,"address":[5710475],"length":1,"stats":{"Line":1},"fn_name":null},{"line":453,"address":[5710526],"length":1,"stats":{"Line":1},"fn_name":null},{"line":454,"address":[5710587],"length":1,"stats":{"Line":1},"fn_name":null},{"line":455,"address":[5710728],"length":1,"stats":{"Line":1},"fn_name":null},{"line":456,"address":[5711006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":457,"address":[5711124],"length":1,"stats":{"Line":1},"fn_name":null},{"line":459,"address":[5711314,5711133],"length":1,"stats":{"Line":1},"fn_name":null},{"line":472,"address":[4625941,4625936],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":473,"address":[5736976],"length":1,"stats":{"Line":1},"fn_name":null},{"line":474,"address":[5736989],"length":1,"stats":{"Line":1},"fn_name":null},{"line":475,"address":[5737289],"length":1,"stats":{"Line":1},"fn_name":null},{"line":476,"address":[5737395],"length":1,"stats":{"Line":1},"fn_name":null},{"line":477,"address":[5737417],"length":1,"stats":{"Line":1},"fn_name":null},{"line":479,"address":[5737426,5737607],"length":1,"stats":{"Line":1},"fn_name":null},{"line":483,"address":[4625968,4625973],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":484,"address":[5738254],"length":1,"stats":{"Line":1},"fn_name":null},{"line":485,"address":[5738272],"length":1,"stats":{"Line":1},"fn_name":null},{"line":486,"address":[5738572],"length":1,"stats":{"Line":1},"fn_name":null},{"line":487,"address":[5738678],"length":1,"stats":{"Line":1},"fn_name":null},{"line":488,"address":[5738700],"length":1,"stats":{"Line":1},"fn_name":null},{"line":490,"address":[5738709,5738890],"length":1,"stats":{"Line":1},"fn_name":null},{"line":494,"address":[4626000,4626005],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":495,"address":[5739534],"length":1,"stats":{"Line":1},"fn_name":null},{"line":496,"address":[5739552],"length":1,"stats":{"Line":1},"fn_name":null},{"line":497,"address":[5739852],"length":1,"stats":{"Line":1},"fn_name":null},{"line":498,"address":[5739958],"length":1,"stats":{"Line":1},"fn_name":null},{"line":499,"address":[5739980],"length":1,"stats":{"Line":1},"fn_name":null},{"line":501,"address":[5739989,5740170],"length":1,"stats":{"Line":1},"fn_name":null},{"line":514,"address":[4519429,4519424],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":515,"address":[5718188],"length":1,"stats":{"Line":1},"fn_name":null},{"line":516,"address":[5718233],"length":1,"stats":{"Line":1},"fn_name":null},{"line":517,"address":[5718301],"length":1,"stats":{"Line":1},"fn_name":null},{"line":518,"address":[5718314],"length":1,"stats":{"Line":1},"fn_name":null},{"line":520,"address":[5718363,5718467],"length":1,"stats":{"Line":1},"fn_name":null},{"line":524,"address":[4519456,4519461],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":525,"address":[5718780],"length":1,"stats":{"Line":1},"fn_name":null},{"line":526,"address":[5718825],"length":1,"stats":{"Line":1},"fn_name":null},{"line":527,"address":[5718893],"length":1,"stats":{"Line":1},"fn_name":null},{"line":528,"address":[5718906],"length":1,"stats":{"Line":1},"fn_name":null},{"line":530,"address":[5719059,5718955],"length":1,"stats":{"Line":1},"fn_name":null},{"line":534,"address":[4519488,4519493],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":535,"address":[5719369],"length":1,"stats":{"Line":1},"fn_name":null},{"line":536,"address":[5719411],"length":1,"stats":{"Line":1},"fn_name":null},{"line":537,"address":[5719473],"length":1,"stats":{"Line":1},"fn_name":null},{"line":538,"address":[5719478],"length":1,"stats":{"Line":1},"fn_name":null},{"line":540,"address":[5719612,5719508],"length":1,"stats":{"Line":1},"fn_name":null},{"line":544,"address":[4519520,4519525],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":545,"address":[5719923],"length":1,"stats":{"Line":1},"fn_name":null},{"line":546,"address":[5719971],"length":1,"stats":{"Line":1},"fn_name":null},{"line":547,"address":[5720054],"length":1,"stats":{"Line":1},"fn_name":null},{"line":548,"address":[5720136],"length":1,"stats":{"Line":1},"fn_name":null},{"line":550,"address":[5720145,5720326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":554,"address":[4519552,4519557],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":555,"address":[5720969],"length":1,"stats":{"Line":1},"fn_name":null},{"line":556,"address":[5721011],"length":1,"stats":{"Line":1},"fn_name":null},{"line":557,"address":[5721073],"length":1,"stats":{"Line":1},"fn_name":null},{"line":558,"address":[5721078],"length":1,"stats":{"Line":1},"fn_name":null},{"line":560,"address":[5721108,5721212],"length":1,"stats":{"Line":1},"fn_name":null},{"line":564,"address":[4519584,4519589],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":565,"address":[5721516],"length":1,"stats":{"Line":1},"fn_name":null},{"line":566,"address":[5721558],"length":1,"stats":{"Line":1},"fn_name":null},{"line":567,"address":[5721620],"length":1,"stats":{"Line":1},"fn_name":null},{"line":568,"address":[5721625],"length":1,"stats":{"Line":1},"fn_name":null},{"line":570,"address":[5721655,5721759],"length":1,"stats":{"Line":1},"fn_name":null},{"line":574,"address":[4519616,4519621],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":575,"address":[5722055],"length":1,"stats":{"Line":1},"fn_name":null},{"line":576,"address":[5722082],"length":1,"stats":{"Line":1},"fn_name":null},{"line":578,"address":[5722180,5722128],"length":1,"stats":{"Line":2},"fn_name":null},{"line":579,"address":[5722218],"length":1,"stats":{"Line":1},"fn_name":null},{"line":581,"address":[5722419,5722378,5722273],"length":1,"stats":{"Line":2},"fn_name":null},{"line":585,"address":[4519653,4519648],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":586,"address":[5722908,5722839],"length":1,"stats":{"Line":2},"fn_name":null},{"line":588,"address":[5722968],"length":1,"stats":{"Line":1},"fn_name":null},{"line":590,"address":[5723014,5723069],"length":1,"stats":{"Line":2},"fn_name":null},{"line":591,"address":[5723107],"length":1,"stats":{"Line":1},"fn_name":null},{"line":593,"address":[5723308,5723162,5723267],"length":1,"stats":{"Line":2},"fn_name":null},{"line":597,"address":[4519680,4519685],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":598,"address":[5723724,5723945],"length":1,"stats":{"Line":2},"fn_name":null},{"line":605,"address":[5724008],"length":1,"stats":{"Line":1},"fn_name":null},{"line":607,"address":[5724063,5724136],"length":1,"stats":{"Line":2},"fn_name":null},{"line":608,"address":[5724174],"length":1,"stats":{"Line":1},"fn_name":null},{"line":609,"address":[5724431],"length":1,"stats":{"Line":1},"fn_name":null},{"line":612,"address":[4519712,4519731],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":615,"address":[5724588,5724760],"length":1,"stats":{"Line":2},"fn_name":null},{"line":627,"address":[5724768,5725020],"length":1,"stats":{"Line":1},"fn_name":null},{"line":628,"address":[5726858,5725603,5725389,5724954,5725877,5725638],"length":1,"stats":{"Line":4},"fn_name":null},{"line":629,"address":[5725882,5725720],"length":1,"stats":{"Line":1},"fn_name":null},{"line":634,"address":[4519765,4519760],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":635,"address":[5727036,5727257],"length":1,"stats":{"Line":2},"fn_name":null},{"line":642,"address":[5727320],"length":1,"stats":{"Line":1},"fn_name":null},{"line":644,"address":[5727375,5727448],"length":1,"stats":{"Line":2},"fn_name":null},{"line":645,"address":[5727486],"length":1,"stats":{"Line":1},"fn_name":null},{"line":646,"address":[5727743],"length":1,"stats":{"Line":1},"fn_name":null},{"line":649,"address":[4519811,4519792],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":652,"address":[5728072,5727900],"length":1,"stats":{"Line":2},"fn_name":null},{"line":664,"address":[5728332,5728080],"length":1,"stats":{"Line":1},"fn_name":null},{"line":665,"address":[5729189,5730170,5728701,5728950,5728915,5728266],"length":1,"stats":{"Line":4},"fn_name":null},{"line":666,"address":[5729194,5729032],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":254,"coverable":261},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","financial","src","mock.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nuse crate::{Module, Trait};\nuse chrono::prelude::*;\nuse core::time::Duration;\nuse financial_primitives::{BalanceAware, CalcReturnType, CalcVolatilityType};\nuse frame_support::codec::{Decode, Encode};\nuse frame_support::dispatch::DispatchError;\nuse frame_support::traits::UnixTime;\nuse frame_support::{impl_outer_origin, parameter_types, weights::Weight};\nuse frame_system as system;\nuse sp_core::H256;\nuse sp_runtime::{\n    testing::Header,\n    traits::{BlakeTwo256, IdentityLookup},\n    Perbill,\n};\nuse std::cell::RefCell;\nuse std::collections::HashMap;\nuse substrate_fixed::types::I64F64;\n\nimpl_outer_origin! {\n    pub enum Origin for Test {}\n}\n\ntype AccountId = u64;\n\nthread_local! {\n    pub static NOW: RefCell\u003cDuration\u003e = RefCell::new(Duration::from_secs(0));\n    pub static BALANCES: RefCell\u003cHashMap\u003c(AccountId, Asset), FixedNumber\u003e\u003e = RefCell::new(HashMap::new());\n}\n\npub fn set_now(now: Duration) {\n    NOW.with(|n| *n.borrow_mut() = now);\n}\n\n#[allow(dead_code)]\npub fn set_balance(account_id: AccountId, asset: Asset, balance: FixedNumber) {\n    BALANCES.with(|b| b.borrow_mut().insert((account_id, asset), balance));\n}\n\n#[derive(Clone, Eq, PartialEq)]\npub struct Test;\nparameter_types! {\n    pub const BlockHashCount: u64 = 250;\n    pub const MaximumBlockWeight: Weight = 1024;\n    pub const MaximumBlockLength: u32 = 2 * 1024;\n    pub const AvailableBlockRatio: Perbill = Perbill::from_percent(75);\n}\n\nimpl system::Trait for Test {\n    type BaseCallFilter = ();\n    type Origin = Origin;\n    type Call = ();\n    type Index = u64;\n    type BlockNumber = u64;\n    type Hash = H256;\n    type Hashing = BlakeTwo256;\n    type AccountId = AccountId;\n    type Lookup = IdentityLookup\u003cSelf::AccountId\u003e;\n    type Header = Header;\n    type Event = ();\n    type BlockHashCount = BlockHashCount;\n    type MaximumBlockWeight = MaximumBlockWeight;\n    type DbWeight = ();\n    type BlockExecutionWeight = ();\n    type ExtrinsicBaseWeight = ();\n    type MaximumExtrinsicWeight = MaximumBlockWeight;\n    type MaximumBlockLength = MaximumBlockLength;\n    type AvailableBlockRatio = AvailableBlockRatio;\n    type Version = ();\n    type ModuleToIndex = ();\n    type AccountData = ();\n    type OnNewAccount = ();\n    type OnKilledAccount = ();\n    type SystemWeightInfo = ();\n}\n\npub type FixedNumber = I64F64;\n\nparameter_types! {\n    pub const PriceCount: u32 = 10;\n    pub const PricePeriod: u32 = 60;\n    pub const ReturnType: u32 = CalcReturnType::Regular.into_u32();\n    pub const VolCorType: i64 = CalcVolatilityType::Regular.into_i64();\n}\n\npub struct TestUnixTime;\n\nimpl UnixTime for TestUnixTime {\n    fn now() -\u003e Duration {\n        NOW.with(|n| *n.borrow())\n    }\n}\n\nimpl Trait for Test {\n    type Event = ();\n    type PriceCount = PriceCount;\n    type PricePeriod = PricePeriod;\n    type ReturnType = ReturnType;\n    type VolCorType = VolCorType;\n    type UnixTime = TestUnixTime;\n    type Asset = Asset;\n    type FixedNumberBits = i128;\n    type FixedNumber = FixedNumber;\n    type Price = FixedNumber;\n    type Balances = Balances;\n}\n\npub type FinancialModule = Module\u003cTest\u003e;\n\n#[derive(Clone, Copy, Debug, Eq, PartialEq, Encode, Decode, Hash, Ord, PartialOrd)]\npub enum Asset {\n    Usd,\n    Btc,\n    Eos,\n    Eq,\n    Eth,\n}\n\npub struct Balances;\n\nimpl BalanceAware for Balances {\n    type AccountId = AccountId;\n    type Asset = Asset;\n    type Balance = FixedNumber;\n\n    fn balances(\n        account_id: \u0026Self::AccountId,\n        assets: \u0026[Self::Asset],\n    ) -\u003e Result\u003cVec\u003cSelf::Balance\u003e, DispatchError\u003e {\n        BALANCES.with(|b| {\n            Ok(assets\n                .iter()\n                .map(|\u0026a| {\n                    b.borrow()\n                        .get(\u0026(*account_id, a))\n                        .copied()\n                        .unwrap_or(FixedNumber::default())\n                })\n                .collect())\n        })\n    }\n}\n\npub fn initial_btc_prices() -\u003e Vec\u003cf64\u003e {\n    vec![\n        7_117.21, 7_429.72, 7_550.90, 7_569.94, 7_679.87, 7_795.60, 7_807.06, 8_801.04, 8_658.55,\n        8_864.77,\n    ]\n}\n\npub fn initial_eos_prices() -\u003e Vec\u003cf64\u003e {\n    vec![2.62, 2.67, 2.72, 2.72, 2.74, 2.75, 2.78, 3.02, 2.83, 2.89]\n}\n\npub fn initial_eq_prices() -\u003e Vec\u003cFixedNumber\u003e {\n    vec![\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n    ]\n}\n\npub fn initial_eth_prices() -\u003e Vec\u003cf64\u003e {\n    vec![0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\n}\n\nfn create_duration(\n    year: i32,\n    month: u32,\n    day: u32,\n    hour: u32,\n    minute: u32,\n    second: u32,\n) -\u003e Duration {\n    let timestamp = Utc\n        .ymd(year, month, day)\n        .and_hms(hour, minute, second)\n        .timestamp();\n    Duration::from_secs(timestamp as u64)\n}\n\npub fn new_test_ext() -\u003e sp_io::TestExternalities {\n    let mut t = system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap();\n\n    let prev_period_now = create_duration(2020, 9, 14, 11, 25, 0);\n    crate::GenesisConfig::\u003cTest\u003e {\n        prices: vec![\n            (\n                Asset::Btc,\n                initial_btc_prices()\n                    .into_iter()\n                    .map(FixedNumber::from_num)\n                    .collect(),\n                prev_period_now,\n            ),\n            (\n                Asset::Eos,\n                initial_eos_prices()\n                    .into_iter()\n                    .map(FixedNumber::from_num)\n                    .collect(),\n                prev_period_now,\n            ),\n            (Asset::Eq, initial_eq_prices(), prev_period_now),\n            (\n                Asset::Eth,\n                initial_eth_prices()\n                    .into_iter()\n                    .map(FixedNumber::from_num)\n                    .collect(),\n                prev_period_now,\n            ),\n        ],\n    }\n    .assimilate_storage(\u0026mut t)\n    .unwrap();\n\n    t.into()\n}\n\npub fn new_test_ext_empty_storage() -\u003e sp_io::TestExternalities {\n    system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap()\n        .into()\n}\n\npub fn new_test_ext_btc_eos_only() -\u003e sp_io::TestExternalities {\n    let mut t = system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap();\n\n    let prev_period_now = create_duration(2020, 9, 14, 11, 25, 0);\n    crate::GenesisConfig::\u003cTest\u003e {\n        prices: vec![\n            (\n                Asset::Btc,\n                initial_btc_prices()\n                    .into_iter()\n                    .map(FixedNumber::from_num)\n                    .collect(),\n                prev_period_now,\n            ),\n            (\n                Asset::Eos,\n                initial_eos_prices()\n                    .into_iter()\n                    .map(FixedNumber::from_num)\n                    .collect(),\n                prev_period_now,\n            ),\n        ],\n    }\n    .assimilate_storage(\u0026mut t)\n    .unwrap();\n\n    t.into()\n}\n","traces":[{"line":35,"address":[5500432,5500501],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[5519744],"length":1,"stats":{"Line":2},"fn_name":null},{"line":43,"address":[5519863],"length":1,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[5513040],"length":1,"stats":{"Line":1},"fn_name":"set_now"},{"line":47,"address":[5499264,5499278],"length":1,"stats":{"Line":5},"fn_name":"{{closure}}"},{"line":51,"address":[5513088],"length":1,"stats":{"Line":1},"fn_name":"set_balance"},{"line":52,"address":[5513111],"length":1,"stats":{"Line":3},"fn_name":null},{"line":61,"address":[5520081],"length":1,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[5520145],"length":1,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[5520177],"length":1,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":141,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[5513296],"length":1,"stats":{"Line":2},"fn_name":"initial_btc_prices"},{"line":160,"address":[5513303],"length":1,"stats":{"Line":2},"fn_name":null},{"line":166,"address":[5513504],"length":1,"stats":{"Line":2},"fn_name":"initial_eos_prices"},{"line":167,"address":[5513511],"length":1,"stats":{"Line":2},"fn_name":null},{"line":170,"address":[5513696,5513781],"length":1,"stats":{"Line":2},"fn_name":"initial_eq_prices"},{"line":171,"address":[5513954,5513734,5514219],"length":1,"stats":{"Line":4},"fn_name":null},{"line":172,"address":[5513758],"length":1,"stats":{"Line":2},"fn_name":null},{"line":173,"address":[5513796],"length":1,"stats":{"Line":2},"fn_name":null},{"line":174,"address":[5513819],"length":1,"stats":{"Line":2},"fn_name":null},{"line":175,"address":[5513836],"length":1,"stats":{"Line":2},"fn_name":null},{"line":176,"address":[5513853],"length":1,"stats":{"Line":2},"fn_name":null},{"line":177,"address":[5513870],"length":1,"stats":{"Line":2},"fn_name":null},{"line":178,"address":[5513887],"length":1,"stats":{"Line":2},"fn_name":null},{"line":179,"address":[5513904],"length":1,"stats":{"Line":2},"fn_name":null},{"line":180,"address":[5513921],"length":1,"stats":{"Line":2},"fn_name":null},{"line":181,"address":[5513938],"length":1,"stats":{"Line":2},"fn_name":null},{"line":185,"address":[5514256],"length":1,"stats":{"Line":2},"fn_name":"initial_eth_prices"},{"line":186,"address":[5514263],"length":1,"stats":{"Line":2},"fn_name":null},{"line":189,"address":[5514384],"length":1,"stats":{"Line":2},"fn_name":"create_duration"},{"line":197,"address":[5514415],"length":1,"stats":{"Line":2},"fn_name":null},{"line":201,"address":[5514536],"length":1,"stats":{"Line":2},"fn_name":null},{"line":204,"address":[5514623,5514576],"length":1,"stats":{"Line":2},"fn_name":"new_test_ext"},{"line":205,"address":[5514586,5514654],"length":1,"stats":{"Line":4},"fn_name":null},{"line":209,"address":[5514760],"length":1,"stats":{"Line":2},"fn_name":null},{"line":211,"address":[5515321,5515469,5515928,5514820,5515030,5515210],"length":1,"stats":{"Line":4},"fn_name":null},{"line":242,"address":[5515775],"length":1,"stats":{"Line":2},"fn_name":null},{"line":245,"address":[5516119,5516080],"length":1,"stats":{"Line":1},"fn_name":"new_test_ext_empty_storage"},{"line":246,"address":[5516204,5516090,5516147],"length":1,"stats":{"Line":3},"fn_name":null},{"line":252,"address":[5516256,5516303],"length":1,"stats":{"Line":1},"fn_name":"new_test_ext_btc_eos_only"},{"line":253,"address":[5516334,5516266],"length":1,"stats":{"Line":2},"fn_name":null},{"line":257,"address":[5516440],"length":1,"stats":{"Line":1},"fn_name":null},{"line":259,"address":[5516861,5517236,5516500,5516710],"length":1,"stats":{"Line":2},"fn_name":null},{"line":281,"address":[5517083],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":48,"coverable":55},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","financial","src","tests.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nuse super::*;\nuse crate::mock::*;\nuse crate::{CalcReturnType, CalcVolatilityType, Error, Financial, PriceUpdate};\nuse approx::assert_abs_diff_eq;\nuse chrono::prelude::*;\nuse core::time::Duration;\nuse financial_primitives::OnPriceSet;\nuse frame_support::assert_ok;\nuse frame_support::dispatch::DispatchError;\nuse sp_std::ops::Range;\nuse substrate_fixed::traits::LossyInto;\n\nfn create_duration(\n    year: i32,\n    month: u32,\n    day: u32,\n    hour: u32,\n    minute: u32,\n    second: u32,\n) -\u003e Duration {\n    let timestamp = Utc\n        .ymd(year, month, day)\n        .and_hms(hour, minute, second)\n        .timestamp();\n    Duration::from_secs(timestamp as u64)\n}\n\n#[cfg(test)]\nmod price_period {\n    use super::super::*;\n    use super::create_duration;\n\n    #[test]\n    fn info_for_neighbour_periods() {\n        let period_start = create_duration(2020, 9, 14, 12, 31, 0);\n        let now = create_duration(2020, 9, 14, 13, 2, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_curr_period_info(\u0026period, period_start, now);\n        let expected = Ok((create_duration(2020, 9, 14, 13, 0, 0), 1));\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn info_for_distant_periods() {\n        let period_start = create_duration(2020, 9, 14, 12, 31, 0);\n        let now = create_duration(2020, 9, 15, 7, 2, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_curr_period_info(\u0026period, period_start, now);\n        let expected = Ok((create_duration(2020, 9, 15, 7, 0, 0), 19));\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn invalid_period_start() {\n        let period_start = create_duration(2020, 9, 14, 12, 31, 0);\n        let now = create_duration(2020, 9, 14, 12, 42, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Err(PricePeriodChangeError::InvalidPeriodStart);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn period_remains_unchanged() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 12, 42, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Ok(PricePeriodChange {\n            period_start,\n            action: PricePeriodAction::RemainsUnchanged,\n        });\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn period_changed_slightly() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 13, 2, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Ok(PricePeriodChange {\n            period_start: create_duration(2020, 9, 14, 13, 0, 0),\n            action: PricePeriodAction::StartedNew(0),\n        });\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn period_changed_significantly() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 15, 7, 2, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Ok(PricePeriodChange {\n            period_start: create_duration(2020, 9, 15, 7, 0, 0),\n            action: PricePeriodAction::StartedNew(18),\n        });\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn period_is_in_the_past() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 12, 16, 27, 10);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Err(PricePeriodChangeError::PeriodIsInThePast);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn zero_period() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 15, 7, 2, 0);\n\n        // period is one hour\n        let period = PricePeriod(0);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Err(PricePeriodChangeError::DivisionByZero);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn elapsed_period_count_is_too_large() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = Duration::from_secs(u64::MAX);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Err(PricePeriodChangeError::Overflow);\n\n        assert_eq!(actual, expected);\n    }\n}\n\n#[cfg(test)]\nmod new_prices {\n    use crate::*;\n\n    #[test]\n    fn some_last_price_no_empty_periods() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 0, 5);\n        let expected = Ok(vec![123]);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn some_last_price_some_empty_periods_less_than_max() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 3, 5);\n        let expected = Ok(vec![555, 555, 555, 123]);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn some_last_price_some_empty_periods_equal_to_max() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 4, 5);\n        let expected = Ok(vec![555, 555, 555, 555, 123]);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn some_last_price_some_empty_periods_slightly_more_than_max() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 5, 5);\n        let expected = Ok(vec![555, 555, 555, 555, 123]);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn some_last_price_some_empty_periods_significantly_more_than_max() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 27, 5);\n        let expected = Ok(vec![555, 555, 555, 555, 123]);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn max_periods_is_zero() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 27, 0);\n        let expected = Err(GetNewPricesError::Overflow);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn max_periods_is_one() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 3, 1);\n        let expected = Ok(vec![123]);\n\n        assert_eq!(actual, expected);\n    }\n}\n\n#[cfg(test)]\nmod index_range {\n    use crate::*;\n\n    #[test]\n    fn empty_range() {\n        let actual = get_index_range(\u0026(3..3), \u0026(0..1));\n        let expected = Err(MathError::InvalidArgument);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn empty_intersaction() {\n        let actual = get_index_range(\u0026(0..5), \u0026(4..4));\n        let expected = Ok(0..0);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn intersaction_not_included_completely() {\n        let actual = get_index_range(\u0026(0..5), \u0026(4..6));\n        let expected = Err(MathError::InvalidArgument);\n\n        assert_eq!(actual, expected);\n    }\n}\n\n#[cfg(test)]\nmod range_intersection {\n    use crate::*;\n\n    #[test]\n    fn one_range() {\n        let r = 0..10;\n        let v: Vec\u003c_\u003e = vec![r.clone()];\n        let actual = get_range_intersection(v.iter()).unwrap();\n        let expected = r;\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn empty_range() {\n        let r = 0..0;\n        let v: Vec\u003c_\u003e = vec![r.clone()];\n        let actual = get_range_intersection(v.iter()).unwrap();\n        let expected = r;\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn empty_iterator() {\n        let v: Vec\u003cRange\u003ci32\u003e\u003e = vec![];\n        let actual = get_range_intersection(v.iter());\n        let expected = Err(MathError::NotEnoughPoints);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn not_intersected_ranges() {\n        let v: Vec\u003c_\u003e = vec![0..10, 11..12];\n        let actual = get_range_intersection(v.iter());\n        let expected = Err(MathError::NotEnoughPoints);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn two_intersected_ranges() {\n        let v: Vec\u003c_\u003e = vec![0..10, 9..12];\n        let actual = get_range_intersection(v.iter()).unwrap();\n        let expected = 9..10;\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn three_intersected_ranges() {\n        let v: Vec\u003c_\u003e = vec![0..11, 9..12, 8..10];\n        let actual = get_range_intersection(v.iter()).unwrap();\n        let expected = 9..10;\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn two_ranges_one_empty() {\n        let v: Vec\u003c_\u003e = vec![0..10, 9..9];\n        let actual = get_range_intersection(v.iter());\n        let expected = Err(MathError::NotEnoughPoints);\n\n        assert_eq!(actual, expected);\n    }\n}\n\n#[cfg(test)]\nmod stateful_calculations {\n    use super::super::*;\n    use super::{btc_prices, eos_prices};\n    use crate::mock::FixedNumber;\n    use approx::assert_abs_diff_eq;\n    use frame_support::assert_ok;\n    use substrate_fixed::traits::LossyInto;\n\n    macro_rules! ret_tests {\n        ($($name:ident: $value:expr,)*) =\u003e {\n        $(\n            #[test]\n            fn $name() {\n                let (return_type, prices, expected) = $value;\n                let actual = Ret::\u003cFixedNumber\u003e::new(\u0026prices, return_type);\n\n                assert_ok!(\u0026actual);\n                let actual = actual.unwrap().ret;\n\n                assert_eq!(actual.len(), expected.len());\n                for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n                    let a: f64 = a.lossy_into();\n                    assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n                }\n            }\n        )*\n        }\n    }\n\n    ret_tests! {\n        btc_regular_ret: (CalcReturnType::Regular, btc_prices(), vec![\n            0.04390906,\n            0.01631017,\n            0.00252155,\n            0.01452191,\n            0.01506927,\n            0.00147006,\n            0.12731809,\n            -0.01619013,\n            0.02381692,\n            0.01396878,\n            -0.01013840,\n            0.00170610,\n            0.01014513,\n            0.02951104,\n            0.07366250,\n            -0.01093803,\n            -0.02527465,\n            -0.08729193,\n            -0.01765902,\n            0.02356251,\n            0.05287195,\n            0.05002487,\n            -0.04166136,\n            0.00523252,\n            0.03132448,\n            0.00577308,\n            0.00025394,\n            -0.02117989,\n            -0.04633214,\n        ]),\n        eos_regular_ret: (CalcReturnType::Regular, eos_prices(), vec![\n            0.01908397,\n            0.01872659,\n            0.00000000,\n            0.00735294,\n            0.00364964,\n            0.01090909,\n            0.08633094,\n            -0.06291391,\n            0.02120141,\n            0.02076125,\n            -0.03728814,\n            -0.02112676,\n            -0.00359712,\n            -0.02888087,\n            0.02602230,\n            0.00000000,\n            0.00000000,\n            -0.11231884,\n            -0.01632653,\n            0.01244813,\n            0.03688525,\n            0.03162055,\n            -0.00766284,\n            0.01544402,\n            -0.00380228,\n            0.01526718,\n            -0.01127820,\n            -0.01140684,\n            -0.05000000,\n        ]),\n        btc_log_ret: (CalcReturnType::Log, btc_prices(), vec![\n            0.042972378,\n            0.016178588,\n            0.002518380,\n            0.014417479,\n            0.014956852,\n            0.001468981,\n            0.119841444,\n            -0.016322624,\n            0.023537722,\n            0.013872113,\n            -0.010190141,\n            0.001704649,\n            0.010094014,\n            0.029083976,\n            0.071075698,\n            -0.010998288,\n            -0.025599536,\n            -0.091339192,\n            -0.017816804,\n            0.023289199,\n            0.051521618,\n            0.048813845,\n            -0.042554076,\n            0.005218879,\n            0.030843883,\n            0.005756484,\n            0.000253911,\n            -0.021407402,\n            -0.047439819,\n        ]),\n        eos_log_ret: (CalcReturnType::Log, eos_prices(), vec![\n            0.018904155,\n            0.018553408,\n            0.000000000,\n            0.007326040,\n            0.003642991,\n            0.010850016,\n            0.082805904,\n            -0.064980120,\n            0.020979790,\n            0.020548668,\n            -0.038001118,\n            -0.021353124,\n            -0.003603608,\n            -0.029306127,\n            0.025689486,\n            0.000000000,\n            0.000000000,\n            -0.119142655,\n            -0.016461277,\n            0.012371292,\n            0.036221263,\n            0.031130919,\n            -0.007692346,\n            0.015325970,\n            -0.003809528,\n            0.015151805,\n            -0.011342277,\n            -0.011472401,\n            -0.051293294,\n        ]),\n    }\n\n    macro_rules! vol_tests {\n        ($($name:ident: $value:expr,)*) =\u003e {\n        $(\n            #[test]\n            fn $name() {\n                let (return_type, vol_cor_type, prices, expected) = $value;\n                let ret = Ret::\u003cFixedNumber\u003e::new(\u0026prices, return_type);\n\n                assert_ok!(\u0026ret);\n                let ret = ret.unwrap();\n\n                let actual = Vol::\u003cFixedNumber\u003e::new(\u0026ret, vol_cor_type);\n\n                assert_ok!(\u0026actual);\n                let actual: f64 = actual.unwrap().vol.lossy_into();\n\n                assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n            }\n        )*\n        }\n    }\n\n    vol_tests! {\n        btc_regular_regular_vol: (CalcReturnType::Regular, CalcVolatilityType::Regular, btc_prices(), 0.03957419747),\n        eos_regular_regular_vol: (CalcReturnType::Regular, CalcVolatilityType::Regular, eos_prices(), 0.03545408186),\n        btc_log_regular_vol: (CalcReturnType::Log, CalcVolatilityType::Regular, btc_prices(), 0.03897272754),\n        eos_log_regular_vol: (CalcReturnType::Log, CalcVolatilityType::Regular, eos_prices(), 0.03608986052),\n        btc_regular_exp_vol: (CalcReturnType::Regular, CalcVolatilityType::Exponential(36), btc_prices(), 0.03780489568156),\n        eos_regular_exp_vol: (CalcReturnType::Regular, CalcVolatilityType::Exponential(36), eos_prices(), 0.03163066694536),\n        btc_log_exp_vol: (CalcReturnType::Log, CalcVolatilityType::Exponential(36), btc_prices(), 0.03755128719775),\n        eos_log_exp_vol: (CalcReturnType::Log, CalcVolatilityType::Exponential(36), eos_prices(), 0.03234405779893),\n    }\n\n    macro_rules! cor_tests {\n        ($($name:ident: $value:expr,)*) =\u003e {\n        $(\n            #[test]\n            fn $name() {\n                let (return_type, vol_cor_type, prices1, prices2, expected) = $value;\n\n                let ret1 = Ret::\u003cFixedNumber\u003e::new(\u0026prices1, return_type);\n                let ret2 = Ret::\u003cFixedNumber\u003e::new(\u0026prices2, return_type);\n\n                assert_ok!(\u0026ret1);\n                let ret1 = ret1.unwrap();\n                assert_ok!(\u0026ret2);\n                let ret2 = ret2.unwrap();\n\n                let vol1 = Vol::\u003cFixedNumber\u003e::new(\u0026ret1, vol_cor_type);\n                let vol2 = Vol::\u003cFixedNumber\u003e::new(\u0026ret2, vol_cor_type);\n\n                assert_ok!(\u0026vol1);\n                let vol1 = vol1.unwrap();\n                assert_ok!(\u0026vol2);\n                let vol2 = vol2.unwrap();\n\n                let actual = cor(\u0026ret1, \u0026vol1, \u0026ret2, \u0026vol2);\n\n                assert_ok!(\u0026actual);\n                let actual: f64 = actual.unwrap().lossy_into();\n\n                assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n            }\n        )*\n        }\n    }\n\n    cor_tests! {\n        btc_eos_regular_regular_cor: (CalcReturnType::Regular, CalcVolatilityType::Regular, btc_prices(), eos_prices(), 0.83272869396),\n        btc_eos_log_regular_cor: (CalcReturnType::Log, CalcVolatilityType::Regular, btc_prices(), eos_prices(), 0.83127977977),\n        btc_eos_regular_exp_cor: (CalcReturnType::Regular, CalcVolatilityType::Exponential(36), btc_prices(), eos_prices(), 0.8417527336731),\n        btc_eos_log_exp_cor: (CalcReturnType::Log, CalcVolatilityType::Exponential(36), btc_prices(), eos_prices(), 0.8414762672002),\n    }\n}\n\n#[test]\nfn calc_linear_return_for_btc_using_only_genesis() {\n    new_test_ext().execute_with(|| {\n        let actual: Vec\u003cf64\u003e =\n            \u003cFinancialModule as Financial\u003e::calc_return(CalcReturnType::Regular, Asset::Btc)\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n        let expected = vec![\n            0.04390906,\n            0.01631017,\n            0.00252155,\n            0.01452191,\n            0.01506927,\n            0.00147006,\n            0.12731809,\n            -0.01619013,\n            0.02381692,\n        ];\n\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    });\n}\n\n#[test]\nfn calc_log_return_for_btc_using_only_genesis() {\n    new_test_ext().execute_with(|| {\n        let actual: Vec\u003cf64\u003e =\n            \u003cFinancialModule as Financial\u003e::calc_return(CalcReturnType::Log, Asset::Btc)\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n        let expected = vec![\n            0.042972378,\n            0.016178588,\n            0.002518380,\n            0.014417479,\n            0.014956852,\n            0.001468981,\n            0.119841444,\n            -0.016322624,\n            0.023537722,\n        ];\n\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    });\n}\n\n#[test]\nfn calc_linear_return_for_eos_using_only_genesis() {\n    new_test_ext().execute_with(|| {\n        let actual: Vec\u003cf64\u003e =\n            \u003cFinancialModule as Financial\u003e::calc_return(CalcReturnType::Regular, Asset::Eos)\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n        let expected = vec![\n            0.01908397,\n            0.01872659,\n            0.00000000,\n            0.00735294,\n            0.00364964,\n            0.01090909,\n            0.08633094,\n            -0.06291391,\n            0.02120141,\n        ];\n\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    });\n}\n\n#[test]\nfn calc_log_return_for_eos_using_only_genesis() {\n    new_test_ext().execute_with(|| {\n        let actual: Vec\u003cf64\u003e =\n            \u003cFinancialModule as Financial\u003e::calc_return(CalcReturnType::Log, Asset::Eos)\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n        let expected = vec![\n            0.018904155,\n            0.018553408,\n            0.000000000,\n            0.007326040,\n            0.003642991,\n            0.010850016,\n            0.082805904,\n            -0.064980120,\n            0.020979790,\n        ];\n\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    });\n}\n\n#[test]\nfn calc_linear_return_for_btc_using_some_oracle_prices() {\n    new_test_ext().execute_with(|| {\n        let prices: Vec\u003c_\u003e = vec![8_988.60, 8_897.47, 8_912.65, 9_003.07]\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n\n        let mut now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        for p in prices.into_iter() {\n            let result = \u003cFinancialModule as OnPriceSet\u003e::on_price_set(Asset::Btc, p);\n\n            assert_ok!(result);\n\n            now = now + Duration::from_secs(60 * 60);\n            set_now(now);\n        }\n\n        let actual: Vec\u003cf64\u003e =\n            \u003cFinancialModule as Financial\u003e::calc_return(CalcReturnType::Regular, Asset::Btc)\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n        let expected = vec![\n            0.01506927,\n            0.00147006,\n            0.12731809,\n            -0.01619013,\n            0.02381692,\n            0.01396878,\n            -0.01013840,\n            0.00170610,\n            0.01014513,\n        ];\n\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    });\n}\n\n#[test]\nfn initial_prices_state_with_empty_genesis() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = None;\n\n        let log = FinancialModule::price_logs(asset);\n        let expected_log = None;\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(log, expected_log);\n    });\n}\n\n#[test]\nfn initial_prices_state_with_nonempty_genesis() {\n    new_test_ext().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = None;\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = initial_btc_prices()\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn first_price_with_empty_genesis() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(period_start, now, price));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_is_in_the_past() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let past_price = FixedNumber::from_num(7_300);\n        let past_now = create_duration(2020, 9, 13, 0, 3, 0);\n        set_now(past_now);\n\n        let result = \u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, past_price);\n        let expected_result: Result\u003c(), DispatchError\u003e =\n            Err(Error::\u003cTest\u003e::PeriodIsInThePast.into());\n        assert_eq!(result, expected_result);\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(period_start, now, price));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_is_in_current_period() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let same_period_price = FixedNumber::from_num(9_100);\n        let same_period_now = create_duration(2020, 9, 14, 12, 48, 0);\n        set_now(same_period_now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(\n            asset,\n            same_period_price\n        ));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(\n            period_start,\n            same_period_now,\n            same_period_price,\n        ));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_is_in_next_period() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let next_period_start = create_duration(2020, 9, 14, 13, 0, 0);\n        let next_period_price = FixedNumber::from_num(9_100);\n        let next_period_now = create_duration(2020, 9, 14, 13, 27, 0);\n        set_now(next_period_now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(\n            asset,\n            next_period_price\n        ));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(\n            next_period_start,\n            next_period_now,\n            next_period_price,\n        ));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price, next_period_price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_is_a_few_periods_ahead() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let new_period_start = create_duration(2020, 9, 14, 16, 0, 0);\n        let new_period_price = FixedNumber::from_num(9_100);\n        let new_period_now = create_duration(2020, 9, 14, 16, 27, 0);\n        set_now(new_period_now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(\n            asset,\n            new_period_price\n        ));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(\n            new_period_start,\n            new_period_now,\n            new_period_price,\n        ));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price, price, price, price, new_period_price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_is_many_periods_ahead() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let new_period_start = create_duration(2020, 10, 3, 22, 0, 0);\n        let new_period_price = FixedNumber::from_num(9_100);\n        let new_period_now = create_duration(2020, 10, 3, 22, 27, 0);\n        set_now(new_period_now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(\n            asset,\n            new_period_price\n        ));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(\n            new_period_start,\n            new_period_now,\n            new_period_price,\n        ));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let mut expected_prices: Vec\u003cFixedNumber\u003e = vec![price; PriceCount::get() as usize - 1];\n        expected_prices.push(new_period_price);\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn wrong_now_in_the_distant_future() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let distant_future_price = FixedNumber::from_num(9_100);\n        let distant_future_now = Duration::from_secs(u64::MAX);\n        set_now(distant_future_now);\n\n        let result = \u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, distant_future_price);\n        let expected_result: Result\u003c(), DispatchError\u003e = Err(Error::\u003cTest\u003e::Overflow.into());\n        assert_eq!(result, expected_result);\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(period_start, now, price));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_has_arravied_while_prices_countainer_is_full() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let prices: Vec\u003c_\u003e = vec![1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n\n        let mut now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        for \u0026p in prices.iter() {\n            let result = \u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, p);\n\n            assert_ok!(result);\n\n            now = now + Duration::from_secs(60 * 60);\n            set_now(now);\n        }\n\n        let new_period_start = create_duration(2020, 9, 14, 22, 0, 0);\n        let new_period_price = FixedNumber::from_num(11);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(\n            asset,\n            new_period_price\n        ));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(new_period_start, now, new_period_price));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let actual_prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let mut expected_prices: Vec\u003c_\u003e = prices[1..].iter().copied().collect();\n        expected_prices.push(new_period_price);\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(actual_prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\nfn btc_prices() -\u003e Vec\u003cFixedNumber\u003e {\n    vec![\n        7_117.21, 7_429.72, 7_550.90, 7_569.94, 7_679.87, 7_795.60, 7_807.06, 8_801.04, 8_658.55,\n        8_864.77, 8_988.60, 8_897.47, 8_912.65, 9_003.07, 9_268.76, 9_951.52, 9_842.67, 9_593.90,\n        8_756.43, 8_601.80, 8_804.48, 9_269.99, 9_733.72, 9_328.20, 9_377.01, 9_670.74, 9_726.57,\n        9_729.04, 9_522.98, 9_081.76,\n    ]\n    .into_iter()\n    .map(FixedNumber::from_num)\n    .collect()\n}\n\nfn eos_prices() -\u003e Vec\u003cFixedNumber\u003e {\n    vec![\n        2.62, 2.67, 2.72, 2.72, 2.74, 2.75, 2.78, 3.02, 2.83, 2.89, 2.95, 2.84, 2.78, 2.77, 2.69,\n        2.76, 2.76, 2.76, 2.45, 2.41, 2.44, 2.53, 2.61, 2.59, 2.63, 2.62, 2.66, 2.63, 2.6, 2.47,\n    ]\n    .into_iter()\n    .map(FixedNumber::from_num)\n    .collect()\n}\n\n#[test]\nfn calc_correlation_different_price_periods_results_in_periods_intersection() {\n    new_test_ext().execute_with(|| {\n        let prices: Vec\u003c_\u003e = vec![8_988.60, 8_897.47]\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n\n        let mut now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        for p in prices.into_iter() {\n            let result = \u003cFinancialModule as OnPriceSet\u003e::on_price_set(Asset::Btc, p);\n\n            assert_ok!(result);\n\n            now = now + Duration::from_secs(60 * 60);\n            set_now(now);\n        }\n\n        let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n            CalcReturnType::Regular,\n            CalcVolatilityType::Regular,\n            Asset::Btc,\n            Asset::Eos,\n        );\n        assert_ok!(\u0026actual);\n        let (_, actual_period) = actual.unwrap();\n        let expected_period = Range {\n            start: create_duration(2020, 9, 14, 4, 0, 0),\n            end: create_duration(2020, 9, 14, 12, 0, 0),\n        };\n\n        assert_eq!(actual_period, expected_period);\n    });\n}\n\n#[cfg(test)]\nmod calc_vol {\n    use crate::*;\n    use approx::assert_abs_diff_eq;\n    use frame_support::assert_ok;\n    use mock::{new_test_ext, Asset, FinancialModule, Test};\n    use substrate_fixed::traits::LossyInto;\n\n    #[test]\n    fn calc_vol_btc_regular_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.04163212889;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_eos_regular_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0380004985;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_btc_log_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.03932894975;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_eos_log_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.03764429688;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_btc_regular_exp() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0294825719888474;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_btc_log_exp() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0282782458740207;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_eos_regular_exp() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Exponential(36),\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0246077778994953;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_eos_log_exp() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0245077247817629;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_asset_without_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Usd,\n            );\n            let expected: Result\u003c\u003cmock::Test as Trait\u003e::Price, DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::NotEnoughPoints.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_vol_regular_asset_with_big_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Eq,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0;\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_vol_exponential_asset_with_big_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Eq,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0;\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_vol_regular_asset_with_zero_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Eth,\n            );\n            let expected: Result\u003c\u003cmock::Test as Trait\u003e::Price, DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::DivisionByZero.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_vol_exponential_asset_with_zero_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Eth,\n            );\n            let expected: Result\u003c\u003cmock::Test as Trait\u003e::Price, DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::DivisionByZero.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n}\n\n#[cfg(test)]\nmod calc_corr {\n    use crate::*;\n    use approx::assert_abs_diff_eq;\n    use frame_support::assert_ok;\n    use mock::{new_test_ext, Asset, FinancialModule, Test};\n    use substrate_fixed::traits::LossyInto;\n\n    #[test]\n    fn calc_corr_btc_eos_regular_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.8836901525;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_corr_btc_eos_log_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.87585873751;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_corr_btc_eos_regular_exp() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.866920411417432;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_corr_btc_eos_log_exponential() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.860312211443148;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_corr_asset_without_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n                Asset::Usd,\n            );\n\n            let expected: Result\u003c(\u003cmock::Test as Trait\u003e::Price, Range\u003cDuration\u003e), DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::NotEnoughPoints.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_corr_regular_asset_with_big_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n                Asset::Eq,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0;\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_corr_exponential_asset_with_big_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n                Asset::Eq,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0;\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_corr_regular_asset_with_zero_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n                Asset::Eth,\n            );\n            let expected: Result\u003c(\u003cmock::Test as Trait\u003e::Price, Range\u003cDuration\u003e), DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::DivisionByZero.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_corr_exponential_asset_with_zero_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n                Asset::Eth,\n            );\n            let expected: Result\u003c(\u003cmock::Test as Trait\u003e::Price, Range\u003cDuration\u003e), DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::DivisionByZero.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n}\n\n#[cfg(test)]\nmod calc_portf {\n    use crate::*;\n    use approx::assert_abs_diff_eq;\n    use frame_support::assert_ok;\n    use mock::{new_test_ext_btc_eos_only, set_balance, Asset, FinancialModule, FixedNumber};\n    use substrate_fixed::traits::LossyInto;\n\n    #[test]\n    fn calc_portf_vol_btc_eos_regular_regular_1() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Btc, FixedNumber::from_num(10));\n            set_balance(333, Asset::Eos, FixedNumber::from_num(10000));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.03989302699122;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_portf_vol_btc_eos_regular_regular_2() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Eos, FixedNumber::from_num(35));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.03800049849557;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_portf_vol_btc_eos_regular_regular_3() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Btc, FixedNumber::from_num(15));\n            set_balance(333, Asset::Eos, FixedNumber::from_num(725));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.04150814612241;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_portf_var_btc_eos_regular_regular_1() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Btc, FixedNumber::from_num(10));\n            set_balance(333, Asset::Eos, FixedNumber::from_num(10000));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_var(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n                5,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.17744728149940;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_portf_var_btc_eos_regular_regular_2() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Eos, FixedNumber::from_num(35));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_var(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n                5,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.17840908472867;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_portf_var_btc_eos_regular_regular_3() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Btc, FixedNumber::from_num(15));\n            set_balance(333, Asset::Eos, FixedNumber::from_num(725));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_var(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n                5,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.18233883857922;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n}\n","traces":[{"line":28,"address":[4323696],"length":1,"stats":{"Line":1},"fn_name":"create_duration"},{"line":36,"address":[4323727],"length":1,"stats":{"Line":1},"fn_name":null},{"line":40,"address":[4323848],"length":1,"stats":{"Line":1},"fn_name":null},{"line":49,"address":[5411749,5411744],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":50,"address":[5748250],"length":1,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[5748311],"length":1,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[5748366],"length":1,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[5748377],"length":1,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[5748422],"length":1,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[5748657,5748553],"length":1,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[5411776,5411781],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":64,"address":[5748954],"length":1,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[5749015],"length":1,"stats":{"Line":1},"fn_name":null},{"line":68,"address":[5749070],"length":1,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[5749081],"length":1,"stats":{"Line":1},"fn_name":null},{"line":71,"address":[5749126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[5749361,5749257],"length":1,"stats":{"Line":1},"fn_name":null},{"line":77,"address":[5411808,5411813],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":78,"address":[5749658],"length":1,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[5749716],"length":1,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[5749771],"length":1,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[5749784],"length":1,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[5749854],"length":1,"stats":{"Line":1},"fn_name":null},{"line":87,"address":[5749988,5749884],"length":1,"stats":{"Line":1},"fn_name":null},{"line":91,"address":[5411845,5411840],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":92,"address":[5750297],"length":1,"stats":{"Line":1},"fn_name":null},{"line":93,"address":[5750355],"length":1,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[5750410],"length":1,"stats":{"Line":1},"fn_name":null},{"line":98,"address":[5750423],"length":1,"stats":{"Line":1},"fn_name":null},{"line":99,"address":[5750512],"length":1,"stats":{"Line":1},"fn_name":null},{"line":101,"address":[5750496],"length":1,"stats":{"Line":1},"fn_name":null},{"line":104,"address":[5750719,5750615],"length":1,"stats":{"Line":1},"fn_name":null},{"line":108,"address":[5411877,5411872],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":109,"address":[5751017],"length":1,"stats":{"Line":1},"fn_name":null},{"line":110,"address":[5751078],"length":1,"stats":{"Line":1},"fn_name":null},{"line":113,"address":[5751133],"length":1,"stats":{"Line":1},"fn_name":null},{"line":115,"address":[5751152],"length":1,"stats":{"Line":1},"fn_name":null},{"line":116,"address":[5751297],"length":1,"stats":{"Line":1},"fn_name":null},{"line":117,"address":[5751230],"length":1,"stats":{"Line":1},"fn_name":null},{"line":118,"address":[5751270],"length":1,"stats":{"Line":1},"fn_name":null},{"line":121,"address":[5751504,5751400],"length":1,"stats":{"Line":1},"fn_name":null},{"line":125,"address":[5411909,5411904],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":126,"address":[5751801],"length":1,"stats":{"Line":1},"fn_name":null},{"line":127,"address":[5751862],"length":1,"stats":{"Line":1},"fn_name":null},{"line":130,"address":[5751917],"length":1,"stats":{"Line":1},"fn_name":null},{"line":132,"address":[5751936],"length":1,"stats":{"Line":1},"fn_name":null},{"line":133,"address":[5752081],"length":1,"stats":{"Line":1},"fn_name":null},{"line":134,"address":[5752014],"length":1,"stats":{"Line":1},"fn_name":null},{"line":135,"address":[5752054],"length":1,"stats":{"Line":1},"fn_name":null},{"line":138,"address":[5752184,5752288],"length":1,"stats":{"Line":1},"fn_name":null},{"line":142,"address":[5411936,5411941],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":143,"address":[5752585],"length":1,"stats":{"Line":1},"fn_name":null},{"line":144,"address":[5752640],"length":1,"stats":{"Line":1},"fn_name":null},{"line":147,"address":[5752701],"length":1,"stats":{"Line":1},"fn_name":null},{"line":149,"address":[5752714],"length":1,"stats":{"Line":1},"fn_name":null},{"line":150,"address":[5752784],"length":1,"stats":{"Line":1},"fn_name":null},{"line":152,"address":[5752814,5752918],"length":1,"stats":{"Line":1},"fn_name":null},{"line":156,"address":[5411973,5411968],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":157,"address":[5753225],"length":1,"stats":{"Line":1},"fn_name":null},{"line":158,"address":[5753283],"length":1,"stats":{"Line":1},"fn_name":null},{"line":161,"address":[5753338],"length":1,"stats":{"Line":1},"fn_name":null},{"line":163,"address":[5753351],"length":1,"stats":{"Line":1},"fn_name":null},{"line":164,"address":[5753421],"length":1,"stats":{"Line":1},"fn_name":null},{"line":166,"address":[5753451,5753555],"length":1,"stats":{"Line":1},"fn_name":null},{"line":170,"address":[5412000,5412005],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":171,"address":[5753849],"length":1,"stats":{"Line":1},"fn_name":null},{"line":172,"address":[5753904],"length":1,"stats":{"Line":1},"fn_name":null},{"line":175,"address":[5753940],"length":1,"stats":{"Line":1},"fn_name":null},{"line":177,"address":[5753953],"length":1,"stats":{"Line":1},"fn_name":null},{"line":178,"address":[5754023],"length":1,"stats":{"Line":1},"fn_name":null},{"line":180,"address":[5754157,5754053],"length":1,"stats":{"Line":1},"fn_name":null},{"line":189,"address":[4687936,4687941],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":190,"address":[5501369],"length":1,"stats":{"Line":1},"fn_name":null},{"line":191,"address":[5501473,5501417],"length":1,"stats":{"Line":2},"fn_name":null},{"line":193,"address":[5501507,5501629],"length":1,"stats":{"Line":1},"fn_name":null},{"line":197,"address":[4687973,4687968],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":198,"address":[5502007],"length":1,"stats":{"Line":1},"fn_name":null},{"line":199,"address":[5502144,5502065],"length":1,"stats":{"Line":2},"fn_name":null},{"line":201,"address":[5502181,5502312],"length":1,"stats":{"Line":1},"fn_name":null},{"line":205,"address":[4688000,4688005],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":206,"address":[5502695],"length":1,"stats":{"Line":1},"fn_name":null},{"line":207,"address":[5502753,5502831],"length":1,"stats":{"Line":2},"fn_name":null},{"line":209,"address":[5502865,5502987],"length":1,"stats":{"Line":1},"fn_name":null},{"line":213,"address":[4688037,4688032],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":214,"address":[5503367],"length":1,"stats":{"Line":1},"fn_name":null},{"line":215,"address":[5503424,5503502],"length":1,"stats":{"Line":2},"fn_name":null},{"line":217,"address":[5503536,5503658],"length":1,"stats":{"Line":1},"fn_name":null},{"line":221,"address":[4688064,4688069],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":222,"address":[5504039],"length":1,"stats":{"Line":1},"fn_name":null},{"line":223,"address":[5504097,5504175],"length":1,"stats":{"Line":2},"fn_name":null},{"line":225,"address":[5504209,5504331],"length":1,"stats":{"Line":1},"fn_name":null},{"line":229,"address":[4688096,4688101],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":230,"address":[5504714],"length":1,"stats":{"Line":1},"fn_name":null},{"line":231,"address":[5504756],"length":1,"stats":{"Line":1},"fn_name":null},{"line":233,"address":[5504904,5504770],"length":1,"stats":{"Line":1},"fn_name":null},{"line":237,"address":[4688128,4688133],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":238,"address":[5505287],"length":1,"stats":{"Line":1},"fn_name":null},{"line":239,"address":[5505340,5505396],"length":1,"stats":{"Line":2},"fn_name":null},{"line":241,"address":[5505430,5505552],"length":1,"stats":{"Line":1},"fn_name":null},{"line":250,"address":[5336272,5336277],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":251,"address":[5804231],"length":1,"stats":{"Line":1},"fn_name":null},{"line":252,"address":[5804255],"length":1,"stats":{"Line":1},"fn_name":null},{"line":254,"address":[5804279,5804380],"length":1,"stats":{"Line":1},"fn_name":null},{"line":258,"address":[5336309,5336304],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":259,"address":[5804679],"length":1,"stats":{"Line":1},"fn_name":null},{"line":260,"address":[5804703],"length":1,"stats":{"Line":1},"fn_name":null},{"line":262,"address":[5804761,5804862],"length":1,"stats":{"Line":1},"fn_name":null},{"line":266,"address":[5336341,5336336],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":267,"address":[5805159],"length":1,"stats":{"Line":1},"fn_name":null},{"line":268,"address":[5805183],"length":1,"stats":{"Line":1},"fn_name":null},{"line":270,"address":[5805207,5805308],"length":1,"stats":{"Line":1},"fn_name":null},{"line":279,"address":[5413008,5413089],"length":1,"stats":{"Line":3},"fn_name":"one_range"},{"line":280,"address":[5413015],"length":1,"stats":{"Line":1},"fn_name":null},{"line":281,"address":[5413104,5413768,5413047],"length":1,"stats":{"Line":2},"fn_name":null},{"line":282,"address":[5413168,5413254],"length":1,"stats":{"Line":2},"fn_name":null},{"line":283,"address":[5413313],"length":1,"stats":{"Line":1},"fn_name":null},{"line":285,"address":[5413457,5413349],"length":1,"stats":{"Line":1},"fn_name":null},{"line":289,"address":[5413840,5413921],"length":1,"stats":{"Line":3},"fn_name":"empty_range"},{"line":290,"address":[5413847],"length":1,"stats":{"Line":1},"fn_name":null},{"line":291,"address":[5413879,5413936,5414600],"length":1,"stats":{"Line":2},"fn_name":null},{"line":292,"address":[5414000,5414086],"length":1,"stats":{"Line":2},"fn_name":null},{"line":293,"address":[5414145],"length":1,"stats":{"Line":1},"fn_name":null},{"line":295,"address":[5414289,5414181],"length":1,"stats":{"Line":1},"fn_name":null},{"line":299,"address":[5414694,5414672],"length":1,"stats":{"Line":3},"fn_name":"empty_iterator"},{"line":300,"address":[5414679],"length":1,"stats":{"Line":1},"fn_name":null},{"line":301,"address":[5414794,5414717],"length":1,"stats":{"Line":2},"fn_name":null},{"line":302,"address":[5414801],"length":1,"stats":{"Line":1},"fn_name":null},{"line":304,"address":[5414839,5414950],"length":1,"stats":{"Line":1},"fn_name":null},{"line":308,"address":[5415296,5415431],"length":1,"stats":{"Line":3},"fn_name":"not_intersected_ranges"},{"line":309,"address":[5415303],"length":1,"stats":{"Line":1},"fn_name":null},{"line":310,"address":[5415531,5415454],"length":1,"stats":{"Line":2},"fn_name":null},{"line":311,"address":[5415538],"length":1,"stats":{"Line":1},"fn_name":null},{"line":313,"address":[5415576,5415687],"length":1,"stats":{"Line":1},"fn_name":null},{"line":317,"address":[5416032,5416167],"length":1,"stats":{"Line":3},"fn_name":"two_intersected_ranges"},{"line":318,"address":[5416039],"length":1,"stats":{"Line":1},"fn_name":null},{"line":319,"address":[5416190,5416267],"length":1,"stats":{"Line":2},"fn_name":null},{"line":320,"address":[5416326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":322,"address":[5416356,5416464],"length":1,"stats":{"Line":1},"fn_name":null},{"line":326,"address":[5416800,5416979],"length":1,"stats":{"Line":3},"fn_name":"three_intersected_ranges"},{"line":327,"address":[5416807],"length":1,"stats":{"Line":1},"fn_name":null},{"line":328,"address":[5417002,5417085],"length":1,"stats":{"Line":2},"fn_name":null},{"line":329,"address":[5417144],"length":1,"stats":{"Line":1},"fn_name":null},{"line":331,"address":[5417174,5417282],"length":1,"stats":{"Line":1},"fn_name":null},{"line":335,"address":[5417751,5417616],"length":1,"stats":{"Line":3},"fn_name":"two_ranges_one_empty"},{"line":336,"address":[5417623],"length":1,"stats":{"Line":1},"fn_name":null},{"line":337,"address":[5417851,5417774],"length":1,"stats":{"Line":2},"fn_name":null},{"line":338,"address":[5417858],"length":1,"stats":{"Line":1},"fn_name":null},{"line":340,"address":[5418007,5417896],"length":1,"stats":{"Line":1},"fn_name":null},{"line":357,"address":[4237712,4234195,4234128,4226976,4230560,4230627,4227043,4237779],"length":1,"stats":{"Line":12},"fn_name":"btc_regular_ret"},{"line":358,"address":[4238348,4234782,4231196,4227630],"length":1,"stats":{"Line":4},"fn_name":null},{"line":359,"address":[4227731,4234883,4234947,4238449,4231297,4231361,4227795,4238513],"length":1,"stats":{"Line":8},"fn_name":null},{"line":361,"address":[4227840,4234992,4238558,4231406],"length":1,"stats":{"Line":4},"fn_name":null},{"line":362,"address":[4228097,4231663,4238815,4235249],"length":1,"stats":{"Line":4},"fn_name":null},{"line":364,"address":[4235441,4235399,4231855,4231813,4228289,4239007,4232072,4235658,4239224,4228506,4228247,4238965],"length":1,"stats":{"Line":8},"fn_name":null},{"line":365,"address":[4232006,4229089,4232441,4236276,4228440,4236583,4229124,4236241,4229431,4232655,4241114,4228875,4237548,4240149,4239842,4230396,4233962,4236027,4239593,4232690,4232997,4239158,4239807,4235592],"length":1,"stats":{"Line":16},"fn_name":null},{"line":366,"address":[4239944,4236378,4229226,4232792],"length":1,"stats":{"Line":4},"fn_name":null},{"line":367,"address":[4239992,4229274,4233002,4240154,4232840,4236426,4229436,4236588],"length":1,"stats":{"Line":4},"fn_name":null},{"line":375,"address":[4226988,4227068,4227558],"length":1,"stats":{"Line":3},"fn_name":null},{"line":406,"address":[4231124,4230572,4230652],"length":1,"stats":{"Line":3},"fn_name":null},{"line":437,"address":[4234710,4234140,4234220],"length":1,"stats":{"Line":3},"fn_name":null},{"line":468,"address":[4237724,4238276,4237804],"length":1,"stats":{"Line":3},"fn_name":null},{"line":505,"address":[4258912,4248878,4251401,4253929,4246366,4243854,4251328,4243792,4256384,4248816,4258985,4241280,4241342,4253856,4256457,4246304],"length":1,"stats":{"Line":24},"fn_name":"btc_regular_regular_vol"},{"line":506,"address":[4251502,4259086,4256558,4246467,4241443,4243955,4248979,4254030],"length":1,"stats":{"Line":8},"fn_name":null},{"line":507,"address":[4259258,4254202,4241567,4244127,4251674,4259210,4254154,4256730,4246591,4249103,4256682,4241615,4246639,4251626,4249151,4244079],"length":1,"stats":{"Line":16},"fn_name":null},{"line":509,"address":[4251719,4256775,4249196,4244172,4241660,4246684,4259303,4254247],"length":1,"stats":{"Line":8},"fn_name":null},{"line":510,"address":[4249453,4251976,4244429,4257032,4241917,4246941,4254504,4259560],"length":1,"stats":{"Line":8},"fn_name":null},{"line":512,"address":[4247073,4254636,4257164,4249585,4242049,4252108,4244561,4259692],"length":1,"stats":{"Line":8},"fn_name":null},{"line":514,"address":[4247088,4252123,4252187,4244576,4244640,4254651,4257243,4259771,4254715,4242064,4257179,4242128,4247152,4259707,4249600,4249664],"length":1,"stats":{"Line":8},"fn_name":null},{"line":515,"address":[4247365,4252400,4244853,4242341,4257456,4249877,4254928,4259984],"length":1,"stats":{"Line":8},"fn_name":null},{"line":517,"address":[4250102,4257864,4250285,4247773,4255153,4252808,4260392,4247590,4252625,4257681,4242749,4242566,4245261,4255336,4260209,4245078],"length":1,"stats":{"Line":8},"fn_name":null},{"line":524,"address":[4241292,4241357],"length":1,"stats":{"Line":2},"fn_name":null},{"line":525,"address":[4243804,4243869],"length":1,"stats":{"Line":2},"fn_name":null},{"line":526,"address":[4246316,4246381],"length":1,"stats":{"Line":2},"fn_name":null},{"line":527,"address":[4248893,4248828],"length":1,"stats":{"Line":2},"fn_name":null},{"line":528,"address":[4251416,4251340],"length":1,"stats":{"Line":2},"fn_name":null},{"line":529,"address":[4253944,4253868],"length":1,"stats":{"Line":2},"fn_name":null},{"line":530,"address":[4256396,4256472],"length":1,"stats":{"Line":2},"fn_name":null},{"line":531,"address":[4258924,4259000],"length":1,"stats":{"Line":2},"fn_name":null},{"line":538,"address":[4269913,4261518,4265632,4269824,4265710,4261440,4274105,4274016],"length":1,"stats":{"Line":12},"fn_name":"btc_eos_regular_regular_cor"},{"line":539,"address":[4261666,4265858,4270061,4274253],"length":1,"stats":{"Line":4},"fn_name":null},{"line":541,"address":[4274409,4261822,4270217,4266095,4270298,4266014,4274490,4261903],"length":1,"stats":{"Line":8},"fn_name":null},{"line":542,"address":[4266148,4274543,4261956,4270351],"length":1,"stats":{"Line":4},"fn_name":null},{"line":544,"address":[4262031,4266223,4270426,4274618],"length":1,"stats":{"Line":4},"fn_name":null},{"line":545,"address":[4262288,4270683,4266480,4274875],"length":1,"stats":{"Line":4},"fn_name":null},{"line":546,"address":[4262636,4275223,4266582,4274977,4271031,4270785,4262390,4266828],"length":1,"stats":{"Line":4},"fn_name":null},{"line":547,"address":[4275252,4271060,4266857,4262665],"length":1,"stats":{"Line":4},"fn_name":null},{"line":549,"address":[4262797,4275384,4271192,4266989],"length":1,"stats":{"Line":4},"fn_name":null},{"line":550,"address":[4262867,4267034,4262842,4271237,4271262,4275429,4267059,4275454],"length":1,"stats":{"Line":8},"fn_name":null},{"line":552,"address":[4262875,4267067,4275462,4271270],"length":1,"stats":{"Line":4},"fn_name":null},{"line":553,"address":[4271527,4275719,4267324,4263132],"length":1,"stats":{"Line":4},"fn_name":null},{"line":554,"address":[4276099,4271907,4263266,4263512,4267458,4267704,4271661,4275853],"length":1,"stats":{"Line":4},"fn_name":null},{"line":555,"address":[4263541,4271936,4276128,4267733],"length":1,"stats":{"Line":4},"fn_name":null},{"line":557,"address":[4272110,4276302,4263715,4267907],"length":1,"stats":{"Line":4},"fn_name":null},{"line":559,"address":[4267978,4276309,4272181,4263722,4267914,4272117,4263786,4276373],"length":1,"stats":{"Line":4},"fn_name":null},{"line":560,"address":[4268191,4272394,4276586,4263999],"length":1,"stats":{"Line":4},"fn_name":null},{"line":562,"address":[4272697,4276714,4268494,4272522,4268319,4264302,4276889,4264127],"length":1,"stats":{"Line":4},"fn_name":null},{"line":569,"address":[4261452,4261541,4261845],"length":1,"stats":{"Line":2},"fn_name":null},{"line":570,"address":[4265733,4265644,4266037],"length":1,"stats":{"Line":2},"fn_name":null},{"line":571,"address":[4270240,4269836,4269936],"length":1,"stats":{"Line":2},"fn_name":null},{"line":572,"address":[4274028,4274128,4274432],"length":1,"stats":{"Line":2},"fn_name":null},{"line":577,"address":[4325283,4325264],"length":1,"stats":{"Line":3},"fn_name":"calc_linear_return_for_btc_using_only_genesis"},{"line":578,"address":[4325271,4325303],"length":1,"stats":{"Line":3},"fn_name":null},{"line":579,"address":[5281692],"length":1,"stats":{"Line":1},"fn_name":null},{"line":580,"address":[5281789,5281716],"length":1,"stats":{"Line":2},"fn_name":null},{"line":583,"address":[5281632,5281651],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":584,"address":[5281876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":585,"address":[5281894,5282066],"length":1,"stats":{"Line":2},"fn_name":null},{"line":597,"address":[5282074,5282326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":598,"address":[5282260,5282695,5282909,5282944,5283183,5284097],"length":1,"stats":{"Line":4},"fn_name":null},{"line":599,"address":[5283188,5283026],"length":1,"stats":{"Line":1},"fn_name":null},{"line":605,"address":[4325360,4325379],"length":1,"stats":{"Line":3},"fn_name":"calc_log_return_for_btc_using_only_genesis"},{"line":606,"address":[4325399,4325367],"length":1,"stats":{"Line":3},"fn_name":null},{"line":607,"address":[5284300],"length":1,"stats":{"Line":1},"fn_name":null},{"line":608,"address":[5284324,5284397],"length":1,"stats":{"Line":2},"fn_name":null},{"line":611,"address":[5284259,5284240],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":612,"address":[5284484],"length":1,"stats":{"Line":1},"fn_name":null},{"line":613,"address":[5284502,5284674],"length":1,"stats":{"Line":2},"fn_name":null},{"line":625,"address":[5284934,5284682],"length":1,"stats":{"Line":1},"fn_name":null},{"line":626,"address":[5285791,5286705,5285552,5284868,5285303,5285517],"length":1,"stats":{"Line":4},"fn_name":null},{"line":627,"address":[5285634,5285796],"length":1,"stats":{"Line":1},"fn_name":null},{"line":633,"address":[4325456,4325475],"length":1,"stats":{"Line":3},"fn_name":"calc_linear_return_for_eos_using_only_genesis"},{"line":634,"address":[4325495,4325463],"length":1,"stats":{"Line":3},"fn_name":null},{"line":635,"address":[5286908],"length":1,"stats":{"Line":1},"fn_name":null},{"line":636,"address":[5287005,5286932],"length":1,"stats":{"Line":2},"fn_name":null},{"line":639,"address":[5286848,5286867],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":640,"address":[5287092],"length":1,"stats":{"Line":1},"fn_name":null},{"line":641,"address":[5287276,5287110],"length":1,"stats":{"Line":2},"fn_name":null},{"line":653,"address":[5287284,5287536],"length":1,"stats":{"Line":1},"fn_name":null},{"line":654,"address":[5289307,5288119,5287905,5287470,5288154,5288393],"length":1,"stats":{"Line":4},"fn_name":null},{"line":655,"address":[5288398,5288236],"length":1,"stats":{"Line":1},"fn_name":null},{"line":661,"address":[4325571,4325552],"length":1,"stats":{"Line":3},"fn_name":"calc_log_return_for_eos_using_only_genesis"},{"line":662,"address":[4325559,4325591],"length":1,"stats":{"Line":3},"fn_name":null},{"line":663,"address":[5289516],"length":1,"stats":{"Line":1},"fn_name":null},{"line":664,"address":[5289613,5289540],"length":1,"stats":{"Line":2},"fn_name":null},{"line":667,"address":[5289456,5289475],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":668,"address":[5289700],"length":1,"stats":{"Line":1},"fn_name":null},{"line":669,"address":[5289718,5289884],"length":1,"stats":{"Line":2},"fn_name":null},{"line":681,"address":[5290144,5289892],"length":1,"stats":{"Line":1},"fn_name":null},{"line":682,"address":[5290078,5290727,5290762,5291915,5291001,5290513],"length":1,"stats":{"Line":4},"fn_name":null},{"line":683,"address":[5290844,5291006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":689,"address":[4325648,4325667],"length":1,"stats":{"Line":3},"fn_name":"calc_linear_return_for_btc_using_some_oracle_prices"},{"line":690,"address":[4325687,4325655],"length":1,"stats":{"Line":3},"fn_name":null},{"line":691,"address":[5292124,5292263],"length":1,"stats":{"Line":2},"fn_name":null},{"line":694,"address":[5292326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":696,"address":[5292363],"length":1,"stats":{"Line":1},"fn_name":null},{"line":697,"address":[5292415],"length":1,"stats":{"Line":1},"fn_name":null},{"line":699,"address":[5292652,5292437,5293295,5292727],"length":1,"stats":{"Line":3},"fn_name":null},{"line":700,"address":[5292793],"length":1,"stats":{"Line":1},"fn_name":null},{"line":702,"address":[5292831],"length":1,"stats":{"Line":1},"fn_name":null},{"line":704,"address":[5293127],"length":1,"stats":{"Line":1},"fn_name":null},{"line":705,"address":[5293273],"length":1,"stats":{"Line":1},"fn_name":null},{"line":709,"address":[5293300],"length":1,"stats":{"Line":1},"fn_name":null},{"line":712,"address":[5292083,5292064],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":713,"address":[5293446],"length":1,"stats":{"Line":1},"fn_name":null},{"line":714,"address":[5293636,5293464],"length":1,"stats":{"Line":2},"fn_name":null},{"line":726,"address":[5293644,5293896],"length":1,"stats":{"Line":1},"fn_name":null},{"line":727,"address":[5294514,5294753,5295721,5294265,5294479,5293830],"length":1,"stats":{"Line":4},"fn_name":null},{"line":728,"address":[5294758,5294596],"length":1,"stats":{"Line":1},"fn_name":null},{"line":734,"address":[4325744,4325763],"length":1,"stats":{"Line":3},"fn_name":"initial_prices_state_with_empty_genesis"},{"line":735,"address":[4325751,4325783],"length":1,"stats":{"Line":3},"fn_name":null},{"line":736,"address":[5295927],"length":1,"stats":{"Line":1},"fn_name":null},{"line":738,"address":[5295935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":739,"address":[5295970],"length":1,"stats":{"Line":1},"fn_name":null},{"line":741,"address":[5295982],"length":1,"stats":{"Line":1},"fn_name":null},{"line":742,"address":[5296003],"length":1,"stats":{"Line":1},"fn_name":null},{"line":744,"address":[5296023,5296270],"length":1,"stats":{"Line":1},"fn_name":null},{"line":745,"address":[5296619,5296175,5296595],"length":1,"stats":{"Line":2},"fn_name":null},{"line":750,"address":[4325840,4325859],"length":1,"stats":{"Line":3},"fn_name":"initial_prices_state_with_nonempty_genesis"},{"line":751,"address":[4325847,4325879],"length":1,"stats":{"Line":3},"fn_name":null},{"line":752,"address":[5297031],"length":1,"stats":{"Line":1},"fn_name":null},{"line":754,"address":[5297039],"length":1,"stats":{"Line":1},"fn_name":null},{"line":755,"address":[5297074],"length":1,"stats":{"Line":1},"fn_name":null},{"line":757,"address":[5297086],"length":1,"stats":{"Line":1},"fn_name":null},{"line":758,"address":[5297218,5297138],"length":1,"stats":{"Line":2},"fn_name":null},{"line":759,"address":[5297233,5297294],"length":1,"stats":{"Line":2},"fn_name":null},{"line":764,"address":[5297324],"length":1,"stats":{"Line":1},"fn_name":null},{"line":765,"address":[5297395],"length":1,"stats":{"Line":1},"fn_name":null},{"line":766,"address":[5297431,5297467],"length":1,"stats":{"Line":2},"fn_name":null},{"line":768,"address":[5297690,5297482],"length":1,"stats":{"Line":1},"fn_name":null},{"line":769,"address":[5298057,5298170,5297595],"length":1,"stats":{"Line":2},"fn_name":null},{"line":770,"address":[5298500,5298063],"length":1,"stats":{"Line":1},"fn_name":null},{"line":775,"address":[4325936,4325955],"length":1,"stats":{"Line":3},"fn_name":"first_price_with_empty_genesis"},{"line":776,"address":[4325975,4325943],"length":1,"stats":{"Line":3},"fn_name":null},{"line":777,"address":[5298999],"length":1,"stats":{"Line":1},"fn_name":null},{"line":779,"address":[5299012],"length":1,"stats":{"Line":1},"fn_name":null},{"line":781,"address":[5299074],"length":1,"stats":{"Line":1},"fn_name":null},{"line":782,"address":[5299138],"length":1,"stats":{"Line":1},"fn_name":null},{"line":783,"address":[5299214],"length":1,"stats":{"Line":1},"fn_name":null},{"line":785,"address":[5299219],"length":1,"stats":{"Line":1},"fn_name":null},{"line":787,"address":[5299521],"length":1,"stats":{"Line":1},"fn_name":null},{"line":788,"address":[5299542],"length":1,"stats":{"Line":1},"fn_name":null},{"line":790,"address":[5299658],"length":1,"stats":{"Line":1},"fn_name":null},{"line":791,"address":[5299790,5299710],"length":1,"stats":{"Line":2},"fn_name":null},{"line":792,"address":[5299807],"length":1,"stats":{"Line":1},"fn_name":null},{"line":794,"address":[5299873],"length":1,"stats":{"Line":1},"fn_name":null},{"line":795,"address":[5299909,5299945],"length":1,"stats":{"Line":2},"fn_name":null},{"line":797,"address":[5299960,5300168],"length":1,"stats":{"Line":1},"fn_name":null},{"line":798,"address":[5300073,5300648,5300535],"length":1,"stats":{"Line":2},"fn_name":null},{"line":799,"address":[5300984,5300541],"length":1,"stats":{"Line":1},"fn_name":null},{"line":804,"address":[4326032,4326051],"length":1,"stats":{"Line":3},"fn_name":"new_price_is_in_the_past"},{"line":805,"address":[4326039,4326071],"length":1,"stats":{"Line":3},"fn_name":null},{"line":806,"address":[5301447],"length":1,"stats":{"Line":1},"fn_name":null},{"line":808,"address":[5301460],"length":1,"stats":{"Line":1},"fn_name":null},{"line":810,"address":[5301522],"length":1,"stats":{"Line":1},"fn_name":null},{"line":811,"address":[5301586],"length":1,"stats":{"Line":1},"fn_name":null},{"line":812,"address":[5301662],"length":1,"stats":{"Line":1},"fn_name":null},{"line":814,"address":[5301667],"length":1,"stats":{"Line":1},"fn_name":null},{"line":816,"address":[5301974],"length":1,"stats":{"Line":1},"fn_name":null},{"line":817,"address":[5302019],"length":1,"stats":{"Line":1},"fn_name":null},{"line":818,"address":[5302095],"length":1,"stats":{"Line":1},"fn_name":null},{"line":820,"address":[5302100],"length":1,"stats":{"Line":1},"fn_name":null},{"line":822,"address":[5302139],"length":1,"stats":{"Line":1},"fn_name":null},{"line":823,"address":[5302353,5302216],"length":1,"stats":{"Line":1},"fn_name":null},{"line":825,"address":[5302327],"length":1,"stats":{"Line":1},"fn_name":null},{"line":826,"address":[5302688],"length":1,"stats":{"Line":1},"fn_name":null},{"line":828,"address":[5302804],"length":1,"stats":{"Line":1},"fn_name":null},{"line":829,"address":[5302856,5302936],"length":1,"stats":{"Line":2},"fn_name":null},{"line":830,"address":[5302953],"length":1,"stats":{"Line":1},"fn_name":null},{"line":832,"address":[5303019],"length":1,"stats":{"Line":1},"fn_name":null},{"line":833,"address":[5303055,5303091],"length":1,"stats":{"Line":2},"fn_name":null},{"line":835,"address":[5303314,5303106],"length":1,"stats":{"Line":1},"fn_name":null},{"line":836,"address":[5303681,5303794,5303219],"length":1,"stats":{"Line":2},"fn_name":null},{"line":837,"address":[5303687,5304130],"length":1,"stats":{"Line":1},"fn_name":null},{"line":842,"address":[4326147,4326128],"length":1,"stats":{"Line":3},"fn_name":"new_price_is_in_current_period"},{"line":843,"address":[4326167,4326135],"length":1,"stats":{"Line":3},"fn_name":null},{"line":844,"address":[5304599],"length":1,"stats":{"Line":1},"fn_name":null},{"line":846,"address":[5304612],"length":1,"stats":{"Line":1},"fn_name":null},{"line":848,"address":[5304674],"length":1,"stats":{"Line":1},"fn_name":null},{"line":849,"address":[5304738],"length":1,"stats":{"Line":1},"fn_name":null},{"line":850,"address":[5304814],"length":1,"stats":{"Line":1},"fn_name":null},{"line":852,"address":[5304819],"length":1,"stats":{"Line":1},"fn_name":null},{"line":854,"address":[5305126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":855,"address":[5305172],"length":1,"stats":{"Line":1},"fn_name":null},{"line":856,"address":[5305248],"length":1,"stats":{"Line":1},"fn_name":null},{"line":858,"address":[5305260],"length":1,"stats":{"Line":1},"fn_name":null},{"line":859,"address":[5305253],"length":1,"stats":{"Line":1},"fn_name":null},{"line":863,"address":[5305555],"length":1,"stats":{"Line":1},"fn_name":null},{"line":864,"address":[5305576],"length":1,"stats":{"Line":1},"fn_name":null},{"line":870,"address":[5305692],"length":1,"stats":{"Line":1},"fn_name":null},{"line":871,"address":[5305824,5305744],"length":1,"stats":{"Line":2},"fn_name":null},{"line":872,"address":[5305841],"length":1,"stats":{"Line":1},"fn_name":null},{"line":874,"address":[5305907],"length":1,"stats":{"Line":1},"fn_name":null},{"line":875,"address":[5305943,5305979],"length":1,"stats":{"Line":2},"fn_name":null},{"line":877,"address":[5305994,5306202],"length":1,"stats":{"Line":1},"fn_name":null},{"line":878,"address":[5306107,5306682,5306569],"length":1,"stats":{"Line":2},"fn_name":null},{"line":879,"address":[5307018,5306575],"length":1,"stats":{"Line":1},"fn_name":null},{"line":884,"address":[4326224,4326243],"length":1,"stats":{"Line":3},"fn_name":"new_price_is_in_next_period"},{"line":885,"address":[4326231,4326263],"length":1,"stats":{"Line":3},"fn_name":null},{"line":886,"address":[5307479],"length":1,"stats":{"Line":1},"fn_name":null},{"line":888,"address":[5307492],"length":1,"stats":{"Line":1},"fn_name":null},{"line":890,"address":[5307555],"length":1,"stats":{"Line":1},"fn_name":null},{"line":891,"address":[5307631],"length":1,"stats":{"Line":1},"fn_name":null},{"line":893,"address":[5307636],"length":1,"stats":{"Line":1},"fn_name":null},{"line":895,"address":[5307940],"length":1,"stats":{"Line":1},"fn_name":null},{"line":896,"address":[5308006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":897,"address":[5308052],"length":1,"stats":{"Line":1},"fn_name":null},{"line":898,"address":[5308128],"length":1,"stats":{"Line":1},"fn_name":null},{"line":900,"address":[5308140],"length":1,"stats":{"Line":1},"fn_name":null},{"line":901,"address":[5308133],"length":1,"stats":{"Line":1},"fn_name":null},{"line":905,"address":[5308435],"length":1,"stats":{"Line":1},"fn_name":null},{"line":906,"address":[5308456],"length":1,"stats":{"Line":1},"fn_name":null},{"line":912,"address":[5308572],"length":1,"stats":{"Line":1},"fn_name":null},{"line":913,"address":[5308624,5308704],"length":1,"stats":{"Line":2},"fn_name":null},{"line":914,"address":[5308721],"length":1,"stats":{"Line":1},"fn_name":null},{"line":916,"address":[5308814],"length":1,"stats":{"Line":1},"fn_name":null},{"line":917,"address":[5308886,5308850],"length":1,"stats":{"Line":2},"fn_name":null},{"line":919,"address":[5309109,5308901],"length":1,"stats":{"Line":1},"fn_name":null},{"line":920,"address":[5309589,5309014,5309476],"length":1,"stats":{"Line":2},"fn_name":null},{"line":921,"address":[5309482,5309925],"length":1,"stats":{"Line":1},"fn_name":null},{"line":926,"address":[4326320,4326339],"length":1,"stats":{"Line":3},"fn_name":"new_price_is_a_few_periods_ahead"},{"line":927,"address":[4326359,4326327],"length":1,"stats":{"Line":3},"fn_name":null},{"line":928,"address":[5310391],"length":1,"stats":{"Line":1},"fn_name":null},{"line":930,"address":[5310404],"length":1,"stats":{"Line":1},"fn_name":null},{"line":932,"address":[5310467],"length":1,"stats":{"Line":1},"fn_name":null},{"line":933,"address":[5310543],"length":1,"stats":{"Line":1},"fn_name":null},{"line":935,"address":[5310548],"length":1,"stats":{"Line":1},"fn_name":null},{"line":937,"address":[5310852],"length":1,"stats":{"Line":1},"fn_name":null},{"line":938,"address":[5310918],"length":1,"stats":{"Line":1},"fn_name":null},{"line":939,"address":[5310964],"length":1,"stats":{"Line":1},"fn_name":null},{"line":940,"address":[5311040],"length":1,"stats":{"Line":1},"fn_name":null},{"line":942,"address":[5311052],"length":1,"stats":{"Line":1},"fn_name":null},{"line":943,"address":[5311045],"length":1,"stats":{"Line":1},"fn_name":null},{"line":947,"address":[5311347],"length":1,"stats":{"Line":1},"fn_name":null},{"line":948,"address":[5311368],"length":1,"stats":{"Line":1},"fn_name":null},{"line":954,"address":[5311484],"length":1,"stats":{"Line":1},"fn_name":null},{"line":955,"address":[5311536,5311616],"length":1,"stats":{"Line":2},"fn_name":null},{"line":956,"address":[5311633],"length":1,"stats":{"Line":1},"fn_name":null},{"line":958,"address":[5311750],"length":1,"stats":{"Line":1},"fn_name":null},{"line":959,"address":[5311786,5311822],"length":1,"stats":{"Line":2},"fn_name":null},{"line":961,"address":[5312045,5311837],"length":1,"stats":{"Line":1},"fn_name":null},{"line":962,"address":[5312525,5311950,5312412],"length":1,"stats":{"Line":2},"fn_name":null},{"line":963,"address":[5312861,5312418],"length":1,"stats":{"Line":1},"fn_name":null},{"line":968,"address":[4326416,4326435],"length":1,"stats":{"Line":3},"fn_name":"new_price_is_many_periods_ahead"},{"line":969,"address":[4326423,4326455],"length":1,"stats":{"Line":3},"fn_name":null},{"line":970,"address":[5313319],"length":1,"stats":{"Line":1},"fn_name":null},{"line":972,"address":[5313332],"length":1,"stats":{"Line":1},"fn_name":null},{"line":974,"address":[5313395],"length":1,"stats":{"Line":1},"fn_name":null},{"line":975,"address":[5313471],"length":1,"stats":{"Line":1},"fn_name":null},{"line":977,"address":[5313476],"length":1,"stats":{"Line":1},"fn_name":null},{"line":979,"address":[5313780],"length":1,"stats":{"Line":1},"fn_name":null},{"line":980,"address":[5313846],"length":1,"stats":{"Line":1},"fn_name":null},{"line":981,"address":[5313892],"length":1,"stats":{"Line":1},"fn_name":null},{"line":982,"address":[5313968],"length":1,"stats":{"Line":1},"fn_name":null},{"line":984,"address":[5313980],"length":1,"stats":{"Line":1},"fn_name":null},{"line":985,"address":[5313973],"length":1,"stats":{"Line":1},"fn_name":null},{"line":989,"address":[5314275],"length":1,"stats":{"Line":1},"fn_name":null},{"line":990,"address":[5314296],"length":1,"stats":{"Line":1},"fn_name":null},{"line":996,"address":[5314412],"length":1,"stats":{"Line":1},"fn_name":null},{"line":997,"address":[5314464,5314544],"length":1,"stats":{"Line":2},"fn_name":null},{"line":998,"address":[5314654,5316197,5314551],"length":1,"stats":{"Line":2},"fn_name":null},{"line":999,"address":[5314685],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1001,"address":[5314736,5314692],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1002,"address":[5314743],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1004,"address":[5314779,5314987],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1005,"address":[5315467,5314892,5315354],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1006,"address":[5315803,5315360],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1011,"address":[4326531,4326512],"length":1,"stats":{"Line":3},"fn_name":"wrong_now_in_the_distant_future"},{"line":1012,"address":[4326519,4326551],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1013,"address":[5316295],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1015,"address":[5316308],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1017,"address":[5316370],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1018,"address":[5316434],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1019,"address":[5316510],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1021,"address":[5316515],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1023,"address":[5316822],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1024,"address":[5316865],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1025,"address":[5316922],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1027,"address":[5316927],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1028,"address":[5316966],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1029,"address":[5317180,5317043],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1031,"address":[5317154],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1032,"address":[5317515],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1034,"address":[5317631],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1035,"address":[5317763,5317683],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1036,"address":[5317780],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1038,"address":[5317846],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1039,"address":[5317882,5317918],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1041,"address":[5317933,5318141],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1042,"address":[5318046,5318508,5318621],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1043,"address":[5318957,5318514],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1048,"address":[4326627,4326608],"length":1,"stats":{"Line":3},"fn_name":"new_price_has_arravied_while_prices_countainer_is_full"},{"line":1049,"address":[4326615,4326647],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1050,"address":[5319415],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1052,"address":[5319423,5319548],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1057,"address":[5319640],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1058,"address":[5319692],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1060,"address":[5319740,5320536,5319990],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1061,"address":[5320039],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1063,"address":[5320072],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1065,"address":[5320368],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1066,"address":[5320514],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1069,"address":[5319959,5320564],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1070,"address":[5320606],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1072,"address":[5320661],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1077,"address":[5320936],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1078,"address":[5320959],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1080,"address":[5321094],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1081,"address":[5321227,5321147],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1082,"address":[5321365,5321234],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1083,"address":[5321443],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1085,"address":[5321497,5321450],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1086,"address":[5321504],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1088,"address":[5321748,5321540],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1089,"address":[5322228,5322115,5321653],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1090,"address":[5322121,5322564],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1094,"address":[4323888],"length":1,"stats":{"Line":6},"fn_name":"btc_prices"},{"line":1095,"address":[4323898],"length":1,"stats":{"Line":6},"fn_name":null},{"line":1106,"address":[4324640],"length":1,"stats":{"Line":4},"fn_name":"eos_prices"},{"line":1107,"address":[4324650],"length":1,"stats":{"Line":4},"fn_name":null},{"line":1117,"address":[4326723,4326704],"length":1,"stats":{"Line":3},"fn_name":"calc_correlation_different_price_periods_results_in_periods_intersection"},{"line":1118,"address":[4326743,4326711],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1119,"address":[5323152,5323063],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1122,"address":[5323215],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1124,"address":[5323252],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1125,"address":[5323304],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1127,"address":[5323541,5324184,5323326,5323616],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1128,"address":[5323682],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1130,"address":[5323720],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1132,"address":[5324016],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1133,"address":[5324162],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1136,"address":[5324224],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1137,"address":[5324189],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1138,"address":[5324197],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1139,"address":[5324208],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1140,"address":[5324216],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1142,"address":[5324279],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1143,"address":[5324526],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1144,"address":[5324777],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1145,"address":[5324674],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1146,"address":[5324745],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1149,"address":[5324828,5324934],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1162,"address":[5642928,5642933],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1163,"address":[5642960],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1164,"address":[5643001],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1165,"address":[5642974],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1166,"address":[5642982],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1167,"address":[5642993],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1169,"address":[5643049],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1170,"address":[5643310],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1171,"address":[5643416],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1172,"address":[5643438],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1173,"address":[5643628,5643447],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1178,"address":[5644261,5644256],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1179,"address":[5644288],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1180,"address":[5644329],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1181,"address":[5644302],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1182,"address":[5644310],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1183,"address":[5644321],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1185,"address":[5644377],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1186,"address":[5644638],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1187,"address":[5644744],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1188,"address":[5644766],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1189,"address":[5644775,5644956],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1194,"address":[5645584,5645589],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1195,"address":[5645616],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1196,"address":[5645657],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1197,"address":[5645630],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1198,"address":[5645638],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1199,"address":[5645649],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1201,"address":[5645705],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1202,"address":[5645966],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1203,"address":[5646072],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1204,"address":[5646094],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1205,"address":[5646103,5646284],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1210,"address":[5646912,5646917],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1211,"address":[5646944],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1212,"address":[5646985],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1213,"address":[5646958],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1214,"address":[5646966],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1215,"address":[5646977],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1217,"address":[5647033],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1218,"address":[5647294],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1219,"address":[5647400],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1220,"address":[5647422],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1221,"address":[5647612,5647431],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1226,"address":[5648240,5648245],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1227,"address":[5648272],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1228,"address":[5648324],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1229,"address":[5648286],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1230,"address":[5648294],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1231,"address":[5648316],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1233,"address":[5648372],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1234,"address":[5648633],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1235,"address":[5648739],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1236,"address":[5648761],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1237,"address":[5648770,5648951],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1242,"address":[5649584,5649589],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1243,"address":[5649616],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1244,"address":[5649668],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1245,"address":[5649630],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1246,"address":[5649638],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1247,"address":[5649660],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1249,"address":[5649716],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1250,"address":[5649977],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1251,"address":[5650083],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1252,"address":[5650105],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1253,"address":[5650114,5650295],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1258,"address":[5650928,5650933],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1259,"address":[5650960],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1260,"address":[5651012],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1261,"address":[5650974],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1262,"address":[5650982],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1263,"address":[5651004],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1265,"address":[5651060],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1266,"address":[5651321],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1267,"address":[5651427],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1268,"address":[5651449],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1269,"address":[5651639,5651458],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1274,"address":[5652277,5652272],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1275,"address":[5652304],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1276,"address":[5652356],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1277,"address":[5652318],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1278,"address":[5652326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1279,"address":[5652348],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1281,"address":[5652404],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1282,"address":[5652665],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1283,"address":[5652771],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1284,"address":[5652793],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1285,"address":[5652802,5652983],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1290,"address":[5653616,5653621],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1291,"address":[5653648],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1292,"address":[5653690],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1293,"address":[5653655],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1294,"address":[5653660],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1295,"address":[5653682],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1298,"address":[5653732],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1300,"address":[5653821,5653925],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1305,"address":[5654229,5654224],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1306,"address":[5654256],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1307,"address":[5654290],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1308,"address":[5654263],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1309,"address":[5654271],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1310,"address":[5654282],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1312,"address":[5654338],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1313,"address":[5654575],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1314,"address":[5654669],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1315,"address":[5654683],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1317,"address":[5654810,5654695],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1322,"address":[5655093,5655088],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1323,"address":[5655120],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1324,"address":[5655165],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1325,"address":[5655127],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1326,"address":[5655135],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1327,"address":[5655157],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1329,"address":[5655213],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1330,"address":[5655450],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1331,"address":[5655544],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1332,"address":[5655558],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1334,"address":[5655570,5655685],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1339,"address":[5655968,5655973],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1340,"address":[5656000],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1341,"address":[5656031],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1342,"address":[5656007],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1343,"address":[5656012],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1344,"address":[5656023],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1347,"address":[5656073],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1349,"address":[5656266,5656162],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1354,"address":[5656560,5656565],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1355,"address":[5656592],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1356,"address":[5656634],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1357,"address":[5656599],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1358,"address":[5656604],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1359,"address":[5656626],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1362,"address":[5656676],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1364,"address":[5656869,5656765],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1378,"address":[4631152,4631157],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1379,"address":[4631184],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1380,"address":[4631233],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1381,"address":[4631198],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1382,"address":[4631206],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1383,"address":[4631217],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1384,"address":[4631225],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1386,"address":[4631312],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1387,"address":[4631580],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1388,"address":[4631689],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1389,"address":[4631717],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1390,"address":[4631907,4631726],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1395,"address":[4632544,4632549],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1396,"address":[4632576],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1397,"address":[4632625],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1398,"address":[4632590],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1399,"address":[4632598],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1400,"address":[4632609],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1401,"address":[4632617],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1403,"address":[4632704],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1404,"address":[4632972],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1405,"address":[4633081],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1406,"address":[4633109],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1407,"address":[4633118,4633299],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1412,"address":[4633941,4633936],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1413,"address":[4633968],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1414,"address":[4634028],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1415,"address":[4633982],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1416,"address":[4633990],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1417,"address":[4634012],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1418,"address":[4634020],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1420,"address":[4634107],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1421,"address":[4634375],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1422,"address":[4634484],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1423,"address":[4634512],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1424,"address":[4634521,4634702],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1429,"address":[4635333,4635328],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1430,"address":[4635360],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1431,"address":[4635420],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1432,"address":[4635374],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1433,"address":[4635382],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1434,"address":[4635404],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1435,"address":[4635412],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1437,"address":[4635499],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1438,"address":[4635767],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1439,"address":[4635876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1440,"address":[4635904],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1441,"address":[4636094,4635913],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1446,"address":[4636725,4636720],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1447,"address":[4636752],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1448,"address":[4636805],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1449,"address":[4636759],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1450,"address":[4636767],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1451,"address":[4636789],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1452,"address":[4636797],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1456,"address":[4636875],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1458,"address":[4637068,4636964],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1463,"address":[4637360,4637365],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1464,"address":[4637392],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1465,"address":[4637434],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1466,"address":[4637399],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1467,"address":[4637407],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1468,"address":[4637418],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1469,"address":[4637426],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1471,"address":[4637513],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1472,"address":[4637757],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1473,"address":[4637854],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1474,"address":[4637874],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1476,"address":[4637886,4638001],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1481,"address":[4638288,4638293],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1482,"address":[4638320],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1483,"address":[4638373],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1484,"address":[4638327],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1485,"address":[4638335],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1486,"address":[4638357],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1487,"address":[4638365],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1489,"address":[4638452],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1490,"address":[4638696],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1491,"address":[4638793],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1492,"address":[4638813],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1494,"address":[4638940,4638825],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1499,"address":[4639232,4639237],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1500,"address":[4639264],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1501,"address":[4639306],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1502,"address":[4639271],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1503,"address":[4639279],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1504,"address":[4639290],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1505,"address":[4639298],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1508,"address":[4639376],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1510,"address":[4639465,4639569],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1515,"address":[4639861,4639856],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1516,"address":[4639888],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1517,"address":[4639941],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1518,"address":[4639895],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1519,"address":[4639903],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1520,"address":[4639925],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1521,"address":[4639933],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1524,"address":[4640011],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1526,"address":[4640100,4640204],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1540,"address":[4627168,4627187],"length":1,"stats":{"Line":3},"fn_name":"calc_portf_vol_btc_eos_regular_regular_1"},{"line":1541,"address":[4627175,4627207],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1542,"address":[5418398],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1543,"address":[5418468],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1545,"address":[5418557],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1546,"address":[5418538],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1547,"address":[5418546],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1550,"address":[5418602],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1551,"address":[5418863],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1552,"address":[5418969],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1553,"address":[5418991],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1554,"address":[5419000,5419181],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1559,"address":[4627264,4627283],"length":1,"stats":{"Line":3},"fn_name":"calc_portf_vol_btc_eos_regular_regular_2"},{"line":1560,"address":[4627271,4627303],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1561,"address":[5419854],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1563,"address":[5419943],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1564,"address":[5419924],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1565,"address":[5419932],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1568,"address":[5419988],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1569,"address":[5420249],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1570,"address":[5420355],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1571,"address":[5420377],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1572,"address":[5420386,5420567],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1577,"address":[4627360,4627379],"length":1,"stats":{"Line":3},"fn_name":"calc_portf_vol_btc_eos_regular_regular_3"},{"line":1578,"address":[4627399,4627367],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1579,"address":[5421246],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1580,"address":[5421316],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1582,"address":[5421405],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1583,"address":[5421386],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1584,"address":[5421394],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1587,"address":[5421450],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1588,"address":[5421711],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1589,"address":[5421817],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1590,"address":[5421839],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1591,"address":[5422029,5421848],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1596,"address":[4627475,4627456],"length":1,"stats":{"Line":3},"fn_name":"calc_portf_var_btc_eos_regular_regular_1"},{"line":1597,"address":[4627463,4627495],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1598,"address":[5422702],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1599,"address":[5422772],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1601,"address":[5422861],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1602,"address":[5422842],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1603,"address":[5422850],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1607,"address":[5422912],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1608,"address":[5423173],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1609,"address":[5423279],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1610,"address":[5423301],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1611,"address":[5423491,5423310],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1616,"address":[4627552,4627571],"length":1,"stats":{"Line":3},"fn_name":"calc_portf_var_btc_eos_regular_regular_2"},{"line":1617,"address":[4627559,4627591],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1618,"address":[5424174],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1620,"address":[5424263],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1621,"address":[5424244],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1622,"address":[5424252],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1626,"address":[5424314],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1627,"address":[5424575],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1628,"address":[5424681],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1629,"address":[5424703],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1630,"address":[5424893,5424712],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1635,"address":[4627667,4627648],"length":1,"stats":{"Line":3},"fn_name":"calc_portf_var_btc_eos_regular_regular_3"},{"line":1636,"address":[4627655,4627687],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1637,"address":[5425566],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1638,"address":[5425636],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1640,"address":[5425725],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1641,"address":[5425706],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1642,"address":[5425714],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1646,"address":[5425776],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1647,"address":[5426037],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1648,"address":[5426143],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1649,"address":[5426165],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1650,"address":[5426355,5426174],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":794,"coverable":794},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","manual-timestamp","src","lib.rs"],"content":"#![cfg_attr(not(feature = \"std\"), no_std)]\n\nuse frame_support::traits::UnixTime;\nuse frame_support::{decl_error, decl_event, decl_module, decl_storage, dispatch, traits::Get};\nuse frame_system::ensure_signed;\n\n#[cfg(test)]\nmod mock;\n\n#[cfg(test)]\nmod tests;\n\npub trait Trait: frame_system::Trait {\n    type Event: From\u003cEvent\u003cSelf\u003e\u003e + Into\u003c\u003cSelf as frame_system::Trait\u003e::Event\u003e;\n}\n\ndecl_storage! {\n    trait Store for Module\u003cT: Trait\u003e as OracleModule {\n        pub Now get(fn now): u64;\n    }\n    add_extra_genesis {\n        config(timestamp): u64;\n\n        build(|config| {\n            Now::put(config.timestamp);\n        });\n    }\n}\n\ndecl_event!(\n    pub enum Event\u003cT\u003e\n    where\n        AccountId = \u003cT as frame_system::Trait\u003e::AccountId,\n    {\n        NowAdvanced(u64, AccountId),\n    }\n);\n\ndecl_error! {\n    pub enum Error for Module\u003cT: Trait\u003e {}\n}\n\ndecl_module! {\n    pub struct Module\u003cT: Trait\u003e for enum Call where origin: T::Origin {\n        type Error = Error\u003cT\u003e;\n\n        fn deposit_event() = default;\n\n        #[weight = 10_000 + T::DbWeight::get().writes(1)]\n        pub fn advance_secs(origin, secs: u32) -\u003e dispatch::DispatchResult {\n            let who = ensure_signed(origin)?;\n            let new_now = Self::now() + 1000 * (secs as u64);\n\n            \u003cSelf as Store\u003e::Now::put(new_now);\n\n            Self::deposit_event(RawEvent::NowAdvanced(new_now, who));\n            Ok(())\n        }\n    }\n}\n\nimpl\u003cT: Trait\u003e UnixTime for Module\u003cT\u003e {\n    fn now() -\u003e core::time::Duration {\n        core::time::Duration::from_millis(Self::now())\n    }\n}\n","traces":[{"line":17,"address":[91426512,91426129,91426496,91426597,91426576,91425632,91426448,91426480,91426176,91426272,91425680,91426533,91426329,91425698,91426112,91426320,91426286,91425636,91425922,91426368,91426389,91426256,91425833],"length":1,"stats":{"Line":16},"fn_name":"default"},{"line":24,"address":[4956416,4956460],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}"},{"line":25,"address":[84696382],"length":1,"stats":{"Line":2},"fn_name":null},{"line":35,"address":[67900924,67901084,67900625,67900792,67900952,67901076,67900916],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[67899432,67899550,67899182,67899370,67899294,67899474],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[4338803,4338773,4338372],"length":1,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[4958807,4958587,4958718,4958680,4958860],"length":1,"stats":{"Line":3},"fn_name":null},{"line":52,"address":[4958941,4958795,4959320],"length":1,"stats":{"Line":2},"fn_name":null},{"line":54,"address":[4959016],"length":1,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[67898148],"length":1,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[4959090],"length":1,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":10,"coverable":13},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","manual-timestamp","src","mock.rs"],"content":"use crate::{Module, Trait};\nuse frame_support::{impl_outer_origin, parameter_types, weights::Weight};\nuse frame_system as system;\nuse sp_core::H256;\nuse sp_runtime::{\n    testing::Header,\n    traits::{BlakeTwo256, IdentityLookup},\n    Perbill,\n};\n\nimpl_outer_origin! {\n    pub enum Origin for Test {}\n}\n\n// Configure a mock runtime to test the pallet.\n\n#[derive(Clone, Eq, PartialEq)]\npub struct Test;\nparameter_types! {\n    pub const BlockHashCount: u64 = 250;\n    pub const MaximumBlockWeight: Weight = 1024;\n    pub const MaximumBlockLength: u32 = 2 * 1024;\n    pub const AvailableBlockRatio: Perbill = Perbill::from_percent(75);\n}\n\nimpl system::Trait for Test {\n    type BaseCallFilter = ();\n    type Origin = Origin;\n    type Call = ();\n    type Index = u64;\n    type BlockNumber = u64;\n    type Hash = H256;\n    type Hashing = BlakeTwo256;\n    type AccountId = u64;\n    type Lookup = IdentityLookup\u003cSelf::AccountId\u003e;\n    type Header = Header;\n    type Event = ();\n    type BlockHashCount = BlockHashCount;\n    type MaximumBlockWeight = MaximumBlockWeight;\n    type DbWeight = ();\n    type BlockExecutionWeight = ();\n    type ExtrinsicBaseWeight = ();\n    type MaximumExtrinsicWeight = MaximumBlockWeight;\n    type MaximumBlockLength = MaximumBlockLength;\n    type AvailableBlockRatio = AvailableBlockRatio;\n    type Version = ();\n    type ModuleToIndex = ();\n    type AccountData = ();\n    type OnNewAccount = ();\n    type OnKilledAccount = ();\n    type SystemWeightInfo = ();\n}\n\nimpl Trait for Test {\n    type Event = ();\n}\n\npub type TimestampModule = Module\u003cTest\u003e;\n\npub const INITIAL_TIMESTAMP: u64 = 11223344000;\n\n// Build genesis storage according to the mock runtime.\npub fn new_test_ext() -\u003e sp_io::TestExternalities {\n    let mut t = system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap();\n\n    crate::GenesisConfig {\n        timestamp: INITIAL_TIMESTAMP,\n    }\n    .assimilate_storage(\u0026mut t)\n    .unwrap();\n\n    t.into()\n}\n","traces":[{"line":11,"address":[4901957,4901888],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[4254881],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[4252047,4252000],"length":1,"stats":{"Line":2},"fn_name":"new_test_ext"},{"line":64,"address":[4252010,4252075],"length":1,"stats":{"Line":4},"fn_name":null},{"line":74,"address":[4252198],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":3,"coverable":5},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","manual-timestamp","src","tests.rs"],"content":"use crate::mock::*;\nuse core::time::Duration;\nuse frame_support::assert_ok;\nuse frame_support::traits::UnixTime;\n\n#[test]\nfn genesis_timestamp() {\n    new_test_ext().execute_with(|| {\n        assert_eq!(\n            \u003cTimestampModule as UnixTime\u003e::now(),\n            Duration::from_millis(INITIAL_TIMESTAMP)\n        );\n    });\n}\n\n#[test]\nfn advance_secs() {\n    new_test_ext().execute_with(|| {\n        let delta = 543;\n        assert_ok!(TimestampModule::advance_secs(Origin::signed(1), delta));\n        assert_eq!(\n            \u003cTimestampModule as UnixTime\u003e::now(),\n            Duration::from_millis(INITIAL_TIMESTAMP + (1000 * delta as u64))\n        );\n    });\n}\n","traces":[{"line":7,"address":[4620675,4620656],"length":1,"stats":{"Line":3},"fn_name":"genesis_timestamp"},{"line":8,"address":[4620663,4620695],"length":1,"stats":{"Line":3},"fn_name":null},{"line":9,"address":[5138109,5138205],"length":1,"stats":{"Line":1},"fn_name":null},{"line":10,"address":[5138071],"length":1,"stats":{"Line":1},"fn_name":null},{"line":11,"address":[5138095],"length":1,"stats":{"Line":1},"fn_name":null},{"line":17,"address":[4620752,4620771],"length":1,"stats":{"Line":3},"fn_name":"advance_secs"},{"line":18,"address":[4620791,4620759],"length":1,"stats":{"Line":3},"fn_name":null},{"line":19,"address":[5138519],"length":1,"stats":{"Line":1},"fn_name":null},{"line":20,"address":[5138530],"length":1,"stats":{"Line":1},"fn_name":null},{"line":21,"address":[5138931,5139045],"length":1,"stats":{"Line":1},"fn_name":null},{"line":22,"address":[5138819],"length":1,"stats":{"Line":1},"fn_name":null},{"line":23,"address":[5139322,5138839],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":12,"coverable":12},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","oracle","src","lib.rs"],"content":"#![cfg_attr(not(feature = \"std\"), no_std)]\n\nuse financial_primitives::OnPriceSet;\nuse frame_support::codec::Codec;\nuse frame_support::dispatch::Parameter;\nuse frame_support::{decl_error, decl_event, decl_module, decl_storage, dispatch, traits::Get};\nuse frame_system::ensure_signed;\n\n#[cfg(test)]\nmod mock;\n\n#[cfg(test)]\nmod tests;\n\npub trait Trait: frame_system::Trait {\n    type Event: From\u003cEvent\u003cSelf\u003e\u003e + Into\u003c\u003cSelf as frame_system::Trait\u003e::Event\u003e;\n    type Asset: Codec + Parameter + Default + Copy;\n    type Price: Codec + Parameter + Default + Copy;\n    type OnPriceSet: OnPriceSet\u003cPrice = Self::Price, Asset = Self::Asset\u003e;\n}\n\ndecl_storage! {\n    trait Store for Module\u003cT: Trait\u003e as OracleModule {\n        PricePoints get(fn price_points): map hasher(identity) T::Asset =\u003e T::Price;\n    }\n    add_extra_genesis {\n        config(prices): Vec\u003c(T::Asset, T::Price)\u003e;\n\n        build(|config| {\n            for \u0026(asset, value) in config.prices.iter() {\n                PricePoints::\u003cT\u003e::insert(asset, value);\n            }\n        });\n    }\n}\n\ndecl_event!(\n    pub enum Event\u003cT\u003e\n    where\n        AccountId = \u003cT as frame_system::Trait\u003e::AccountId,\n        Asset = \u003cT as Trait\u003e::Asset,\n        Price = \u003cT as Trait\u003e::Price,\n    {\n        PriceSet(Asset, Price, AccountId),\n    }\n);\n\ndecl_error! {\n    pub enum Error for Module\u003cT: Trait\u003e {}\n}\n\ndecl_module! {\n    pub struct Module\u003cT: Trait\u003e for enum Call where origin: T::Origin {\n        type Error = Error\u003cT\u003e;\n\n        fn deposit_event() = default;\n\n        #[weight = 10_000 + T::DbWeight::get().writes(1)]\n        pub fn set_price(origin, asset: T::Asset, value: T::Price) -\u003e dispatch::DispatchResult {\n            let who = ensure_signed(origin)?;\n\n            PricePoints::\u003cT\u003e::insert(asset, value);\n\n            let _ = T::OnPriceSet::on_price_set(asset, value);\n            Self::deposit_event(RawEvent::PriceSet(asset, value, who));\n            Ok(())\n        }\n    }\n}\n","traces":[{"line":22,"address":[67599153,67599200,67602216,67595337,67599136,67592949,67592928,67602192,67599250,67595200,67595210,67602272,67594032,67602279,67594112],"length":1,"stats":{"Line":6},"fn_name":"build_module_genesis_storage\u003cnode_template_runtime::Runtime,oracle::__InherentHiddenInstance\u003e"},{"line":29,"address":[67599219,67599280],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":30,"address":[74334689,74334826,74334898,74334896],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[67599478],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[5831157,5830715,5830436,5830537,5830884,5830987],"length":1,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[67600561,67600591,67600038],"length":1,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[4518074,4518175,4517943,4518228,4518036],"length":1,"stats":{"Line":3},"fn_name":null},{"line":62,"address":[74332996],"length":1,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[4518309],"length":1,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[4518334],"length":1,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[4518406],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":6,"coverable":11},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","oracle","src","mock.rs"],"content":"use crate::{Module, Trait};\nuse common::Asset;\nuse financial_primitives::OnPriceSet;\nuse frame_support::dispatch::DispatchError;\nuse frame_support::{impl_outer_origin, parameter_types, weights::Weight};\nuse frame_system as system;\nuse sp_core::H256;\nuse sp_runtime::{\n    testing::Header,\n    traits::{BlakeTwo256, IdentityLookup},\n    Perbill,\n};\n\nimpl_outer_origin! {\n    pub enum Origin for Test {}\n}\n\n// Configure a mock runtime to test the pallet.\n\n#[derive(Clone, Eq, PartialEq)]\npub struct Test;\nparameter_types! {\n    pub const BlockHashCount: u64 = 250;\n    pub const MaximumBlockWeight: Weight = 1024;\n    pub const MaximumBlockLength: u32 = 2 * 1024;\n    pub const AvailableBlockRatio: Perbill = Perbill::from_percent(75);\n}\n\nimpl system::Trait for Test {\n    type BaseCallFilter = ();\n    type Origin = Origin;\n    type Call = ();\n    type Index = u64;\n    type BlockNumber = u64;\n    type Hash = H256;\n    type Hashing = BlakeTwo256;\n    type AccountId = u64;\n    type Lookup = IdentityLookup\u003cSelf::AccountId\u003e;\n    type Header = Header;\n    type Event = ();\n    type BlockHashCount = BlockHashCount;\n    type MaximumBlockWeight = MaximumBlockWeight;\n    type DbWeight = ();\n    type BlockExecutionWeight = ();\n    type ExtrinsicBaseWeight = ();\n    type MaximumExtrinsicWeight = MaximumBlockWeight;\n    type MaximumBlockLength = MaximumBlockLength;\n    type AvailableBlockRatio = AvailableBlockRatio;\n    type Version = ();\n    type ModuleToIndex = ();\n    type AccountData = ();\n    type OnNewAccount = ();\n    type OnKilledAccount = ();\n    type SystemWeightInfo = ();\n}\n\nimpl Trait for Test {\n    type Event = ();\n    type Asset = Asset;\n    type Price = u32;\n    type OnPriceSet = TestOnPriceSet;\n}\n\npub struct TestOnPriceSet;\n\nimpl OnPriceSet for TestOnPriceSet {\n    type Asset = Asset;\n    type Price = u32;\n    fn on_price_set(_asset: Asset, _value: u32) -\u003e Result\u003c(), DispatchError\u003e {\n        Ok(())\n    }\n}\n\npub type OracleModule = Module\u003cTest\u003e;\n\n// Build genesis storage according to the mock runtime.\npub fn new_test_ext() -\u003e sp_io::TestExternalities {\n    system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap()\n        .into()\n}\n","traces":[{"line":14,"address":[5151584,5151653],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[4838705],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":77,"address":[4836087,4836048],"length":1,"stats":{"Line":1},"fn_name":"new_test_ext"},{"line":78,"address":[4836115,4836172,4836058],"length":1,"stats":{"Line":3},"fn_name":null}],"covered":4,"coverable":6},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","oracle","src","tests.rs"],"content":"use crate::mock::*;\nuse common::Asset;\nuse frame_support::assert_ok;\n\n#[test]\nfn set_price_is_visible_through_storage() {\n    new_test_ext().execute_with(|| {\n        assert_ok!(OracleModule::set_price(Origin::signed(1), Asset::Btc, 42));\n        assert_eq!(OracleModule::price_points(Asset::Btc), 42);\n    });\n}\n","traces":[{"line":6,"address":[4701333,4701328],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":7,"address":[4701360],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":8,"address":[4701367],"length":1,"stats":{"Line":1},"fn_name":null},{"line":9,"address":[4701794,4701660],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":4,"coverable":4},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","portfolio","src","lib.rs"],"content":"#![cfg_attr(not(feature = \"std\"), no_std)]\n\nuse financial_primitives::BalanceAware;\nuse frame_support::codec::Codec;\nuse frame_support::dispatch::{DispatchError, DispatchResult, Parameter};\nuse frame_support::{decl_error, decl_event, decl_module, decl_storage, dispatch, traits::Get};\nuse frame_system::ensure_signed;\nuse sp_std::vec::Vec;\n\n#[cfg(test)]\nmod mock;\n\n#[cfg(test)]\nmod tests;\n\npub trait Trait: frame_system::Trait {\n    type Event: From\u003cEvent\u003cSelf\u003e\u003e + Into\u003c\u003cSelf as frame_system::Trait\u003e::Event\u003e;\n    type Asset: Codec + Parameter + Default + Copy;\n    type Balance: Codec + Parameter + Default + Copy;\n}\n\ndecl_storage! {\n    trait Store for Module\u003cT: Trait\u003e as OracleModule {\n        Balances get(fn balances): double_map hasher(blake2_128_concat) T::AccountId, hasher(identity) T::Asset =\u003e T::Balance;\n    }\n}\n\ndecl_event!(\n    pub enum Event\u003cT\u003e\n    where\n        AccountId = \u003cT as frame_system::Trait\u003e::AccountId,\n        Asset = \u003cT as Trait\u003e::Asset,\n        Balance = \u003cT as Trait\u003e::Balance,\n    {\n        BalanceSet(AccountId, Asset, Balance, AccountId),\n    }\n);\n\ndecl_error! {\n    pub enum Error for Module\u003cT: Trait\u003e {}\n}\n\ndecl_module! {\n    pub struct Module\u003cT: Trait\u003e for enum Call where origin: T::Origin {\n        type Error = Error\u003cT\u003e;\n\n        fn deposit_event() = default;\n\n        #[weight = 10_000 + T::DbWeight::get().writes(1)]\n        pub fn set_balance(origin, account_id: T::AccountId,  asset: T::Asset, balance: T::Balance) -\u003e dispatch::DispatchResult {\n            let who = ensure_signed(origin)?;\n\n            Balances::\u003cT\u003e::mutate(\u0026account_id, asset, |b| -\u003e DispatchResult {\n                *b = balance;\n                Ok(())\n            })?;\n\n            Self::deposit_event(RawEvent::BalanceSet(account_id, asset, balance, who));\n            Ok(())\n        }\n    }\n}\n\nimpl\u003cT: Trait\u003e BalanceAware for Module\u003cT\u003e {\n    type AccountId = T::AccountId;\n    type Asset = T::Asset;\n    type Balance = T::Balance;\n\n    fn balances(\n        account_id: \u0026T::AccountId,\n        assets: \u0026[Self::Asset],\n    ) -\u003e Result\u003cVec\u003cSelf::Balance\u003e, DispatchError\u003e {\n        Ok(assets\n            .iter()\n            .map(|a| \u003cBalances\u003cT\u003e\u003e::get(account_id, a))\n            .collect())\n    }\n}\n","traces":[{"line":22,"address":[5032272,5032320,5032213,5032192,5032304],"length":1,"stats":{"Line":15},"fn_name":"fmt"},{"line":35,"address":[4221159,4221295,4221563,4221807,4221963,4222207,4221340],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[4220098,4220128,4219638],"length":1,"stats":{"Line":0},"fn_name":"dispatch_bypass_filter\u003cnode_template_runtime::Runtime\u003e"},{"line":51,"address":[74835988,74835848,74836185,74835945,74836148],"length":1,"stats":{"Line":3},"fn_name":null},{"line":53,"address":[4224580,4224783,4225025,4225424],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":54,"address":[74836976],"length":1,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[4225454],"length":1,"stats":{"Line":1},"fn_name":null},{"line":58,"address":[5025772],"length":1,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[68101310],"length":1,"stats":{"Line":1},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":10,"coverable":14},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","portfolio","src","mock.rs"],"content":"use crate::{Module, Trait};\nuse common::Asset;\nuse frame_support::{impl_outer_origin, parameter_types, weights::Weight};\nuse frame_system as system;\nuse sp_core::H256;\nuse sp_runtime::{\n    testing::Header,\n    traits::{BlakeTwo256, IdentityLookup},\n    Perbill,\n};\n\nimpl_outer_origin! {\n    pub enum Origin for Test {}\n}\n\n// Configure a mock runtime to test the pallet.\n\n#[derive(Clone, Eq, PartialEq)]\npub struct Test;\nparameter_types! {\n    pub const BlockHashCount: u64 = 250;\n    pub const MaximumBlockWeight: Weight = 1024;\n    pub const MaximumBlockLength: u32 = 2 * 1024;\n    pub const AvailableBlockRatio: Perbill = Perbill::from_percent(75);\n}\n\nimpl system::Trait for Test {\n    type BaseCallFilter = ();\n    type Origin = Origin;\n    type Call = ();\n    type Index = u64;\n    type BlockNumber = u64;\n    type Hash = H256;\n    type Hashing = BlakeTwo256;\n    type AccountId = u64;\n    type Lookup = IdentityLookup\u003cSelf::AccountId\u003e;\n    type Header = Header;\n    type Event = ();\n    type BlockHashCount = BlockHashCount;\n    type MaximumBlockWeight = MaximumBlockWeight;\n    type DbWeight = ();\n    type BlockExecutionWeight = ();\n    type ExtrinsicBaseWeight = ();\n    type MaximumExtrinsicWeight = MaximumBlockWeight;\n    type MaximumBlockLength = MaximumBlockLength;\n    type AvailableBlockRatio = AvailableBlockRatio;\n    type Version = ();\n    type ModuleToIndex = ();\n    type AccountData = ();\n    type OnNewAccount = ();\n    type OnKilledAccount = ();\n    type SystemWeightInfo = ();\n}\n\nimpl Trait for Test {\n    type Event = ();\n    type Asset = Asset;\n    type Balance = u32;\n}\n\npub type PortfolioModule = Module\u003cTest\u003e;\n\n// Build genesis storage according to the mock runtime.\npub fn new_test_ext() -\u003e sp_io::TestExternalities {\n    system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap()\n        .into()\n}\n","traces":[{"line":12,"address":[4742725,4742656],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[5137937],"length":1,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[5135319,5135280],"length":1,"stats":{"Line":1},"fn_name":"new_test_ext"},{"line":65,"address":[5135290,5135404,5135347],"length":1,"stats":{"Line":3},"fn_name":null}],"covered":2,"coverable":4},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","portfolio","src","tests.rs"],"content":"use crate::mock::*;\nuse common::Asset;\nuse financial_primitives::BalanceAware;\nuse frame_support::assert_ok;\n\n#[test]\nfn default_balance_is_zero() {\n    new_test_ext().execute_with(|| {\n        //assert_ok!(OracleModule::set_price(Origin::signed(1), Asset::Btc, 42));\n        assert_eq!(PortfolioModule::balances(123, Asset::Btc), 0);\n    });\n}\n\n#[test]\nfn set_balance() {\n    new_test_ext().execute_with(|| {\n        assert_ok!(PortfolioModule::set_balance(\n            Origin::signed(1),\n            456,\n            Asset::Btc,\n            42\n        ));\n        assert_eq!(PortfolioModule::balances(456, Asset::Btc), 42);\n    });\n}\n\n#[test]\nfn balance_aware_balances() {\n    new_test_ext().execute_with(|| {\n        assert_ok!(PortfolioModule::set_balance(\n            Origin::signed(1),\n            456,\n            Asset::Btc,\n            42\n        ));\n        assert_ok!(PortfolioModule::set_balance(\n            Origin::signed(1),\n            456,\n            Asset::Eos,\n            11\n        ));\n        let actual = \u003cPortfolioModule as BalanceAware\u003e::balances(\n            \u0026456,\n            \u0026vec![Asset::Eos, Asset::Btc, Asset::Usd],\n        );\n\n        assert_eq!(actual, Ok(vec![11, 42, 0]));\n    });\n}\n","traces":[{"line":7,"address":[4310320,4310325],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":8,"address":[4813607,4813639],"length":1,"stats":{"Line":3},"fn_name":null},{"line":10,"address":[4310359,4310474],"length":1,"stats":{"Line":1},"fn_name":null},{"line":15,"address":[4813696,4813715],"length":1,"stats":{"Line":3},"fn_name":"set_balance"},{"line":16,"address":[4813703,4813735],"length":1,"stats":{"Line":3},"fn_name":null},{"line":17,"address":[4310817],"length":1,"stats":{"Line":1},"fn_name":null},{"line":18,"address":[4310791],"length":1,"stats":{"Line":1},"fn_name":null},{"line":20,"address":[4310809],"length":1,"stats":{"Line":1},"fn_name":null},{"line":23,"address":[4311090,4311229],"length":1,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[4311520,4311525],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":29,"address":[4311552,4311579],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":30,"address":[4311602],"length":1,"stats":{"Line":1},"fn_name":null},{"line":31,"address":[4311559],"length":1,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[4311594],"length":1,"stats":{"Line":1},"fn_name":null},{"line":36,"address":[4311931],"length":1,"stats":{"Line":1},"fn_name":null},{"line":37,"address":[4311905],"length":1,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[4311923],"length":1,"stats":{"Line":1},"fn_name":null},{"line":42,"address":[4312401],"length":1,"stats":{"Line":1},"fn_name":null},{"line":43,"address":[4312228],"length":1,"stats":{"Line":1},"fn_name":null},{"line":44,"address":[4312235],"length":1,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[4312451],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":21,"coverable":21},{"path":["/","home","rotor","work","src","polka","financial-pallet","runtime","build.rs"],"content":"use wasm_builder_runner::WasmBuilder;\n\nfn main() {\n    WasmBuilder::new()\n        .with_current_project()\n        .with_wasm_builder_from_crates(\"2.0.0\")\n        .export_heap_base()\n        .import_memory()\n        .build()\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","runtime","src","lib.rs"],"content":"#![cfg_attr(not(feature = \"std\"), no_std)]\n// `construct_runtime!` does a lot of recursion and requires us to increase the limit to 256.\n#![recursion_limit = \"256\"]\n\n// Make the WASM binary available.\n#[cfg(feature = \"std\")]\ninclude!(concat!(env!(\"OUT_DIR\"), \"/wasm_binary.rs\"));\n\nuse common::Asset;\nuse pallet_grandpa::fg_primitives;\nuse pallet_grandpa::{AuthorityId as GrandpaId, AuthorityList as GrandpaAuthorityList};\nuse sp_api::impl_runtime_apis;\nuse sp_consensus_aura::sr25519::AuthorityId as AuraId;\nuse sp_core::{crypto::KeyTypeId, OpaqueMetadata};\nuse sp_runtime::traits::{\n    BlakeTwo256, Block as BlockT, IdentifyAccount, IdentityLookup, NumberFor, Saturating, Verify,\n};\nuse sp_runtime::{\n    create_runtime_str, generic, impl_opaque_keys,\n    transaction_validity::{TransactionSource, TransactionValidity},\n    ApplyExtrinsicResult, MultiSignature,\n};\nuse sp_std::prelude::*;\n#[cfg(feature = \"std\")]\nuse sp_version::NativeVersion;\nuse sp_version::RuntimeVersion;\n\nuse financial_primitives::{CalcReturnType, CalcVolatilityType};\n\n// A few exports that help ease life for downstream crates.\npub use frame_support::{\n    construct_runtime, parameter_types,\n    traits::{KeyOwnerProofSystem, Randomness},\n    weights::{\n        constants::{BlockExecutionWeight, ExtrinsicBaseWeight, RocksDbWeight, WEIGHT_PER_SECOND},\n        IdentityFee, Weight,\n    },\n    StorageValue,\n};\npub use pallet_balances::Call as BalancesCall;\npub use pallet_timestamp::Call as TimestampCall;\n#[cfg(any(feature = \"std\", test))]\npub use sp_runtime::BuildStorage;\npub use sp_runtime::{Perbill, Permill};\n\n/// Import the financial pallet.\npub use financial_pallet;\n\n/// Import the oracle pallet.\npub use oracle;\n\n/// Import the manual-timestamp pallet.\npub use manual_timestamp;\n\n/// Import the portfolio pallet.\npub use portfolio;\n\n/// An index to a block.\npub type BlockNumber = u32;\n\n/// Alias to 512-bit hash when used in the context of a transaction signature on the chain.\npub type Signature = MultiSignature;\n\n/// Some way of identifying an account on the chain. We intentionally make it equivalent\n/// to the public key of our transaction signing scheme.\npub type AccountId = \u003c\u003cSignature as Verify\u003e::Signer as IdentifyAccount\u003e::AccountId;\n\n/// The type for looking up accounts. We don't expect more than 4 billion of them, but you\n/// never know...\npub type AccountIndex = u32;\n\n/// Balance of an account.\npub type Balance = u128;\n\n/// Index of a transaction in the chain.\npub type Index = u32;\n\n/// A hash of some data used by the chain.\npub type Hash = sp_core::H256;\n\n/// Digest item type.\npub type DigestItem = generic::DigestItem\u003cHash\u003e;\n\n/// Opaque types. These are used by the CLI to instantiate machinery that don't need to know\n/// the specifics of the runtime. They can then be made to be agnostic over specific formats\n/// of data like extrinsics, allowing for them to continue syncing the network through upgrades\n/// to even the core data structures.\npub mod opaque {\n    use super::*;\n\n    pub use sp_runtime::OpaqueExtrinsic as UncheckedExtrinsic;\n\n    /// Opaque block header type.\n    pub type Header = generic::Header\u003cBlockNumber, BlakeTwo256\u003e;\n    /// Opaque block type.\n    pub type Block = generic::Block\u003cHeader, UncheckedExtrinsic\u003e;\n    /// Opaque block identifier type.\n    pub type BlockId = generic::BlockId\u003cBlock\u003e;\n\n    impl_opaque_keys! {\n        pub struct SessionKeys {\n            pub aura: Aura,\n            pub grandpa: Grandpa,\n        }\n    }\n}\n\npub const VERSION: RuntimeVersion = RuntimeVersion {\n    spec_name: create_runtime_str!(\"node-template\"),\n    impl_name: create_runtime_str!(\"node-template\"),\n    authoring_version: 1,\n    spec_version: 1,\n    impl_version: 1,\n    apis: RUNTIME_API_VERSIONS,\n    transaction_version: 1,\n};\n\npub const MILLISECS_PER_BLOCK: u64 = 6000;\n\npub const SLOT_DURATION: u64 = MILLISECS_PER_BLOCK;\n\n// Time is measured by number of blocks.\npub const MINUTES: BlockNumber = 60_000 / (MILLISECS_PER_BLOCK as BlockNumber);\npub const HOURS: BlockNumber = MINUTES * 60;\npub const DAYS: BlockNumber = HOURS * 24;\n\n/// The version information used to identify this runtime when compiled natively.\n#[cfg(feature = \"std\")]\npub fn native_version() -\u003e NativeVersion {\n    NativeVersion {\n        runtime_version: VERSION,\n        can_author_with: Default::default(),\n    }\n}\n\nparameter_types! {\n    pub const BlockHashCount: BlockNumber = 2400;\n    /// We allow for 2 seconds of compute with a 6 second average block time.\n    pub const MaximumBlockWeight: Weight = 2 * WEIGHT_PER_SECOND;\n    pub const AvailableBlockRatio: Perbill = Perbill::from_percent(75);\n    /// Assume 10% of weight for average on_initialize calls.\n    pub MaximumExtrinsicWeight: Weight = AvailableBlockRatio::get()\n        .saturating_sub(Perbill::from_percent(10)) * MaximumBlockWeight::get();\n    pub const MaximumBlockLength: u32 = 5 * 1024 * 1024;\n    pub const Version: RuntimeVersion = VERSION;\n}\n\n// Configure FRAME pallets to include in runtime.\n\nimpl frame_system::Trait for Runtime {\n    /// The basic call filter to use in dispatchable.\n    type BaseCallFilter = ();\n    /// The identifier used to distinguish between accounts.\n    type AccountId = AccountId;\n    /// The aggregated dispatch type that is available for extrinsics.\n    type Call = Call;\n    /// The lookup mechanism to get account ID from whatever is passed in dispatchers.\n    type Lookup = IdentityLookup\u003cAccountId\u003e;\n    /// The index type for storing how many extrinsics an account has signed.\n    type Index = Index;\n    /// The index type for blocks.\n    type BlockNumber = BlockNumber;\n    /// The type for hashing blocks and tries.\n    type Hash = Hash;\n    /// The hashing algorithm used.\n    type Hashing = BlakeTwo256;\n    /// The header type.\n    type Header = generic::Header\u003cBlockNumber, BlakeTwo256\u003e;\n    /// The ubiquitous event type.\n    type Event = Event;\n    /// The ubiquitous origin type.\n    type Origin = Origin;\n    /// Maximum number of block number to block hash mappings to keep (oldest pruned first).\n    type BlockHashCount = BlockHashCount;\n    /// Maximum weight of each block.\n    type MaximumBlockWeight = MaximumBlockWeight;\n    /// The weight of database operations that the runtime can invoke.\n    type DbWeight = RocksDbWeight;\n    /// The weight of the overhead invoked on the block import process, independent of the\n    /// extrinsics included in that block.\n    type BlockExecutionWeight = BlockExecutionWeight;\n    /// The base weight of any extrinsic processed by the runtime, independent of the\n    /// logic of that extrinsic. (Signature verification, nonce increment, fee, etc...)\n    type ExtrinsicBaseWeight = ExtrinsicBaseWeight;\n    /// The maximum weight that a single extrinsic of `Normal` dispatch class can have,\n    /// idependent of the logic of that extrinsics. (Roughly max block weight - average on\n    /// initialize cost).\n    type MaximumExtrinsicWeight = MaximumExtrinsicWeight;\n    /// Maximum size of all encoded transactions (in bytes) that are allowed in one block.\n    type MaximumBlockLength = MaximumBlockLength;\n    /// Portion of the block weight that is available to all normal transactions.\n    type AvailableBlockRatio = AvailableBlockRatio;\n    /// Version of the runtime.\n    type Version = Version;\n    /// Converts a module to the index of the module in `construct_runtime!`.\n    ///\n    /// This type is being generated by `construct_runtime!`.\n    type ModuleToIndex = ModuleToIndex;\n    /// What to do if a new account is created.\n    type OnNewAccount = ();\n    /// What to do if an account is fully reaped from the system.\n    type OnKilledAccount = ();\n    /// The data to be stored in an account.\n    type AccountData = pallet_balances::AccountData\u003cBalance\u003e;\n    /// Weight information for the extrinsics of this pallet.\n    type SystemWeightInfo = ();\n}\n\nimpl pallet_aura::Trait for Runtime {\n    type AuthorityId = AuraId;\n}\n\nimpl pallet_grandpa::Trait for Runtime {\n    type Event = Event;\n    type Call = Call;\n\n    type KeyOwnerProofSystem = ();\n\n    type KeyOwnerProof =\n        \u003cSelf::KeyOwnerProofSystem as KeyOwnerProofSystem\u003c(KeyTypeId, GrandpaId)\u003e\u003e::Proof;\n\n    type KeyOwnerIdentification = \u003cSelf::KeyOwnerProofSystem as KeyOwnerProofSystem\u003c(\n        KeyTypeId,\n        GrandpaId,\n    )\u003e\u003e::IdentificationTuple;\n\n    type HandleEquivocation = ();\n}\n\nparameter_types! {\n    pub const MinimumPeriod: u64 = SLOT_DURATION / 2;\n}\n\nimpl pallet_timestamp::Trait for Runtime {\n    /// A timestamp: milliseconds since the unix epoch.\n    type Moment = u64;\n    type OnTimestampSet = Aura;\n    type MinimumPeriod = MinimumPeriod;\n    type WeightInfo = ();\n}\n\nparameter_types! {\n    pub const ExistentialDeposit: u128 = 500;\n}\n\nimpl pallet_balances::Trait for Runtime {\n    /// The type for recording an account's balance.\n    type Balance = Balance;\n    /// The ubiquitous event type.\n    type Event = Event;\n    type DustRemoval = ();\n    type ExistentialDeposit = ExistentialDeposit;\n    type AccountStore = System;\n    type WeightInfo = ();\n}\n\nparameter_types! {\n    pub const TransactionByteFee: Balance = 1;\n}\n\nimpl pallet_transaction_payment::Trait for Runtime {\n    type Currency = Balances;\n    type OnTransactionPayment = ();\n    type TransactionByteFee = TransactionByteFee;\n    type WeightToFee = IdentityFee\u003cBalance\u003e;\n    type FeeMultiplierUpdate = ();\n}\n\nimpl pallet_sudo::Trait for Runtime {\n    type Event = Event;\n    type Call = Call;\n}\n\nparameter_types! {\n    pub const PriceCount: u32 = 30;\n    pub const PricePeriod: u32 = 1440;\n    pub const ReturnType: u32 = CalcReturnType::Log.into_u32();\n    pub const VolCorType: i64 = CalcVolatilityType::Regular.into_i64();\n}\n\npub type FixedNumber = substrate_fixed::types::I64F64;\n\n/// Configure the pallet financial in pallets/financial.\nimpl financial_pallet::Trait for Runtime {\n    type Event = Event;\n    type UnixTime = manual_timestamp::Module\u003cRuntime\u003e;\n    type PriceCount = PriceCount;\n    type PricePeriod = PricePeriod;\n    type ReturnType = ReturnType;\n    type VolCorType = VolCorType;\n    type FixedNumberBits = i128;\n    type FixedNumber = FixedNumber;\n    type Price = FixedNumber;\n    type Asset = Asset;\n    type Balances = portfolio::Module\u003cRuntime\u003e;\n}\n\n/// Configure the pallet oracle in pallets/oracle.\nimpl oracle::Trait for Runtime {\n    type Event = Event;\n    type Price = FixedNumber;\n    type OnPriceSet = financial_pallet::Module\u003cRuntime\u003e;\n    type Asset = Asset;\n}\n\n/// Configure the pallet manual-timestamp in pallets/manual-timestamp.\nimpl manual_timestamp::Trait for Runtime {\n    type Event = Event;\n}\n\n/// Configure the pallet portfolio in pallets/portfolio.\nimpl portfolio::Trait for Runtime {\n    type Event = Event;\n    type Asset = Asset;\n    type Balance = FixedNumber;\n}\n\n// Create the runtime by composing the FRAME pallets that were previously configured.\nconstruct_runtime!(\n    pub enum Runtime where\n        Block = Block,\n        NodeBlock = opaque::Block,\n        UncheckedExtrinsic = UncheckedExtrinsic\n    {\n        System: frame_system::{Module, Call, Config, Storage, Event\u003cT\u003e},\n        RandomnessCollectiveFlip: pallet_randomness_collective_flip::{Module, Call, Storage},\n        Timestamp: pallet_timestamp::{Module, Call, Storage, Inherent},\n        Aura: pallet_aura::{Module, Config\u003cT\u003e, Inherent},\n        Grandpa: pallet_grandpa::{Module, Call, Storage, Config, Event},\n        Balances: pallet_balances::{Module, Call, Storage, Config\u003cT\u003e, Event\u003cT\u003e},\n        TransactionPayment: pallet_transaction_payment::{Module, Storage},\n        Sudo: pallet_sudo::{Module, Call, Config\u003cT\u003e, Storage, Event\u003cT\u003e},\n\n        Financial: financial_pallet::{Module, Call, Storage, Event\u003cT\u003e, Config\u003cT\u003e},\n        Oracle: oracle::{Module, Call, Storage, Event\u003cT\u003e, Config\u003cT\u003e},\n        ManualTimestamp: manual_timestamp::{Module, Call, Storage, Event\u003cT\u003e, Config},\n        Portfolio: portfolio::{Module, Call, Storage, Event\u003cT\u003e},\n    }\n);\n\n/// The address format for describing accounts.\npub type Address = AccountId;\n/// Block header type as expected by this runtime.\npub type Header = generic::Header\u003cBlockNumber, BlakeTwo256\u003e;\n/// Block type as expected by this runtime.\npub type Block = generic::Block\u003cHeader, UncheckedExtrinsic\u003e;\n/// A Block signed with a Justification\npub type SignedBlock = generic::SignedBlock\u003cBlock\u003e;\n/// BlockId type as expected by this runtime.\npub type BlockId = generic::BlockId\u003cBlock\u003e;\n/// The SignedExtension to the basic transaction logic.\npub type SignedExtra = (\n    frame_system::CheckSpecVersion\u003cRuntime\u003e,\n    frame_system::CheckTxVersion\u003cRuntime\u003e,\n    frame_system::CheckGenesis\u003cRuntime\u003e,\n    frame_system::CheckEra\u003cRuntime\u003e,\n    frame_system::CheckNonce\u003cRuntime\u003e,\n    frame_system::CheckWeight\u003cRuntime\u003e,\n    pallet_transaction_payment::ChargeTransactionPayment\u003cRuntime\u003e,\n);\n/// Unchecked extrinsic type as expected by this runtime.\npub type UncheckedExtrinsic = generic::UncheckedExtrinsic\u003cAddress, Call, Signature, SignedExtra\u003e;\n/// Extrinsic type that has already been checked.\npub type CheckedExtrinsic = generic::CheckedExtrinsic\u003cAccountId, Call, SignedExtra\u003e;\n/// Executive: handles dispatch to the various modules.\npub type Executive = frame_executive::Executive\u003c\n    Runtime,\n    Block,\n    frame_system::ChainContext\u003cRuntime\u003e,\n    Runtime,\n    AllModules,\n\u003e;\n\nimpl_runtime_apis! {\n    impl sp_api::Core\u003cBlock\u003e for Runtime {\n        fn version() -\u003e RuntimeVersion {\n            VERSION\n        }\n\n        fn execute_block(block: Block) {\n            Executive::execute_block(block)\n        }\n\n        fn initialize_block(header: \u0026\u003cBlock as BlockT\u003e::Header) {\n            Executive::initialize_block(header)\n        }\n    }\n\n    impl sp_api::Metadata\u003cBlock\u003e for Runtime {\n        fn metadata() -\u003e OpaqueMetadata {\n            Runtime::metadata().into()\n        }\n    }\n\n    impl sp_block_builder::BlockBuilder\u003cBlock\u003e for Runtime {\n        fn apply_extrinsic(extrinsic: \u003cBlock as BlockT\u003e::Extrinsic) -\u003e ApplyExtrinsicResult {\n            Executive::apply_extrinsic(extrinsic)\n        }\n\n        fn finalize_block() -\u003e \u003cBlock as BlockT\u003e::Header {\n            Executive::finalize_block()\n        }\n\n        fn inherent_extrinsics(data: sp_inherents::InherentData) -\u003e Vec\u003c\u003cBlock as BlockT\u003e::Extrinsic\u003e {\n            data.create_extrinsics()\n        }\n\n        fn check_inherents(\n            block: Block,\n            data: sp_inherents::InherentData,\n        ) -\u003e sp_inherents::CheckInherentsResult {\n            data.check_extrinsics(\u0026block)\n        }\n\n        fn random_seed() -\u003e \u003cBlock as BlockT\u003e::Hash {\n            RandomnessCollectiveFlip::random_seed()\n        }\n    }\n\n    impl sp_transaction_pool::runtime_api::TaggedTransactionQueue\u003cBlock\u003e for Runtime {\n        fn validate_transaction(\n            source: TransactionSource,\n            tx: \u003cBlock as BlockT\u003e::Extrinsic,\n        ) -\u003e TransactionValidity {\n            Executive::validate_transaction(source, tx)\n        }\n    }\n\n    impl sp_offchain::OffchainWorkerApi\u003cBlock\u003e for Runtime {\n        fn offchain_worker(header: \u0026\u003cBlock as BlockT\u003e::Header) {\n            Executive::offchain_worker(header)\n        }\n    }\n\n    impl sp_consensus_aura::AuraApi\u003cBlock, AuraId\u003e for Runtime {\n        fn slot_duration() -\u003e u64 {\n            Aura::slot_duration()\n        }\n\n        fn authorities() -\u003e Vec\u003cAuraId\u003e {\n            Aura::authorities()\n        }\n    }\n\n    impl sp_session::SessionKeys\u003cBlock\u003e for Runtime {\n        fn generate_session_keys(seed: Option\u003cVec\u003cu8\u003e\u003e) -\u003e Vec\u003cu8\u003e {\n            opaque::SessionKeys::generate(seed)\n        }\n\n        fn decode_session_keys(\n            encoded: Vec\u003cu8\u003e,\n        ) -\u003e Option\u003cVec\u003c(Vec\u003cu8\u003e, KeyTypeId)\u003e\u003e {\n            opaque::SessionKeys::decode_into_raw_public_keys(\u0026encoded)\n        }\n    }\n\n    impl fg_primitives::GrandpaApi\u003cBlock\u003e for Runtime {\n        fn grandpa_authorities() -\u003e GrandpaAuthorityList {\n            Grandpa::grandpa_authorities()\n        }\n\n        fn submit_report_equivocation_unsigned_extrinsic(\n            _equivocation_proof: fg_primitives::EquivocationProof\u003c\n                \u003cBlock as BlockT\u003e::Hash,\n                NumberFor\u003cBlock\u003e,\n            \u003e,\n            _key_owner_proof: fg_primitives::OpaqueKeyOwnershipProof,\n        ) -\u003e Option\u003c()\u003e {\n            None\n        }\n\n        fn generate_key_ownership_proof(\n            _set_id: fg_primitives::SetId,\n            _authority_id: GrandpaId,\n        ) -\u003e Option\u003cfg_primitives::OpaqueKeyOwnershipProof\u003e {\n            // NOTE: this is the only implementation possible since we've\n            // defined our key owner proof type as a bottom type (i.e. a type\n            // with no values).\n            None\n        }\n    }\n\n    impl frame_system_rpc_runtime_api::AccountNonceApi\u003cBlock, AccountId, Index\u003e for Runtime {\n        fn account_nonce(account: AccountId) -\u003e Index {\n            System::account_nonce(account)\n        }\n    }\n\n    impl pallet_transaction_payment_rpc_runtime_api::TransactionPaymentApi\u003cBlock, Balance\u003e for Runtime {\n        fn query_info(\n            uxt: \u003cBlock as BlockT\u003e::Extrinsic,\n            len: u32,\n        ) -\u003e pallet_transaction_payment_rpc_runtime_api::RuntimeDispatchInfo\u003cBalance\u003e {\n            TransactionPayment::query_info(uxt, len)\n        }\n    }\n}\n","traces":[{"line":100,"address":[4356565,4356925,4356306,4356882],"length":1,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[5435552],"length":1,"stats":{"Line":0},"fn_name":"native_version"},{"line":132,"address":[5435559],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[5435697],"length":1,"stats":{"Line":1},"fn_name":null},{"line":142,"address":[5435764,5435732,5435793],"length":1,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[5435741,5435774],"length":1,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[5435844],"length":1,"stats":{"Line":0},"fn_name":null},{"line":277,"address":[5435953],"length":1,"stats":{"Line":0},"fn_name":null},{"line":278,"address":[5435985],"length":1,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[5436112,5436144,5438244,5437188,5437924,5436016,5436037,5436096,5436521,5436884,5437451,5437620,5436213],"length":1,"stats":{"Line":4},"fn_name":"fmt"},{"line":325,"address":[5765935,5766079],"length":1,"stats":{"Line":0},"fn_name":null},{"line":326,"address":[5766514,5766116],"length":1,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[5766559,5766668],"length":1,"stats":{"Line":0},"fn_name":null},{"line":329,"address":[5766930,5766705],"length":1,"stats":{"Line":0},"fn_name":null},{"line":330,"address":[5767330,5766967],"length":1,"stats":{"Line":0},"fn_name":null},{"line":332,"address":[5767367,5767730],"length":1,"stats":{"Line":0},"fn_name":null},{"line":334,"address":[5767767,5768126],"length":1,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[5768163,5768376],"length":1,"stats":{"Line":0},"fn_name":null},{"line":336,"address":[5768674,5768413],"length":1,"stats":{"Line":0},"fn_name":null},{"line":337,"address":[5768711,5768923],"length":1,"stats":{"Line":0},"fn_name":null},{"line":374,"address":[5963785,5958904,5965051,5963501,5958499,5966123,5967760,5957188,5964174,5961019,5954538,5956170,5952576,5964279,5961507,5966518,5955292,5958215,5959507,5962320,5952631,5968559,5966535,5957577,5966994,5959920,5968904,5964968,5956815,5954903,5965627,5967410,5958987,5964563,5961424,5960025],"length":1,"stats":{"Line":0},"fn_name":"dispatch"},{"line":376,"address":[5458224],"length":1,"stats":{"Line":0},"fn_name":"version"},{"line":377,"address":[5458228],"length":1,"stats":{"Line":0},"fn_name":null},{"line":380,"address":[5458256],"length":1,"stats":{"Line":0},"fn_name":"execute_block"},{"line":381,"address":[5458263],"length":1,"stats":{"Line":0},"fn_name":null},{"line":384,"address":[5458320],"length":1,"stats":{"Line":0},"fn_name":"initialize_block"},{"line":385,"address":[5458325],"length":1,"stats":{"Line":0},"fn_name":null},{"line":390,"address":[5458336],"length":1,"stats":{"Line":0},"fn_name":"metadata"},{"line":391,"address":[5458343],"length":1,"stats":{"Line":0},"fn_name":null},{"line":396,"address":[5458400],"length":1,"stats":{"Line":0},"fn_name":"apply_extrinsic"},{"line":397,"address":[5458410],"length":1,"stats":{"Line":0},"fn_name":null},{"line":400,"address":[5458480],"length":1,"stats":{"Line":0},"fn_name":"finalize_block"},{"line":401,"address":[5458488],"length":1,"stats":{"Line":0},"fn_name":null},{"line":404,"address":[5458536,5458512],"length":1,"stats":{"Line":0},"fn_name":"inherent_extrinsics"},{"line":405,"address":[5458529],"length":1,"stats":{"Line":0},"fn_name":null},{"line":408,"address":[5458647,5458608],"length":1,"stats":{"Line":0},"fn_name":"check_inherents"},{"line":409,"address":[5959266,5959373],"length":1,"stats":{"Line":0},"fn_name":null},{"line":410,"address":[5959333,5959435],"length":1,"stats":{"Line":0},"fn_name":null},{"line":412,"address":[5458620],"length":1,"stats":{"Line":0},"fn_name":null},{"line":415,"address":[5458752],"length":1,"stats":{"Line":0},"fn_name":"random_seed"},{"line":416,"address":[5458760],"length":1,"stats":{"Line":0},"fn_name":null},{"line":421,"address":[5458784],"length":1,"stats":{"Line":0},"fn_name":"validate_transaction"},{"line":422,"address":[5960840],"length":1,"stats":{"Line":0},"fn_name":null},{"line":423,"address":[5960851],"length":1,"stats":{"Line":0},"fn_name":null},{"line":425,"address":[5458802],"length":1,"stats":{"Line":0},"fn_name":null},{"line":430,"address":[5458896],"length":1,"stats":{"Line":0},"fn_name":"offchain_worker"},{"line":431,"address":[5458901],"length":1,"stats":{"Line":0},"fn_name":null},{"line":436,"address":[5458912],"length":1,"stats":{"Line":0},"fn_name":"slot_duration"},{"line":437,"address":[5458913],"length":1,"stats":{"Line":0},"fn_name":null},{"line":440,"address":[5458928],"length":1,"stats":{"Line":0},"fn_name":"authorities"},{"line":441,"address":[5458936],"length":1,"stats":{"Line":0},"fn_name":null},{"line":446,"address":[5458960],"length":1,"stats":{"Line":0},"fn_name":"generate_session_keys"},{"line":447,"address":[5458967],"length":1,"stats":{"Line":0},"fn_name":null},{"line":450,"address":[5459024,5459069],"length":1,"stats":{"Line":0},"fn_name":"decode_session_keys"},{"line":451,"address":[5964507],"length":1,"stats":{"Line":0},"fn_name":null},{"line":453,"address":[5459095,5459031],"length":1,"stats":{"Line":0},"fn_name":null},{"line":458,"address":[5459152],"length":1,"stats":{"Line":0},"fn_name":"grandpa_authorities"},{"line":459,"address":[5459160],"length":1,"stats":{"Line":0},"fn_name":null},{"line":462,"address":[5459184],"length":1,"stats":{"Line":0},"fn_name":"submit_report_equivocation_unsigned_extrinsic"},{"line":463,"address":[5965919,5966013],"length":1,"stats":{"Line":0},"fn_name":null},{"line":467,"address":[5965965,5966059],"length":1,"stats":{"Line":0},"fn_name":null},{"line":469,"address":[5459188],"length":1,"stats":{"Line":0},"fn_name":null},{"line":472,"address":[5459232],"length":1,"stats":{"Line":0},"fn_name":"generate_key_ownership_proof"},{"line":473,"address":[5966850],"length":1,"stats":{"Line":0},"fn_name":null},{"line":474,"address":[5966866],"length":1,"stats":{"Line":0},"fn_name":null},{"line":479,"address":[5459240],"length":1,"stats":{"Line":0},"fn_name":null},{"line":484,"address":[5459264],"length":1,"stats":{"Line":0},"fn_name":"account_nonce"},{"line":485,"address":[5459268],"length":1,"stats":{"Line":0},"fn_name":null},{"line":490,"address":[5459328],"length":1,"stats":{"Line":0},"fn_name":"query_info"},{"line":491,"address":[5968411,5968482],"length":1,"stats":{"Line":0},"fn_name":null},{"line":492,"address":[5968466],"length":1,"stats":{"Line":0},"fn_name":null},{"line":494,"address":[5459345],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":2,"coverable":72}]};
        var previousData = {"files":[{"path":["/","home","rotor","work","src","polka","financial-pallet","common","src","lib.rs"],"content":"#![cfg_attr(not(feature = \"std\"), no_std)]\n\nuse core::slice::Iter;\nuse frame_support::codec::{Decode, Encode};\n#[cfg(feature = \"std\")]\nuse serde::{Deserialize, Serialize};\n\n#[derive(Encode, Decode, Debug, PartialEq, Eq, Clone, Copy, Hash, Ord, PartialOrd)]\n#[cfg_attr(feature = \"std\", derive(Serialize, Deserialize))]\npub enum Asset {\n    Unknown,\n    Usd,\n    Eq,\n    Eth,\n    Btc,\n    Eos,\n}\n\nimpl Default for Asset {\n    fn default() -\u003e Asset {\n        Asset::Unknown\n    }\n}\n\nimpl Asset {\n    pub fn iterator() -\u003e Iter\u003c'static, Asset\u003e {\n        static ASSETS: [Asset; 5] = [Asset::Usd, Asset::Eq, Asset::Eth, Asset::Btc, Asset::Eos];\n        ASSETS.iter()\n    }\n}\n\nimpl Asset {\n    pub fn value(\u0026self) -\u003e u8 {\n        match *self {\n            Asset::Unknown =\u003e 0x0,\n            Asset::Usd =\u003e 0x1,\n            Asset::Eq =\u003e 0x2,\n            Asset::Eth =\u003e 0x3,\n            Asset::Btc =\u003e 0x4,\n            Asset::Eos =\u003e 0x5,\n        }\n    }\n}\n","traces":[{"line":20,"address":[5447440],"length":1,"stats":{"Line":0},"fn_name":"default"},{"line":21,"address":[5447444],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[5447456],"length":1,"stats":{"Line":0},"fn_name":"iterator"},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[5447467],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[5447520],"length":1,"stats":{"Line":0},"fn_name":"value"},{"line":34,"address":[5447563,5447586,5447572,5447579,5447593],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[5464102],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":13},{"path":["/","home","rotor","work","src","polka","financial-pallet","financial-primitives","src","capvec.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nuse frame_support::codec::{Decode, Encode};\nuse sp_std::ops::Range;\nuse sp_std::prelude::Vec;\n\nenum OneOfThree\u003cT1, T2, T3\u003e {\n    First(T1),\n    Second(T2),\n    Third(T3),\n}\n\nfn split_range(\n    range: \u0026Range\u003cusize\u003e,\n    head: usize,\n    length: usize,\n) -\u003e OneOfThree\u003c(), Range\u003cusize\u003e, (Range\u003cusize\u003e, Range\u003cusize\u003e)\u003e {\n    assert!(\n        range.start \u003c= length,\n        \"range start index {} out of range for CapVec of length {}\",\n        range.start,\n        length\n    );\n    assert!(\n        range.end \u003c= length,\n        \"range end index {} out of range for CapVec of length {}\",\n        range.start,\n        length\n    );\n\n    if range.is_empty() {\n        OneOfThree::First(())\n    } else {\n        let upper_start = range.start + head;\n        let upper_end = range.end + head;\n\n        if upper_start \u003c length \u0026\u0026 upper_end \u003c= length {\n            // Range fits in the upper part\n            OneOfThree::Second(upper_start..upper_end)\n        } else {\n            let lower_start = upper_start % length;\n            let lower_end = upper_end % length;\n\n            if lower_start \u003c head \u0026\u0026 lower_end \u003c= head {\n                // Range fits in the lower part\n                OneOfThree::Second(lower_start..lower_end)\n            } else {\n                // Range located in both upper and lower parts\n                OneOfThree::Third((upper_start..length, 0..lower_end))\n            }\n        }\n    }\n}\n\n#[derive(Encode, Decode, Clone, Default, PartialEq, Eq, Debug)]\npub struct CapVec\u003cT\u003e {\n    head_index: u32,\n    len_cap: u32,\n    items: Vec\u003cT\u003e,\n}\n\nuse sp_std::fmt::Debug;\nimpl\u003cT\u003e CapVec\u003cT\u003e {\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// ```\n    pub fn new(length: u32) -\u003e CapVec\u003cT\u003e {\n        CapVec {\n            head_index: 0,\n            len_cap: length,\n            items: Vec::new(),\n        }\n    }\n\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// items.push(1);\n    /// ```\n    pub fn push(\u0026mut self, item: T) {\n        if self.items.len() \u003c (self.len_cap as usize) {\n            self.items.push(item);\n        } else {\n            self.items[self.head_index as usize] = item;\n            self.head_index = (self.head_index + 1) % (self.items.len() as u32);\n        }\n    }\n\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// items.push(1);\n    /// items.push(2);\n    /// items.push(3);\n    /// let items_vec: Vec\u003c_\u003e = items.iter().copied().collect();\n    /// assert_eq!(items_vec, vec![2, 3]);\n    /// ```\n    pub fn iter(\u0026self) -\u003e impl Iterator\u003cItem = \u0026T\u003e {\n        let head = self.head_index as usize;\n        let first_part = self.items[head..].iter();\n        let last_part = self.items[..head].iter();\n\n        first_part.chain(last_part)\n    }\n\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(4);\n    /// items.push(1);\n    /// items.push(2);\n    /// items.push(3);\n    /// items.push(4);\n    /// let items_vec: Vec\u003c_\u003e = items.iter_range(\u0026(1..3)).copied().collect();\n    /// assert_eq!(items_vec, vec![2, 3]);\n    /// ```\n    pub fn iter_range(\u0026self, range: \u0026Range\u003cusize\u003e) -\u003e impl Iterator\u003cItem = \u0026T\u003e {\n        let ranges = split_range(range, self.head_index as usize, self.items.len());\n        let (range1, range2) = match ranges {\n            OneOfThree::First(_) =\u003e ((0..0), (0..0)),\n            OneOfThree::Second(r) =\u003e (r, (0..0)),\n            OneOfThree::Third((r1, r2)) =\u003e (r1, r2),\n        };\n\n        let first_part = self.items[range1].iter();\n        let last_part = self.items[range2].iter();\n\n        first_part.chain(last_part)\n    }\n\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// assert_eq!(items.len_cap(), 2);\n    /// ```\n    pub fn len_cap(\u0026self) -\u003e u32 {\n        self.len_cap\n    }\n\n    pub fn len(\u0026self) -\u003e usize {\n        self.items.len()\n    }\n\n    /// # Examples\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// assert_eq!(items.last(), None);\n    /// ```\n    /// ```\n    /// # use financial_primitives::capvec::CapVec;\n    /// let mut items = CapVec::\u003cu64\u003e::new(2);\n    /// items.push(1);\n    /// items.push(2);\n    /// items.push(3);\n    /// assert_eq!(items.last(), Some(\u00263));\n    /// ```\n    pub fn last(\u0026self) -\u003e Option\u003c\u0026T\u003e {\n        let len = self.items.len();\n\n        if len == 0 {\n            None\n        } else if len \u003c (self.len_cap as usize) {\n            Some(\u0026self.items[len - 1])\n        } else {\n            let index = (self.len_cap + self.head_index - 1) % (self.len_cap);\n            Some(\u0026self.items[index as usize])\n        }\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_empty() {\n        let capvec = CapVec::\u003cu32\u003e::new(5);\n\n        let actual: Vec\u003c_\u003e = capvec.iter().cloned().collect();\n        let expected: Vec\u003cu32\u003e = vec![];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_not_capped() {\n        let mut capvec = CapVec::\u003cu32\u003e::new(5);\n        capvec.push(1);\n        capvec.push(2);\n        capvec.push(3);\n\n        let actual: Vec\u003c_\u003e = capvec.iter().cloned().collect();\n        let expected: Vec\u003cu32\u003e = vec![1, 2, 3];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_capped() {\n        let mut capvec = CapVec::\u003cu32\u003e::new(5);\n        capvec.push(1);\n        capvec.push(2);\n        capvec.push(3);\n        capvec.push(4);\n        capvec.push(5);\n        capvec.push(6);\n\n        let actual: Vec\u003c_\u003e = capvec.iter().cloned().collect();\n        let expected: Vec\u003cu32\u003e = vec![2, 3, 4, 5, 6];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_last_empty() {\n        let capvec = CapVec::\u003cu32\u003e::new(5);\n\n        let actual = capvec.last();\n        let expected = None;\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_last_non_empty() {\n        let mut capvec = CapVec::\u003cu32\u003e::new(5);\n        capvec.push(1);\n        capvec.push(2);\n        capvec.push(3);\n        capvec.push(4);\n        capvec.push(5);\n        capvec.push(6);\n\n        let actual = capvec.last();\n        let expected = Some(\u00266);\n\n        assert_eq!(actual, expected);\n    }\n\n    fn from_vec\u003cT: Debug\u003e(cap: u32, items: Vec\u003cT\u003e) -\u003e CapVec\u003cT\u003e {\n        let mut capvec = CapVec::\u003cT\u003e::new(cap);\n        for item in items.into_iter() {\n            capvec.push(item);\n        }\n\n        capvec\n    }\n\n    #[test]\n    fn test_iter_range_full_range() {\n        let capvec = from_vec(5, vec![1, 2, 3, 4, 5]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(0..5)).copied().collect();\n        let expected = vec![1, 2, 3, 4, 5];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_iter_range_empty_range() {\n        let capvec = from_vec(5, vec![1, 2, 3, 4, 5]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(0..0)).copied().collect();\n        let expected = vec![];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_iter_range_first_part_range() {\n        let capvec = from_vec(6, vec![1, 2, 3, 4, 5, 6, 7, 8, 9]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(1..3)).copied().collect();\n        let expected = vec![5, 6];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_iter_range_second_part_range() {\n        let capvec = from_vec(6, vec![1, 2, 3, 4, 5, 6, 7, 8, 9]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(4..6)).copied().collect();\n        let expected = vec![8, 9];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_iter_range_both_parts_range() {\n        let capvec = from_vec(6, vec![1, 2, 3, 4, 5, 6, 7, 8, 9]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(2..5)).copied().collect();\n        let expected = vec![6, 7, 8];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn test_iter_range_small_range_start_on_zero() {\n        let capvec = from_vec(5, vec![1, 2, 3, 4, 5]);\n\n        let actual: Vec\u003c_\u003e = capvec.iter_range(\u0026(1..3)).copied().collect();\n        let expected = vec![2, 3];\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    #[should_panic(expected = \"index out of bounds: the len is 0 but the index is 0\")]\n    fn test_zero_cap() {\n        let mut capvec = CapVec::\u003cu32\u003e::new(0);\n        capvec.push(1);\n    }\n}\n","traces":[{"line":26,"address":[4243648],"length":1,"stats":{"Line":11},"fn_name":"split_range"},{"line":31,"address":[4243697,4243801],"length":1,"stats":{"Line":11},"fn_name":null},{"line":32,"address":[4243682],"length":1,"stats":{"Line":11},"fn_name":null},{"line":37,"address":[4243762,4244120],"length":1,"stats":{"Line":14},"fn_name":null},{"line":38,"address":[4243747],"length":1,"stats":{"Line":14},"fn_name":null},{"line":44,"address":[4245069,4244422,4244084,4244363],"length":1,"stats":{"Line":40},"fn_name":null},{"line":45,"address":[4244415],"length":1,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[4245087,4244385,4244432],"length":1,"stats":{"Line":26},"fn_name":null},{"line":48,"address":[4245117,4244456],"length":1,"stats":{"Line":13},"fn_name":null},{"line":50,"address":[4245067,4244497,4244652],"length":1,"stats":{"Line":25},"fn_name":null},{"line":52,"address":[4244592],"length":1,"stats":{"Line":11},"fn_name":null},{"line":54,"address":[4244556,4244662,4245147],"length":1,"stats":{"Line":4},"fn_name":null},{"line":55,"address":[4245177,4245207,4244682],"length":1,"stats":{"Line":2},"fn_name":null},{"line":57,"address":[4244756,4245000],"length":1,"stats":{"Line":3},"fn_name":null},{"line":59,"address":[4245007],"length":1,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[4244819],"length":1,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":34},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":19},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":115,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":120,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":135,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":142,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":179,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":195,"address":[4222352,4222376],"length":1,"stats":{"Line":3},"fn_name":"test_empty"},{"line":196,"address":[4222359],"length":1,"stats":{"Line":1},"fn_name":null},{"line":198,"address":[4222459,4222404],"length":1,"stats":{"Line":2},"fn_name":null},{"line":199,"address":[4222466],"length":1,"stats":{"Line":1},"fn_name":null},{"line":201,"address":[4222643,4222490,4222597],"length":1,"stats":{"Line":2},"fn_name":null},{"line":205,"address":[4223040,4223064],"length":1,"stats":{"Line":3},"fn_name":"test_not_capped"},{"line":206,"address":[4223047],"length":1,"stats":{"Line":1},"fn_name":null},{"line":207,"address":[4223089],"length":1,"stats":{"Line":1},"fn_name":null},{"line":208,"address":[4223106],"length":1,"stats":{"Line":1},"fn_name":null},{"line":209,"address":[4223135],"length":1,"stats":{"Line":1},"fn_name":null},{"line":211,"address":[4223155],"length":1,"stats":{"Line":1},"fn_name":null},{"line":212,"address":[4223215],"length":1,"stats":{"Line":1},"fn_name":null},{"line":214,"address":[4223288,4223428],"length":1,"stats":{"Line":1},"fn_name":null},{"line":218,"address":[4222032,4222037],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":219,"address":[4223847],"length":1,"stats":{"Line":1},"fn_name":null},{"line":220,"address":[4223889],"length":1,"stats":{"Line":1},"fn_name":null},{"line":221,"address":[4223906],"length":1,"stats":{"Line":1},"fn_name":null},{"line":222,"address":[4223935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":223,"address":[4223952],"length":1,"stats":{"Line":1},"fn_name":null},{"line":224,"address":[4223969],"length":1,"stats":{"Line":1},"fn_name":null},{"line":225,"address":[4223986],"length":1,"stats":{"Line":1},"fn_name":null},{"line":227,"address":[4224006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":228,"address":[4224066],"length":1,"stats":{"Line":1},"fn_name":null},{"line":230,"address":[4224153,4224293],"length":1,"stats":{"Line":1},"fn_name":null},{"line":234,"address":[4222069,4222064],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":235,"address":[4224711],"length":1,"stats":{"Line":1},"fn_name":null},{"line":237,"address":[4224748],"length":1,"stats":{"Line":1},"fn_name":null},{"line":238,"address":[4224773],"length":1,"stats":{"Line":1},"fn_name":null},{"line":240,"address":[4224916,4224793,4224895],"length":1,"stats":{"Line":2},"fn_name":null},{"line":244,"address":[4222101,4222096],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":245,"address":[4225271],"length":1,"stats":{"Line":1},"fn_name":null},{"line":246,"address":[4225313],"length":1,"stats":{"Line":1},"fn_name":null},{"line":247,"address":[4225330],"length":1,"stats":{"Line":1},"fn_name":null},{"line":248,"address":[4225359],"length":1,"stats":{"Line":1},"fn_name":null},{"line":249,"address":[4225376],"length":1,"stats":{"Line":1},"fn_name":null},{"line":250,"address":[4225393],"length":1,"stats":{"Line":1},"fn_name":null},{"line":251,"address":[4225410],"length":1,"stats":{"Line":1},"fn_name":null},{"line":253,"address":[4225422],"length":1,"stats":{"Line":1},"fn_name":null},{"line":254,"address":[4225447],"length":1,"stats":{"Line":1},"fn_name":null},{"line":256,"address":[4225470,4225578],"length":1,"stats":{"Line":1},"fn_name":null},{"line":259,"address":[4221519,4221456],"length":1,"stats":{"Line":6},"fn_name":"from_vec\u003ci32\u003e"},{"line":260,"address":[4221473],"length":1,"stats":{"Line":6},"fn_name":null},{"line":261,"address":[4221696,4221752,4221820,4221613,4221534],"length":1,"stats":{"Line":24},"fn_name":null},{"line":262,"address":[4221803],"length":1,"stats":{"Line":6},"fn_name":null},{"line":269,"address":[4222133,4222128],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":270,"address":[4225927,4226017],"length":1,"stats":{"Line":2},"fn_name":null},{"line":272,"address":[4226040,4226118],"length":1,"stats":{"Line":2},"fn_name":null},{"line":273,"address":[4226135],"length":1,"stats":{"Line":1},"fn_name":null},{"line":275,"address":[4226221,4226357],"length":1,"stats":{"Line":1},"fn_name":null},{"line":279,"address":[4222160,4222165],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":280,"address":[4226775,4226865],"length":1,"stats":{"Line":2},"fn_name":null},{"line":282,"address":[4226888,4226966],"length":1,"stats":{"Line":2},"fn_name":null},{"line":283,"address":[4226973],"length":1,"stats":{"Line":1},"fn_name":null},{"line":285,"address":[4227106,4227000,4227152],"length":1,"stats":{"Line":2},"fn_name":null},{"line":289,"address":[4222197,4222192],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":290,"address":[4227575,4227693],"length":1,"stats":{"Line":2},"fn_name":null},{"line":292,"address":[4227794,4227716],"length":1,"stats":{"Line":2},"fn_name":null},{"line":293,"address":[4227811],"length":1,"stats":{"Line":1},"fn_name":null},{"line":295,"address":[4227876,4228012],"length":1,"stats":{"Line":1},"fn_name":null},{"line":299,"address":[4222224,4222229],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":300,"address":[4228541,4228423],"length":1,"stats":{"Line":2},"fn_name":null},{"line":302,"address":[4228564,4228642],"length":1,"stats":{"Line":2},"fn_name":null},{"line":303,"address":[4228659],"length":1,"stats":{"Line":1},"fn_name":null},{"line":305,"address":[4228860,4228724],"length":1,"stats":{"Line":1},"fn_name":null},{"line":309,"address":[4222261,4222256],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":310,"address":[4229389,4229271],"length":1,"stats":{"Line":2},"fn_name":null},{"line":312,"address":[4229412,4229490],"length":1,"stats":{"Line":2},"fn_name":null},{"line":313,"address":[4229507],"length":1,"stats":{"Line":1},"fn_name":null},{"line":315,"address":[4229579,4229715],"length":1,"stats":{"Line":1},"fn_name":null},{"line":319,"address":[4222288,4222293],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":320,"address":[4230225,4230135],"length":1,"stats":{"Line":2},"fn_name":null},{"line":322,"address":[4230326,4230248],"length":1,"stats":{"Line":2},"fn_name":null},{"line":323,"address":[4230343],"length":1,"stats":{"Line":1},"fn_name":null},{"line":325,"address":[4230544,4230408],"length":1,"stats":{"Line":1},"fn_name":null},{"line":330,"address":[4222320,4222325],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}"},{"line":331,"address":[4230966],"length":1,"stats":{"Line":1},"fn_name":null},{"line":332,"address":[4231000],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":126,"coverable":126},{"path":["/","home","rotor","work","src","polka","financial-pallet","financial-primitives","src","lib.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n//#![warn(missing_docs)]\n#![cfg_attr(not(feature = \"std\"), no_std)]\n\npub mod capvec;\n\nuse core::time::Duration;\nuse frame_support::dispatch::DispatchError;\nuse sp_std::convert::{From, TryFrom};\nuse sp_std::vec::Vec;\n\npub trait OnPriceSet {\n    type Asset;\n    type Price;\n\n    fn on_price_set(asset: Self::Asset, value: Self::Price) -\u003e Result\u003c(), DispatchError\u003e;\n}\n\npub trait BalanceAware {\n    type AccountId;\n    type Asset;\n    type Balance;\n\n    fn balances(\n        account_id: \u0026Self::AccountId,\n        assets: \u0026[Self::Asset],\n    ) -\u003e Result\u003cVec\u003cSelf::Balance\u003e, DispatchError\u003e;\n}\n\n#[derive(Debug, Eq, PartialEq)]\npub enum PricePeriodError {\n    DivisionByZero,\n    Overflow,\n}\n\npub type PricePeriodResult\u003cT\u003e = Result\u003cT, PricePeriodError\u003e;\n\npub struct PricePeriod(pub u32);\n\nimpl PricePeriod {\n    pub fn get_period_id(\u0026self, now: Duration) -\u003e Result\u003cu64, PricePeriodError\u003e {\n        let seconds = now.as_secs();\n        let period = self.0 as u64;\n\n        seconds\n            .checked_div(60)\n            .and_then(|x| x.checked_div(period))\n            .ok_or(PricePeriodError::DivisionByZero)\n    }\n\n    pub fn get_period_id_start(\u0026self, period_id: u64) -\u003e Result\u003cDuration, PricePeriodError\u003e {\n        let period = self.0 as u64;\n        let seconds: Result\u003c_, PricePeriodError\u003e = period_id\n            .checked_mul(60)\n            .and_then(|x| x.checked_mul(period))\n            .ok_or(PricePeriodError::Overflow);\n\n        Ok(Duration::from_secs(seconds?))\n    }\n\n    pub fn get_period_start(\u0026self, now: Duration) -\u003e Result\u003cDuration, PricePeriodError\u003e {\n        self.get_period_id_start(self.get_period_id(now)?)\n    }\n\n    pub fn is_valid_period_start(\u0026self, period_start: Duration) -\u003e PricePeriodResult\u003cbool\u003e {\n        Ok(period_start == self.get_period_start(period_start)?)\n    }\n}\n\n/// Indicates what returns will be used in calculations of volatilities, correlations, and value at\n/// risk: `Regular` or `Log` returns.\n///\n/// The choice of return type also governs the method for Value at Risk (VAR) calculation:\n/// * `Regular` type should be used when arithmetic returns are used and are assumed to be normally\n/// distributed;\n/// * `Log` normal type should be used when geometric returns (log returns) are used\n/// and are assumed to be normally distributed.\n///\n/// We suggest using the latter approach, as it doesn't\n/// lead to losses greater than a portfolio value unlike the normal VaR.\n#[derive(Copy, Clone, Debug)]\npub enum CalcReturnType {\n    /// Regular returns.\n    Regular,\n\n    /// Log returns.\n    Log,\n}\n\nimpl CalcReturnType {\n    pub const fn into_u32(\u0026self) -\u003e u32 {\n        match self {\n            CalcReturnType::Regular =\u003e 0,\n            CalcReturnType::Log =\u003e 1,\n        }\n    }\n}\n\nimpl TryFrom\u003cu32\u003e for CalcReturnType {\n    type Error = ();\n\n    fn try_from(value: u32) -\u003e Result\u003cSelf, Self::Error\u003e {\n        match value {\n            0 =\u003e Ok(CalcReturnType::Regular),\n            1 =\u003e Ok(CalcReturnType::Log),\n            _ =\u003e Err(()),\n        }\n    }\n}\n\nimpl From\u003cCalcReturnType\u003e for u32 {\n    fn from(value: CalcReturnType) -\u003e Self {\n        value.into_u32()\n    }\n}\n\n/// Indicates the method for calculating volatility: `Regular` or `Exponential`.\n#[derive(Copy, Clone, Debug)]\npub enum CalcVolatilityType {\n    /// Regular type is a standard statistical approach of calculating standard deviation of\n    /// returns using simple average.\n    Regular,\n\n    /// Exponentially weighted type gives more weight to most recent data given the decay value or\n    /// period of exponentially weighted moving average.\n    Exponential(u32),\n}\n\nimpl CalcVolatilityType {\n    pub const fn into_i64(\u0026self) -\u003e i64 {\n        match self {\n            CalcVolatilityType::Regular =\u003e -1,\n            CalcVolatilityType::Exponential(n) =\u003e *n as i64,\n        }\n    }\n}\n\nimpl TryFrom\u003ci64\u003e for CalcVolatilityType {\n    type Error = ();\n\n    fn try_from(value: i64) -\u003e Result\u003cSelf, Self::Error\u003e {\n        match value {\n            -1 =\u003e Ok(CalcVolatilityType::Regular),\n            n if n \u003e= 0 =\u003e Ok(CalcVolatilityType::Exponential(n as u32)),\n            _ =\u003e Err(()),\n        }\n    }\n}\n\nimpl From\u003cCalcVolatilityType\u003e for i64 {\n    fn from(value: CalcVolatilityType) -\u003e i64 {\n        value.into_i64()\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    #[cfg(test)]\n    mod price_period {\n        use super::super::*;\n        use chrono::prelude::*;\n\n        fn create_duration(\n            year: i32,\n            month: u32,\n            day: u32,\n            hour: u32,\n            minute: u32,\n            second: u32,\n        ) -\u003e Duration {\n            let timestamp = Utc\n                .ymd(year, month, day)\n                .and_hms(hour, minute, second)\n                .timestamp();\n            Duration::from_secs(timestamp as u64)\n        }\n\n        #[test]\n        fn period_id_are_same_within_period() {\n            let time1 = create_duration(2020, 9, 14, 12, 31, 0);\n            let time2 = create_duration(2020, 9, 14, 12, 54, 0);\n\n            // period is one hour\n            let period = PricePeriod(60);\n\n            let period_id_1 = period.get_period_id(time1);\n            let period_id_2 = period.get_period_id(time2);\n\n            assert!(period_id_1.is_ok());\n            assert!(period_id_2.is_ok());\n            assert_eq!(period_id_1, period_id_2);\n        }\n\n        #[test]\n        fn period_id_are_different_for_different_periods() {\n            let time1 = create_duration(2020, 9, 14, 12, 31, 0);\n            let time2 = create_duration(2020, 9, 14, 13, 2, 0);\n\n            // period is one hour\n            let period = PricePeriod(60);\n\n            let period_id_1 = period.get_period_id(time1);\n            let period_id_2 = period.get_period_id(time2);\n\n            assert!(period_id_1.is_ok());\n            assert!(period_id_2.is_ok());\n            assert!(period_id_1 != period_id_2);\n        }\n    }\n}\n","traces":[{"line":55,"address":[4240432],"length":1,"stats":{"Line":4},"fn_name":"get_period_id"},{"line":56,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":61,"address":[4213952,4213966],"length":1,"stats":{"Line":12},"fn_name":"{{closure}}"},{"line":62,"address":[4240569],"length":1,"stats":{"Line":4},"fn_name":null},{"line":65,"address":[4240624],"length":1,"stats":{"Line":2},"fn_name":"get_period_id_start"},{"line":66,"address":[4240650],"length":1,"stats":{"Line":2},"fn_name":null},{"line":67,"address":[4240702,4240664,4240737],"length":1,"stats":{"Line":6},"fn_name":null},{"line":69,"address":[4240692],"length":1,"stats":{"Line":6},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":120,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[4232368],"length":1,"stats":{"Line":2},"fn_name":"create_duration"},{"line":185,"address":[4232399],"length":1,"stats":{"Line":2},"fn_name":null},{"line":189,"address":[4232520],"length":1,"stats":{"Line":2},"fn_name":null},{"line":193,"address":[4231669,4231664],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":194,"address":[4232570],"length":1,"stats":{"Line":1},"fn_name":null},{"line":195,"address":[4232628],"length":1,"stats":{"Line":1},"fn_name":null},{"line":198,"address":[4232683],"length":1,"stats":{"Line":1},"fn_name":null},{"line":200,"address":[4232691],"length":1,"stats":{"Line":1},"fn_name":null},{"line":201,"address":[4232715],"length":1,"stats":{"Line":1},"fn_name":null},{"line":203,"address":[4232742,4232785],"length":1,"stats":{"Line":1},"fn_name":null},{"line":204,"address":[4232913,4232766,4232819],"length":1,"stats":{"Line":2},"fn_name":null},{"line":205,"address":[4232947,4232961,4232825],"length":1,"stats":{"Line":2},"fn_name":null},{"line":209,"address":[4231701,4231696],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":210,"address":[4233255],"length":1,"stats":{"Line":1},"fn_name":null},{"line":211,"address":[4233307],"length":1,"stats":{"Line":1},"fn_name":null},{"line":214,"address":[4233356],"length":1,"stats":{"Line":1},"fn_name":null},{"line":216,"address":[4233364],"length":1,"stats":{"Line":1},"fn_name":null},{"line":217,"address":[4233388],"length":1,"stats":{"Line":1},"fn_name":null},{"line":219,"address":[4233412,4233452],"length":1,"stats":{"Line":1},"fn_name":null},{"line":220,"address":[4233436,4233513,4233486],"length":1,"stats":{"Line":2},"fn_name":null},{"line":221,"address":[4233558,4233588,4233492,4233547],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":37,"coverable":59},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","integration-testing-macro","src","lib.rs"],"content":"extern crate proc_macro;\n\nuse proc_macro::{Literal, TokenStream, TokenTree};\nuse quote::quote;\nuse syn::parse::{Parse, ParseStream};\nuse syn::parse_macro_input;\nuse syn::punctuated::Punctuated;\nuse syn::{Expr, Token};\n\nstruct Input {\n    name: syn::Ident,\n    args: Punctuated\u003cExpr, Token![,]\u003e,\n}\n\nimpl Parse for Input {\n    fn parse(input: ParseStream) -\u003e syn::parse::Result\u003cSelf\u003e {\n        let name = input.parse()?;\n        input.parse::\u003csyn::Token![,]\u003e()?;\n        let args = Punctuated::\u003cExpr, Token![,]\u003e::parse_terminated(input)?;\n        Ok(Input { name, args })\n    }\n}\n\nfn tuple_read(name: syn::Ident, num: usize) -\u003e syn::Expr {\n    let num = Literal::usize_unsuffixed(num);\n    let num: TokenTree = num.into();\n    let num: TokenStream = num.into();\n    let num: syn::Lit = syn::parse(num).unwrap();\n    let gen = quote! {\n        #name.#num\n    };\n\n    let tokens: TokenStream = gen.into();\n\n    syn::parse(tokens).unwrap()\n}\n\n#[proc_macro]\npub fn tuple_to_vec(tokens: TokenStream) -\u003e TokenStream {\n    let input = parse_macro_input!(tokens as Input);\n    let name = input.name;\n\n    let vec_args: Punctuated\u003csyn::Expr, Token![,]\u003e = input\n        .args\n        .into_iter()\n        .enumerate()\n        .map(|(i, _)| tuple_read(name.clone(), i))\n        .collect();\n\n    let gen = quote! {\n        vec!(#vec_args)\n    };\n\n    gen.into()\n}\n","traces":[{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[4233696,4233747],"length":1,"stats":{"Line":0},"fn_name":"tuple_read"},{"line":25,"address":[4233714,4233766],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[4233830,4233784],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[4233851],"length":1,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[4233903],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[4233963,4234022],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[4234129],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[4234221],"length":1,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[4234384,4234449],"length":1,"stats":{"Line":0},"fn_name":"tuple_to_vec"},{"line":40,"address":[4234818,4234403,4234464],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[4234699],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[4234746,4234993,4234954],"length":1,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[4231600,4231612],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":50,"address":[4235116,4235047],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[4235355],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":20},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","financial.rs"],"content":"use codec::{Codec, Encode};\nuse common::Asset;\nuse core::marker::PhantomData;\nuse pallet_financial::{AssetMetrics, FinancialMetrics, PriceLog, PriceUpdate};\nuse sp_runtime::traits::Member;\nuse std::fmt::Debug;\nuse substrate_fixed::types::I64F64;\nuse substrate_subxt::system::{System, SystemEventsDecoder};\nuse substrate_subxt_proc_macro::{module, Call, Store};\n\npub type FixedNumber = I64F64;\npub type Price = FixedNumber;\n\n#[module]\npub trait Financial: System {\n    type Asset: Default + Codec + Member;\n    type FixedNumber: Default + Codec + Member;\n    type Price: Default + Codec + Member;\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct UpdatesStore\u003cT: Financial\u003e {\n    #[store(returns = Option\u003cPriceUpdate\u003cT::FixedNumber\u003e\u003e)]\n    pub asset: Asset,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct PriceLogsStore\u003cT: Financial\u003e {\n    #[store(returns = Option\u003cPriceLog\u003cT::FixedNumber\u003e\u003e)]\n    pub asset: Asset,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct MetricsStore\u003cT: Financial\u003e {\n    #[store(returns = Option\u003cFinancialMetrics\u003cT::Asset, T::Price\u003e\u003e)]\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct PerAssetMetricsStore\u003cT: Financial\u003e {\n    #[store(returns = Option\u003cAssetMetrics\u003cT::Asset, T::Price\u003e\u003e)]\n    pub asset: Asset,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, PartialEq, Call, Encode)]\npub struct RecalcAssetCall\u003cT: Financial\u003e {\n    pub asset: Asset,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, PartialEq, Call, Encode)]\npub struct RecalcCall\u003cT: Financial\u003e {\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","key.rs"],"content":"use crate::keyring::{KeyPair, Nonces, PubKey};\nuse arraystring::{error, typenum::U10, ArrayString};\nuse serde::ser::{Serialize, SerializeStruct, SerializeTupleVariant, Serializer};\nuse sp_core::crypto::Pair as CryptoPair;\nuse sp_core::sr25519::Pair;\nuse sp_runtime::traits::AccountIdConversion;\nuse sp_runtime::{AccountId32, ModuleId};\nuse std::cmp::Ordering;\nuse std::collections::HashMap;\n\n#[derive(Copy, Clone, Debug, Eq, PartialEq, Hash)]\npub enum AccountKey {\n    Keyring(sp_keyring::sr25519::Keyring),\n    Str(\u0026'static str),\n    Random(ArrayString10),\n}\n\nimpl AccountKey {\n    /// Constructs account key from random seed string.\n    pub fn generate_random() -\u003e Self {\n        let seed = generate_random_array_string().expect(\"should be short random string\");\n        AccountKey::Random(seed)\n    }\n\n    fn to_num(\u0026self) -\u003e usize {\n        match self {\n            \u0026AccountKey::Keyring(_) =\u003e 0,\n            \u0026AccountKey::Str(_) =\u003e 1,\n            \u0026AccountKey::Random(_) =\u003e 2,\n        }\n    }\n}\n\n/// Represents fixed-capacity string for testing AccountKey.\ntype ArrayString10 = ArrayString\u003cU10\u003e;\n\n/// Generates random array string with fixed length, otherwise returns an error.\n/// ```rust\n/// let s = generate_random_array_string();\n/// ```\nfn generate_random_array_string() -\u003e Result\u003cArrayString10, error::OutOfBounds\u003e {\n    use rand::{distributions::Alphanumeric, Rng};\n    let s: String = rand::thread_rng()\n        .sample_iter(\u0026Alphanumeric)\n        .take(10)\n        .collect();\n    ArrayString10::try_from_str(s)\n}\n\nfn keyring_to_string(keyring: sp_keyring::sr25519::Keyring) -\u003e \u0026'static str {\n    keyring.into()\n}\n\nimpl PartialOrd for AccountKey {\n    fn partial_cmp(\u0026self, other: \u0026AccountKey) -\u003e Option\u003cOrdering\u003e {\n        Some(self.cmp(other))\n    }\n}\n\nimpl Serialize for AccountKey {\n    fn serialize\u003cS\u003e(\u0026self, serializer: S) -\u003e Result\u003cS::Ok, S::Error\u003e\n    where\n        S: Serializer,\n    {\n        match self {\n            \u0026AccountKey::Keyring(kr) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"AccountKey\", 0, \"Keyring\", 1)?;\n                state.serialize_field(keyring_to_string(kr))?;\n                state.end()\n            }\n            \u0026AccountKey::Str(s) =\u003e {\n                let mut state = serializer.serialize_tuple_variant(\"AccountKey\", 1, \"Str\", 1)?;\n                state.serialize_field(s)?;\n                state.end()\n            }\n            \u0026AccountKey::Random(s) =\u003e {\n                let mut state = serializer.serialize_tuple_variant(\"AccountKey\", 2, \"Random\", 1)?;\n                state.serialize_field(s.as_str())?;\n                state.end()\n            }\n        }\n    }\n}\n\nimpl Ord for AccountKey {\n    fn cmp(\u0026self, other: \u0026AccountKey) -\u003e Ordering {\n        let num_ord = self.to_num().cmp(\u0026other.to_num());\n\n        if num_ord != Ordering::Equal {\n            num_ord\n        } else {\n            match (self, other) {\n                (\u0026AccountKey::Keyring(a), \u0026AccountKey::Keyring(b)) =\u003e {\n                    keyring_to_string(a).cmp(keyring_to_string(b))\n                }\n                (\u0026AccountKey::Str(a), \u0026AccountKey::Str(b)) =\u003e a.cmp(b),\n                _ =\u003e panic!(\"Not meant to be there\"),\n            }\n        }\n    }\n}\n\nimpl From\u003csp_keyring::sr25519::Keyring\u003e for AccountKey {\n    fn from(x: sp_keyring::sr25519::Keyring) -\u003e AccountKey {\n        AccountKey::Keyring(x)\n    }\n}\n\nimpl From\u003c\u0026'static str\u003e for AccountKey {\n    fn from(x: \u0026'static str) -\u003e AccountKey {\n        AccountKey::Str(x)\n    }\n}\n\nfn string_to_static_str(s: \u0026String) -\u003e \u0026'static str {\n    Box::leak(s.clone().into_boxed_str())\n}\n\nimpl From\u003c\u0026String\u003e for AccountKey {\n    fn from(x: \u0026String) -\u003e AccountKey {\n        let s: \u0026'static str = string_to_static_str(x);\n        AccountKey::Str(s)\n    }\n}\n\nimpl PubKey for AccountKey {\n    type AccountId = AccountId32;\n\n    fn acc_id(\u0026self) -\u003e Self::AccountId {\n        match self {\n            \u0026AccountKey::Keyring(k) =\u003e k.to_account_id(),\n            \u0026AccountKey::Str(s) =\u003e Pair::from_string(\u0026ensure_canonical_seed(s), None)\n                .unwrap()\n                .public()\n                .into(),\n            \u0026AccountKey::Random(s) =\u003e Pair::from_string(\u0026ensure_canonical_seed(s.as_str()), None)\n                .unwrap()\n                .public()\n                .into(),\n        }\n    }\n}\n\nimpl KeyPair for AccountKey {\n    fn key_pair(\u0026self) -\u003e sp_core::sr25519::Pair {\n        match self {\n            \u0026AccountKey::Keyring(k) =\u003e k.pair(),\n            \u0026AccountKey::Str(s) =\u003e Pair::from_string(\u0026ensure_canonical_seed(s), None).unwrap(),\n            \u0026AccountKey::Random(s) =\u003e {\n                Pair::from_string(\u0026ensure_canonical_seed(s.as_str()), None).unwrap()\n            }\n        }\n    }\n}\n\npub type DevNonces = Nonces\u003cAccountKey\u003e;\n\n#[derive(Clone, Copy, Debug, Eq, PartialEq, Hash, Ord, PartialOrd)]\npub enum DevPubKeyId {\n    ModuleId([u8; 8]),\n    AccKey(AccountKey),\n    External(u32),\n    WellKnown(\u0026'static str),\n}\n\nimpl DevPubKeyId {\n    pub fn is_internal(\u0026self) -\u003e bool {\n        match self {\n            \u0026DevPubKeyId::External(_) =\u003e false,\n            _ =\u003e true,\n        }\n    }\n}\n\nimpl serde::Serialize for DevPubKeyId {\n    fn serialize\u003cS\u003e(\u0026self, serializer: S) -\u003e Result\u003cS::Ok, S::Error\u003e\n    where\n        S: Serializer,\n    {\n        match self {\n            \u0026DevPubKeyId::ModuleId(bs) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"DevPubKeyId\", 0, \"ModuleId\", 1)?;\n                state.serialize_field(\u0026String::from_utf8_lossy(\u0026bs))?;\n                state.end()\n            }\n            \u0026DevPubKeyId::AccKey(k) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"DevPubKeyId\", 1, \"AccKey\", 1)?;\n                state.serialize_field(\u0026k)?;\n                state.end()\n            }\n            \u0026DevPubKeyId::External(e) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"DevPubKeyId\", 2, \"External\", 1)?;\n                state.serialize_field(\u0026e)?;\n                state.end()\n            }\n            \u0026DevPubKeyId::WellKnown(s) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"DevPubKeyId\", 3, \"WellKnown\", 1)?;\n                state.serialize_field(s)?;\n                state.end()\n            }\n        }\n    }\n}\n\n#[derive(Clone, Debug)]\npub struct DevPubKey {\n    id: DevPubKeyId,\n    acc_id: AccountId32,\n}\n\nimpl Serialize for DevPubKey {\n    fn serialize\u003cS\u003e(\u0026self, serializer: S) -\u003e Result\u003cS::Ok, S::Error\u003e\n    where\n        S: Serializer,\n    {\n        let mut state = serializer.serialize_struct(\"DevPubKey\", 2)?;\n        state.serialize_field(\"id\", \u0026self.id)?;\n        state.serialize_field(\"acc_id\", \u0026self.acc_id.to_string())?;\n        state.end()\n    }\n}\n\nimpl DevPubKey {\n    pub fn well_known(name: \u0026'static str, acc_id: AccountId32) -\u003e DevPubKey {\n        DevPubKey {\n            id: DevPubKeyId::WellKnown(name),\n            acc_id,\n        }\n    }\n\n    pub fn id(\u0026self) -\u003e DevPubKeyId {\n        self.id\n    }\n}\n\nimpl PubKey for DevPubKey {\n    type AccountId = AccountId32;\n\n    fn acc_id(\u0026self) -\u003e Self::AccountId {\n        self.acc_id.clone()\n    }\n}\n\nimpl From\u003cModuleId\u003e for DevPubKey {\n    fn from(x: ModuleId) -\u003e DevPubKey {\n        DevPubKey {\n            id: DevPubKeyId::ModuleId(x.0),\n            acc_id: x.into_account(),\n        }\n    }\n}\n\nimpl From\u003cAccountKey\u003e for DevPubKey {\n    fn from(x: AccountKey) -\u003e DevPubKey {\n        DevPubKey {\n            id: DevPubKeyId::AccKey(x),\n            acc_id: x.acc_id(),\n        }\n    }\n}\n\n#[derive(Eq, PartialEq)]\npub enum PubKeyStoreRegisterResult {\n    AddedNew,\n    ExistsNotModified,\n    ExistsReplaced,\n}\n\n#[derive(Debug)]\npub struct PubKeyStore {\n    items: HashMap\u003cAccountId32, DevPubKeyId\u003e,\n    next_id: u32,\n}\n\nimpl PubKeyStore {\n    pub fn new() -\u003e PubKeyStore {\n        PubKeyStore {\n            items: HashMap::new(),\n            next_id: 0,\n        }\n    }\n\n    pub fn register(\u0026mut self, pub_key: DevPubKey) -\u003e PubKeyStoreRegisterResult {\n        let DevPubKey { id, acc_id } = pub_key;\n        let item = self.items.get(\u0026acc_id);\n\n        if let Some(existing_id) = item {\n            match (existing_id, id) {\n                (_, DevPubKeyId::External(_)) =\u003e PubKeyStoreRegisterResult::ExistsNotModified,\n                _ =\u003e PubKeyStoreRegisterResult::ExistsReplaced,\n            }\n        } else {\n            self.items.insert(acc_id, id);\n            PubKeyStoreRegisterResult::AddedNew\n        }\n    }\n\n    pub fn register_external(\u0026mut self, acc_id: AccountId32) {\n        let id = DevPubKeyId::External(self.next_id);\n        let result = self.register(DevPubKey { id, acc_id });\n\n        if result == PubKeyStoreRegisterResult::AddedNew\n            || result == PubKeyStoreRegisterResult::ExistsReplaced\n        {\n            self.next_id = self.next_id + 1;\n        }\n    }\n\n    pub fn get_id(\u0026self, acc_id: \u0026AccountId32) -\u003e Option\u003cDevPubKeyId\u003e {\n        self.items.get(acc_id).map(|\u0026x| x)\n    }\n\n    pub fn dump(\u0026self) -\u003e Vec\u003cDevPubKey\u003e {\n        let mut items: Vec\u003c_\u003e = self\n            .items\n            .iter()\n            .map(|(acc_id, \u0026id)| DevPubKey {\n                id,\n                acc_id: acc_id.clone(),\n            })\n            .collect();\n\n        items.sort_by(|a, b| a.id.cmp(\u0026b.id));\n\n        items\n    }\n}\n\n/// Prepends \"//\" to the string if absent.\nfn ensure_canonical_seed(s: \u0026str) -\u003e String {\n    if !s.starts_with(\"//\") {\n        format!(\"//{}\", s)\n    } else {\n        String::from(s)\n    }\n}\n","traces":[{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[5767888],"length":1,"stats":{"Line":0},"fn_name":"generate_random_array_string"},{"line":43,"address":[5767928,5767905],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[5767916],"length":1,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[5767983],"length":1,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[5768048],"length":1,"stats":{"Line":0},"fn_name":"keyring_to_string"},{"line":51,"address":[5768057],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[5768672],"length":1,"stats":{"Line":0},"fn_name":"string_to_static_str"},{"line":117,"address":[5768681],"length":1,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":189,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":190,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":191,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":192,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":203,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":221,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":222,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":224,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":229,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":236,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":237,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":244,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":245,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":250,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":252,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":253,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":261,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":262,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":281,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":283,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":288,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":290,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":292,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":293,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":294,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":295,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":303,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":304,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":305,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":307,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":310,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":315,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":320,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":328,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":330,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[5772096],"length":1,"stats":{"Line":0},"fn_name":"ensure_canonical_seed"},{"line":336,"address":[5772381,5772123],"length":1,"stats":{"Line":0},"fn_name":null},{"line":337,"address":[5772206],"length":1,"stats":{"Line":0},"fn_name":null},{"line":339,"address":[5772174],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":131},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","keyring.rs"],"content":"use std::cmp::Eq;\nuse std::collections::HashMap;\nuse std::fmt::Debug;\nuse std::hash::Hash;\n\npub trait PubKey {\n    type AccountId;\n    fn acc_id(\u0026self) -\u003e Self::AccountId;\n}\n\npub trait KeyPair: PubKey {\n    fn key_pair(\u0026self) -\u003e sp_core::sr25519::Pair;\n}\n\npub struct Nonces\u003cK\u003e {\n    nonces: HashMap\u003cK, u32\u003e,\n}\n\nimpl\u003cK\u003e Nonces\u003cK\u003e {\n    pub fn new() -\u003e Nonces\u003cK\u003e {\n        Nonces {\n            nonces: HashMap::\u003cK, u32\u003e::new(),\n        }\n    }\n}\n\npub trait NonceManager {\n    type AccountKey: Copy + Debug;\n\n    fn is_initialized(\u0026self, key: Self::AccountKey) -\u003e bool;\n    fn init_nonce(\u0026mut self, key: Self::AccountKey, nonce: u32);\n    fn get_nonce_and_inc(\u0026mut self, key: Self::AccountKey) -\u003e u32;\n}\n\nimpl\u003cAccountKey: Copy + Debug + Eq + Hash\u003e NonceManager for Nonces\u003cAccountKey\u003e {\n    type AccountKey = AccountKey;\n\n    fn is_initialized(\u0026self, key: Self::AccountKey) -\u003e bool {\n        self.nonces.get(\u0026key).is_some()\n    }\n\n    fn init_nonce(\u0026mut self, key: Self::AccountKey, nonce: u32) {\n        if self.nonces.insert(key, nonce).is_some() {\n            panic!(\"nonce for key {:?} has already been initialized\", key);\n        }\n    }\n\n    fn get_nonce_and_inc(\u0026mut self, key: Self::AccountKey) -\u003e u32 {\n        let value = self.nonces.get_mut(\u0026key);\n\n        if let Some(value) = value {\n            let curr_nonce = *value;\n            *value = *value + 1;\n            curr_nonce\n        } else {\n            panic!(\"nonce for key {:?} is not initialized\", key);\n        }\n    }\n}\n","traces":[{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":14},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","main.rs"],"content":"#![recursion_limit = \"256\"]\n\npub mod financial;\npub mod key;\npub mod keyring;\npub mod manual_timestamp;\npub mod oracle;\npub mod requester;\npub mod runtime;\npub mod test;\npub mod test_context;\npub mod test_scripts;\npub mod timestamp;\n\nuse crate::key::{AccountKey, DevNonces, PubKeyStore};\nuse crate::keyring::PubKey;\nuse crate::test::init_nonce;\nuse crate::test_context::register_common_pub_keys;\n\nuse futures::lock::Mutex;\nuse log::{Level, Metadata, Record};\nuse log::{LevelFilter, SetLoggerError};\nuse runtime::TestRuntime;\nuse serde::{Deserialize, Serialize};\nuse sp_keyring::AccountKeyring;\nuse std::fs::File;\nuse std::io::BufReader;\nuse std::sync::Arc;\nuse substrate_subxt::ClientBuilder;\n#[allow(unused_imports)]\nuse test_scripts::test_financial::test_financial;\nuse test_scripts::test_oracle::test_oracle;\n\npub const ONE: u64 = 1_000_000_000;\n\n#[macro_use]\nextern crate lazy_static;\n\nstruct SimpleLogger;\nimpl log::Log for SimpleLogger {\n    fn enabled(\u0026self, metadata: \u0026Metadata) -\u003e bool {\n        metadata.level() \u003c= Level::Info\n    }\n\n    fn log(\u0026self, record: \u0026Record) {\n        if self.enabled(record.metadata()) {\n            println!(\"{} - {}\", record.level(), record.args());\n        }\n    }\n\n    fn flush(\u0026self) {}\n}\n\nstatic LOGGER: SimpleLogger = SimpleLogger;\n\npub fn init() -\u003e Result\u003c(), SetLoggerError\u003e {\n    log::set_logger(\u0026LOGGER).map(|()| log::set_max_level(LevelFilter::Info))\n}\n\n#[derive(Debug, Serialize, Deserialize, Clone)]\npub struct IntegrationTestConfig {\n    local: bool,\n    sudo: String,\n    endpoint: String,\n    tests_to_launch: Vec\u003cString\u003e,\n    validators: Vec\u003cString\u003e,\n}\n\npub fn read_integration_test_config() -\u003e IntegrationTestConfig {\n    let file = File::open(\"integration_test.json\").unwrap();\n    let reader = BufReader::new(file);\n    let conf: IntegrationTestConfig =\n        serde_json::from_reader(reader).expect(\"JSON was not well-formatted\");\n    println!(\"{:?}\", conf);\n    conf\n}\n\n#[async_std::main]\nasync fn main() -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    //init();\n    let config = read_integration_test_config();\n\n    let client = ClientBuilder::\u003cTestRuntime\u003e::new()\n        .set_page_size(1)\n        .set_url(\"ws://localhost:9944/\")\n        .build()\n        .await?;\n    let nonces = Arc::new(Mutex::new(DevNonces::new()));\n    let pub_key_store = Arc::new(Mutex::new(PubKeyStore::new()));\n    {\n        let mut store = pub_key_store.lock().await;\n        register_common_pub_keys(\u0026mut store);\n    }\n\n    let alice_acc = AccountKey::from(AccountKeyring::Alice);\n    println!(\"alice {:?}\", alice_acc.acc_id());\n    init_nonce(\u0026client, nonces.clone(), alice_acc).await?;\n\n    let sudo_acc = AccountKey::from(\u0026config.sudo);\n    println!(\"sudo {:?}\", sudo_acc.acc_id());\n    init_nonce(\u0026client, nonces.clone(), sudo_acc).await?;\n\n    if config\n        .tests_to_launch\n        .contains(\u0026\"test_financial\".to_string())\n    {\n        println!(\"\\n\\nRunning financial test \\n\\n\");\n        test_financial(\u0026client, nonces.clone()).await?;\n    }\n\n    if config.tests_to_launch.contains(\u0026\"test_oracle\".to_string()) {\n        println!(\"\\n\\nRunning oracle test \\n\\n\");\n        test_oracle(\u0026client, nonces.clone()).await?;\n    }\n\n    Ok(())\n}\n","traces":[{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[4454448,4454455,4454453],"length":1,"stats":{"Line":0},"fn_name":"flush"},{"line":56,"address":[4454464],"length":1,"stats":{"Line":0},"fn_name":"init"},{"line":57,"address":[5660992,5660996],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":69,"address":[4454544,4454595],"length":1,"stats":{"Line":0},"fn_name":"read_integration_test_config"},{"line":70,"address":[4454617,4454561],"length":1,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[4454641],"length":1,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[4454656],"length":1,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[4454764,4454915],"length":1,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[4456221,4456288,4456208,4456304],"length":1,"stats":{"Line":0},"fn_name":"main"},{"line":81,"address":[5669746],"length":1,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[5289060],"length":1,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[5670305,5670476,5670825,5670785],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[5670929,5670986,5670910,5670464],"length":1,"stats":{"Line":0},"fn_name":null},{"line":89,"address":[5671066,5670997,5671123],"length":1,"stats":{"Line":0},"fn_name":null},{"line":91,"address":[5289175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[5671566,5671538],"length":1,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[5671605],"length":1,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[5671705,5671849,5671645,5671781],"length":1,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[5289268],"length":1,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[5672431],"length":1,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[5672878,5672734,5672674,5672810],"length":1,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[5289297],"length":1,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[5673460,5674380,5673735,5673795],"length":1,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[5673661,5673751,5673772],"length":1,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[5673806],"length":1,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[5289324],"length":1,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[5675244,5674666,5674687,5674541,5674653],"length":1,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[5674718],"length":1,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[5289349],"length":1,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[5675370],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":35},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","manual_timestamp.rs"],"content":"use codec::Encode;\nuse core::marker::PhantomData;\nuse std::fmt::Debug;\nuse substrate_subxt::system::{System, SystemEventsDecoder};\nuse substrate_subxt_proc_macro::{module, Call, Store};\n\n#[module]\npub trait ManualTimestamp: System {}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct NowStore\u003cT: ManualTimestamp\u003e {\n    #[store(returns = u64)]\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n\n#[derive(Clone, Debug, PartialEq, Call, Encode)]\npub struct AdvanceSecsCall\u003cT: ManualTimestamp\u003e {\n    pub secs: u32,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","oracle.rs"],"content":"use codec::{Codec, Encode};\nuse common::Asset;\nuse core::marker::PhantomData;\nuse sp_runtime::traits::Member;\nuse std::fmt::Debug;\nuse substrate_fixed::types::I64F64;\nuse substrate_subxt::system::{System, SystemEventsDecoder};\nuse substrate_subxt_proc_macro::{module, Call, Store};\n\npub type Price = I64F64;\n\n#[module]\npub trait Oracle: System {\n    type Asset: Default + Codec + Member;\n    type Price: Default + Codec + Member;\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct PricePointsStore\u003cT: Oracle\u003e {\n    #[store(returns = Price)]\n    pub asset: \u003cT as Oracle\u003e::Asset,\n}\n\n#[derive(Clone, Debug, PartialEq, Call, Encode)]\npub struct SetPriceCall\u003cT: Oracle\u003e {\n    pub asset: Asset,\n    pub value: Price,\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","requester.rs"],"content":"use super::TestRuntime;\nuse crate::key::{AccountKey, DevNonces};\nuse crate::keyring::{KeyPair, NonceManager};\nuse crate::runtime::{AccountId, Balance};\nuse core::marker::PhantomData;\nuse futures::lock::Mutex;\nuse pallet_transaction_payment_rpc_runtime_api::RuntimeDispatchInfo;\nuse sp_keyring::AccountKeyring;\nuse std::collections::HashMap;\nuse std::sync::Arc;\nuse substrate_subxt::ExtrinsicSuccessWithFee;\nuse substrate_subxt::{sudo::SudoCall, Call, Client, PairSigner};\n\nlazy_static! {\n    pub static ref FEES: HashMap\u003cString, u64\u003e = vec![\n        (String::from(\"transfer_and_watch\"), 125_000_146),\n        (String::from(\"register_bailsman_and_watch\"), 125_000_105),\n        (String::from(\"unregister_bailsman_and_watch\"), 125_000_105),\n        (String::from(\"register_whitelist_and_watch\"), 125_000_139),\n        (String::from(\"unregister_whitelist_and_watch\"), 125_000_139),\n        (String::from(\"set_price_and_watch\"), 125_000_114),\n    ]\n    .into_iter()\n    .collect();\n}\n\npub struct Requester {\n    pub client: Client\u003csuper::TestRuntime\u003e,\n    nonces: HashMap\u003csuper::runtime::AccountId, u32\u003e,\n}\n\nimpl Requester {\n    pub fn new(client: Client\u003cTestRuntime\u003e) -\u003e Self {\n        Requester {\n            client,\n            nonces: HashMap::new(),\n        }\n    }\n\n    pub async fn with_sudo\u003cC: Call\u003cTestRuntime\u003e\u003e(\n        \u0026mut self,\n        call: C,\n    ) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n        let alice = AccountKeyring::Alice;\n        let mut signer = PairSigner::new(alice.pair()); //hardcode Alice as sudo signer\n        let sudo_nonce = self\n            .increment_nonce(AccountKeyring::Alice.to_account_id())\n            .await?;\n\n        signer.set_nonce(sudo_nonce);\n        let encoded = self.client.encode(call)?;\n        let sudo = SudoCall {\n            call: \u0026encoded,\n            _runtime: PhantomData,\n        };\n        let extrinsic = self.client.watch(sudo, \u0026signer).await?;\n        println!(\"with_sudo extrinsic {:?}\", extrinsic);\n        Ok(())\n    }\n\n    pub async fn increment_nonce(\n        \u0026mut self,\n        who: AccountId,\n    ) -\u003e Result\u003cu32, Box\u003cdyn std::error::Error\u003e\u003e {\n        let nonce = self\n            .nonces\n            .entry(who.clone())\n            .and_modify(|a| *a += 1)\n            .or_insert(\n                self.client\n                    .fetch_or_default(\n                        \u0026substrate_subxt::system::AccountStore { account_id: \u0026who },\n                        None,\n                    )\n                    .await\n                    .unwrap()\n                    .nonce,\n            );\n        println!(\"new nonce is {}\", nonce);\n        Ok(*nonce)\n    }\n}\n\npub type ChainCallSuccess = ExtrinsicSuccessWithFee\u003cTestRuntime, (AccountKey, Balance)\u003e;\npub type ChainCallResult = Result\u003cVec\u003cChainCallSuccess\u003e, Box\u003cdyn std::error::Error\u003e\u003e;\n\npub async fn call_chain\u003cC: Call\u003cTestRuntime\u003e + Send + Sync\u003e(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n    account_key: AccountKey,\n    call: C,\n) -\u003e Result\u003cVec\u003cChainCallSuccess\u003e, Box\u003cdyn std::error::Error\u003e\u003e {\n    let nonce = { nonces.lock().await.get_nonce_and_inc(account_key) };\n    println!(\"Current nonce for {:?} is {}\", account_key, nonce);\n\n    let mut signer = PairSigner::new(account_key.key_pair());\n    signer.set_nonce(nonce);\n    let extrinsic = client.create_signed(call, \u0026signer).await?;\n    let decoder = TestRuntime::create_decoder(client.metadata().clone());\n    let success = client\n        .submit_and_watch_extrinsic_with_fee::\u003cBalance\u003e(extrinsic, decoder)\n        .await?;\n    let fee = success\n        .dispatch_info\n        .as_ref()\n        .map(|x| x.partial_fee)\n        .unwrap_or(0);\n\n    println!(\"incoming fee for {:?}: {}\", account_key, fee);\n\n    Ok(vec![ExtrinsicSuccessWithFee {\n        block: success.block,\n        extrinsic: success.extrinsic,\n        events: success.events,\n        dispatch_info: success.dispatch_info.map(|x| RuntimeDispatchInfo {\n            weight: x.weight,\n            class: x.class,\n            partial_fee: (account_key, x.partial_fee),\n        }),\n    }])\n}\n\npub async fn sudo_call_chain\u003cC: Call\u003cTestRuntime\u003e + Send + Sync\u003e(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n    call: C,\n) -\u003e Result\u003cVec\u003cChainCallSuccess\u003e, Box\u003cdyn std::error::Error\u003e\u003e {\n    let encoded = client.encode(call)?;\n    let sudo_call = SudoCall {\n        call: \u0026encoded,\n        _runtime: PhantomData,\n    };\n\n    call_chain(client, nonces, AccountKeyring::Alice.into(), sudo_call).await\n}\n\npub async fn call_chain_unsigned\u003cC: Call\u003cTestRuntime\u003e + Send + Sync\u003e(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    call: C,\n) -\u003e Result\u003cVec\u003cChainCallSuccess\u003e, Box\u003cdyn std::error::Error\u003e\u003e {\n    let extrinsic = client.create_unsigned(call)?;\n    let decoder = TestRuntime::create_decoder(client.metadata().clone());\n    let success = client\n        .submit_and_watch_extrinsic(extrinsic, decoder)\n        .await?;\n\n    Ok(vec![ExtrinsicSuccessWithFee {\n        block: success.block,\n        extrinsic: success.extrinsic,\n        events: success.events,\n        dispatch_info: Option::None,\n    }])\n}\n\n#[macro_export]\nmacro_rules! join_chain_calls {\n    ( $($tokens:tt)* ) =\u003e {{\n        let join_result = try_join!($($tokens)*)?;\n\n        let vec_vec = tuple_to_vec!(join_result, $($tokens)*);\n\n        let flatten: Vec\u003c_\u003e = vec_vec.into_iter().flatten().collect();\n\n        flatten\n    }};\n}\n","traces":[{"line":15,"address":[5234883,5235371,5235234,5235057,5235450,5235144,5234970,5234777],"length":1,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[5234794],"length":1,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[5234899,5234856],"length":1,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[5234986,5234943],"length":1,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[5235073,5235030],"length":1,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[5235160,5235117],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[5235204,5235390],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[4493256,4493120],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":36,"address":[4493175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[5697680,5697792,5697568],"length":1,"stats":{"Line":0},"fn_name":"call_chain\u003cintegration_testing::manual_timestamp::AdvanceSecsCall\u003cintegration_testing::runtime::TestRuntime\u003e\u003e"},{"line":93,"address":[5284018,5245682,5248738],"length":1,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[5699248,5705215,5711490,5705442,5699575,5711390,5705542,5699475,5711163],"length":1,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[5705569,5711517,5699602],"length":1,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[5705634,5699667,5711582],"length":1,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[5711891,5712655,5699820,5712320,5705752,5706701,5709390,5711623,5699931,5711767,5699708,5706201,5715344,5705937,5711817,5700269,5706366,5711706,5705813,5705675,5712155,5699881,5700769,5705863,5700434,5703458,5700005],"length":1,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[5706845,5712290,5706874,5712828,5712799,5700942,5706336,5700913,5700404],"length":1,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[5245881,5248937,5284217],"length":1,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[5712847,5706893,5700961],"length":1,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[5714203,5708249,5707963,5701714,5713600,5702317,5702031,5707646,5713917],"length":1,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[5702440,5702375,5714216,5702330,5702003,5714326,5708372,5708307,5714261,5713889,5708262,5707935],"length":1,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[5697977,5697968,5698009,5697936,5697945,5698000],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cintegration_testing::financial::RecalcCall\u003cintegration_testing::runtime::TestRuntime\u003e\u003e"},{"line":109,"address":[5702733,5714347,5708393,5702645,5702461,5714619,5714531,5708665,5708577],"length":1,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[5715078,5702962,5702762,5708694,5715110,5708894,5714648,5709156,5703192,5709124,5714848,5703224],"length":1,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[5702775,5708707,5714661],"length":1,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[5708739,5714693,5702807],"length":1,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[5714725,5702839,5708771],"length":1,"stats":{"Line":0},"fn_name":null},{"line":115,"address":[5702879,5714765,5698288,5698160,5698106,5698234,5698362,5708811,5698032],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cintegration_testing::financial::RecalcCall\u003cintegration_testing::runtime::TestRuntime\u003e\u003e"},{"line":116,"address":[5698044,5698172,5698300],"length":1,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[5698175,5698047,5698303],"length":1,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[5698307,5698051,5698179],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":55},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","runtime.rs"],"content":"use super::{financial, manual_timestamp, oracle, timestamp};\nuse crate::financial::FinancialEventsDecoder;\nuse crate::manual_timestamp::ManualTimestampEventsDecoder;\nuse crate::oracle::OracleEventsDecoder;\nuse crate::timestamp::TimestampEventsDecoder;\nuse common::Asset;\nuse sp_runtime::traits::{BlakeTwo256, IdentifyAccount, Verify};\nuse sp_runtime::{generic, MultiSignature, OpaqueExtrinsic};\nuse substrate_fixed::types::I64F64;\nuse substrate_subxt::{\n    balances::{AccountData, Balances, BalancesEventsDecoder}, // needed for sign extra\n    extrinsic::DefaultExtra,\n    sudo::Sudo,\n    system::{System, SystemEventsDecoder},\n    EventsDecoder,\n    Metadata,\n    Runtime,\n};\n\n#[derive(Clone, PartialEq, Debug)]\npub struct TestRuntime;\n\nimpl TestRuntime {\n    pub fn create_decoder(metadata: Metadata) -\u003e EventsDecoder\u003cTestRuntime\u003e {\n        let mut decoder = EventsDecoder::\u003cTestRuntime\u003e::new(metadata);\n        decoder.with_system();\n        decoder.with_balances();\n        decoder.with_oracle();\n        decoder.with_timestamp();\n        decoder.with_financial();\n        decoder.with_manual_timestamp();\n\n        decoder.register_type_size::\u003cu64\u003e(\"u64\");\n\n        decoder\n    }\n}\n\nimpl Eq for TestRuntime {}\n\ntype Signature = MultiSignature;\n\nimpl Runtime for TestRuntime {\n    type Signature = Signature;\n    type Extra = DefaultExtra\u003cSelf\u003e;\n}\n\npub type AccountId = \u003c\u003cMultiSignature as Verify\u003e::Signer as IdentifyAccount\u003e::AccountId;\n\npub type Address = AccountId;\n\npub type FixedNumber = I64F64;\npub type Price = I64F64;\n\nimpl System for TestRuntime {\n    type Index = u32;\n    type BlockNumber = u32;\n    type Hash = sp_core::H256;\n    type Hashing = BlakeTwo256;\n    type AccountId = AccountId;\n    type Address = Self::AccountId;\n    type Header = generic::Header\u003cSelf::BlockNumber, BlakeTwo256\u003e;\n    type Extrinsic = OpaqueExtrinsic;\n    type AccountData = AccountData\u003c\u003cSelf as Balances\u003e::Balance\u003e;\n}\n\npub type Balance = u128;\n\nimpl Balances for TestRuntime {\n    type Balance = Balance;\n}\n\nimpl timestamp::Timestamp for TestRuntime {\n    type Moment = u64;\n}\n\nimpl Sudo for TestRuntime {}\n\nimpl oracle::Oracle for TestRuntime {\n    type Asset = Asset;\n    type Price = FixedNumber;\n}\n\nimpl financial::Financial for TestRuntime {\n    type Asset = Asset;\n    type FixedNumber = FixedNumber;\n    type Price = FixedNumber;\n}\n\nimpl manual_timestamp::ManualTimestamp for TestRuntime {}\n","traces":[{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":10},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","test.rs"],"content":"use crate::key::{AccountKey, DevNonces};\nuse crate::keyring::{NonceManager, PubKey};\nuse crate::runtime::TestRuntime;\nuse futures::lock::Mutex;\nuse sp_arithmetic::FixedI64;\nuse std::sync::Arc;\nuse substrate_subxt::Client;\n\npub fn i128_to_u64(n: i128) -\u003e Option\u003cu64\u003e {\n    if n \u003c 0 || n \u003e u64::MAX as i128 {\n        return None;\n    }\n    Some(n as u64)\n}\n\npub fn i128_to_fixedi64(n: i128) -\u003e Option\u003cFixedI64\u003e {\n    if n \u003c i64::MIN as i128 || n \u003e i64::MAX as i128 {\n        return None;\n    }\n\n    Some(FixedI64::from_inner(n as i64))\n}\n\npub async fn init_nonce(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n    account_key: AccountKey,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    let mut nonces = nonces.lock().await;\n\n    if nonces.is_initialized(account_key) {\n        Ok(())\n    } else {\n        let id = account_key.acc_id();\n        let initial_nonce = client\n            .fetch_or_default(\n                \u0026substrate_subxt::system::AccountStore { account_id: \u0026id },\n                None,\n            )\n            .await\n            .unwrap()\n            .nonce;\n\n        nonces.init_nonce(account_key, initial_nonce);\n\n        println!(\"Initial nonce for {:?} is {}\", account_key, initial_nonce);\n\n        Ok(())\n    }\n}\n","traces":[{"line":9,"address":[5584864],"length":1,"stats":{"Line":0},"fn_name":"i128_to_u64"},{"line":10,"address":[5584878],"length":1,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[5584946],"length":1,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[5584930],"length":1,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[5584976],"length":1,"stats":{"Line":0},"fn_name":"i128_to_fixedi64"},{"line":17,"address":[5585000],"length":1,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[5585105],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[5585134,5585089],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[5585152],"length":1,"stats":{"Line":0},"fn_name":"init_nonce"},{"line":29,"address":[5292132],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[5310820,5310987,5310930],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[5310975],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[5310946],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[5292203],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[5311004],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[5311035],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[5311583,5311615],"length":1,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[5311673,5311800,5311858,5311945],"length":1,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[5311964],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":19},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","test_context.rs"],"content":"use super::runtime::AccountId;\nuse crate::financial::{PerAssetMetricsStoreExt, PriceLogsStoreExt, UpdatesStoreExt};\nuse crate::key::{AccountKey, DevPubKey, DevPubKeyId, PubKeyStore};\nuse crate::manual_timestamp::NowStoreExt;\nuse crate::oracle::PricePointsStoreExt;\nuse crate::runtime::{FixedNumber, Price, TestRuntime};\nuse common::Asset;\nuse pallet_financial::{AssetMetrics, PriceLog, PriceUpdate};\nuse serde::ser::SerializeTupleVariant;\nuse serde::{Serialize, Serializer};\nuse sp_keyring::sr25519::Keyring;\nuse sp_runtime::{AccountId32, ModuleId};\nuse std::collections::HashMap;\nuse std::fmt::Debug;\nuse std::{cell::RefCell, hash::Hash, str::FromStr};\nuse substrate_subxt::Client;\n\n// Used for selfless traits implementations\nthread_local! {\n    static SAVED_TD: RefCell\u003cOption\u003cTestData\u003e\u003e = RefCell::new(Option::None)\n}\n\n#[derive(Debug, PartialEq, Eq, Ord, PartialOrd)]\npub enum AccountName {\n    Id(DevPubKeyId),\n    Unknown(AccountId),\n}\n\nimpl Serialize for AccountName {\n    fn serialize\u003cS\u003e(\u0026self, serializer: S) -\u003e Result\u003cS::Ok, S::Error\u003e\n    where\n        S: Serializer,\n    {\n        match self.clone() {\n            AccountName::Id(id) =\u003e {\n                let mut state = serializer.serialize_tuple_variant(\"AccountName\", 0, \"Id\", 1)?;\n                state.serialize_field(\u0026id)?;\n                state.end()\n            }\n            AccountName::Unknown(u) =\u003e {\n                let mut state =\n                    serializer.serialize_tuple_variant(\"AccountName\", 1, \"Unknown\", 1)?;\n                state.serialize_field(\u0026u)?;\n                state.end()\n            }\n        }\n    }\n}\n\npub fn get_known_modules() -\u003e Vec\u003cDevPubKey\u003e {\n    vec![]\n        .into_iter()\n        .map(|\u0026x| DevPubKey::from(ModuleId(x)))\n        .collect()\n}\n\npub fn register_common_pub_keys(pub_key_store: \u0026mut PubKeyStore) {\n    for k in Keyring::iter() {\n        let acc_key = AccountKey::from(k);\n        pub_key_store.register(acc_key.into());\n    }\n\n    let known_modules: Vec\u003c_\u003e = get_known_modules();\n\n    for m in known_modules {\n        pub_key_store.register(m);\n    }\n\n    let known_pub_keys: Vec\u003c_\u003e = vec![(\n        \"Alice//stash\",\n        \"0xbe5ddb1579b72e84524fc29e78609e3caf42e85aa118ebfe0b0ad404b5bdd25f\",\n    )]\n    .into_iter()\n    .map(|(name, acc_id_str)| {\n        DevPubKey::well_known(name, AccountId32::from_str(acc_id_str).unwrap())\n    })\n    .collect();\n\n    for k in known_pub_keys {\n        pub_key_store.register(k);\n    }\n}\n\n#[derive(Debug, Clone)]\npub struct TestData {\n    pub price_points: HashMap\u003cAsset, FixedNumber\u003e,\n    pub updates: HashMap\u003cAsset, Option\u003cPriceUpdate\u003cFixedNumber\u003e\u003e\u003e,\n    pub price_logs: HashMap\u003cAsset, Option\u003cPriceLog\u003cFixedNumber\u003e\u003e\u003e,\n    pub per_asset_metrics: HashMap\u003cAsset, Option\u003cAssetMetrics\u003cAsset, Price\u003e\u003e\u003e,\n    pub now: u64,\n}\n\nimpl TestData {\n    pub fn new() -\u003e Self {\n        TestData {\n            price_points: HashMap::new(),\n            updates: HashMap::new(),\n            price_logs: HashMap::new(),\n            per_asset_metrics: HashMap::new(),\n            now: 0,\n        }\n    }\n\n    pub fn clear(\u0026mut self) {\n        self.price_points.clear();\n        self.updates.clear();\n        self.price_logs.clear();\n        self.per_asset_metrics.clear();\n        self.now = 0;\n    }\n\n    pub fn to_static(\u0026self) {\n        SAVED_TD.with(|td_ref| {\n            td_ref.replace(Some(self.clone()));\n        });\n    }\n\n    pub fn get_static() -\u003e Self {\n        SAVED_TD.with(|td_ref| {\n            let result = td_ref.borrow().clone();\n            match result {\n                Some(td) =\u003e td,\n                None =\u003e panic!(\"Error during attempt to access LTS TestData - no data\"),\n            }\n        })\n    }\n}\n\npub const EPS: i64 = 1_0;\n\npub trait EqWithEps {\n    fn eq_with_eps(\u0026self, other: \u0026Self) -\u003e bool;\n}\n\nimpl EqWithEps for u64 {\n    fn eq_with_eps(\u0026self, other: \u0026Self) -\u003e bool {\n        (*self as i64 - *other as i64).abs() \u003c EPS\n    }\n}\n\nimpl\u003cK, V\u003e EqWithEps for HashMap\u003cK, V\u003e\nwhere\n    K: Eq + Hash,\n    V: EqWithEps,\n{\n    fn eq_with_eps(\u0026self, other: \u0026Self) -\u003e bool {\n        self.len() == other.len()\n            \u0026\u0026 self\n                .iter()\n                .all(|(k, v)| (*other).get(k).map_or(false, |v2| v.eq_with_eps(v2)))\n    }\n}\n\npub struct TestContext {}\n\nimpl TestContext {\n    pub async fn read_storage(\n        client: \u0026Client\u003cTestRuntime\u003e,\n    ) -\u003e Result\u003cTestData, Box\u003cdyn std::error::Error\u003e\u003e {\n        let mut data = TestData::new();\n\n        for asset in Asset::iterator() {\n            let price_points = client.price_points(*asset, Option::None).await;\n            data.price_points.insert(*asset, price_points.unwrap());\n\n            let updates = client.updates(*asset, Option::None).await;\n            data.updates.insert(*asset, updates.unwrap());\n\n            let price_logs = client.price_logs(*asset, Option::None).await;\n            data.price_logs.insert(*asset, price_logs.unwrap());\n\n            let metrics = client.per_asset_metrics(*asset, Option::None).await;\n            data.per_asset_metrics.insert(*asset, metrics.unwrap());\n        }\n        data.now = client.now(Option::None).await.unwrap();\n\n        Ok(data)\n    }\n}\n","traces":[{"line":20,"address":[4389578],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[4387120],"length":1,"stats":{"Line":0},"fn_name":"get_known_modules"},{"line":51,"address":[4387127],"length":1,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[4348688,4348705],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":57,"address":[4387249,4387216],"length":1,"stats":{"Line":0},"fn_name":"register_common_pub_keys"},{"line":58,"address":[4387339,4387451,4387269,4387236],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[4387366],"length":1,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[4387379],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[4387324],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[4388013,4387671,4387456,4387630],"length":1,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[4387929],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[4388018],"length":1,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[4348783,4348768],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":75,"address":[4348827],"length":1,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[4388392,4388775,4388433,4388218],"length":1,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[4388691],"length":1,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":120,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":160,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":66},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","test_scripts","mod.rs"],"content":"pub use super::*;\n\npub mod test_financial;\npub mod test_oracle;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","test_scripts","test_financial.rs"],"content":"use crate::financial::{MetricsStoreExt, RecalcCall, UpdatesStoreExt};\nuse crate::key::{AccountKey, DevNonces};\nuse crate::manual_timestamp::{AdvanceSecsCall, NowStoreExt};\nuse crate::oracle::{PricePointsStoreExt, SetPriceCall};\nuse crate::runtime::FixedNumber;\nuse crate::test::init_nonce;\nuse crate::{join_chain_calls, requester::call_chain, TestRuntime};\nuse approx::assert_abs_diff_eq;\nuse common::Asset;\nuse core::time::Duration;\nuse futures::{lock::Mutex, try_join};\nuse integration_testing_macro::tuple_to_vec;\nuse itertools::izip;\nuse pallet_financial::FinancialMetrics;\nuse sp_keyring::AccountKeyring;\nuse std::{marker::PhantomData, sync::Arc};\nuse substrate_fixed::traits::LossyInto;\nuse substrate_subxt::Client;\n\npub async fn test_financial(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    println!(\"Start recalc asset test\");\n    let alice_key = AccountKey::from(AccountKeyring::Alice);\n    init_nonce(client, nonces.clone(), alice_key).await?;\n    let secs_to_move = 86400;\n\n    // ------------------------------------ Setting prices ------------------------------------\n\n    set_prices_and_move_time(client, alice_key, nonces.clone(), secs_to_move).await?;\n\n    // ------------------------------- Recalc financial pallet -------------------------------\n\n    println!(\"Recalc financial pallet for every asset\");\n    call_chain(\n        client,\n        nonces.clone(),\n        alice_key,\n        RecalcCall {\n            _runtime: PhantomData,\n        },\n    )\n    .await?;\n\n    // ---------------------------------- Assert chain state ----------------------------------\n\n    assert_first_recalc_chain_state(client).await?;\n\n    // -------------------- Setting prices 1 day after month prices setted --------------------\n\n    set_prices_after_month(client, alice_key, nonces.clone(), secs_to_move).await?;\n\n    // ------------------------------- Recalc financial pallet -------------------------------\n\n    println!(\"Recalc financial pallet for every asset\");\n    call_chain(\n        client,\n        nonces.clone(),\n        alice_key,\n        RecalcCall {\n            _runtime: PhantomData,\n        },\n    )\n    .await?;\n\n    // ---------------------------------- Assert chain state ----------------------------------\n\n    assert_second_recalc_chain_state(client).await?;\n\n    // ------------------------------------ Test assertion ------------------------------------\n\n    println!(\"Assertion successful, test passed\");\n\n    Ok(())\n}\n\nfn assert_vectors_with_epsilon(\n    step_name: \u0026str,\n    actual_vec: Vec\u003cFixedNumber\u003e,\n    expected_vec: Vec\u003cFixedNumber\u003e,\n) {\n    println!(\"Assert vectors elements. {}\", step_name);\n    let actual: Vec\u003cf64\u003e = actual_vec.into_iter().map(|x| x.lossy_into()).collect();\n    let expected: Vec\u003cf64\u003e = expected_vec.into_iter().map(|x| x.lossy_into()).collect();\n\n    for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n        assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n    }\n}\n\nfn assert_metrics_assets(metrics: \u0026FinancialMetrics\u003cAsset, FixedNumber\u003e) {\n    for (actual, expect) in metrics.clone().assets.into_iter().zip(Asset::iterator()) {\n        assert!(actual.value() == expect.value());\n    }\n}\n\nasync fn assert_second_recalc_chain_state(\n    client: \u0026Client\u003cTestRuntime\u003e,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    let metrics = client.metrics(Option::None).await?.unwrap();\n\n    assert_metrics_assets(\u0026metrics);\n\n    let expected_volatilities: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(0.0),               // usd\n        FixedNumber::from_num(0.041212132650566), // eq\n        FixedNumber::from_num(0.026979767511806), // eth\n        FixedNumber::from_num(0.019530767671752), // btc\n        FixedNumber::from_num(0.022172261805909), // eos\n    ];\n\n    assert_vectors_with_epsilon(\n        \"Assert assets volatilities\",\n        metrics.volatilities,\n        expected_volatilities,\n    );\n\n    let expected_correlations: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.58314744717848),\n        FixedNumber::from_num(0.5055289438838),\n        FixedNumber::from_num(-0.14858602369776),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.58314744717848),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.72688913085808),\n        FixedNumber::from_num(0.33944301098853),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.5055289438838),\n        FixedNumber::from_num(0.72688913085808),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.18143650586153),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(-0.14858602369776),\n        FixedNumber::from_num(0.33944301098853),\n        FixedNumber::from_num(0.18143650586153),\n        FixedNumber::from_num(1),\n    ];\n\n    let expected_covariances: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.001698439877608),\n        FixedNumber::from_num(0.00064839800627),\n        FixedNumber::from_num(0.00040690256633),\n        FixedNumber::from_num(-0.00013577288546),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.00064839800627),\n        FixedNumber::from_num(0.000727907854991),\n        FixedNumber::from_num(0.0003830237393),\n        FixedNumber::from_num(0.00020305564717),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.00040690256633),\n        FixedNumber::from_num(0.0003830237393),\n        FixedNumber::from_num(0.000381450885848),\n        FixedNumber::from_num(0.00007856949929),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(-0.00013577288546),\n        FixedNumber::from_num(0.00020305564717),\n        FixedNumber::from_num(0.00007856949929),\n        FixedNumber::from_num(0.00049160919359),\n    ];\n\n    let actual_correlations: Vec\u003cFixedNumber\u003e = metrics.correlations;\n    let actual_covariances: Vec\u003cFixedNumber\u003e = metrics.covariances;\n\n    assert_vectors_with_epsilon(\n        \"Assert correlations matrix\",\n        actual_correlations,\n        expected_correlations,\n    );\n\n    assert_vectors_with_epsilon(\n        \"Assert covariances matrix\",\n        actual_covariances,\n        expected_covariances,\n    );\n\n    // let actual_btc_metrics = client\n    //     .per_asset_metrics(Asset::Btc, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eos_metrics = client\n    //     .per_asset_metrics(Asset::Eos, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eth_metrics = client\n    //     .per_asset_metrics(Asset::Eth, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eq_metrics = client\n    //     .per_asset_metrics(Asset::Eq, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_usd_metrics = client\n    //     .per_asset_metrics(Asset::Usd, Option::None)\n    //     .await?\n    //     .unwrap();\n\n    // let expected_btc_log_return = vec![\n    //     FixedNumber::from_num(-0.017851775539992),\n    //     FixedNumber::from_num(0.006485899505049),\n    //     FixedNumber::from_num(0.023702618762709),\n    //     FixedNumber::from_num(0.011824769398687),\n    //     FixedNumber::from_num(0.021735125114429),\n    //     FixedNumber::from_num(0.006526171853234),\n    //     FixedNumber::from_num(0.014313388019069),\n    //     FixedNumber::from_num(-0.009840284915377),\n    //     FixedNumber::from_num(0.000175008750884),\n    //     FixedNumber::from_num(0.006888460773841),\n    //     FixedNumber::from_num(-0.015941477997688),\n    //     FixedNumber::from_num(0.003701423103186),\n    //     FixedNumber::from_num(0.012674440896728),\n    //     FixedNumber::from_num(0.020971976194077),\n    //     FixedNumber::from_num(0.013936624912131),\n    //     FixedNumber::from_num(0.072074847729704),\n    //     FixedNumber::from_num(0.013719550155069),\n    //     FixedNumber::from_num(-0.004088407746743),\n    //     FixedNumber::from_num(0.014503573115766),\n    //     FixedNumber::from_num(-0.006496755376766),\n    //     FixedNumber::from_num(0.002144772940134),\n    //     FixedNumber::from_num(0.043203424778333),\n    //     FixedNumber::from_num(-0.026735589150183),\n    //     FixedNumber::from_num(0.013160052345472),\n    //     FixedNumber::from_num(0.007695760935366),\n    //     FixedNumber::from_num(0.017319297317554),\n    //     FixedNumber::from_num(-0.002974789061153),\n    //     FixedNumber::from_num(-0.013976007681055),\n    //     FixedNumber::from_num(0.0328349845197),\n    // ];\n\n    // let expected_eos_log_return = vec![\n    //     FixedNumber::from_num(0.063945225362233),\n    //     FixedNumber::from_num(-0.018342269805096),\n    //     FixedNumber::from_num(-0.014076701910362),\n    //     FixedNumber::from_num(0.013698844358162),\n    //     FixedNumber::from_num(-0.00151285959263),\n    //     FixedNumber::from_num(0.006789916693474),\n    //     FixedNumber::from_num(-0.004899199548643),\n    //     FixedNumber::from_num(-0.002648006086739),\n    //     FixedNumber::from_num(-0.011045627441233),\n    //     FixedNumber::from_num(-0.004606534057638),\n    //     FixedNumber::from_num(-0.023750386367157),\n    //     FixedNumber::from_num(-0.004739345363897),\n    //     FixedNumber::from_num(0.008671713781618),\n    //     FixedNumber::from_num(0.014029848210439),\n    //     FixedNumber::from_num(-0.021514618232527),\n    //     FixedNumber::from_num(0.032292243726357),\n    //     FixedNumber::from_num(0.022336722713639),\n    //     FixedNumber::from_num(-0.01091672802769),\n    //     FixedNumber::from_num(0.007917100731662),\n    //     FixedNumber::from_num(0.017126256271163),\n    //     FixedNumber::from_num(-0.028455682588786),\n    //     FixedNumber::from_num(0.014703375160227),\n    //     FixedNumber::from_num(-0.006382600980497),\n    //     FixedNumber::from_num(-0.006423600398779),\n    //     FixedNumber::from_num(-0.049738301151431),\n    //     FixedNumber::from_num(0.006750075262365),\n    //     FixedNumber::from_num(-0.003567892783902),\n    //     FixedNumber::from_num(-0.033518179087602),\n    //     FixedNumber::from_num(-0.027901039512794),\n    // ];\n\n    // let expected_eth_log_return = vec![\n    //     FixedNumber::from_num(-0.037176219300342),\n    //     FixedNumber::from_num(0.003105046726959),\n    //     FixedNumber::from_num(0.026808317225208),\n    //     FixedNumber::from_num(0.039664149077215),\n    //     FixedNumber::from_num(0.014858549313211),\n    //     FixedNumber::from_num(0.009366053036486),\n    //     FixedNumber::from_num(0.032947494656537),\n    //     FixedNumber::from_num(-0.014317195829359),\n    //     FixedNumber::from_num(-0.006048511576352),\n    //     FixedNumber::from_num(-0.003726170720288),\n    //     FixedNumber::from_num(-0.032615096229953),\n    //     FixedNumber::from_num(0.008362550947202),\n    //     FixedNumber::from_num(0.026209855400584),\n    //     FixedNumber::from_num(0.002559874723751),\n    //     FixedNumber::from_num(-0.02852562591775),\n    //     FixedNumber::from_num(0.059791550432133),\n    //     FixedNumber::from_num(0.057189635500972),\n    //     FixedNumber::from_num(-0.011965145719892),\n    //     FixedNumber::from_num(0.007249581694894),\n    //     FixedNumber::from_num(-0.015117944327008),\n    //     FixedNumber::from_num(-0.033149995299452),\n    //     FixedNumber::from_num(0.02668163550439),\n    //     FixedNumber::from_num(-0.037783197312849),\n    //     FixedNumber::from_num(-0.003168839842996),\n    //     FixedNumber::from_num(-0.012410908361374),\n    //     FixedNumber::from_num(0.010422040197932),\n    //     FixedNumber::from_num(0.025476158297524),\n    //     FixedNumber::from_num(-0.033679947915332),\n    //     FixedNumber::from_num(0.011842738081395),\n    // ];\n\n    // let expected_usd_log_return = vec![\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    // ];\n\n    // let expected_eq_log_return = vec![\n    //     FixedNumber::from_num(-0.104400822685896),\n    //     FixedNumber::from_num(0.027852562402598),\n    //     FixedNumber::from_num(0.065930399912786),\n    //     FixedNumber::from_num(0.033634655314806),\n    //     FixedNumber::from_num(-0.003995774502009),\n    //     FixedNumber::from_num(0.00070629785161),\n    //     FixedNumber::from_num(0.014254242982982),\n    //     FixedNumber::from_num(-0.012608152076313),\n    //     FixedNumber::from_num(-0.01395976768789),\n    //     FixedNumber::from_num(-0.02411498578672),\n    //     FixedNumber::from_num(-0.04569512959085),\n    //     FixedNumber::from_num(0.013954304827044),\n    //     FixedNumber::from_num(0.035152134114813),\n    //     FixedNumber::from_num(-0.030125734992472),\n    //     FixedNumber::from_num(-0.018980703949385),\n    //     FixedNumber::from_num(0.05686029412138),\n    //     FixedNumber::from_num(0.030193664145268),\n    //     FixedNumber::from_num(-0.000937207191374),\n    //     FixedNumber::from_num(0.021795437311784),\n    //     FixedNumber::from_num(-0.006442728222199),\n    //     FixedNumber::from_num(0.083021433280261),\n    //     FixedNumber::from_num(-0.00575265248945),\n    //     FixedNumber::from_num(-0.069221835426132),\n    //     FixedNumber::from_num(-0.073632490279114),\n    //     FixedNumber::from_num(0.00712271217112),\n    //     FixedNumber::from_num(0.023462196064631),\n    //     FixedNumber::from_num(0.009280256966068),\n    //     FixedNumber::from_num(-0.044807107555325),\n    //     FixedNumber::from_num(-0.001983635661594),\n    // ];\n\n    // assert_vectors_with_epsilon(\n    //     \"BTC log return\",\n    //     actual_btc_metrics.returns,\n    //     expected_btc_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"EOS log return\",\n    //     actual_eos_metrics.returns,\n    //     expected_eos_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"ETH log return\",\n    //     actual_eth_metrics.returns,\n    //     expected_eth_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"USD log return\",\n    //     actual_usd_metrics.returns,\n    //     expected_usd_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"EQ log return\",\n    //     actual_eq_metrics.returns,\n    //     expected_eq_log_return,\n    // );\n\n    Ok(())\n}\n\nasync fn assert_first_recalc_chain_state(\n    client: \u0026Client\u003cTestRuntime\u003e,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    let metrics = client.metrics(Option::None).await?.unwrap();\n\n    assert_metrics_assets(\u0026metrics);\n\n    let expected_volatilities: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(0.0),              // usd\n        FixedNumber::from_num(0.04121390630829), // eq\n        FixedNumber::from_num(0.02692861833717), // eth\n        FixedNumber::from_num(0.01899396779000), // btc\n        FixedNumber::from_num(0.02163976358360), // eos\n    ];\n\n    assert_vectors_with_epsilon(\n        \"Assert assets volatilities\",\n        metrics.volatilities,\n        expected_volatilities,\n    );\n\n    let expected_correlations: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.58444399870037),\n        FixedNumber::from_num(0.52044196493031),\n        FixedNumber::from_num(-0.15357736293063),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.58444399870037),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.73404325427508),\n        FixedNumber::from_num(0.36263027397808),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.52044196493031),\n        FixedNumber::from_num(0.73404325427508),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(0.24738115822628),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(-0.15357736293063),\n        FixedNumber::from_num(0.36263027397808),\n        FixedNumber::from_num(0.24738115822628),\n        FixedNumber::from_num(1),\n    ];\n\n    let expected_covariances: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.001698586073),\n        FixedNumber::from_num(0.0006486355597),\n        FixedNumber::from_num(0.00040741009369),\n        FixedNumber::from_num(-0.00013696938233),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.0006486355597),\n        FixedNumber::from_num(0.0007251504855),\n        FixedNumber::from_num(0.0003754494048),\n        FixedNumber::from_num(0.00021131515315),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(0.00040741009369),\n        FixedNumber::from_num(0.0003754494048),\n        FixedNumber::from_num(0.00036077081241),\n        FixedNumber::from_num(0.00010167983375),\n        FixedNumber::from_num(0),\n        FixedNumber::from_num(-0.00013696938233),\n        FixedNumber::from_num(0.00021131515315),\n        FixedNumber::from_num(0.00010167983375),\n        FixedNumber::from_num(0.000468279368),\n    ];\n\n    let actual_correlations: Vec\u003cFixedNumber\u003e = metrics.correlations;\n    let actual_covariances: Vec\u003cFixedNumber\u003e = metrics.covariances;\n\n    assert_vectors_with_epsilon(\n        \"Assert correlations matrix\",\n        actual_correlations,\n        expected_correlations,\n    );\n\n    assert_vectors_with_epsilon(\n        \"Assert covariances matrix\",\n        actual_covariances,\n        expected_covariances,\n    );\n\n    // let actual_btc_metrics = client\n    //     .per_asset_metrics(Asset::Btc, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eos_metrics = client\n    //     .per_asset_metrics(Asset::Eos, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eth_metrics = client\n    //     .per_asset_metrics(Asset::Eth, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_eq_metrics = client\n    //     .per_asset_metrics(Asset::Eq, Option::None)\n    //     .await?\n    //     .unwrap();\n    // let actual_usd_metrics = client\n    //     .per_asset_metrics(Asset::Usd, Option::None)\n    //     .await?\n    //     .unwrap();\n\n    // let expected_btc_log_return = vec![\n    //     FixedNumber::from_num(0.011084832424493),\n    //     FixedNumber::from_num(-0.017851775539992),\n    //     FixedNumber::from_num(0.006485899505049),\n    //     FixedNumber::from_num(0.023702618762709),\n    //     FixedNumber::from_num(0.011824769398687),\n    //     FixedNumber::from_num(0.021735125114429),\n    //     FixedNumber::from_num(0.006526171853234),\n    //     FixedNumber::from_num(0.014313388019069),\n    //     FixedNumber::from_num(-0.009840284915377),\n    //     FixedNumber::from_num(0.000175008750884),\n    //     FixedNumber::from_num(0.006888460773841),\n    //     FixedNumber::from_num(-0.015941477997688),\n    //     FixedNumber::from_num(0.003701423103186),\n    //     FixedNumber::from_num(0.012674440896728),\n    //     FixedNumber::from_num(0.020971976194077),\n    //     FixedNumber::from_num(0.013936624912131),\n    //     FixedNumber::from_num(0.072074847729704),\n    //     FixedNumber::from_num(0.013719550155069),\n    //     FixedNumber::from_num(-0.004088407746743),\n    //     FixedNumber::from_num(0.014503573115766),\n    //     FixedNumber::from_num(-0.006496755376766),\n    //     FixedNumber::from_num(0.002144772940134),\n    //     FixedNumber::from_num(0.043203424778333),\n    //     FixedNumber::from_num(-0.026735589150183),\n    //     FixedNumber::from_num(0.013160052345472),\n    //     FixedNumber::from_num(0.007695760935366),\n    //     FixedNumber::from_num(0.017319297317554),\n    //     FixedNumber::from_num(-0.002974789061153),\n    //     FixedNumber::from_num(-0.013976007681055),\n    // ];\n\n    // let expected_eos_log_return = vec![\n    //     FixedNumber::from_num(0.003961970317355),\n    //     FixedNumber::from_num(0.063945225362233),\n    //     FixedNumber::from_num(-0.018342269805096),\n    //     FixedNumber::from_num(-0.014076701910362),\n    //     FixedNumber::from_num(0.013698844358162),\n    //     FixedNumber::from_num(-0.00151285959263),\n    //     FixedNumber::from_num(0.006789916693474),\n    //     FixedNumber::from_num(-0.004899199548643),\n    //     FixedNumber::from_num(-0.002648006086739),\n    //     FixedNumber::from_num(-0.011045627441233),\n    //     FixedNumber::from_num(-0.004606534057638),\n    //     FixedNumber::from_num(-0.023750386367157),\n    //     FixedNumber::from_num(-0.004739345363897),\n    //     FixedNumber::from_num(0.008671713781618),\n    //     FixedNumber::from_num(0.014029848210439),\n    //     FixedNumber::from_num(-0.021514618232527),\n    //     FixedNumber::from_num(0.032292243726357),\n    //     FixedNumber::from_num(0.022336722713639),\n    //     FixedNumber::from_num(-0.01091672802769),\n    //     FixedNumber::from_num(0.007917100731662),\n    //     FixedNumber::from_num(0.017126256271163),\n    //     FixedNumber::from_num(-0.028455682588786),\n    //     FixedNumber::from_num(0.014703375160227),\n    //     FixedNumber::from_num(-0.006382600980497),\n    //     FixedNumber::from_num(-0.006423600398779),\n    //     FixedNumber::from_num(-0.049738301151431),\n    //     FixedNumber::from_num(0.006750075262365),\n    //     FixedNumber::from_num(-0.003567892783902),\n    //     FixedNumber::from_num(-0.033518179087602),\n    // ];\n\n    // let expected_eth_log_return = vec![\n    //     FixedNumber::from_num(0.003256086798801),\n    //     FixedNumber::from_num(-0.037176219300342),\n    //     FixedNumber::from_num(0.003105046726959),\n    //     FixedNumber::from_num(0.026808317225208),\n    //     FixedNumber::from_num(0.039664149077215),\n    //     FixedNumber::from_num(0.014858549313211),\n    //     FixedNumber::from_num(0.009366053036486),\n    //     FixedNumber::from_num(0.032947494656537),\n    //     FixedNumber::from_num(-0.014317195829359),\n    //     FixedNumber::from_num(-0.006048511576352),\n    //     FixedNumber::from_num(-0.003726170720288),\n    //     FixedNumber::from_num(-0.032615096229953),\n    //     FixedNumber::from_num(0.008362550947202),\n    //     FixedNumber::from_num(0.026209855400584),\n    //     FixedNumber::from_num(0.002559874723751),\n    //     FixedNumber::from_num(-0.02852562591775),\n    //     FixedNumber::from_num(0.059791550432133),\n    //     FixedNumber::from_num(0.057189635500972),\n    //     FixedNumber::from_num(-0.011965145719892),\n    //     FixedNumber::from_num(0.007249581694894),\n    //     FixedNumber::from_num(-0.015117944327008),\n    //     FixedNumber::from_num(-0.033149995299452),\n    //     FixedNumber::from_num(0.02668163550439),\n    //     FixedNumber::from_num(-0.037783197312849),\n    //     FixedNumber::from_num(-0.003168839842996),\n    //     FixedNumber::from_num(-0.012410908361374),\n    //     FixedNumber::from_num(0.010422040197932),\n    //     FixedNumber::from_num(0.025476158297524),\n    //     FixedNumber::from_num(-0.033679947915332),\n    // ];\n\n    // let expected_usd_log_return = vec![\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    //     FixedNumber::from_num(0),\n    // ];\n\n    // let expected_eq_log_return = vec![\n    //     FixedNumber::from_num(-0.003354903697885),\n    //     FixedNumber::from_num(-0.104400822685896),\n    //     FixedNumber::from_num(0.027852562402598),\n    //     FixedNumber::from_num(0.065930399912786),\n    //     FixedNumber::from_num(0.033634655314806),\n    //     FixedNumber::from_num(-0.003995774502009),\n    //     FixedNumber::from_num(0.00070629785161),\n    //     FixedNumber::from_num(0.014254242982982),\n    //     FixedNumber::from_num(-0.012608152076313),\n    //     FixedNumber::from_num(-0.01395976768789),\n    //     FixedNumber::from_num(-0.02411498578672),\n    //     FixedNumber::from_num(-0.04569512959085),\n    //     FixedNumber::from_num(0.013954304827044),\n    //     FixedNumber::from_num(0.035152134114813),\n    //     FixedNumber::from_num(-0.030125734992472),\n    //     FixedNumber::from_num(-0.018980703949385),\n    //     FixedNumber::from_num(0.05686029412138),\n    //     FixedNumber::from_num(0.030193664145268),\n    //     FixedNumber::from_num(-0.000937207191374),\n    //     FixedNumber::from_num(0.021795437311784),\n    //     FixedNumber::from_num(-0.006442728222199),\n    //     FixedNumber::from_num(0.083021433280261),\n    //     FixedNumber::from_num(-0.00575265248945),\n    //     FixedNumber::from_num(-0.069221835426132),\n    //     FixedNumber::from_num(-0.073632490279114),\n    //     FixedNumber::from_num(0.00712271217112),\n    //     FixedNumber::from_num(0.023462196064631),\n    //     FixedNumber::from_num(0.009280256966068),\n    //     FixedNumber::from_num(-0.044807107555325),\n    // ];\n\n    // assert_vectors_with_epsilon(\n    //     \"BTC log return\",\n    //     actual_btc_metrics.returns,\n    //     expected_btc_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"EOS log return\",\n    //     actual_eos_metrics.returns,\n    //     expected_eos_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"ETH log return\",\n    //     actual_eth_metrics.returns,\n    //     expected_eth_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"USD log return\",\n    //     actual_usd_metrics.returns,\n    //     expected_usd_log_return,\n    // );\n    // assert_vectors_with_epsilon(\n    //     \"EQ log return\",\n    //     actual_eq_metrics.returns,\n    //     expected_eq_log_return,\n    // );\n\n    Ok(())\n}\n\nasync fn set_prices_after_month(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    alice_key: AccountKey,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n    secs_to_move: i32,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    println!(\"Setting prices 1 day after month\");\n    let usd_price: FixedNumber = FixedNumber::from_num(1);\n    let eq_price: FixedNumber = FixedNumber::from_num(0.68493);\n    let eth_price: FixedNumber = FixedNumber::from_num(388.18);\n    let btc_price: FixedNumber = FixedNumber::from_num(14024);\n    let eos_price: FixedNumber = FixedNumber::from_num(2.368);\n\n    let initial_timestamp: u64 = client.now(Option::None).await?;\n\n    join_chain_calls!(\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Usd,\n                value: usd_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eq,\n                value: eq_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eth,\n                value: eth_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Btc,\n                value: btc_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eos,\n                value: eos_price,\n                _runtime: PhantomData,\n            },\n        ),\n    );\n\n    let curr_btc = client.price_points(Asset::Btc, Option::None).await?;\n    let curr_eos = client.price_points(Asset::Eos, Option::None).await?;\n    let curr_eth = client.price_points(Asset::Eth, Option::None).await?;\n    let curr_eq = client.price_points(Asset::Eq, Option::None).await?;\n    let curr_usd = client.price_points(Asset::Usd, Option::None).await?;\n\n    assert!(curr_btc == btc_price);\n    assert!(curr_eos == eos_price);\n    assert!(curr_eth == eth_price);\n    assert!(curr_eq == eq_price);\n    assert!(curr_usd == usd_price);\n\n    let btc_update = client.updates(Asset::Btc, Option::None).await?.unwrap();\n    let eos_update = client.updates(Asset::Eos, Option::None).await?.unwrap();\n    let eth_update = client.updates(Asset::Eth, Option::None).await?.unwrap();\n    let eq_update = client.updates(Asset::Eq, Option::None).await?.unwrap();\n    let usd_update = client.updates(Asset::Usd, Option::None).await?.unwrap();\n\n    assert!(btc_update.price == btc_price);\n    assert!(eos_update.price == eos_price);\n    assert!(eth_update.price == eth_price);\n    assert!(eq_update.price == eq_price);\n    assert!(usd_update.price == usd_price);\n\n    assert!(btc_update.time == Duration::from_millis(initial_timestamp));\n    assert!(eos_update.time == Duration::from_millis(initial_timestamp));\n    assert!(eth_update.time == Duration::from_millis(initial_timestamp));\n    assert!(eq_update.time == Duration::from_millis(initial_timestamp));\n    assert!(usd_update.time == Duration::from_millis(initial_timestamp));\n\n    println!(\"Moving time\");\n    call_chain(\n        client,\n        nonces.clone(),\n        alice_key,\n        AdvanceSecsCall {\n            _runtime: PhantomData,\n            secs: (secs_to_move as u32),\n        },\n    )\n    .await?;\n\n    let actual_timestamp = client.now(Option::None).await?;\n    let expected_timestamp = initial_timestamp + 1000 * (secs_to_move as u64);\n\n    assert!(actual_timestamp == expected_timestamp);\n\n    Ok(())\n}\n\nasync fn set_prices_and_move_time(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    alice_key: AccountKey,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n    secs_to_move: i32,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    let btc_prices: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(10676),\n        FixedNumber::from_num(10795),\n        FixedNumber::from_num(10604),\n        FixedNumber::from_num(10673),\n        FixedNumber::from_num(10929),\n        FixedNumber::from_num(11059),\n        FixedNumber::from_num(11302),\n        FixedNumber::from_num(11376),\n        FixedNumber::from_num(11540),\n        FixedNumber::from_num(11427),\n        FixedNumber::from_num(11429),\n        FixedNumber::from_num(11508),\n        FixedNumber::from_num(11326),\n        FixedNumber::from_num(11368),\n        FixedNumber::from_num(11513),\n        FixedNumber::from_num(11757),\n        FixedNumber::from_num(11922),\n        FixedNumber::from_num(12813),\n        FixedNumber::from_num(12990),\n        FixedNumber::from_num(12937),\n        FixedNumber::from_num(13126),\n        FixedNumber::from_num(13041),\n        FixedNumber::from_num(13069),\n        FixedNumber::from_num(13646),\n        FixedNumber::from_num(13286),\n        FixedNumber::from_num(13462),\n        FixedNumber::from_num(13566),\n        FixedNumber::from_num(13803),\n        FixedNumber::from_num(13762),\n        FixedNumber::from_num(13571),\n    ];\n\n    let eos_prices: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(2.519),\n        FixedNumber::from_num(2.529),\n        FixedNumber::from_num(2.696),\n        FixedNumber::from_num(2.647),\n        FixedNumber::from_num(2.61),\n        FixedNumber::from_num(2.646),\n        FixedNumber::from_num(2.642),\n        FixedNumber::from_num(2.66),\n        FixedNumber::from_num(2.647),\n        FixedNumber::from_num(2.64),\n        FixedNumber::from_num(2.611),\n        FixedNumber::from_num(2.599),\n        FixedNumber::from_num(2.538),\n        FixedNumber::from_num(2.526),\n        FixedNumber::from_num(2.548),\n        FixedNumber::from_num(2.584),\n        FixedNumber::from_num(2.529),\n        FixedNumber::from_num(2.612),\n        FixedNumber::from_num(2.671),\n        FixedNumber::from_num(2.642),\n        FixedNumber::from_num(2.663),\n        FixedNumber::from_num(2.709),\n        FixedNumber::from_num(2.633),\n        FixedNumber::from_num(2.672),\n        FixedNumber::from_num(2.655),\n        FixedNumber::from_num(2.638),\n        FixedNumber::from_num(2.51),\n        FixedNumber::from_num(2.527),\n        FixedNumber::from_num(2.518),\n        FixedNumber::from_num(2.435),\n    ];\n\n    let usd_prices: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n        FixedNumber::from_num(1),\n    ];\n\n    let eth_prices: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(352.61),\n        FixedNumber::from_num(353.76),\n        FixedNumber::from_num(340.85),\n        FixedNumber::from_num(341.91),\n        FixedNumber::from_num(351.2),\n        FixedNumber::from_num(365.41),\n        FixedNumber::from_num(370.88),\n        FixedNumber::from_num(374.37),\n        FixedNumber::from_num(386.91),\n        FixedNumber::from_num(381.41),\n        FixedNumber::from_num(379.11),\n        FixedNumber::from_num(377.7),\n        FixedNumber::from_num(365.58),\n        FixedNumber::from_num(368.65),\n        FixedNumber::from_num(378.44),\n        FixedNumber::from_num(379.41),\n        FixedNumber::from_num(368.74),\n        FixedNumber::from_num(391.46),\n        FixedNumber::from_num(414.5),\n        FixedNumber::from_num(409.57),\n        FixedNumber::from_num(412.55),\n        FixedNumber::from_num(406.36),\n        FixedNumber::from_num(393.11),\n        FixedNumber::from_num(403.74),\n        FixedNumber::from_num(388.77),\n        FixedNumber::from_num(387.54),\n        FixedNumber::from_num(382.76),\n        FixedNumber::from_num(386.77),\n        FixedNumber::from_num(396.75),\n        FixedNumber::from_num(383.61),\n    ];\n\n    let eq_prices: Vec\u003cFixedNumber\u003e = vec![\n        FixedNumber::from_num(0.7106),\n        FixedNumber::from_num(0.70822),\n        FixedNumber::from_num(0.63801),\n        FixedNumber::from_num(0.65603),\n        FixedNumber::from_num(0.70074),\n        FixedNumber::from_num(0.72471),\n        FixedNumber::from_num(0.72182),\n        FixedNumber::from_num(0.72233),\n        FixedNumber::from_num(0.7327),\n        FixedNumber::from_num(0.72352),\n        FixedNumber::from_num(0.71349),\n        FixedNumber::from_num(0.69649),\n        FixedNumber::from_num(0.66538),\n        FixedNumber::from_num(0.67473),\n        FixedNumber::from_num(0.69887),\n        FixedNumber::from_num(0.67813),\n        FixedNumber::from_num(0.66538),\n        FixedNumber::from_num(0.70431),\n        FixedNumber::from_num(0.7259),\n        FixedNumber::from_num(0.72522),\n        FixedNumber::from_num(0.7412),\n        FixedNumber::from_num(0.73644),\n        FixedNumber::from_num(0.80019),\n        FixedNumber::from_num(0.7956),\n        FixedNumber::from_num(0.74239),\n        FixedNumber::from_num(0.68969),\n        FixedNumber::from_num(0.69462),\n        FixedNumber::from_num(0.71111),\n        FixedNumber::from_num(0.71774),\n        FixedNumber::from_num(0.68629),\n    ];\n\n    assert!(\n        btc_prices.len() == eos_prices.len()\n            \u0026\u0026 eos_prices.len() == usd_prices.len()\n            \u0026\u0026 usd_prices.len() == eth_prices.len()\n            \u0026\u0026 eth_prices.len() == eq_prices.len()\n            \u0026\u0026 btc_prices.len() == 30\n    );\n\n    let prices_tuple = izip!(usd_prices, eq_prices, eth_prices, btc_prices, eos_prices);\n\n    println!(\"Setting initial monthly prices\");\n\n    let mut counter = 1;\n    for (usd, eq, eth, btc, eos) in prices_tuple {\n        println!(\"Setting prices on iteration #{}\", counter);\n        let initial_timestamp: u64 = client.now(Option::None).await?;\n\n        join_chain_calls!(\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Usd,\n                    value: usd,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eq,\n                    value: eq,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eth,\n                    value: eth,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Btc,\n                    value: btc,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eos,\n                    value: eos,\n                    _runtime: PhantomData,\n                },\n            ),\n        );\n\n        let curr_btc = client.price_points(Asset::Btc, Option::None).await?;\n        let curr_eos = client.price_points(Asset::Eos, Option::None).await?;\n        let curr_eth = client.price_points(Asset::Eth, Option::None).await?;\n        let curr_eq = client.price_points(Asset::Eq, Option::None).await?;\n        let curr_usd = client.price_points(Asset::Usd, Option::None).await?;\n\n        assert!(curr_btc == btc);\n        assert!(curr_eos == eos);\n        assert!(curr_eth == eth);\n        assert!(curr_eq == eq);\n        assert!(curr_usd == usd);\n\n        let btc_update = client.updates(Asset::Btc, Option::None).await?.unwrap();\n        let eos_update = client.updates(Asset::Eos, Option::None).await?.unwrap();\n        let eth_update = client.updates(Asset::Eth, Option::None).await?.unwrap();\n        let eq_update = client.updates(Asset::Eq, Option::None).await?.unwrap();\n        let usd_update = client.updates(Asset::Usd, Option::None).await?.unwrap();\n\n        assert!(btc_update.price == btc);\n        assert!(eos_update.price == eos);\n        assert!(eth_update.price == eth);\n        assert!(eq_update.price == eq);\n        assert!(usd_update.price == usd);\n\n        assert!(btc_update.time == Duration::from_millis(initial_timestamp));\n        assert!(eos_update.time == Duration::from_millis(initial_timestamp));\n        assert!(eth_update.time == Duration::from_millis(initial_timestamp));\n        assert!(eq_update.time == Duration::from_millis(initial_timestamp));\n        assert!(usd_update.time == Duration::from_millis(initial_timestamp));\n\n        println!(\"Moving time\");\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            AdvanceSecsCall {\n                _runtime: PhantomData,\n                secs: (secs_to_move as u32),\n            },\n        )\n        .await?;\n\n        let actual_timestamp = client.now(Option::None).await?;\n        let expected_timestamp = initial_timestamp + 1000 * (secs_to_move as u64);\n\n        assert!(actual_timestamp == expected_timestamp);\n\n        counter = counter + 1;\n    }\n\n    Ok(())\n}\n","traces":[{"line":20,"address":[5363696],"length":1,"stats":{"Line":0},"fn_name":"test_financial"},{"line":24,"address":[4508974],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[4509087],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[4509177,4509426,4509302,4509255,4509133,4509881,4509352,4514102,4509735,4509921],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[4509667],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[4509978,4510482,4510036,4510207,4509674,4510083,4510601,4514123,4510133],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[4510440,4510630],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[4510664],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[4510668],"length":1,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[4510706],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[4511356,4511133,4511227,4511239],"length":1,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[4511612,4511483,4511538,4514165,4511393,4511914,4512033],"length":1,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[4511853,4512693,4514186,4512574,4512070,4512299,4512175,4512225,4512128],"length":1,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[4512532,4512722],"length":1,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[4512756],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[4512760],"length":1,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[4512798],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[4513313,4513219,4513322,4513418],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[4514005,4514228,4513594,4513452,4513907,4513542,4513659],"length":1,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[4513868,4514031],"length":1,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[4514057],"length":1,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[5363980,5363776],"length":1,"stats":{"Line":0},"fn_name":"assert_vectors_with_epsilon"},{"line":83,"address":[5364085,5364003,5363804],"length":1,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[4515632,4515651],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":85,"address":[4515680,4515699],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":87,"address":[5364336,5365887,5364887,5364613,5364648],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[5364892,5364730],"length":1,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[5366067,5366016],"length":1,"stats":{"Line":0},"fn_name":"assert_metrics_assets"},{"line":93,"address":[5366544,5366310,5366082,5366375,5366506,5366704,5366031],"length":1,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[5366437,5366511],"length":1,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[5366960],"length":1,"stats":{"Line":0},"fn_name":"assert_second_recalc_chain_state"},{"line":101,"address":[4516453,4515918,4516057,4516940,4516185,4516980,4516111,4517033,4521533],"length":1,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[4517065],"length":1,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[4517143,4517335,4517219],"length":1,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[4517159],"length":1,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[4517192],"length":1,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[4517244],"length":1,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[4517277],"length":1,"stats":{"Line":0},"fn_name":null},{"line":110,"address":[4517310],"length":1,"stats":{"Line":0},"fn_name":null},{"line":115,"address":[4517500],"length":1,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[4517540],"length":1,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[4517617,4519228,4517702,4518481],"length":1,"stats":{"Line":0},"fn_name":null},{"line":120,"address":[4517635],"length":1,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[4517667],"length":1,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[4517721],"length":1,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[4517748],"length":1,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[4517775],"length":1,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[4517802],"length":1,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[4517832],"length":1,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[4517868],"length":1,"stats":{"Line":0},"fn_name":null},{"line":128,"address":[4517904],"length":1,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[4517940],"length":1,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[4517970],"length":1,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[4518006],"length":1,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[4518039],"length":1,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[4518075],"length":1,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[4518111],"length":1,"stats":{"Line":0},"fn_name":null},{"line":135,"address":[4518141],"length":1,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[4518177],"length":1,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[4518213],"length":1,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[4518246],"length":1,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[4518282],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[4518312],"length":1,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[4518348],"length":1,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[4518384],"length":1,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[4518420],"length":1,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[4518453],"length":1,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[4520790,4519350,4520092,4519246],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[4519261],"length":1,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[4519286],"length":1,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[4519369],"length":1,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[4519396],"length":1,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[4519423],"length":1,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[4519450],"length":1,"stats":{"Line":0},"fn_name":null},{"line":154,"address":[4519483],"length":1,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[4519519],"length":1,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[4519555],"length":1,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[4519591],"length":1,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[4519621],"length":1,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[4519657],"length":1,"stats":{"Line":0},"fn_name":null},{"line":160,"address":[4519693],"length":1,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[4519729],"length":1,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[4519765],"length":1,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[4519795],"length":1,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[4519831],"length":1,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[4519867],"length":1,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[4519897],"length":1,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[4519927],"length":1,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[4519951],"length":1,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[4519981],"length":1,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[4520011],"length":1,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[4520041],"length":1,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[4520071],"length":1,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[4520798],"length":1,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[4520838],"length":1,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[4520886],"length":1,"stats":{"Line":0},"fn_name":null},{"line":181,"address":[4520918],"length":1,"stats":{"Line":0},"fn_name":null},{"line":186,"address":[4520993],"length":1,"stats":{"Line":0},"fn_name":null},{"line":187,"address":[4521033],"length":1,"stats":{"Line":0},"fn_name":null},{"line":397,"address":[4521163],"length":1,"stats":{"Line":0},"fn_name":null},{"line":400,"address":[5367008],"length":1,"stats":{"Line":0},"fn_name":"assert_first_recalc_chain_state"},{"line":403,"address":[4528877,4524377,4523529,4524284,4523455,4523401,4524324,4523262,4523797],"length":1,"stats":{"Line":0},"fn_name":null},{"line":405,"address":[4524409],"length":1,"stats":{"Line":0},"fn_name":null},{"line":407,"address":[4524487,4524679,4524563],"length":1,"stats":{"Line":0},"fn_name":null},{"line":408,"address":[4524503],"length":1,"stats":{"Line":0},"fn_name":null},{"line":409,"address":[4524536],"length":1,"stats":{"Line":0},"fn_name":null},{"line":410,"address":[4524588],"length":1,"stats":{"Line":0},"fn_name":null},{"line":411,"address":[4524621],"length":1,"stats":{"Line":0},"fn_name":null},{"line":412,"address":[4524654],"length":1,"stats":{"Line":0},"fn_name":null},{"line":417,"address":[4524844],"length":1,"stats":{"Line":0},"fn_name":null},{"line":418,"address":[4524884],"length":1,"stats":{"Line":0},"fn_name":null},{"line":421,"address":[4524961,4525046,4525825,4526572],"length":1,"stats":{"Line":0},"fn_name":null},{"line":422,"address":[4524979],"length":1,"stats":{"Line":0},"fn_name":null},{"line":423,"address":[4525011],"length":1,"stats":{"Line":0},"fn_name":null},{"line":424,"address":[4525065],"length":1,"stats":{"Line":0},"fn_name":null},{"line":425,"address":[4525092],"length":1,"stats":{"Line":0},"fn_name":null},{"line":426,"address":[4525119],"length":1,"stats":{"Line":0},"fn_name":null},{"line":427,"address":[4525146],"length":1,"stats":{"Line":0},"fn_name":null},{"line":428,"address":[4525176],"length":1,"stats":{"Line":0},"fn_name":null},{"line":429,"address":[4525212],"length":1,"stats":{"Line":0},"fn_name":null},{"line":430,"address":[4525248],"length":1,"stats":{"Line":0},"fn_name":null},{"line":431,"address":[4525284],"length":1,"stats":{"Line":0},"fn_name":null},{"line":432,"address":[4525314],"length":1,"stats":{"Line":0},"fn_name":null},{"line":433,"address":[4525350],"length":1,"stats":{"Line":0},"fn_name":null},{"line":434,"address":[4525383],"length":1,"stats":{"Line":0},"fn_name":null},{"line":435,"address":[4525419],"length":1,"stats":{"Line":0},"fn_name":null},{"line":436,"address":[4525455],"length":1,"stats":{"Line":0},"fn_name":null},{"line":437,"address":[4525485],"length":1,"stats":{"Line":0},"fn_name":null},{"line":438,"address":[4525521],"length":1,"stats":{"Line":0},"fn_name":null},{"line":439,"address":[4525557],"length":1,"stats":{"Line":0},"fn_name":null},{"line":440,"address":[4525590],"length":1,"stats":{"Line":0},"fn_name":null},{"line":441,"address":[4525626],"length":1,"stats":{"Line":0},"fn_name":null},{"line":442,"address":[4525656],"length":1,"stats":{"Line":0},"fn_name":null},{"line":443,"address":[4525692],"length":1,"stats":{"Line":0},"fn_name":null},{"line":444,"address":[4525728],"length":1,"stats":{"Line":0},"fn_name":null},{"line":445,"address":[4525764],"length":1,"stats":{"Line":0},"fn_name":null},{"line":446,"address":[4525797],"length":1,"stats":{"Line":0},"fn_name":null},{"line":449,"address":[4528134,4527436,4526694,4526590],"length":1,"stats":{"Line":0},"fn_name":null},{"line":450,"address":[4526605],"length":1,"stats":{"Line":0},"fn_name":null},{"line":451,"address":[4526630],"length":1,"stats":{"Line":0},"fn_name":null},{"line":452,"address":[4526713],"length":1,"stats":{"Line":0},"fn_name":null},{"line":453,"address":[4526740],"length":1,"stats":{"Line":0},"fn_name":null},{"line":454,"address":[4526767],"length":1,"stats":{"Line":0},"fn_name":null},{"line":455,"address":[4526794],"length":1,"stats":{"Line":0},"fn_name":null},{"line":456,"address":[4526827],"length":1,"stats":{"Line":0},"fn_name":null},{"line":457,"address":[4526863],"length":1,"stats":{"Line":0},"fn_name":null},{"line":458,"address":[4526899],"length":1,"stats":{"Line":0},"fn_name":null},{"line":459,"address":[4526935],"length":1,"stats":{"Line":0},"fn_name":null},{"line":460,"address":[4526965],"length":1,"stats":{"Line":0},"fn_name":null},{"line":461,"address":[4527001],"length":1,"stats":{"Line":0},"fn_name":null},{"line":462,"address":[4527037],"length":1,"stats":{"Line":0},"fn_name":null},{"line":463,"address":[4527073],"length":1,"stats":{"Line":0},"fn_name":null},{"line":464,"address":[4527109],"length":1,"stats":{"Line":0},"fn_name":null},{"line":465,"address":[4527139],"length":1,"stats":{"Line":0},"fn_name":null},{"line":466,"address":[4527175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":467,"address":[4527211],"length":1,"stats":{"Line":0},"fn_name":null},{"line":468,"address":[4527241],"length":1,"stats":{"Line":0},"fn_name":null},{"line":469,"address":[4527271],"length":1,"stats":{"Line":0},"fn_name":null},{"line":470,"address":[4527295],"length":1,"stats":{"Line":0},"fn_name":null},{"line":471,"address":[4527325],"length":1,"stats":{"Line":0},"fn_name":null},{"line":472,"address":[4527355],"length":1,"stats":{"Line":0},"fn_name":null},{"line":473,"address":[4527385],"length":1,"stats":{"Line":0},"fn_name":null},{"line":474,"address":[4527415],"length":1,"stats":{"Line":0},"fn_name":null},{"line":477,"address":[4528142],"length":1,"stats":{"Line":0},"fn_name":null},{"line":478,"address":[4528182],"length":1,"stats":{"Line":0},"fn_name":null},{"line":482,"address":[4528230],"length":1,"stats":{"Line":0},"fn_name":null},{"line":483,"address":[4528262],"length":1,"stats":{"Line":0},"fn_name":null},{"line":488,"address":[4528337],"length":1,"stats":{"Line":0},"fn_name":null},{"line":489,"address":[4528377],"length":1,"stats":{"Line":0},"fn_name":null},{"line":699,"address":[4528507],"length":1,"stats":{"Line":0},"fn_name":null},{"line":702,"address":[5367056],"length":1,"stats":{"Line":0},"fn_name":"set_prices_after_month"},{"line":708,"address":[4534469],"length":1,"stats":{"Line":0},"fn_name":null},{"line":709,"address":[4534593],"length":1,"stats":{"Line":0},"fn_name":null},{"line":710,"address":[4534672],"length":1,"stats":{"Line":0},"fn_name":null},{"line":711,"address":[4534754],"length":1,"stats":{"Line":0},"fn_name":null},{"line":712,"address":[4534836],"length":1,"stats":{"Line":0},"fn_name":null},{"line":713,"address":[4534915],"length":1,"stats":{"Line":0},"fn_name":null},{"line":715,"address":[4535977,4535096,4553245,4535151,4535558,4535225,4535626,4535937,4535000],"length":1,"stats":{"Line":0},"fn_name":null},{"line":717,"address":[4536939,4538858,4538083,4536728,4536263,4553043,4537261,4539059,4552998,4536691,4538948,4536505,4537222,4536747,4539050,4536034,4536976,4537187,4536244,4536486,4553266,4535589,4536449,4536995,4536178,4537559,4537683,4537609],"length":1,"stats":{"Line":0},"fn_name":null},{"line":770,"address":[4539326,4539159,4539733,4553287,4539271,4539849,4540130,4539400],"length":1,"stats":{"Line":0},"fn_name":null},{"line":771,"address":[4539787,4540674,4540790,4540175,4553308,4541071,4540212,4540267,4540341],"length":1,"stats":{"Line":0},"fn_name":null},{"line":772,"address":[4540728,4541282,4541116,4541153,4542012,4541208,4541731,4553329,4541615],"length":1,"stats":{"Line":0},"fn_name":null},{"line":773,"address":[4541669,4542149,4542953,4542672,4542556,4542223,4553350,4542057,4542094],"length":1,"stats":{"Line":0},"fn_name":null},{"line":774,"address":[4543164,4542610,4542998,4543035,4543593,4543090,4543874,4543497,4553371],"length":1,"stats":{"Line":0},"fn_name":null},{"line":776,"address":[4543910,4543974,4543551],"length":1,"stats":{"Line":0},"fn_name":null},{"line":777,"address":[4544016,4543933,4544077],"length":1,"stats":{"Line":0},"fn_name":null},{"line":778,"address":[4544119,4544039,4544180],"length":1,"stats":{"Line":0},"fn_name":null},{"line":779,"address":[4544142,4544283,4544222],"length":1,"stats":{"Line":0},"fn_name":null},{"line":780,"address":[4544245,4544325,4544407],"length":1,"stats":{"Line":0},"fn_name":null},{"line":782,"address":[4544962,4544552,4544495,4544458,4553392,4544626,4545418,4544348],"length":1,"stats":{"Line":0},"fn_name":null},{"line":783,"address":[4546490,4545698,4553413,4546034,4545455,4545624,4545567],"length":1,"stats":{"Line":0},"fn_name":null},{"line":784,"address":[4547562,4546696,4546527,4546639,4546770,4547106,4553434],"length":1,"stats":{"Line":0},"fn_name":null},{"line":785,"address":[4547842,4547599,4553455,4548634,4547711,4547768,4548178],"length":1,"stats":{"Line":0},"fn_name":null},{"line":786,"address":[4553476,4548671,4548914,4549250,4548840,4549706,4548783],"length":1,"stats":{"Line":0},"fn_name":null},{"line":788,"address":[4549743,4549852],"length":1,"stats":{"Line":0},"fn_name":null},{"line":789,"address":[4549811,4549955,4549894],"length":1,"stats":{"Line":0},"fn_name":null},{"line":790,"address":[4549997,4550058,4549917],"length":1,"stats":{"Line":0},"fn_name":null},{"line":791,"address":[4550161,4550020,4550100],"length":1,"stats":{"Line":0},"fn_name":null},{"line":792,"address":[4550203,4550123,4550277],"length":1,"stats":{"Line":0},"fn_name":null},{"line":794,"address":[4550388,4550226,4550453,4550320],"length":1,"stats":{"Line":0},"fn_name":null},{"line":795,"address":[4550629,4550402,4550496,4550564],"length":1,"stats":{"Line":0},"fn_name":null},{"line":796,"address":[4550672,4550578,4550740,4550805],"length":1,"stats":{"Line":0},"fn_name":null},{"line":797,"address":[4550981,4550916,4550848,4550754],"length":1,"stats":{"Line":0},"fn_name":null},{"line":798,"address":[4551024,4550930,4551137,4551092],"length":1,"stats":{"Line":0},"fn_name":null},{"line":800,"address":[4551172,4551098],"length":1,"stats":{"Line":0},"fn_name":null},{"line":802,"address":[4551206],"length":1,"stats":{"Line":0},"fn_name":null},{"line":803,"address":[4551210],"length":1,"stats":{"Line":0},"fn_name":null},{"line":804,"address":[4551248],"length":1,"stats":{"Line":0},"fn_name":null},{"line":805,"address":[4551278],"length":1,"stats":{"Line":0},"fn_name":null},{"line":807,"address":[4551272],"length":1,"stats":{"Line":0},"fn_name":null},{"line":810,"address":[4551795,4551807,4551701,4551909],"length":1,"stats":{"Line":0},"fn_name":null},{"line":812,"address":[4551943,4553518,4552476,4552827,4552029,4552143,4552078,4552567],"length":1,"stats":{"Line":0},"fn_name":null},{"line":813,"address":[4556911,4552863,4552899,4552508],"length":1,"stats":{"Line":0},"fn_name":null},{"line":815,"address":[4552963,4552912],"length":1,"stats":{"Line":0},"fn_name":null},{"line":817,"address":[4552926],"length":1,"stats":{"Line":0},"fn_name":null},{"line":820,"address":[5367184],"length":1,"stats":{"Line":0},"fn_name":"set_prices_and_move_time"},{"line":826,"address":[4561457,4561315,4563301,4562389],"length":1,"stats":{"Line":0},"fn_name":null},{"line":827,"address":[4561333],"length":1,"stats":{"Line":0},"fn_name":null},{"line":828,"address":[4561361],"length":1,"stats":{"Line":0},"fn_name":null},{"line":829,"address":[4561479],"length":1,"stats":{"Line":0},"fn_name":null},{"line":830,"address":[4561509],"length":1,"stats":{"Line":0},"fn_name":null},{"line":831,"address":[4561539],"length":1,"stats":{"Line":0},"fn_name":null},{"line":832,"address":[4561569],"length":1,"stats":{"Line":0},"fn_name":null},{"line":833,"address":[4561602],"length":1,"stats":{"Line":0},"fn_name":null},{"line":834,"address":[4561635],"length":1,"stats":{"Line":0},"fn_name":null},{"line":835,"address":[4561668],"length":1,"stats":{"Line":0},"fn_name":null},{"line":836,"address":[4561701],"length":1,"stats":{"Line":0},"fn_name":null},{"line":837,"address":[4561734],"length":1,"stats":{"Line":0},"fn_name":null},{"line":838,"address":[4561767],"length":1,"stats":{"Line":0},"fn_name":null},{"line":839,"address":[4561800],"length":1,"stats":{"Line":0},"fn_name":null},{"line":840,"address":[4561833],"length":1,"stats":{"Line":0},"fn_name":null},{"line":841,"address":[4561866],"length":1,"stats":{"Line":0},"fn_name":null},{"line":842,"address":[4561899],"length":1,"stats":{"Line":0},"fn_name":null},{"line":843,"address":[4561932],"length":1,"stats":{"Line":0},"fn_name":null},{"line":844,"address":[4561965],"length":1,"stats":{"Line":0},"fn_name":null},{"line":845,"address":[4561998],"length":1,"stats":{"Line":0},"fn_name":null},{"line":846,"address":[4562031],"length":1,"stats":{"Line":0},"fn_name":null},{"line":847,"address":[4562064],"length":1,"stats":{"Line":0},"fn_name":null},{"line":848,"address":[4562097],"length":1,"stats":{"Line":0},"fn_name":null},{"line":849,"address":[4562130],"length":1,"stats":{"Line":0},"fn_name":null},{"line":850,"address":[4562163],"length":1,"stats":{"Line":0},"fn_name":null},{"line":851,"address":[4562196],"length":1,"stats":{"Line":0},"fn_name":null},{"line":852,"address":[4562229],"length":1,"stats":{"Line":0},"fn_name":null},{"line":853,"address":[4562262],"length":1,"stats":{"Line":0},"fn_name":null},{"line":854,"address":[4562295],"length":1,"stats":{"Line":0},"fn_name":null},{"line":855,"address":[4562328],"length":1,"stats":{"Line":0},"fn_name":null},{"line":856,"address":[4562361],"length":1,"stats":{"Line":0},"fn_name":null},{"line":859,"address":[4564471,4565383,4563455,4563318],"length":1,"stats":{"Line":0},"fn_name":null},{"line":860,"address":[4563339],"length":1,"stats":{"Line":0},"fn_name":null},{"line":861,"address":[4563370],"length":1,"stats":{"Line":0},"fn_name":null},{"line":862,"address":[4563480],"length":1,"stats":{"Line":0},"fn_name":null},{"line":863,"address":[4563513],"length":1,"stats":{"Line":0},"fn_name":null},{"line":864,"address":[4563546],"length":1,"stats":{"Line":0},"fn_name":null},{"line":865,"address":[4563579],"length":1,"stats":{"Line":0},"fn_name":null},{"line":866,"address":[4563615],"length":1,"stats":{"Line":0},"fn_name":null},{"line":867,"address":[4563651],"length":1,"stats":{"Line":0},"fn_name":null},{"line":868,"address":[4563687],"length":1,"stats":{"Line":0},"fn_name":null},{"line":869,"address":[4563723],"length":1,"stats":{"Line":0},"fn_name":null},{"line":870,"address":[4563759],"length":1,"stats":{"Line":0},"fn_name":null},{"line":871,"address":[4563795],"length":1,"stats":{"Line":0},"fn_name":null},{"line":872,"address":[4563831],"length":1,"stats":{"Line":0},"fn_name":null},{"line":873,"address":[4563867],"length":1,"stats":{"Line":0},"fn_name":null},{"line":874,"address":[4563903],"length":1,"stats":{"Line":0},"fn_name":null},{"line":875,"address":[4563939],"length":1,"stats":{"Line":0},"fn_name":null},{"line":876,"address":[4563975],"length":1,"stats":{"Line":0},"fn_name":null},{"line":877,"address":[4564011],"length":1,"stats":{"Line":0},"fn_name":null},{"line":878,"address":[4564047],"length":1,"stats":{"Line":0},"fn_name":null},{"line":879,"address":[4564083],"length":1,"stats":{"Line":0},"fn_name":null},{"line":880,"address":[4564119],"length":1,"stats":{"Line":0},"fn_name":null},{"line":881,"address":[4564155],"length":1,"stats":{"Line":0},"fn_name":null},{"line":882,"address":[4564191],"length":1,"stats":{"Line":0},"fn_name":null},{"line":883,"address":[4564227],"length":1,"stats":{"Line":0},"fn_name":null},{"line":884,"address":[4564263],"length":1,"stats":{"Line":0},"fn_name":null},{"line":885,"address":[4564299],"length":1,"stats":{"Line":0},"fn_name":null},{"line":886,"address":[4564335],"length":1,"stats":{"Line":0},"fn_name":null},{"line":887,"address":[4564371],"length":1,"stats":{"Line":0},"fn_name":null},{"line":888,"address":[4564407],"length":1,"stats":{"Line":0},"fn_name":null},{"line":889,"address":[4564443],"length":1,"stats":{"Line":0},"fn_name":null},{"line":892,"address":[4565400,4566463,4565531,4567375],"length":1,"stats":{"Line":0},"fn_name":null},{"line":893,"address":[4565418],"length":1,"stats":{"Line":0},"fn_name":null},{"line":894,"address":[4565446],"length":1,"stats":{"Line":0},"fn_name":null},{"line":895,"address":[4565553],"length":1,"stats":{"Line":0},"fn_name":null},{"line":896,"address":[4565583],"length":1,"stats":{"Line":0},"fn_name":null},{"line":897,"address":[4565613],"length":1,"stats":{"Line":0},"fn_name":null},{"line":898,"address":[4565643],"length":1,"stats":{"Line":0},"fn_name":null},{"line":899,"address":[4565676],"length":1,"stats":{"Line":0},"fn_name":null},{"line":900,"address":[4565709],"length":1,"stats":{"Line":0},"fn_name":null},{"line":901,"address":[4565742],"length":1,"stats":{"Line":0},"fn_name":null},{"line":902,"address":[4565775],"length":1,"stats":{"Line":0},"fn_name":null},{"line":903,"address":[4565808],"length":1,"stats":{"Line":0},"fn_name":null},{"line":904,"address":[4565841],"length":1,"stats":{"Line":0},"fn_name":null},{"line":905,"address":[4565874],"length":1,"stats":{"Line":0},"fn_name":null},{"line":906,"address":[4565907],"length":1,"stats":{"Line":0},"fn_name":null},{"line":907,"address":[4565940],"length":1,"stats":{"Line":0},"fn_name":null},{"line":908,"address":[4565973],"length":1,"stats":{"Line":0},"fn_name":null},{"line":909,"address":[4566006],"length":1,"stats":{"Line":0},"fn_name":null},{"line":910,"address":[4566039],"length":1,"stats":{"Line":0},"fn_name":null},{"line":911,"address":[4566072],"length":1,"stats":{"Line":0},"fn_name":null},{"line":912,"address":[4566105],"length":1,"stats":{"Line":0},"fn_name":null},{"line":913,"address":[4566138],"length":1,"stats":{"Line":0},"fn_name":null},{"line":914,"address":[4566171],"length":1,"stats":{"Line":0},"fn_name":null},{"line":915,"address":[4566204],"length":1,"stats":{"Line":0},"fn_name":null},{"line":916,"address":[4566237],"length":1,"stats":{"Line":0},"fn_name":null},{"line":917,"address":[4566270],"length":1,"stats":{"Line":0},"fn_name":null},{"line":918,"address":[4566303],"length":1,"stats":{"Line":0},"fn_name":null},{"line":919,"address":[4566336],"length":1,"stats":{"Line":0},"fn_name":null},{"line":920,"address":[4566369],"length":1,"stats":{"Line":0},"fn_name":null},{"line":921,"address":[4566402],"length":1,"stats":{"Line":0},"fn_name":null},{"line":922,"address":[4566435],"length":1,"stats":{"Line":0},"fn_name":null},{"line":925,"address":[4567392,4567529,4569459,4568545],"length":1,"stats":{"Line":0},"fn_name":null},{"line":926,"address":[4567413],"length":1,"stats":{"Line":0},"fn_name":null},{"line":927,"address":[4567444],"length":1,"stats":{"Line":0},"fn_name":null},{"line":928,"address":[4567554],"length":1,"stats":{"Line":0},"fn_name":null},{"line":929,"address":[4567587],"length":1,"stats":{"Line":0},"fn_name":null},{"line":930,"address":[4567620],"length":1,"stats":{"Line":0},"fn_name":null},{"line":931,"address":[4567653],"length":1,"stats":{"Line":0},"fn_name":null},{"line":932,"address":[4567689],"length":1,"stats":{"Line":0},"fn_name":null},{"line":933,"address":[4567725],"length":1,"stats":{"Line":0},"fn_name":null},{"line":934,"address":[4567761],"length":1,"stats":{"Line":0},"fn_name":null},{"line":935,"address":[4567797],"length":1,"stats":{"Line":0},"fn_name":null},{"line":936,"address":[4567833],"length":1,"stats":{"Line":0},"fn_name":null},{"line":937,"address":[4567869],"length":1,"stats":{"Line":0},"fn_name":null},{"line":938,"address":[4567905],"length":1,"stats":{"Line":0},"fn_name":null},{"line":939,"address":[4567941],"length":1,"stats":{"Line":0},"fn_name":null},{"line":940,"address":[4567977],"length":1,"stats":{"Line":0},"fn_name":null},{"line":941,"address":[4568013],"length":1,"stats":{"Line":0},"fn_name":null},{"line":942,"address":[4568049],"length":1,"stats":{"Line":0},"fn_name":null},{"line":943,"address":[4568085],"length":1,"stats":{"Line":0},"fn_name":null},{"line":944,"address":[4568121],"length":1,"stats":{"Line":0},"fn_name":null},{"line":945,"address":[4568157],"length":1,"stats":{"Line":0},"fn_name":null},{"line":946,"address":[4568193],"length":1,"stats":{"Line":0},"fn_name":null},{"line":947,"address":[4568229],"length":1,"stats":{"Line":0},"fn_name":null},{"line":948,"address":[4568265],"length":1,"stats":{"Line":0},"fn_name":null},{"line":949,"address":[4568301],"length":1,"stats":{"Line":0},"fn_name":null},{"line":950,"address":[4568337],"length":1,"stats":{"Line":0},"fn_name":null},{"line":951,"address":[4568373],"length":1,"stats":{"Line":0},"fn_name":null},{"line":952,"address":[4568409],"length":1,"stats":{"Line":0},"fn_name":null},{"line":953,"address":[4568445],"length":1,"stats":{"Line":0},"fn_name":null},{"line":954,"address":[4568481],"length":1,"stats":{"Line":0},"fn_name":null},{"line":955,"address":[4568517],"length":1,"stats":{"Line":0},"fn_name":null},{"line":958,"address":[4569613,4570629,4569476,4571543],"length":1,"stats":{"Line":0},"fn_name":null},{"line":959,"address":[4569497],"length":1,"stats":{"Line":0},"fn_name":null},{"line":960,"address":[4569528],"length":1,"stats":{"Line":0},"fn_name":null},{"line":961,"address":[4569638],"length":1,"stats":{"Line":0},"fn_name":null},{"line":962,"address":[4569671],"length":1,"stats":{"Line":0},"fn_name":null},{"line":963,"address":[4569704],"length":1,"stats":{"Line":0},"fn_name":null},{"line":964,"address":[4569737],"length":1,"stats":{"Line":0},"fn_name":null},{"line":965,"address":[4569773],"length":1,"stats":{"Line":0},"fn_name":null},{"line":966,"address":[4569809],"length":1,"stats":{"Line":0},"fn_name":null},{"line":967,"address":[4569845],"length":1,"stats":{"Line":0},"fn_name":null},{"line":968,"address":[4569881],"length":1,"stats":{"Line":0},"fn_name":null},{"line":969,"address":[4569917],"length":1,"stats":{"Line":0},"fn_name":null},{"line":970,"address":[4569953],"length":1,"stats":{"Line":0},"fn_name":null},{"line":971,"address":[4569989],"length":1,"stats":{"Line":0},"fn_name":null},{"line":972,"address":[4570025],"length":1,"stats":{"Line":0},"fn_name":null},{"line":973,"address":[4570061],"length":1,"stats":{"Line":0},"fn_name":null},{"line":974,"address":[4570097],"length":1,"stats":{"Line":0},"fn_name":null},{"line":975,"address":[4570133],"length":1,"stats":{"Line":0},"fn_name":null},{"line":976,"address":[4570169],"length":1,"stats":{"Line":0},"fn_name":null},{"line":977,"address":[4570205],"length":1,"stats":{"Line":0},"fn_name":null},{"line":978,"address":[4570241],"length":1,"stats":{"Line":0},"fn_name":null},{"line":979,"address":[4570277],"length":1,"stats":{"Line":0},"fn_name":null},{"line":980,"address":[4570313],"length":1,"stats":{"Line":0},"fn_name":null},{"line":981,"address":[4570349],"length":1,"stats":{"Line":0},"fn_name":null},{"line":982,"address":[4570385],"length":1,"stats":{"Line":0},"fn_name":null},{"line":983,"address":[4570421],"length":1,"stats":{"Line":0},"fn_name":null},{"line":984,"address":[4570457],"length":1,"stats":{"Line":0},"fn_name":null},{"line":985,"address":[4570493],"length":1,"stats":{"Line":0},"fn_name":null},{"line":986,"address":[4570529],"length":1,"stats":{"Line":0},"fn_name":null},{"line":987,"address":[4570565],"length":1,"stats":{"Line":0},"fn_name":null},{"line":988,"address":[4570601],"length":1,"stats":{"Line":0},"fn_name":null},{"line":991,"address":[4571618,4572258],"length":1,"stats":{"Line":0},"fn_name":null},{"line":992,"address":[4571982,4571795,4572170,4571740,4572138,4571685,4571640,4571910,4571550,4572060],"length":1,"stats":{"Line":0},"fn_name":null},{"line":993,"address":[4571976,4571934,4571770],"length":1,"stats":{"Line":0},"fn_name":null},{"line":994,"address":[4572054,4571715,4572007],"length":1,"stats":{"Line":0},"fn_name":null},{"line":995,"address":[4572132,4571658,4572085],"length":1,"stats":{"Line":0},"fn_name":null},{"line":996,"address":[4571593,4572163],"length":1,"stats":{"Line":0},"fn_name":null},{"line":999,"address":[4557056,4572198,4572666,4572646,4572488,4572410,4572304,4572563],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1001,"address":[4572673,4572717],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1003,"address":[4572791],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1004,"address":[4572952,4572978,4572801,4591925,4573048],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1005,"address":[4573619,4573448],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1006,"address":[4574279,4573794,4574211,4592464,4573739,4574640,4574600,4573868,4573646],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1008,"address":[4577807,4575227,4574979,4574242,4575934,4576008,4575246,4575190,4575742,4576356,4592262,4577615,4575723,4575438,4576430,4574913,4574763,4575686,4576840,4592485,4574998,4576306,4575969,4575475,4577816,4575494,4592217,4577705],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1061,"address":[4578500,4578157,4592506,4578897,4578083,4578028,4578616,4577916],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1062,"address":[4579108,4578554,4579034,4579567,4579451,4578942,4578979,4579848,4592527],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1063,"address":[4579930,4592548,4580799,4580402,4579985,4579505,4580518,4580059,4579893],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1064,"address":[4581353,4580456,4580844,4580936,4581469,4592569,4580881,4581750,4581010],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1065,"address":[4581795,4582683,4582304,4581961,4592590,4581407,4581832,4581887,4582402],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1067,"address":[4582783,4582358,4582719],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1068,"address":[4582889,4582825,4582742],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1069,"address":[4582995,4582848,4582931],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1070,"address":[4583037,4583101,4582954],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1071,"address":[4583225,4583143,4583060],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1073,"address":[4583444,4583276,4583313,4583166,4583370,4592611,4583790,4584246],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1074,"address":[4584452,4585328,4584872,4584395,4592632,4584526,4584283],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1075,"address":[4585365,4585477,4585954,4586410,4592653,4585534,4585608],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1076,"address":[4586559,4586616,4592674,4586447,4587492,4586690,4587036],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1077,"address":[4587529,4588118,4587772,4587641,4588574,4587698,4592695],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1079,"address":[4588723,4588611],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1080,"address":[4588765,4588829,4588682],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1081,"address":[4588871,4588935,4588788],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1082,"address":[4588894,4589041,4588977],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1083,"address":[4589157,4589083,4589000],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1085,"address":[4589268,4589200,4589106,4589333],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1086,"address":[4589376,4589509,4589282,4589444],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1087,"address":[4589620,4589552,4589458,4589685],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1088,"address":[4589796,4589634,4589861,4589728],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1089,"address":[4589972,4589810,4589904,4590017],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1091,"address":[4590052,4589978],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1093,"address":[4590086],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1094,"address":[4590090],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1095,"address":[4590128],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1096,"address":[4590158],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1098,"address":[4590152],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1101,"address":[4590808,4590591,4590685,4590697],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1103,"address":[4590845,4591388,4591045,4591479,4590931,4592737,4591739,4590980],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1104,"address":[4599670,4591775,4591811,4591420],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1106,"address":[4591824,4591872],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1108,"address":[4599796,4591919,4591846],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1111,"address":[4591935],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":421},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","test_scripts","test_oracle.rs"],"content":"use crate::key::{AccountKey, DevNonces};\nuse crate::oracle::SetPriceCall;\nuse crate::runtime::FixedNumber;\nuse crate::test::init_nonce;\nuse crate::test_context::TestContext;\nuse crate::{join_chain_calls, requester::call_chain, TestRuntime};\nuse common::Asset;\nuse futures::{lock::Mutex, try_join};\nuse integration_testing_macro::tuple_to_vec;\nuse sp_keyring::AccountKeyring;\nuse std::{marker::PhantomData, sync::Arc};\nuse substrate_subxt::Client;\n\npub async fn test_oracle(\n    client: \u0026Client\u003cTestRuntime\u003e,\n    nonces: Arc\u003cMutex\u003cDevNonces\u003e\u003e,\n) -\u003e Result\u003c(), Box\u003cdyn std::error::Error\u003e\u003e {\n    println!(\"Start oracle test\");\n    let alice_key = AccountKey::from(AccountKeyring::Alice);\n    init_nonce(client, nonces.clone(), alice_key).await?;\n\n    let btc_price = FixedNumber::from_num(20_000);\n    let eth_price = FixedNumber::from_num(250);\n    let eq_price = FixedNumber::from_num(25);\n    let eos_price = FixedNumber::from_num(3);\n\n    // ---------------------------------- Setting initial prices ----------------------------------\n\n    println!(\"Initial price set\");\n    join_chain_calls!(\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Btc,\n                value: btc_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eth,\n                value: eth_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eq,\n                value: eq_price,\n                _runtime: PhantomData,\n            },\n        ),\n        call_chain(\n            client,\n            nonces.clone(),\n            alice_key,\n            SetPriceCall {\n                asset: Asset::Eos,\n                value: eos_price,\n                _runtime: PhantomData,\n            },\n        ),\n    );\n\n    // ------------------------------------ Storing chain state ------------------------------------\n\n    let initial_state = TestContext::read_storage(client).await?;\n    let curr_btc = initial_state.price_points.get(\u0026Asset::Btc).unwrap();\n    let curr_eth = initial_state.price_points.get(\u0026Asset::Eth).unwrap();\n    let curr_eq = initial_state.price_points.get(\u0026Asset::Eq).unwrap();\n    let curr_eos = initial_state.price_points.get(\u0026Asset::Eos).unwrap();\n\n    assert!(curr_btc == \u0026btc_price);\n    assert!(curr_eth == \u0026eth_price);\n    assert!(curr_eq == \u0026eq_price);\n    assert!(curr_eos == \u0026eos_price);\n\n    // -------------------------------- Iteratively changing prices --------------------------------\n\n    let iterations: i64 = 30;\n\n    for i in 1..=iterations {\n        // price_q slowly increases from ~1 to 1.5\n        let price_q = FixedNumber::from_num(1)\n            + (FixedNumber::from_num(i) / FixedNumber::from_num(iterations * 2));\n\n        println!(\"Setting prices, iteration #{}\", i);\n        join_chain_calls!(\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Btc,\n                    value: btc_price * price_q,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eth,\n                    value: eth_price / price_q,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eq,\n                    value: eq_price * price_q,\n                    _runtime: PhantomData,\n                },\n            ),\n            call_chain(\n                client,\n                nonces.clone(),\n                alice_key,\n                SetPriceCall {\n                    asset: Asset::Eos,\n                    value: eos_price / price_q,\n                    _runtime: PhantomData,\n                },\n            ),\n        );\n\n        let iteration_state = TestContext::read_storage(client).await?;\n        let curr_btc = iteration_state.price_points.get(\u0026Asset::Btc).unwrap();\n        let curr_eth = iteration_state.price_points.get(\u0026Asset::Eth).unwrap();\n        let curr_eq = iteration_state.price_points.get(\u0026Asset::Eq).unwrap();\n        let curr_eos = iteration_state.price_points.get(\u0026Asset::Eos).unwrap();\n\n        assert!(curr_btc == \u0026(btc_price * price_q));\n        assert!(curr_eth == \u0026(eth_price / price_q));\n        assert!(curr_eq == \u0026(eq_price * price_q));\n        assert!(curr_eos == \u0026(eos_price / price_q));\n    }\n\n    // ------------------------------------ Test assertion ------------------------------------\n\n    println!(\"Assertion successful, test passed\");\n\n    Ok(())\n}\n","traces":[{"line":14,"address":[4798640],"length":1,"stats":{"Line":0},"fn_name":"test_oracle"},{"line":18,"address":[5734209],"length":1,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[5734325],"length":1,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[5269111],"length":1,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[5734911,5735208],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[5735231],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[5735310],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[5735389],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[5735460],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[5269197,5269158],"length":1,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[5269254],"length":1,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[5738804,5739001,5739092],"length":1,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[5739103,5739207],"length":1,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[5739218,5739322],"length":1,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[5739437,5739333],"length":1,"stats":{"Line":0},"fn_name":null},{"line":81,"address":[5739581,5739448],"length":1,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[5739530,5739623,5739697],"length":1,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[5739813,5739739,5739646],"length":1,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[5739855,5739916,5739762],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[5739878],"length":1,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[5739889,5739983,5745773,5739967,5740178],"length":1,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[5740439,5740224],"length":1,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[5747850,5740347,5740292,5740255,5740408],"length":1,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[5740714,5740539],"length":1,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[5269334,5269295],"length":1,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[5269416],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[5744834,5744777,5744583],"length":1,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[5744842,5744916],"length":1,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[5744924,5744992],"length":1,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[5745000,5745062],"length":1,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[5745078,5745260,5745207],"length":1,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[5745430,5745377,5745300,5745221],"length":1,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[5745470,5745600,5745391,5745547],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[5745738,5745717,5745640,5745561],"length":1,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[5740136,5745778],"length":1,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[5745804],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":36},{"path":["/","home","rotor","work","src","polka","financial-pallet","integration-testing","src","timestamp.rs"],"content":"use codec::Encode;\nuse core::marker::PhantomData;\nuse frame_support::Parameter;\nuse sp_runtime::traits::{AtLeast32Bit, Member, Scale};\nuse std::fmt::Debug;\nuse substrate_subxt::system::{System, SystemEventsDecoder};\nuse substrate_subxt_proc_macro::{module, Store};\n\n#[module]\npub trait Timestamp: System {\n    type Moment: Parameter\n        + Default\n        + AtLeast32Bit\n        + Member\n        + Scale\u003cSelf::BlockNumber, Output = Self::Moment\u003e\n        + Copy;\n}\n\n#[derive(Clone, Debug, Eq, PartialEq, Store, Encode)]\npub struct NowStore\u003cT: Timestamp\u003e {\n    #[store(returns = T::Moment)]\n    /// Runtime marker.\n    pub _runtime: PhantomData\u003cT\u003e,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","build.rs"],"content":"use substrate_build_script_utils::{generate_cargo_keys, rerun_if_git_head_changed};\n\nfn main() {\n    generate_cargo_keys();\n\n    rerun_if_git_head_changed();\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","chain_spec.rs"],"content":"use common::Asset;\nuse core::time::Duration;\nuse financial_primitives::PricePeriod;\nuse node_template_runtime::{\n    AccountId, AuraConfig, BalancesConfig, FinancialConfig, FixedNumber, GenesisConfig,\n    GrandpaConfig, ManualTimestampConfig, OracleConfig, Signature, SudoConfig, SystemConfig,\n    WASM_BINARY,\n};\nuse sc_service::ChainType;\nuse sp_consensus_aura::sr25519::AuthorityId as AuraId;\nuse sp_core::{sr25519, Pair, Public};\nuse sp_finality_grandpa::AuthorityId as GrandpaId;\nuse sp_runtime::traits::{IdentifyAccount, Verify};\nuse std::convert::TryInto;\nuse std::time::{SystemTime, UNIX_EPOCH};\nuse substrate_fixed::traits::LossyFrom;\n\n// The URL for the telemetry server.\n// const STAGING_TELEMETRY_URL: \u0026str = \"wss://telemetry.polkadot.io/submit/\";\n\n/// Specialized `ChainSpec`. This is a specialization of the general Substrate ChainSpec type.\npub type ChainSpec = sc_service::GenericChainSpec\u003cGenesisConfig\u003e;\n\n/// Generate a crypto pair from seed.\npub fn get_from_seed\u003cTPublic: Public\u003e(seed: \u0026str) -\u003e \u003cTPublic::Pair as Pair\u003e::Public {\n    TPublic::Pair::from_string(\u0026format!(\"//{}\", seed), None)\n        .expect(\"static values are valid; qed\")\n        .public()\n}\n\ntype AccountPublic = \u003cSignature as Verify\u003e::Signer;\n\n/// Generate an account ID from seed.\npub fn get_account_id_from_seed\u003cTPublic: Public\u003e(seed: \u0026str) -\u003e AccountId\nwhere\n    AccountPublic: From\u003c\u003cTPublic::Pair as Pair\u003e::Public\u003e,\n{\n    AccountPublic::from(get_from_seed::\u003cTPublic\u003e(seed)).into_account()\n}\n\n/// Generate an Aura authority key.\npub fn authority_keys_from_seed(s: \u0026str) -\u003e (AuraId, GrandpaId) {\n    (get_from_seed::\u003cAuraId\u003e(s), get_from_seed::\u003cGrandpaId\u003e(s))\n}\n\npub fn development_config() -\u003e Result\u003cChainSpec, String\u003e {\n    let wasm_binary = WASM_BINARY.ok_or(\"Development wasm binary not available\".to_string())?;\n\n    Ok(ChainSpec::from_genesis(\n        // Name\n        \"Development\",\n        // ID\n        \"dev\",\n        ChainType::Development,\n        move || {\n            testnet_genesis(\n                wasm_binary,\n                // Initial PoA authorities\n                vec![authority_keys_from_seed(\"Alice\")],\n                // Sudo account\n                get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice\"),\n                // Pre-funded accounts\n                vec![\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Bob\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Bob//stash\"),\n                ],\n                true,\n                vec![\n                    // (Asset::Usd, 1),\n                    // (Asset::Eq, 25),\n                    // (Asset::Eth, 250),\n                    // (Asset::Btc, 10_000),\n                    // (Asset::Eos, 3),\n                ], // .into_iter()\n                   // .map(|(a, x)| (a, FixedNumber::lossy_from(x)))\n                   // .collect()\n            )\n        },\n        // Bootnodes\n        vec![],\n        // Telemetry\n        None,\n        // Protocol ID\n        None,\n        // Properties\n        None,\n        // Extensions\n        None,\n    ))\n}\n\npub fn local_testnet_config() -\u003e Result\u003cChainSpec, String\u003e {\n    let wasm_binary = WASM_BINARY.ok_or(\"Development wasm binary not available\".to_string())?;\n\n    Ok(ChainSpec::from_genesis(\n        // Name\n        \"Local Testnet\",\n        // ID\n        \"local_testnet\",\n        ChainType::Local,\n        move || {\n            testnet_genesis(\n                wasm_binary,\n                // Initial PoA authorities\n                vec![\n                    authority_keys_from_seed(\"Alice\"),\n                    authority_keys_from_seed(\"Bob\"),\n                ],\n                // Sudo account\n                get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice\"),\n                // Pre-funded accounts\n                vec![\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Bob\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Charlie\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Dave\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Eve\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Ferdie\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Alice//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Bob//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Charlie//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Dave//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Eve//stash\"),\n                    get_account_id_from_seed::\u003csr25519::Public\u003e(\"Ferdie//stash\"),\n                ],\n                true,\n                vec![\n                    (Asset::Usd, 1),\n                    (Asset::Eq, 25),\n                    (Asset::Eth, 250),\n                    (Asset::Btc, 10_000),\n                    (Asset::Eos, 3),\n                ]\n                .into_iter()\n                .map(|(a, x)| (a, FixedNumber::lossy_from(x)))\n                .collect(),\n            )\n        },\n        // Bootnodes\n        vec![],\n        // Telemetry\n        None,\n        // Protocol ID\n        None,\n        // Properties\n        None,\n        // Extensions\n        None,\n    ))\n}\n\nfn get_prev_period_start(now: Duration, price_period: u32) -\u003e Duration {\n    let price_period = PricePeriod(price_period);\n    let now_period_id = price_period\n        .get_period_id(now)\n        .expect(\"Unable to get current period id\");\n    let prev_period_id = now_period_id\n        .checked_sub(1)\n        .expect(\"Unable to get previous period id\");\n    let prev_period_start = price_period\n        .get_period_id_start(prev_period_id)\n        .expect(\"Unable to get previous period Unix timestamp\");\n\n    prev_period_start\n}\n\n/// Configure initial storage state for FRAME modules.\nfn testnet_genesis(\n    wasm_binary: \u0026[u8],\n    initial_authorities: Vec\u003c(AuraId, GrandpaId)\u003e,\n    root_key: AccountId,\n    endowed_accounts: Vec\u003cAccountId\u003e,\n    _enable_println: bool,\n    prices: Vec\u003c(Asset, FixedNumber)\u003e,\n) -\u003e GenesisConfig {\n    let now = SystemTime::now()\n        .duration_since(UNIX_EPOCH)\n        .expect(\"Unable to get current Unix timestamp\");\n    let prev_period_start = get_prev_period_start(now, node_template_runtime::PricePeriod::get());\n    GenesisConfig {\n        frame_system: Some(SystemConfig {\n            // Add Wasm runtime to storage.\n            code: wasm_binary.to_vec(),\n            changes_trie_config: Default::default(),\n        }),\n        pallet_balances: Some(BalancesConfig {\n            // Configure endowed accounts with initial balance of 1 \u003c\u003c 60.\n            balances: endowed_accounts\n                .iter()\n                .cloned()\n                .map(|k| (k, 1 \u003c\u003c 60))\n                .collect(),\n        }),\n        pallet_aura: Some(AuraConfig {\n            authorities: initial_authorities.iter().map(|x| (x.0.clone())).collect(),\n        }),\n        pallet_grandpa: Some(GrandpaConfig {\n            authorities: initial_authorities\n                .iter()\n                .map(|x| (x.1.clone(), 1))\n                .collect(),\n        }),\n        pallet_sudo: Some(SudoConfig {\n            // Assign network admin rights.\n            key: root_key,\n        }),\n        oracle: Some(OracleConfig {\n            prices: prices.iter().cloned().collect(),\n        }),\n        financial_pallet: Some(FinancialConfig {\n            prices: prices\n                .iter()\n                .cloned()\n                .map(|(a, p)| (a, vec![p], prev_period_start))\n                .collect(),\n        }),\n        manual_timestamp: Some(ManualTimestampConfig {\n            timestamp: now.as_millis().try_into().expect(\"Too much milliseconds\"),\n        }),\n    }\n}\n","traces":[{"line":25,"address":[18143862,18143264,18143366,18143760,18144256,18144358],"length":1,"stats":{"Line":0},"fn_name":"get_from_seed\u003csp_finality_grandpa::app::Public\u003e"},{"line":26,"address":[18144378,18144283,18143291,18143607,18143882,18144599,18143386,18143787,18144103],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[18144768],"length":1,"stats":{"Line":0},"fn_name":"get_account_id_from_seed\u003csp_core::sr25519::Public\u003e"},{"line":38,"address":[18144785],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[17078256],"length":1,"stats":{"Line":0},"fn_name":"authority_keys_from_seed"},{"line":43,"address":[17078273],"length":1,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[17078416,17078477],"length":1,"stats":{"Line":0},"fn_name":"development_config"},{"line":47,"address":[17078766,17078433,17078492,17078653],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[17078819,17078986],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[17078598],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[17078618],"length":1,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[18145348],"length":1,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[18144866],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[18145457,18144975,18144905],"length":1,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[18145032],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[18145069,18145190,18145510],"length":1,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[18145082],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[18145109],"length":1,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[18145136],"length":1,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[18145163],"length":1,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[18145329],"length":1,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[17078634],"length":1,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[17078775],"length":1,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[17078787],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[17078799],"length":1,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[17078811],"length":1,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[17079181,17079120],"length":1,"stats":{"Line":0},"fn_name":"local_testnet_config"},{"line":95,"address":[17079357,17079137,17079470,17079196],"length":1,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[17079523,17079690],"length":1,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[17079302],"length":1,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[17079322],"length":1,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[18147103],"length":1,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[18145746],"length":1,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[18145882,18147212,18145785],"length":1,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[18145816],"length":1,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[18145855],"length":1,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[18145990],"length":1,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[18146027,18147265,18146364],"length":1,"stats":{"Line":0},"fn_name":null},{"line":115,"address":[18146040],"length":1,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[18146067],"length":1,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[18146094],"length":1,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[18146121],"length":1,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[18146148],"length":1,"stats":{"Line":0},"fn_name":null},{"line":120,"address":[18146175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[18146202],"length":1,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[18146229],"length":1,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[18146256],"length":1,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[18146283],"length":1,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[18146310],"length":1,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[18146337],"length":1,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[18146753,18146893,18147050],"length":1,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[18146758],"length":1,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[18146785],"length":1,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[18146812],"length":1,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[18146839],"length":1,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[18146866],"length":1,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[18145632,18145650],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":142,"address":[17079338],"length":1,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[17079479],"length":1,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[17079491],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[17079503],"length":1,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[17079515],"length":1,"stats":{"Line":0},"fn_name":null},{"line":154,"address":[17079824],"length":1,"stats":{"Line":0},"fn_name":"get_prev_period_start"},{"line":155,"address":[17079853],"length":1,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[17079857],"length":1,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[17079947],"length":1,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[17080031],"length":1,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[17080128,17080274],"length":1,"stats":{"Line":0},"fn_name":"testnet_genesis"},{"line":178,"address":[17080297,17080429,17080183],"length":1,"stats":{"Line":0},"fn_name":null},{"line":181,"address":[17080512],"length":1,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[17080708],"length":1,"stats":{"Line":0},"fn_name":null},{"line":188,"address":[17081035],"length":1,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[17081258],"length":1,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[17081481],"length":1,"stats":{"Line":0},"fn_name":null},{"line":205,"address":[17081576],"length":1,"stats":{"Line":0},"fn_name":null},{"line":209,"address":[17081785],"length":1,"stats":{"Line":0},"fn_name":null},{"line":212,"address":[17082027],"length":1,"stats":{"Line":0},"fn_name":null},{"line":219,"address":[17082214],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":78},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","cli.rs"],"content":"use sc_cli::{RunCmd, Subcommand};\nuse structopt::StructOpt;\n\n#[derive(Debug, StructOpt)]\npub struct Cli {\n    #[structopt(subcommand)]\n    pub subcommand: Option\u003cSubcommand\u003e,\n\n    #[structopt(flatten)]\n    pub run: RunCmd,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","command.rs"],"content":"// This file is part of Substrate.\n\n// Copyright (C) 2017-2020 Parity Technologies (UK) Ltd.\n// SPDX-License-Identifier: Apache-2.0\n\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// \thttp://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nuse crate::chain_spec;\nuse crate::cli::Cli;\nuse crate::service;\nuse crate::service::new_partial;\nuse sc_cli::{ChainSpec, Role, RuntimeVersion, SubstrateCli};\nuse sc_service::PartialComponents;\n\nimpl SubstrateCli for Cli {\n    fn impl_name() -\u003e String {\n        \"Substrate Node\".into()\n    }\n\n    fn impl_version() -\u003e String {\n        env!(\"SUBSTRATE_CLI_IMPL_VERSION\").into()\n    }\n\n    fn description() -\u003e String {\n        env!(\"CARGO_PKG_DESCRIPTION\").into()\n    }\n\n    fn author() -\u003e String {\n        env!(\"CARGO_PKG_AUTHORS\").into()\n    }\n\n    fn support_url() -\u003e String {\n        \"support.anonymous.an\".into()\n    }\n\n    fn copyright_start_year() -\u003e i32 {\n        2017\n    }\n\n    fn load_spec(\u0026self, id: \u0026str) -\u003e Result\u003cBox\u003cdyn sc_service::ChainSpec\u003e, String\u003e {\n        Ok(match id {\n            \"dev\" =\u003e Box::new(chain_spec::development_config()?),\n            \"\" | \"local\" =\u003e Box::new(chain_spec::local_testnet_config()?),\n            path =\u003e Box::new(chain_spec::ChainSpec::from_json_file(\n                std::path::PathBuf::from(path),\n            )?),\n        })\n    }\n\n    fn native_runtime_version(_: \u0026Box\u003cdyn ChainSpec\u003e) -\u003e \u0026'static RuntimeVersion {\n        \u0026node_template_runtime::VERSION\n    }\n}\n\n/// Parse and run command line arguments\npub fn run() -\u003e sc_cli::Result\u003c()\u003e {\n    let cli = Cli::from_args();\n\n    match cli.subcommand {\n        Some(ref subcommand) =\u003e {\n            let runner = cli.create_runner(subcommand)?;\n            runner.run_subcommand(subcommand, |config| {\n                let PartialComponents {\n                    client,\n                    backend,\n                    task_manager,\n                    import_queue,\n                    ..\n                } = new_partial(\u0026config)?;\n                Ok((client, backend, import_queue, task_manager))\n            })\n        }\n        None =\u003e {\n            let runner = cli.create_runner(\u0026cli.run)?;\n            runner.run_node_until_exit(|config| match config.role {\n                Role::Light =\u003e service::new_light(config),\n                _ =\u003e service::new_full(config),\n            })\n        }\n    }\n}\n","traces":[{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[12950059],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[12950096],"length":1,"stats":{"Line":0},"fn_name":"impl_version"},{"line":31,"address":[12950107],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[12950144],"length":1,"stats":{"Line":0},"fn_name":"description"},{"line":35,"address":[12950155],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[4828210,4828144],"length":1,"stats":{"Line":0},"fn_name":"run"},{"line":67,"address":[4828160],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[4828285,4828874],"length":1,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[4828295,4828225],"length":1,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[4828311,4828630,4828797,4828845,4828373],"length":1,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[4828526],"length":1,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[16079055],"length":1,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[16079071],"length":1,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[16079087],"length":1,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[16079123],"length":1,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[16078842,16078922,16079757,16079187,16078899,16079369],"length":1,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[16079441],"length":1,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[4828251,4829106,4829267,4828895],"length":1,"stats":{"Line":0},"fn_name":null},{"line":85,"address":[4829031],"length":1,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[16080150,16080074],"length":1,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[16080096],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":36},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","lib.rs"],"content":"pub mod chain_spec;\npub mod rpc;\npub mod service;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","main.rs"],"content":"//! Substrate Node Template CLI library.\n#![warn(missing_docs)]\n\nmod chain_spec;\n#[macro_use]\nmod service;\nmod cli;\nmod command;\nmod rpc;\n\nfn main() -\u003e sc_cli::Result\u003c()\u003e {\n    command::run()\n}\n","traces":[{"line":11,"address":[18340432],"length":1,"stats":{"Line":0},"fn_name":"main"},{"line":12,"address":[18340440],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":2},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","rpc.rs"],"content":"//! A collection of node-specific RPC methods.\n//! Substrate provides the `sc-rpc` crate, which defines the core RPC layer\n//! used by Substrate nodes. This file extends those RPC definitions with\n//! capabilities that are specific to this project's runtime configuration.\n\n#![warn(missing_docs)]\n\nuse std::sync::Arc;\n\nuse node_template_runtime::{opaque::Block, AccountId, Balance, Index};\npub use sc_rpc_api::DenyUnsafe;\nuse sp_api::ProvideRuntimeApi;\nuse sp_block_builder::BlockBuilder;\nuse sp_blockchain::{Error as BlockChainError, HeaderBackend, HeaderMetadata};\nuse sp_transaction_pool::TransactionPool;\n\n/// Full client dependencies.\npub struct FullDeps\u003cC, P\u003e {\n    /// The client instance to use.\n    pub client: Arc\u003cC\u003e,\n    /// Transaction pool instance.\n    pub pool: Arc\u003cP\u003e,\n    /// Whether to deny unsafe calls\n    pub deny_unsafe: DenyUnsafe,\n}\n\n/// Instantiate all full RPC extensions.\npub fn create_full\u003cC, P\u003e(deps: FullDeps\u003cC, P\u003e) -\u003e jsonrpc_core::IoHandler\u003csc_rpc::Metadata\u003e\nwhere\n    C: ProvideRuntimeApi\u003cBlock\u003e,\n    C: HeaderBackend\u003cBlock\u003e + HeaderMetadata\u003cBlock, Error = BlockChainError\u003e + 'static,\n    C: Send + Sync + 'static,\n    C::Api: substrate_frame_rpc_system::AccountNonceApi\u003cBlock, AccountId, Index\u003e,\n    C::Api: pallet_transaction_payment_rpc::TransactionPaymentRuntimeApi\u003cBlock, Balance\u003e,\n    C::Api: BlockBuilder\u003cBlock\u003e,\n    P: TransactionPool + 'static,\n{\n    use pallet_transaction_payment_rpc::{TransactionPayment, TransactionPaymentApi};\n    use substrate_frame_rpc_system::{FullSystem, SystemApi};\n\n    let mut io = jsonrpc_core::IoHandler::default();\n    let FullDeps {\n        client,\n        pool,\n        deny_unsafe,\n    } = deps;\n\n    io.extend_with(SystemApi::to_delegate(FullSystem::new(\n        client.clone(),\n        pool,\n        deny_unsafe,\n    )));\n\n    io.extend_with(TransactionPaymentApi::to_delegate(TransactionPayment::new(\n        client.clone(),\n    )));\n\n    // Extend this RPC with a custom API by using the following syntax.\n    // `YourRpcStruct` should have a reference to a client, which is needed\n    // to call into the runtime.\n    // `io.extend_with(YourRpcTrait::to_delegate(YourRpcStruct::new(ReferenceToClient, ...)));`\n\n    io\n}\n","traces":[{"line":28,"address":[25290273,25289840],"length":1,"stats":{"Line":0},"fn_name":"create_full\u003csc_service::client::client::Client\u003csc_client_db::Backend\u003csp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e, sc_service::client::call_executor::LocalCallExecutor\u003csc_client_db::Backend\u003csp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e, sc_executor::native_executor::NativeExecutor\u003cnode_template::service::Executor\u003e\u003e, sp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e, node_template_runtime::RuntimeApi\u003e,sc_transaction_pool::BasicPool\u003csc_transaction_pool::api::FullChainApi\u003csc_service::client::client::Client\u003csc_client_db::Backend\u003csp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e, sc_service::client::call_executor::LocalCallExecutor\u003csc_client_db::Backend\u003csp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e, sc_executor::native_executor::NativeExecutor\u003cnode_template::service::Executor\u003e\u003e, sp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e, node_template_runtime::RuntimeApi\u003e, sp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e, sp_runtime::generic::block::Block\u003csp_runtime::generic::header::Header\u003cu32, sp_runtime::traits::BlakeTwo256\u003e, sp_runtime::OpaqueExtrinsic\u003e\u003e\u003e"},{"line":41,"address":[25289850],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[25289920],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[25289949],"length":1,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[25289974],"length":1,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[25289993,25290070],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[25290010],"length":1,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[25290053],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[25290172,25290138],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[25290155],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[25290224],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":11},{"path":["/","home","rotor","work","src","polka","financial-pallet","node","src","service.rs"],"content":"//! Service and ServiceFactory implementation. Specialized wrapper over substrate service.\n\nuse node_template_runtime::{self, opaque::Block, RuntimeApi};\nuse sc_client_api::{ExecutorProvider, RemoteBackend};\nuse sc_executor::native_executor_instance;\npub use sc_executor::NativeExecutor;\nuse sc_finality_grandpa::{\n    FinalityProofProvider as GrandpaFinalityProofProvider, SharedVoterState,\n};\nuse sc_service::{error::Error as ServiceError, Configuration, TaskManager};\nuse sp_consensus_aura::sr25519::AuthorityPair as AuraPair;\nuse sp_inherents::InherentDataProviders;\nuse std::sync::Arc;\nuse std::time::Duration;\n\n// Our native executor instance.\nnative_executor_instance!(\n    pub Executor,\n    node_template_runtime::api::dispatch,\n    node_template_runtime::native_version,\n);\n\ntype FullClient = sc_service::TFullClient\u003cBlock, RuntimeApi, Executor\u003e;\ntype FullBackend = sc_service::TFullBackend\u003cBlock\u003e;\ntype FullSelectChain = sc_consensus::LongestChain\u003cFullBackend, Block\u003e;\n\npub fn new_partial(\n    config: \u0026Configuration,\n) -\u003e Result\u003c\n    sc_service::PartialComponents\u003c\n        FullClient,\n        FullBackend,\n        FullSelectChain,\n        sp_consensus::DefaultImportQueue\u003cBlock, FullClient\u003e,\n        sc_transaction_pool::FullPool\u003cBlock, FullClient\u003e,\n        (\n            sc_consensus_aura::AuraBlockImport\u003c\n                Block,\n                FullClient,\n                sc_finality_grandpa::GrandpaBlockImport\u003c\n                    FullBackend,\n                    Block,\n                    FullClient,\n                    FullSelectChain,\n                \u003e,\n                AuraPair,\n            \u003e,\n            sc_finality_grandpa::LinkHalf\u003cBlock, FullClient, FullSelectChain\u003e,\n        ),\n    \u003e,\n    ServiceError,\n\u003e {\n    let inherent_data_providers = sp_inherents::InherentDataProviders::new();\n\n    let (client, backend, keystore, task_manager) =\n        sc_service::new_full_parts::\u003cBlock, RuntimeApi, Executor\u003e(\u0026config)?;\n    let client = Arc::new(client);\n\n    let select_chain = sc_consensus::LongestChain::new(backend.clone());\n\n    let transaction_pool = sc_transaction_pool::BasicPool::new_full(\n        config.transaction_pool.clone(),\n        config.prometheus_registry(),\n        task_manager.spawn_handle(),\n        client.clone(),\n    );\n\n    let (grandpa_block_import, grandpa_link) = sc_finality_grandpa::block_import(\n        client.clone(),\n        \u0026(client.clone() as Arc\u003c_\u003e),\n        select_chain.clone(),\n    )?;\n\n    let aura_block_import = sc_consensus_aura::AuraBlockImport::\u003c_, _, _, AuraPair\u003e::new(\n        grandpa_block_import.clone(),\n        client.clone(),\n    );\n\n    let import_queue = sc_consensus_aura::import_queue::\u003c_, _, _, AuraPair, _, _\u003e(\n        sc_consensus_aura::slot_duration(\u0026*client)?,\n        aura_block_import.clone(),\n        Some(Box::new(grandpa_block_import.clone())),\n        None,\n        client.clone(),\n        inherent_data_providers.clone(),\n        \u0026task_manager.spawn_handle(),\n        config.prometheus_registry(),\n        sp_consensus::CanAuthorWithNativeVersion::new(client.executor().clone()),\n    )?;\n\n    Ok(sc_service::PartialComponents {\n        client,\n        backend,\n        task_manager,\n        import_queue,\n        keystore,\n        select_chain,\n        transaction_pool,\n        inherent_data_providers,\n        other: (aura_block_import, grandpa_link),\n    })\n}\n\n/// Builds a new service for a full client.\npub fn new_full(config: Configuration) -\u003e Result\u003cTaskManager, ServiceError\u003e {\n    let sc_service::PartialComponents {\n        client,\n        backend,\n        mut task_manager,\n        import_queue,\n        keystore,\n        select_chain,\n        transaction_pool,\n        inherent_data_providers,\n        other: (block_import, grandpa_link),\n    } = new_partial(\u0026config)?;\n\n    let finality_proof_provider =\n        GrandpaFinalityProofProvider::new_for_service(backend.clone(), client.clone());\n\n    let (network, network_status_sinks, system_rpc_tx, network_starter) =\n        sc_service::build_network(sc_service::BuildNetworkParams {\n            config: \u0026config,\n            client: client.clone(),\n            transaction_pool: transaction_pool.clone(),\n            spawn_handle: task_manager.spawn_handle(),\n            import_queue,\n            on_demand: None,\n            block_announce_validator_builder: None,\n            finality_proof_request_builder: None,\n            finality_proof_provider: Some(finality_proof_provider.clone()),\n        })?;\n\n    if config.offchain_worker.enabled {\n        sc_service::build_offchain_workers(\n            \u0026config,\n            backend.clone(),\n            task_manager.spawn_handle(),\n            client.clone(),\n            network.clone(),\n        );\n    }\n\n    let role = config.role.clone();\n    let force_authoring = config.force_authoring;\n    let name = config.network.node_name.clone();\n    let enable_grandpa = !config.disable_grandpa;\n    let prometheus_registry = config.prometheus_registry().cloned();\n    let telemetry_connection_sinks = sc_service::TelemetryConnectionSinks::default();\n\n    let rpc_extensions_builder = {\n        let client = client.clone();\n        let pool = transaction_pool.clone();\n\n        Box::new(move |deny_unsafe, _| {\n            let deps = crate::rpc::FullDeps {\n                client: client.clone(),\n                pool: pool.clone(),\n                deny_unsafe,\n            };\n\n            crate::rpc::create_full(deps)\n        })\n    };\n\n    sc_service::spawn_tasks(sc_service::SpawnTasksParams {\n        network: network.clone(),\n        client: client.clone(),\n        keystore: keystore.clone(),\n        task_manager: \u0026mut task_manager,\n        transaction_pool: transaction_pool.clone(),\n        telemetry_connection_sinks: telemetry_connection_sinks.clone(),\n        rpc_extensions_builder: rpc_extensions_builder,\n        on_demand: None,\n        remote_blockchain: None,\n        backend,\n        network_status_sinks,\n        system_rpc_tx,\n        config,\n    })?;\n\n    if role.is_authority() {\n        let proposer = sc_basic_authorship::ProposerFactory::new(\n            client.clone(),\n            transaction_pool,\n            prometheus_registry.as_ref(),\n        );\n\n        let can_author_with =\n            sp_consensus::CanAuthorWithNativeVersion::new(client.executor().clone());\n\n        let aura = sc_consensus_aura::start_aura::\u003c_, _, _, _, _, AuraPair, _, _, _\u003e(\n            sc_consensus_aura::slot_duration(\u0026*client)?,\n            client.clone(),\n            select_chain,\n            block_import,\n            proposer,\n            network.clone(),\n            inherent_data_providers.clone(),\n            force_authoring,\n            keystore.clone(),\n            can_author_with,\n        )?;\n\n        // the AURA authoring task is considered essential, i.e. if it\n        // fails we take down the service with it.\n        task_manager\n            .spawn_essential_handle()\n            .spawn_blocking(\"aura\", aura);\n    }\n\n    // if the node isn't actively participating in consensus then it doesn't\n    // need a keystore, regardless of which protocol we use below.\n    let keystore = if role.is_authority() {\n        Some(keystore as sp_core::traits::BareCryptoStorePtr)\n    } else {\n        None\n    };\n\n    let grandpa_config = sc_finality_grandpa::Config {\n        // FIXME #1578 make this available through chainspec\n        gossip_duration: Duration::from_millis(333),\n        justification_period: 512,\n        name: Some(name),\n        observer_enabled: false,\n        keystore,\n        is_authority: role.is_network_authority(),\n    };\n\n    if enable_grandpa {\n        // start the full GRANDPA voter\n        // NOTE: non-authorities could run the GRANDPA observer protocol, but at\n        // this point the full voter should provide better guarantees of block\n        // and vote data availability than the observer. The observer has not\n        // been tested extensively yet and having most nodes in a network run it\n        // could lead to finality stalls.\n        let grandpa_config = sc_finality_grandpa::GrandpaParams {\n            config: grandpa_config,\n            link: grandpa_link,\n            network,\n            inherent_data_providers,\n            telemetry_on_connect: Some(telemetry_connection_sinks.on_connect_stream()),\n            voting_rule: sc_finality_grandpa::VotingRulesBuilder::default().build(),\n            prometheus_registry,\n            shared_voter_state: SharedVoterState::empty(),\n        };\n\n        // the GRANDPA voter task is considered infallible, i.e.\n        // if it fails we take down the service with it.\n        task_manager.spawn_essential_handle().spawn_blocking(\n            \"grandpa-voter\",\n            sc_finality_grandpa::run_grandpa_voter(grandpa_config)?,\n        );\n    } else {\n        sc_finality_grandpa::setup_disabled_grandpa(client, \u0026inherent_data_providers, network)?;\n    }\n\n    network_starter.start_network();\n    Ok(task_manager)\n}\n\n/// Builds a new service for a light client.\npub fn new_light(config: Configuration) -\u003e Result\u003cTaskManager, ServiceError\u003e {\n    let (client, backend, keystore, mut task_manager, on_demand) =\n        sc_service::new_light_parts::\u003cBlock, RuntimeApi, Executor\u003e(\u0026config)?;\n\n    let transaction_pool = Arc::new(sc_transaction_pool::BasicPool::new_light(\n        config.transaction_pool.clone(),\n        config.prometheus_registry(),\n        task_manager.spawn_handle(),\n        client.clone(),\n        on_demand.clone(),\n    ));\n\n    let grandpa_block_import = sc_finality_grandpa::light_block_import(\n        client.clone(),\n        backend.clone(),\n        \u0026(client.clone() as Arc\u003c_\u003e),\n        Arc::new(on_demand.checker().clone()) as Arc\u003c_\u003e,\n    )?;\n    let finality_proof_import = grandpa_block_import.clone();\n    let finality_proof_request_builder =\n        finality_proof_import.create_finality_proof_request_builder();\n\n    let import_queue = sc_consensus_aura::import_queue::\u003c_, _, _, AuraPair, _, _\u003e(\n        sc_consensus_aura::slot_duration(\u0026*client)?,\n        grandpa_block_import,\n        None,\n        Some(Box::new(finality_proof_import)),\n        client.clone(),\n        InherentDataProviders::new(),\n        \u0026task_manager.spawn_handle(),\n        config.prometheus_registry(),\n        sp_consensus::NeverCanAuthor,\n    )?;\n\n    let finality_proof_provider =\n        GrandpaFinalityProofProvider::new_for_service(backend.clone(), client.clone());\n\n    let (network, network_status_sinks, system_rpc_tx, network_starter) =\n        sc_service::build_network(sc_service::BuildNetworkParams {\n            config: \u0026config,\n            client: client.clone(),\n            transaction_pool: transaction_pool.clone(),\n            spawn_handle: task_manager.spawn_handle(),\n            import_queue,\n            on_demand: Some(on_demand.clone()),\n            block_announce_validator_builder: None,\n            finality_proof_request_builder: Some(finality_proof_request_builder),\n            finality_proof_provider: Some(finality_proof_provider),\n        })?;\n\n    if config.offchain_worker.enabled {\n        sc_service::build_offchain_workers(\n            \u0026config,\n            backend.clone(),\n            task_manager.spawn_handle(),\n            client.clone(),\n            network.clone(),\n        );\n    }\n\n    sc_service::spawn_tasks(sc_service::SpawnTasksParams {\n        remote_blockchain: Some(backend.remote_blockchain()),\n        transaction_pool,\n        task_manager: \u0026mut task_manager,\n        on_demand: Some(on_demand),\n        rpc_extensions_builder: Box::new(|_, _| ()),\n        telemetry_connection_sinks: sc_service::TelemetryConnectionSinks::default(),\n        config,\n        client,\n        keystore,\n        backend,\n        network,\n        network_status_sinks,\n        system_rpc_tx,\n    })?;\n\n    network_starter.start_network();\n\n    Ok(task_manager)\n}\n","traces":[{"line":27,"address":[16502240,16502048],"length":1,"stats":{"Line":0},"fn_name":"new_partial"},{"line":53,"address":[16502072],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[16502449],"length":1,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[16502611,16503011],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[16503035],"length":1,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[16503097],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[16503127],"length":1,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[16503154],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[16503197],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[16503307],"length":1,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[16503354],"length":1,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[16503424],"length":1,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[16504367],"length":1,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[16504390],"length":1,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[16504460,16504834,16504558,16504608,16504532],"length":1,"stats":{"Line":0},"fn_name":null},{"line":81,"address":[16504839,16504598],"length":1,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[16504968,16504863],"length":1,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[16505007],"length":1,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[16505035,16505084],"length":1,"stats":{"Line":0},"fn_name":null},{"line":85,"address":[16505154,16505108],"length":1,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[16505170],"length":1,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[16505220],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[16505279,16505385],"length":1,"stats":{"Line":0},"fn_name":null},{"line":91,"address":[16506748],"length":1,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[16506074],"length":1,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[16506090],"length":1,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[16506106],"length":1,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[16506196],"length":1,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[16506260],"length":1,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[16506276],"length":1,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[16506292],"length":1,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[16506308],"length":1,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[16506324],"length":1,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[16508208,16508571],"length":1,"stats":{"Line":0},"fn_name":"new_full"},{"line":106,"address":[16509266,16508225,16508602,16509455],"length":1,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[16508745],"length":1,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[16508769],"length":1,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[16508793],"length":1,"stats":{"Line":0},"fn_name":null},{"line":110,"address":[16508840],"length":1,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[16508912],"length":1,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[16508936],"length":1,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[16508960],"length":1,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[16508984],"length":1,"stats":{"Line":0},"fn_name":null},{"line":115,"address":[16509008],"length":1,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[16518264,16509638,16509248],"length":1,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[16510535,16510784,16510503,16510073],"length":1,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[16509755],"length":1,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[16509835,16509794],"length":1,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[16509843],"length":1,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[16509885],"length":1,"stats":{"Line":0},"fn_name":null},{"line":128,"address":[16509957],"length":1,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[16509969],"length":1,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[16509981],"length":1,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[16510042,16510001],"length":1,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[16510766,16511562,16511271],"length":1,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[16511284],"length":1,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[16511323],"length":1,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[16511366],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[16511413],"length":1,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[16511572],"length":1,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[16511602],"length":1,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[16511615],"length":1,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[16511666],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[16511738,16511682],"length":1,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[16511777],"length":1,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[16511816],"length":1,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[16511863,16511905],"length":1,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[16512073,16511913],"length":1,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[19910210],"length":1,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[19910115,19910169],"length":1,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[19910179],"length":1,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[19910241],"length":1,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[16512914,16512564,16512943,16512989],"length":1,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[16512105],"length":1,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[16512186,16512144],"length":1,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[16512240,16512202],"length":1,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[16512256,16512294],"length":1,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[16512310],"length":1,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[16512340],"length":1,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[16512356],"length":1,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[16512368],"length":1,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[16512380],"length":1,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[16512396],"length":1,"stats":{"Line":0},"fn_name":null},{"line":178,"address":[16512412],"length":1,"stats":{"Line":0},"fn_name":null},{"line":179,"address":[16512452],"length":1,"stats":{"Line":0},"fn_name":null},{"line":182,"address":[16513338],"length":1,"stats":{"Line":0},"fn_name":null},{"line":184,"address":[16513390],"length":1,"stats":{"Line":0},"fn_name":null},{"line":185,"address":[16513429],"length":1,"stats":{"Line":0},"fn_name":null},{"line":186,"address":[16513469],"length":1,"stats":{"Line":0},"fn_name":null},{"line":189,"address":[16513590],"length":1,"stats":{"Line":0},"fn_name":null},{"line":193,"address":[16514056,16513690,16513823,16513773],"length":1,"stats":{"Line":0},"fn_name":null},{"line":194,"address":[16513805,16514069],"length":1,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[16514085],"length":1,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[16514117],"length":1,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[16514261],"length":1,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[16514317],"length":1,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[16514438,16514364],"length":1,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[16514462],"length":1,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[16514477],"length":1,"stats":{"Line":0},"fn_name":null},{"line":207,"address":[16514921,16515211],"length":1,"stats":{"Line":0},"fn_name":null},{"line":209,"address":[16515254,16515162],"length":1,"stats":{"Line":0},"fn_name":null},{"line":214,"address":[16515375,16515316],"length":1,"stats":{"Line":0},"fn_name":null},{"line":215,"address":[16515384],"length":1,"stats":{"Line":0},"fn_name":null},{"line":217,"address":[16515355],"length":1,"stats":{"Line":0},"fn_name":null},{"line":222,"address":[16515429],"length":1,"stats":{"Line":0},"fn_name":null},{"line":224,"address":[16515466],"length":1,"stats":{"Line":0},"fn_name":null},{"line":227,"address":[16515578],"length":1,"stats":{"Line":0},"fn_name":null},{"line":230,"address":[16515799,16517296,16517240],"length":1,"stats":{"Line":0},"fn_name":null},{"line":242,"address":[16516091],"length":1,"stats":{"Line":0},"fn_name":null},{"line":243,"address":[16516253,16516158],"length":1,"stats":{"Line":0},"fn_name":null},{"line":245,"address":[16516308],"length":1,"stats":{"Line":0},"fn_name":null},{"line":250,"address":[16516935,16516606],"length":1,"stats":{"Line":0},"fn_name":null},{"line":252,"address":[16516790,16516767,16516981,16516812,16516652],"length":1,"stats":{"Line":0},"fn_name":null},{"line":255,"address":[16517301,16517261,16515825],"length":1,"stats":{"Line":0},"fn_name":null},{"line":258,"address":[16517452],"length":1,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[16517479],"length":1,"stats":{"Line":0},"fn_name":null},{"line":263,"address":[16520816,16521091],"length":1,"stats":{"Line":0},"fn_name":"new_light"},{"line":264,"address":[16520833,16521441,16521630,16521122],"length":1,"stats":{"Line":0},"fn_name":null},{"line":267,"address":[16521952,16521857],"length":1,"stats":{"Line":0},"fn_name":null},{"line":268,"address":[16521408],"length":1,"stats":{"Line":0},"fn_name":null},{"line":269,"address":[16521725],"length":1,"stats":{"Line":0},"fn_name":null},{"line":270,"address":[16521752],"length":1,"stats":{"Line":0},"fn_name":null},{"line":271,"address":[16521795],"length":1,"stats":{"Line":0},"fn_name":null},{"line":272,"address":[16521842],"length":1,"stats":{"Line":0},"fn_name":null},{"line":276,"address":[16521999],"length":1,"stats":{"Line":0},"fn_name":null},{"line":277,"address":[16522038],"length":1,"stats":{"Line":0},"fn_name":null},{"line":278,"address":[16522077,16522118],"length":1,"stats":{"Line":0},"fn_name":null},{"line":279,"address":[16522274,16522203,16522165],"length":1,"stats":{"Line":0},"fn_name":null},{"line":281,"address":[16522927],"length":1,"stats":{"Line":0},"fn_name":null},{"line":282,"address":[16522950],"length":1,"stats":{"Line":0},"fn_name":null},{"line":286,"address":[16523346,16523592,16523021,16523535,16523107],"length":1,"stats":{"Line":0},"fn_name":null},{"line":287,"address":[16523123],"length":1,"stats":{"Line":0},"fn_name":null},{"line":288,"address":[16523187],"length":1,"stats":{"Line":0},"fn_name":null},{"line":289,"address":[16523597,16523207],"length":1,"stats":{"Line":0},"fn_name":null},{"line":290,"address":[16523739,16523644],"length":1,"stats":{"Line":0},"fn_name":null},{"line":291,"address":[16523755],"length":1,"stats":{"Line":0},"fn_name":null},{"line":292,"address":[16523790],"length":1,"stats":{"Line":0},"fn_name":null},{"line":293,"address":[16523851],"length":1,"stats":{"Line":0},"fn_name":null},{"line":297,"address":[16524620,16528537],"length":1,"stats":{"Line":0},"fn_name":null},{"line":300,"address":[16525620],"length":1,"stats":{"Line":0},"fn_name":null},{"line":303,"address":[16524768],"length":1,"stats":{"Line":0},"fn_name":null},{"line":304,"address":[16524807],"length":1,"stats":{"Line":0},"fn_name":null},{"line":305,"address":[16524838],"length":1,"stats":{"Line":0},"fn_name":null},{"line":306,"address":[16524883],"length":1,"stats":{"Line":0},"fn_name":null},{"line":307,"address":[16525001,16524963],"length":1,"stats":{"Line":0},"fn_name":null},{"line":308,"address":[16525009],"length":1,"stats":{"Line":0},"fn_name":null},{"line":309,"address":[16525021],"length":1,"stats":{"Line":0},"fn_name":null},{"line":310,"address":[16525061],"length":1,"stats":{"Line":0},"fn_name":null},{"line":313,"address":[16526334,16525756,16526043],"length":1,"stats":{"Line":0},"fn_name":null},{"line":316,"address":[16526056],"length":1,"stats":{"Line":0},"fn_name":null},{"line":317,"address":[16526095],"length":1,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[16526138],"length":1,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[16526185],"length":1,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[16527270,16527224,16526834],"length":1,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[16526344],"length":1,"stats":{"Line":0},"fn_name":null},{"line":325,"address":[16526422],"length":1,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[16526446],"length":1,"stats":{"Line":0},"fn_name":null},{"line":328,"address":[16526568],"length":1,"stats":{"Line":0},"fn_name":null},{"line":329,"address":[16526591],"length":1,"stats":{"Line":0},"fn_name":null},{"line":330,"address":[16526621],"length":1,"stats":{"Line":0},"fn_name":null},{"line":331,"address":[16526698],"length":1,"stats":{"Line":0},"fn_name":null},{"line":332,"address":[16526714],"length":1,"stats":{"Line":0},"fn_name":null},{"line":333,"address":[16526730],"length":1,"stats":{"Line":0},"fn_name":null},{"line":334,"address":[16526746],"length":1,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[16526762],"length":1,"stats":{"Line":0},"fn_name":null},{"line":336,"address":[16526778],"length":1,"stats":{"Line":0},"fn_name":null},{"line":339,"address":[16527480],"length":1,"stats":{"Line":0},"fn_name":null},{"line":341,"address":[16527507],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":168},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","financial","src","lib.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n//! # Financial Pallet Module\n//! ## Overview\n//!\n//! Equilibrium's Financial Pallet is an open-source substrate module that subscribes to external\n//! price feed/oracle, gathers asset prices and calculates financial metrics based on the\n//! information collected.\n//!\n//! ## Genesis Config\n//!\n//! You can provide initial price logs for the assets using [`GenesisConfig`](./struct.GenesisConfig.html).\n\n#![warn(missing_docs)]\n#![cfg_attr(not(feature = \"std\"), no_std)]\n\nuse core::ops::{AddAssign, BitOrAssign, ShlAssign};\nuse core::time::Duration;\nuse financial_primitives::capvec::CapVec;\nuse financial_primitives::{\n    BalanceAware, CalcReturnType, CalcVolatilityType, OnPriceSet, PricePeriod, PricePeriodError,\n};\nuse frame_support::codec::{Decode, Encode, FullCodec};\nuse frame_support::dispatch::{DispatchError, Parameter};\nuse frame_support::storage::{IterableStorageMap, StorageMap};\nuse frame_support::traits::{Get, UnixTime};\nuse frame_support::{decl_error, decl_event, decl_module, decl_storage, dispatch, ensure};\nuse frame_system::ensure_signed;\nuse math::{\n    calc_return_func, calc_return_iter, covariance, decay, demeaned, exp_corr, from_num,\n    last_recurrent_ewma, log_value_at_risk, mean, mul, regular_corr, regular_value_at_risk,\n    regular_vola, squared, sum, ConstType, MathError, MathResult,\n};\nuse sp_std::cmp::{max, min};\nuse sp_std::convert::{TryFrom, TryInto};\nuse sp_std::iter::Iterator;\nuse sp_std::ops::Range;\nuse sp_std::prelude::Vec;\nuse sp_std::vec;\nuse substrate_fixed::traits::{Fixed, FixedSigned, ToFixed};\nuse substrate_fixed::transcendental::sqrt;\n\npub use math::CalcCorrelationType;\n\nmod math;\n\n#[cfg(test)]\nmod mock;\n\n#[cfg(test)]\nmod tests;\n\n/// The module configuration trait.\npub trait Trait: frame_system::Trait {\n    /// The overarching event type.\n    type Event: From\u003cEvent\u003cSelf\u003e\u003e + Into\u003c\u003cSelf as frame_system::Trait\u003e::Event\u003e;\n    /// Implementation for the current unix timestamp provider. The\n    /// [`pallet_timestamp`](https://crates.parity.io/pallet_timestamp/index.html) is\n    /// right choice in most cases.\n    type UnixTime: UnixTime;\n    /// Number of price data points stored and used for calculations.\n    type PriceCount: Get\u003cu32\u003e;\n    /// The period of the collected prices in minutes.\n    type PricePeriod: Get\u003cu32\u003e;\n    /// Default type of calculation for return: Regular or Log.\n    type ReturnType: Get\u003cu32\u003e;\n    /// Default type of calculation for volatility and correlation: Regular or Exponential.\n    type VolCorType: Get\u003ci64\u003e;\n    /// System wide type for representing various assets such as BTC, ETH, EOS, etc.\n    type Asset: Parameter + Copy + Ord + Eq;\n    /// Primitive integer type that [`FixedNumber`](#associatedtype.FixedNumber) based on.\n    type FixedNumberBits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign;\n    /// Fixed point data type with a required precision that used for all financial calculations.\n    type FixedNumber: Clone\n        + Copy\n        + FullCodec\n        + FixedSigned\u003cBits = Self::FixedNumberBits\u003e\n        + PartialOrd\u003cConstType\u003e\n        + From\u003cConstType\u003e;\n    /// System wide type for representing price values. It must be convertable to and\n    /// from [`FixedNumber`](#associatedtype.FixedNumber).\n    type Price: Parameter + Clone + From\u003cSelf::FixedNumber\u003e + Into\u003cSelf::FixedNumber\u003e;\n    /// Type that gets user balances for a given AccountId\n    type Balances: BalanceAware\u003c\n        AccountId = Self::AccountId,\n        Asset = Self::Asset,\n        Balance = Self::Price,\n    \u003e;\n}\n\n/// Information about latest price update.\n#[derive(Encode, Decode, Clone, Default, PartialEq, Eq, Debug)]\npub struct PriceUpdate\u003cP\u003e {\n    /// Timestamp of the price period start for the latest price received.\n    pub period_start: Duration,\n    /// Latest price timestamp.\n    pub time: Duration,\n    /// Latest price value.\n    pub price: P,\n}\n\nimpl\u003cP\u003e PriceUpdate\u003cP\u003e {\n    #[cfg(test)]\n    fn new(period_start: Duration, time: Duration, price: P) -\u003e PriceUpdate\u003cP\u003e {\n        PriceUpdate {\n            period_start,\n            time,\n            price,\n        }\n    }\n}\n\n/// History of price changes for asset\n#[derive(Encode, Decode, Clone, Default, PartialEq, Eq, Debug)]\npub struct PriceLog\u003cF\u003e {\n    /// Timestamp of the latest point in the log.\n    pub latest_timestamp: Duration,\n    /// History of prices changes for last [`PriceCount`](./trait.Trait.html#associatedtype.PriceCount) periods in succesion.\n    pub prices: CapVec\u003cF\u003e,\n}\n\n/// Financial metrics for asset\n#[derive(Encode, Decode, Clone, Default, PartialEq, Eq, Debug)]\npub struct AssetMetrics\u003cA, P\u003e {\n    /// Start of the period inclusive for which metrics were calculated.\n    pub period_start: Duration,\n    /// End of the period exclusive for which metrics were calculated.\n    pub period_end: Duration,\n    /// Log returns\n    pub returns: Vec\u003cP\u003e,\n    /// Volatility\n    pub volatility: P,\n    /// Correlations for all assets\n    pub correlations: Vec\u003c(A, P)\u003e,\n}\n\n/// Financial metrics for all assets\n#[derive(Encode, Decode, Clone, Default, PartialEq, Eq, Debug)]\npub struct FinancialMetrics\u003cA, P\u003e {\n    /// Start of the period inclusive for which metrics were calculated.\n    pub period_start: Duration,\n    /// End of the period exclusive for which metrics were calculated.\n    pub period_end: Duration,\n\n    /// Assets for which metrics were calculated.\n    pub assets: Vec\u003cA\u003e,\n\n    /// Mean returns for all assets. Mean returns are in the same order as the assets in the `assets` field.\n    pub mean_returns: Vec\u003cP\u003e,\n\n    /// Volatilities for all assets. Volatilities are in the same order as the assets in the `assets` field.\n    pub volatilities: Vec\u003cP\u003e,\n\n    /// Correlation matrix for all assets.\n    /// Rows and columns are in the same order as the assets in the `assets` field.\n    /// Matrix is stored by rows. For example, let matrix A =\n    ///\n    /// ```pseudocode\n    /// a11 a12 a13\n    /// a21 a22 a21\n    /// a31 a32 a33\n    /// ```\n    ///\n    /// Then vector for this matrix will be:\n    ///\n    /// ```pseudocode\n    /// vec![a11, a12, a13, a21, a22, a23, a31, a32, a33]\n    /// ```\n    pub correlations: Vec\u003cP\u003e,\n\n    /// Covariance matrix for all assets.\n    /// Rows and columns are in the same order as the assets in the `assets` field.\n    /// Matrix is stored by rows. See example for `correlations` field.\n    pub covariances: Vec\u003cP\u003e,\n}\n\ndecl_storage! {\n    trait Store for Module\u003cT: Trait\u003e as FinancialModule {\n        /// Latest price updates on per asset basis.\n        pub Updates get(fn updates): map hasher(blake2_128_concat) T::Asset =\u003e Option\u003cPriceUpdate\u003cT::FixedNumber\u003e\u003e;\n\n        /// Price log on per asset basis.\n        pub PriceLogs get(fn price_logs): map hasher(blake2_128_concat) T::Asset =\u003e Option\u003cPriceLog\u003cT::FixedNumber\u003e\u003e;\n\n        /// Financial metrics on per asset basis.\n        pub PerAssetMetrics get(fn per_asset_metrics): map hasher(blake2_128_concat) T::Asset =\u003e Option\u003cAssetMetrics\u003cT::Asset, T::Price\u003e\u003e;\n\n        /// Financial metrics for all known assets.\n        pub Metrics get(fn metrics): Option\u003cFinancialMetrics\u003cT::Asset, T::Price\u003e\u003e;\n    }\n\n    add_extra_genesis {\n        /// Initial price logs on per asset basis.\n        config(prices): Vec\u003c(T::Asset, Vec\u003cT::Price\u003e, Duration)\u003e;\n\n        build(|config| {\n            let max_price_count = 180;\n            // Limit max value of `PricePeriod` to 7 days\n            let max_price_period = 7 * 24 * 60;\n\n            let price_count = T::PriceCount::get();\n            assert!(price_count \u003c= max_price_count, \"PriceCount can not be greater than {}\", max_price_count);\n\n            let price_period = T::PricePeriod::get();\n            assert!(price_period \u003c= max_price_period, \"PricePeriod can not be greater than {}\", max_price_period);\n\n            // We assume that each config item for a given asset contains prices of the past perionds going in\n            // succession. Timestamp of the last period is specified in `latest_timestamp`.\n            for (asset, values, latest_timestamp) in config.prices.iter() {\n                let mut prices = CapVec::\u003cT::FixedNumber\u003e::new(price_count);\n\n                assert!(values.len() \u003e 0, \"Initial price vector can not be empty. Asset: {:?}.\");\n\n                for v in values.iter() {\n                    prices.push(v.clone().into());\n                }\n\n                PriceLogs::\u003cT\u003e::insert(asset, PriceLog {\n                    latest_timestamp: *latest_timestamp,\n                    prices\n                });\n            }\n        });\n    }\n}\n\ndecl_event!(\n    pub enum Event\u003cT\u003e\n    where\n        Asset = \u003cT as Trait\u003e::Asset,\n    {\n        /// Financial metrics for the specified asset have been recalculeted\n        Recalculated(Asset),\n        /// Financial metrics for all assets have been recalculeted\n        MetricsRecalculated(),\n    }\n);\n\ndecl_error! {\n    /// Error for the Financial Pallet module.\n    pub enum Error for Module\u003cT: Trait\u003e {\n        /// Timestamp of the received price is in the past.\n        PeriodIsInThePast,\n        /// Overflow occured during financial calculation process.\n        Overflow,\n        /// Division by zero occured during financial calculation process.\n        DivisionByZero,\n        /// Price log is not long enough to calculate required value.\n        NotEnoughPoints,\n        /// Required functionality is not implemented.\n        NotImplemented,\n        /// Storage of the pallet is in an unexpected state.\n        InvalidStorage,\n        /// Specified period start timestamp is invalid for current\n        /// [`PricePeriod`](./trait.Trait.html#associatedtype.PricePeriod) value.\n        InvalidPeriodStart,\n        /// An invalid argument passed to the transcendental function (i.e. log, sqrt, etc.)\n        /// during financial calculation process.\n        Transcendental,\n        /// An invalid argument passed to the function.\n        InvalidArgument,\n        /// Default return type or default correlation type is initialized with a value that can\n        /// not be converted to type `CalcReturnType` or `CalcVolatilityType` respectively.\n        InvalidConstant,\n    }\n}\n\ndecl_module! {\n    /// Financial Pallet module declaration.\n    pub struct Module\u003cT: Trait\u003e for enum Call where origin: T::Origin {\n        type Error = Error\u003cT\u003e;\n\n        fn deposit_event() = default;\n\n        const PriceCount: u32 = T::PriceCount::get();\n        const PricePeriod: u32 = T::PricePeriod::get();\n\n        /// Recalculates financial metrics for a given asset\n        #[weight = 10_000 + T::DbWeight::get().writes(1)]\n        pub fn recalc_asset(origin, asset: T::Asset) -\u003e dispatch::DispatchResult {\n            ensure_signed(origin)?;\n\n            let return_type = CalcReturnType::try_from(T::ReturnType::get()).map_err(|_| Error::\u003cT\u003e::InvalidConstant)?;\n            let vol_cor_type = CalcVolatilityType::try_from(T::VolCorType::get()).map_err(|_| Error::\u003cT\u003e::InvalidConstant)?;\n\n            let mut correlations = vec![];\n\n            let mut asset_logs: Vec\u003c_\u003e = PriceLogs::\u003cT\u003e::iter().collect();\n            ensure!(asset_logs.len() \u003e 0, Error::\u003cT\u003e::NotEnoughPoints);\n            asset_logs.sort_by(|(a1, _), (a2, _)| a1.cmp(a2));\n\n            let price_period = PricePeriod(T::PricePeriod::get());\n            let ranges = asset_logs.iter().map(|(_, l)| get_period_id_range(\u0026price_period, l.prices.len(), l.latest_timestamp)).collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e().map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n            // Ensure that all correlations calculated for the same period\n            let intersection = get_range_intersection(ranges.iter()).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n            let (log1, period_id_range1) = asset_logs.iter().zip(ranges.iter()).find_map(|((a, l), r)| if *a == asset {Some((l, r))} else {None}).ok_or(Error::\u003cT\u003e::NotEnoughPoints)?;\n            let range1 = get_index_range(period_id_range1, \u0026intersection).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n            let prices1 = log1.prices.iter_range(\u0026range1).copied().collect::\u003cVec\u003c_\u003e\u003e();\n\n            let ret1 = Ret::\u003cT::FixedNumber\u003e::new(\u0026prices1, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n            let vol1 = Vol::\u003cT::FixedNumber\u003e::new(\u0026ret1, vol_cor_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n            for ((asset2, log2), period_id_range2) in asset_logs.iter().zip(ranges.iter()) {\n                if *asset2 == asset {\n                    // Correlation for any asset with itself sould be 1\n                    correlations.push((*asset2, from_num::\u003cT::FixedNumber\u003e(1).into()));\n                } else {\n                    let range2 = get_index_range(period_id_range2, \u0026intersection).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n                    let prices2 = log2.prices.iter_range(\u0026range2).copied().collect::\u003cVec\u003c_\u003e\u003e();\n\n                    let ret2 = Ret::\u003cT::FixedNumber\u003e::new(\u0026prices2, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n                    let vol2 = Vol::\u003cT::FixedNumber\u003e::new(\u0026ret2, vol_cor_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n                    let corre = cor(\u0026ret1, \u0026vol1, \u0026ret2, \u0026vol2).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n                    correlations.push((*asset2, corre.into()));\n                }\n            }\n\n            let temporal_range = Range {\n                start: price_period.get_period_id_start(intersection.start).map_err(Into::\u003cMathError\u003e::into).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?,\n                end: price_period.get_period_id_start(intersection.end).map_err(Into::\u003cMathError\u003e::into).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?,\n            };\n\n            let returns: Vec\u003cT::Price\u003e = ret1.ret.into_iter().map(|x| x.into()).collect();\n            let volatility: T::Price = vol1.vol.into();\n\n            PerAssetMetrics::\u003cT\u003e::insert(\u0026asset, AssetMetrics {\n                    period_start: temporal_range.start,\n                    period_end: temporal_range.end,\n                    returns,\n                    volatility,\n                    correlations,\n                }\n            );\n\n            Self::deposit_event(RawEvent::Recalculated(asset));\n\n            Ok(())\n        }\n\n        /// Recalculates financial metrics for all known assets.\n        #[weight = 10_000 + T::DbWeight::get().writes(1)]\n        pub fn recalc(origin) -\u003e dispatch::DispatchResult {\n            ensure_signed(origin)?;\n\n            let return_type = CalcReturnType::try_from(T::ReturnType::get()).map_err(|_| Error::\u003cT\u003e::InvalidConstant)?;\n            let vol_cor_type = CalcVolatilityType::try_from(T::VolCorType::get()).map_err(|_| Error::\u003cT\u003e::InvalidConstant)?;\n\n            let price_period = PricePeriod(T::PricePeriod::get());\n\n            let mut asset_logs: Vec\u003c_\u003e = PriceLogs::\u003cT\u003e::iter().collect();\n            ensure!(asset_logs.len() \u003e 0, Error::\u003cT\u003e::NotEnoughPoints);\n            asset_logs.sort_by(|(a1, _), (a2, _)| a1.cmp(a2));\n\n            let metrics = financial_metrics::\u003cT::Asset, T::FixedNumber, T::Price\u003e(return_type, vol_cor_type, \u0026price_period, \u0026asset_logs).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n            Metrics::\u003cT\u003e::put(metrics);\n\n            Self::deposit_event(RawEvent::MetricsRecalculated());\n\n            Ok(())\n        }\n    }\n}\n\n#[derive(Debug, Eq, PartialEq)]\nenum GetNewPricesError {\n    Overflow,\n}\n\nfn get_new_prices\u003cP: Clone\u003e(\n    last_price: P,\n    new_price: P,\n    empty_periods: u32,\n    max_periods: u32,\n) -\u003e Result\u003cVec\u003cP\u003e, GetNewPricesError\u003e {\n    // Calculate how many values to pre-populate the array with\n    // We will pre-fill up to `max_periods` elements (leaving out one for the new price)\n    let prices_size = min(\n        empty_periods,\n        max_periods\n            .checked_sub(1)\n            .ok_or(GetNewPricesError::Overflow)?,\n    ) as usize;\n\n    // Init the vector filled with last_price\n    let mut new_prices = vec![last_price.clone(); prices_size];\n\n    new_prices.push(new_price);\n\n    Ok(new_prices)\n}\n\nimpl\u003cT: Trait\u003e From\u003cGetNewPricesError\u003e for Error\u003cT\u003e {\n    fn from(error: GetNewPricesError) -\u003e Self {\n        match error {\n            GetNewPricesError::Overflow =\u003e Error::\u003cT\u003e::Overflow,\n        }\n    }\n}\n\n#[derive(Debug, Eq, PartialEq)]\nenum PricePeriodAction {\n    RemainsUnchanged,\n    StartedNew(u32),\n}\n\n#[derive(Debug, Eq, PartialEq)]\nstruct PricePeriodChange {\n    pub period_start: Duration,\n    pub action: PricePeriodAction,\n}\n\n#[derive(Debug, Eq, PartialEq)]\nenum PricePeriodChangeError {\n    DivisionByZero,\n    Overflow,\n    PeriodIsInThePast,\n    InvalidPeriodStart,\n}\n\nimpl From\u003cPricePeriodError\u003e for PricePeriodChangeError {\n    fn from(error: PricePeriodError) -\u003e Self {\n        match error {\n            PricePeriodError::DivisionByZero =\u003e PricePeriodChangeError::DivisionByZero,\n            PricePeriodError::Overflow =\u003e PricePeriodChangeError::Overflow,\n        }\n    }\n}\n\nimpl\u003cT: Trait\u003e From\u003cPricePeriodChangeError\u003e for Error\u003cT\u003e {\n    fn from(error: PricePeriodChangeError) -\u003e Self {\n        match error {\n            PricePeriodChangeError::DivisionByZero =\u003e Error::\u003cT\u003e::DivisionByZero,\n            PricePeriodChangeError::Overflow =\u003e Error::\u003cT\u003e::Overflow,\n            PricePeriodChangeError::PeriodIsInThePast =\u003e Error::\u003cT\u003e::PeriodIsInThePast,\n            PricePeriodChangeError::InvalidPeriodStart =\u003e Error::\u003cT\u003e::InvalidPeriodStart,\n        }\n    }\n}\n\n/// Calculates start timestamp of the period which contains `now` timestamp.\n/// Also  calculates number of periods elapsed since `prev_start` timestamp up until `now` timestamp.\nfn get_curr_period_info(\n    price_period: \u0026PricePeriod,\n    prev_start: Duration,\n    now: Duration,\n) -\u003e Result\u003c(Duration, i32), PricePeriodError\u003e {\n    let prev_period_id = price_period.get_period_id(prev_start)?;\n    let curr_period_id = price_period.get_period_id(now)?;\n\n    let prev: i32 = prev_period_id\n        .try_into()\n        .map_err(|_| PricePeriodError::Overflow)?;\n    let curr: i32 = curr_period_id\n        .try_into()\n        .map_err(|_| PricePeriodError::Overflow)?;\n    let delta: Result\u003c_, PricePeriodError\u003e =\n        curr.checked_sub(prev).ok_or(PricePeriodError::Overflow);\n    Ok((price_period.get_period_id_start(curr_period_id)?, delta?))\n}\n\n/// Dicides if the period change took place.\nfn get_period_change(\n    price_period: \u0026PricePeriod,\n    period_start: Option\u003cDuration\u003e,\n    now: Duration,\n) -\u003e Result\u003cPricePeriodChange, PricePeriodChangeError\u003e {\n    if let Some(period_start) = period_start {\n        ensure!(\n            price_period.is_valid_period_start(period_start)?,\n            PricePeriodChangeError::InvalidPeriodStart\n        );\n    }\n\n    match period_start {\n        // No `period_start` exists. It means that we received price update for the first time.\n        None =\u003e {\n            let period_start = price_period.get_period_start(now)?;\n\n            Ok(PricePeriodChange {\n                period_start,\n                action: PricePeriodAction::StartedNew(0),\n            })\n        }\n        Some(last_start) =\u003e {\n            let (current_start, periods_elapsed) =\n                get_curr_period_info(price_period, last_start, now)?;\n\n            if periods_elapsed \u003c 0 {\n                // Current period is in the past\n\n                Err(PricePeriodChangeError::PeriodIsInThePast)\n            } else if periods_elapsed == 0 {\n                // Period is not changed\n\n                Ok(PricePeriodChange {\n                    period_start: last_start,\n                    action: PricePeriodAction::RemainsUnchanged,\n                })\n            } else {\n                // Period is changed\n\n                let empty_periods = (periods_elapsed - 1) as u32;\n\n                Ok(PricePeriodChange {\n                    period_start: current_start,\n                    action: PricePeriodAction::StartedNew(empty_periods),\n                })\n            }\n        }\n    }\n}\n\nimpl\u003cT: Trait\u003e OnPriceSet for Module\u003cT\u003e {\n    type Asset = T::Asset;\n    type Price = T::Price;\n\n    fn on_price_set(asset: T::Asset, value: T::Price) -\u003e Result\u003c(), DispatchError\u003e {\n        let value: T::FixedNumber = value.into();\n        let now = T::UnixTime::now();\n        let price_count = T::PriceCount::get();\n\n        let update = Self::updates(asset);\n        let log = Self::price_logs(asset);\n\n        // If `PriceLog` for a given asset is not empty then it must contain fully initialized `CapVec`. It's `cap_len` should be equal to `PriceCount`.\n        if let Some(ref log) = log {\n            ensure!(\n                log.prices.len_cap() == price_count,\n                Error::\u003cT\u003e::InvalidStorage\n            );\n        }\n\n        let period_start = update.map(|x| x.period_start);\n        let price_period = PricePeriod(T::PricePeriod::get());\n        let period_change =\n            get_period_change(\u0026price_period, period_start, now).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let period_start = period_change.period_start;\n\n        // Every point received is stores to the `Update`.\n        // Meanwhile only first point received in the current period is stored in the price log.\n        match period_change.action {\n            PricePeriodAction::RemainsUnchanged =\u003e {\n                Updates::\u003cT\u003e::insert(\n                    \u0026asset,\n                    PriceUpdate {\n                        period_start: period_start,\n                        time: now,\n                        price: value,\n                    },\n                );\n            }\n            PricePeriodAction::StartedNew(empty_periods) =\u003e {\n                let log_to_insert = if let Some(mut existing_log) = log {\n                    existing_log.latest_timestamp = now;\n\n                    // If `PriceLog` for a given asset is not empty, then it should contain at\n                    // least one price value. It was set during prevoius `on_price_update` call or\n                    // during genesis state generation routine.\n                    let last_price = existing_log\n                        .prices\n                        .last()\n                        .copied()\n                        .ok_or(Error::\u003cT\u003e::InvalidStorage)?;\n\n                    let new_prices = get_new_prices(last_price, value, empty_periods, price_count)\n                        .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n                    for p in new_prices {\n                        existing_log.prices.push(p);\n                    }\n\n                    existing_log\n                } else {\n                    let mut new_prices = CapVec::\u003cT::FixedNumber\u003e::new(price_count);\n                    new_prices.push(value);\n\n                    PriceLog {\n                        latest_timestamp: now,\n                        prices: new_prices,\n                    }\n                };\n\n                Updates::\u003cT\u003e::insert(\n                    \u0026asset,\n                    PriceUpdate {\n                        period_start: period_start,\n                        time: now,\n                        price: value,\n                    },\n                );\n                PriceLogs::\u003cT\u003e::insert(\u0026asset, log_to_insert);\n            }\n        }\n\n        Ok(())\n    }\n}\n\n/// Important financial functions that uses [`prices`](./struct.Module.html#method.prices) as a data source.\npub trait Financial {\n    /// System wide type for representing various assets such as BTC, ETH, EOS, etc.\n    type Asset;\n    /// System wide type for representing price values.\n    type Price;\n    /// System wide type for representing account id.\n    type AccountId;\n\n    /// Calculates return.\n    fn calc_return(\n        return_type: CalcReturnType,\n        asset: Self::Asset,\n    ) -\u003e Result\u003cVec\u003cSelf::Price\u003e, DispatchError\u003e;\n    /// Calculates volatility.\n    fn calc_vol(\n        return_type: CalcReturnType,\n        volatility_type: CalcVolatilityType,\n        asset: Self::Asset,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e;\n    /// Calculates pairwise correlation between two specified assets.\n    fn calc_corr(\n        return_type: CalcReturnType,\n        correlation_type: CalcVolatilityType,\n        asset1: Self::Asset,\n        asset2: Self::Asset,\n    ) -\u003e Result\u003c(Self::Price, Range\u003cDuration\u003e), DispatchError\u003e;\n    /// Calculates portfolio volatility.\n    fn calc_portf_vol(\n        return_type: CalcReturnType,\n        vol_cor_type: CalcVolatilityType,\n        account_id: Self::AccountId,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e;\n    /// Calculates portfolio value at risk.\n    fn calc_portf_var(\n        return_type: CalcReturnType,\n        vol_cor_type: CalcVolatilityType,\n        account_id: Self::AccountId,\n        z_score: u32,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e;\n}\n\n#[derive(Debug)]\nstruct Ret\u003c'prices, F\u003e {\n    prices: \u0026'prices [F],\n    return_type: CalcReturnType,\n    ret: Vec\u003cF\u003e,\n}\n\nimpl\u003c'prices, F\u003e Ret\u003c'prices, F\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    fn new(prices: \u0026'prices [F], return_type: CalcReturnType) -\u003e MathResult\u003cRet\u003c'prices, F\u003e\u003e {\n        let ret = calc_return_iter(prices, calc_return_func(return_type))\n            .collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()?;\n        Ok(Ret {\n            prices,\n            return_type,\n            ret,\n        })\n    }\n}\n\n#[derive(Debug)]\nstruct Vol\u003cF\u003e {\n    volatility_type: CalcVolatilityType,\n    mean_return: F,\n    demeaned_return: Vec\u003cF\u003e,\n    decay: Option\u003cF\u003e,\n    vol: F,\n}\n\nimpl\u003cF\u003e Vol\u003cF\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    fn new\u003c'prices\u003e(\n        ret: \u0026Ret\u003c'prices, F\u003e,\n        volatility_type: CalcVolatilityType,\n    ) -\u003e MathResult\u003cVol\u003cF\u003e\u003e {\n        let mean_return: F = mean(\u0026ret.ret)?;\n\n        let demeaned_return =\n            demeaned(ret.ret.iter(), mean_return).collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()?;\n        let squared_demeaned_return = squared(demeaned_return.iter().copied().map(Ok));\n\n        match volatility_type {\n            CalcVolatilityType::Regular =\u003e {\n                let vol: F = sqrt(regular_vola(ret.ret.len(), sum(squared_demeaned_return)?)?)\n                    .map_err(|_| MathError::Transcendental)?;\n\n                Ok(Vol {\n                    volatility_type,\n                    mean_return,\n                    demeaned_return,\n                    decay: None,\n                    vol,\n                })\n            }\n            CalcVolatilityType::Exponential(ewma_length) =\u003e {\n                let decay = decay(ewma_length)?;\n                let var = last_recurrent_ewma(squared_demeaned_return, decay)?;\n                let vol = sqrt(var).map_err(|_| MathError::Transcendental)?;\n\n                Ok(Vol {\n                    volatility_type: CalcVolatilityType::Exponential(ewma_length),\n                    mean_return,\n                    demeaned_return,\n                    decay: Some(decay),\n                    vol,\n                })\n            }\n        }\n    }\n}\n\nfn cor\u003c'prices, F\u003e(\n    ret1: \u0026Ret\u003c'prices, F\u003e,\n    volatility1: \u0026Vol\u003cF\u003e,\n    ret2: \u0026Ret\u003c'prices, F\u003e,\n    volatility2: \u0026Vol\u003cF\u003e,\n) -\u003e MathResult\u003cF\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    let zero = from_num::\u003cF\u003e(0);\n\n    match (\u0026volatility1, \u0026volatility2) {\n        (Vol { vol: vol1, .. }, _) if *vol1 == zero =\u003e Ok(zero),\n        (_, Vol { vol: vol2, .. }) if *vol2 == zero =\u003e Ok(zero),\n        (\n            Vol {\n                volatility_type: CalcVolatilityType::Regular,\n                demeaned_return: dr1,\n                vol: vol1,\n                ..\n            },\n            Vol {\n                volatility_type: CalcVolatilityType::Regular,\n                demeaned_return: dr2,\n                vol: vol2,\n                ..\n            },\n        ) =\u003e {\n            let demeaned_returns_product = mul(dr1.iter().copied(), dr2.iter().copied());\n\n            let products_sum = sum(demeaned_returns_product)?;\n            let products_len = min(ret1.ret.len(), ret2.ret.len());\n            let result = regular_corr(products_len, products_sum, *vol1, *vol2)?;\n            Ok(result)\n        }\n        (\n            Vol {\n                volatility_type: CalcVolatilityType::Exponential(n1),\n                demeaned_return: dr1,\n                decay: Some(d1),\n                vol: vol1,\n                ..\n            },\n            Vol {\n                volatility_type: CalcVolatilityType::Exponential(n2),\n                demeaned_return: dr2,\n                vol: vol2,\n                ..\n            },\n        ) if n1 == n2 =\u003e {\n            let demeaned_returns_product = mul(dr1.iter().copied(), dr2.iter().copied());\n\n            let decay = *d1;\n            let last_covar = last_recurrent_ewma(demeaned_returns_product, decay)?;\n            let result = exp_corr(last_covar, *vol1, *vol2)?;\n            Ok(result)\n        }\n        _ =\u003e Err(MathError::InvalidArgument),\n    }\n}\n\nfn financial_metrics\u003cA, F, P\u003e(\n    return_type: CalcReturnType,\n    vol_cor_type: CalcVolatilityType,\n    price_period: \u0026PricePeriod,\n    asset_logs: \u0026[(A, PriceLog\u003cF\u003e)],\n) -\u003e MathResult\u003cFinancialMetrics\u003cA, P\u003e\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n    F: Into\u003cP\u003e,\n    A: Eq + Copy,\n{\n    ensure!(asset_logs.len() \u003e 0, MathError::NotEnoughPoints);\n\n    let mut mean_returns = Vec::with_capacity(asset_logs.len());\n    let mut volatilities = Vec::with_capacity(asset_logs.len());\n    let mut correlations = Vec::with_capacity(asset_logs.len() * asset_logs.len());\n\n    let period_id_ranges = asset_logs\n        .iter()\n        .map(|(_, l)| get_period_id_range(\u0026price_period, l.prices.len(), l.latest_timestamp))\n        .collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()?;\n\n    // Ensure that all correlations calculated for the same period\n    let intersection = get_range_intersection(period_id_ranges.iter())?;\n\n    for ((asset1, log1), period_id_range1) in asset_logs.iter().zip(period_id_ranges.iter()) {\n        let range1 = get_index_range(period_id_range1, \u0026intersection)?;\n        let prices1 = log1.prices.iter_range(\u0026range1).copied().collect::\u003cVec\u003c_\u003e\u003e();\n\n        let ret1 = Ret::\u003cF\u003e::new(\u0026prices1, return_type)?;\n        let vol1 = Vol::\u003cF\u003e::new(\u0026ret1, vol_cor_type)?;\n\n        mean_returns.push(vol1.mean_return);\n        volatilities.push(vol1.vol);\n\n        for ((asset2, log2), period_id_range2) in asset_logs.iter().zip(period_id_ranges.iter()) {\n            if *asset2 == *asset1 {\n                // Correlation for any asset with itself sould be 1\n                correlations.push(from_num::\u003cF\u003e(1));\n            } else {\n                let range2 = get_index_range(period_id_range2, \u0026intersection)?;\n                let prices2 = log2.prices.iter_range(\u0026range2).copied().collect::\u003cVec\u003c_\u003e\u003e();\n\n                let ret2 = Ret::\u003cF\u003e::new(\u0026prices2, return_type)?;\n                let vol2 = Vol::\u003cF\u003e::new(\u0026ret2, vol_cor_type)?;\n\n                let corre = cor(\u0026ret1, \u0026vol1, \u0026ret2, \u0026vol2)?;\n\n                correlations.push(corre);\n            }\n        }\n    }\n\n    let covariances = covariance(\u0026correlations, \u0026volatilities)\n        .map(|x| x.map(|y| y.into()))\n        .collect::\u003cMathResult\u003cVec\u003cP\u003e\u003e\u003e()?;\n\n    let temporal_range = Range {\n        start: price_period.get_period_id_start(intersection.start)?,\n        end: price_period.get_period_id_start(intersection.end)?,\n    };\n\n    Ok(FinancialMetrics {\n        period_start: temporal_range.start,\n        period_end: temporal_range.end,\n        assets: asset_logs.iter().map(|(a, _)| a).copied().collect(),\n        mean_returns: mean_returns.into_iter().map(|x| x.into()).collect(),\n        volatilities: volatilities.into_iter().map(|x| x.into()).collect(),\n        correlations: correlations.into_iter().map(|x| x.into()).collect(),\n        covariances: covariances,\n    })\n}\n\nfn latest_prices\u003c'logs, A, F\u003e(\n    asset_logs: \u0026'logs [(A, PriceLog\u003cF\u003e)],\n) -\u003e impl Iterator\u003cItem = MathResult\u003cF\u003e\u003e + 'logs\nwhere\n    F: Copy,\n{\n    asset_logs.iter().map(|(_, l)| {\n        l.prices\n            .last()\n            .map(|\u0026x| x)\n            .ok_or(MathError::NotEnoughPoints)\n    })\n}\n\nfn weights\u003cF\u003e(quantity: \u0026[F], prices: \u0026[F]) -\u003e MathResult\u003cVec\u003cF\u003e\u003e\nwhere\n    F: Fixed,\n{\n    let products =\n        mul(quantity.iter().copied(), prices.iter().copied()).collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()?;\n    let sum_product = sum(products.iter().copied().map(Ok))?;\n\n    products\n        .iter()\n        .copied()\n        .map(|x| x.checked_div(sum_product).ok_or(MathError::DivisionByZero))\n        .collect()\n}\n\nfn portfolio_vol\u003cF\u003e(weights: \u0026[F], cov: \u0026[F]) -\u003e MathResult\u003cF\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    let n = weights.len();\n    ensure!(cov.len() == n * n, MathError::InvalidArgument);\n\n    let matrix_1xn = cov\n        .chunks(n)\n        .map(|cov_row| sum(mul(weights.iter().copied(), cov_row.iter().copied())))\n        .collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()?;\n\n    let matrix_1x1 = sum(mul(matrix_1xn.into_iter(), weights.iter().copied()))?;\n\n    sqrt(matrix_1x1).map_err(|_| MathError::Transcendental)\n}\n\nimpl From\u003cPricePeriodError\u003e for MathError {\n    fn from(error: PricePeriodError) -\u003e Self {\n        match error {\n            PricePeriodError::DivisionByZero =\u003e MathError::DivisionByZero,\n            PricePeriodError::Overflow =\u003e MathError::Overflow,\n        }\n    }\n}\n\nimpl\u003cT: Trait\u003e From\u003cMathError\u003e for Error\u003cT\u003e {\n    fn from(error: MathError) -\u003e Self {\n        match error {\n            MathError::NotEnoughPoints =\u003e Error::\u003cT\u003e::NotEnoughPoints,\n            MathError::Overflow =\u003e Error::\u003cT\u003e::Overflow,\n            MathError::DivisionByZero =\u003e Error::\u003cT\u003e::DivisionByZero,\n            MathError::Transcendental =\u003e Error::\u003cT\u003e::Transcendental,\n            MathError::InvalidArgument =\u003e Error::\u003cT\u003e::InvalidArgument,\n        }\n    }\n}\n\n/// Calculates price period range for a given `items_length` periods elapsed number\n/// up to `latest_timestamp`.\nfn get_period_id_range(\n    price_period: \u0026PricePeriod,\n    items_length: usize,\n    latest_timestamp: Duration,\n) -\u003e MathResult\u003cRange\u003cu64\u003e\u003e {\n    let last_period_id = price_period.get_period_id(latest_timestamp)?;\n    let next_after_last_period_id = last_period_id.checked_add(1).ok_or(MathError::Overflow)?;\n    let items_length: u64 = items_length.try_into().map_err(|_| MathError::Overflow)?;\n    let first_period_id = next_after_last_period_id\n        .checked_sub(items_length)\n        .ok_or(MathError::Overflow)?;\n\n    Ok(Range {\n        start: first_period_id,\n        end: next_after_last_period_id,\n    })\n}\n\nfn get_range_intersection2\u003cT\u003e(range1: \u0026Range\u003cT\u003e, range2: \u0026Range\u003cT\u003e) -\u003e Range\u003cT\u003e\nwhere\n    T: Ord + Copy,\n{\n    let start = max(range1.start, range2.start);\n    let end = min(range1.end, range2.end);\n\n    Range { start, end }\n}\n\nfn get_range_intersection\u003c'a, T, I\u003e(mut ranges: I) -\u003e MathResult\u003cRange\u003cT\u003e\u003e\nwhere\n    T: 'a + Ord + Copy,\n    I: Iterator\u003cItem = \u0026'a Range\u003cT\u003e\u003e,\n{\n    let intersection = ranges.try_fold::\u003cOption\u003cRange\u003cT\u003e\u003e, _, Option\u003c_\u003e\u003e(None, |acc, r| {\n        if let Some(i) = acc {\n            let new_intersection = get_range_intersection2(\u0026i, r);\n            if new_intersection.is_empty() {\n                None\n            } else {\n                Some(Some(new_intersection))\n            }\n        } else {\n            Some(Some(r.clone()))\n        }\n    });\n\n    intersection\n        .and_then(|i| i)\n        .ok_or(MathError::NotEnoughPoints)\n}\n\n/// Calculates price log indices for the subrange `intersection` of the price period range `range`.\n/// Price log contains only prices within range `range`.\nfn get_index_range(range: \u0026Range\u003cu64\u003e, intersection: \u0026Range\u003cu64\u003e) -\u003e MathResult\u003cRange\u003cusize\u003e\u003e {\n    if intersection.is_empty() {\n        Ok(Range { start: 0, end: 0 })\n    } else {\n        ensure!(\n            range.start \u003c= intersection.start \u0026\u0026 range.end \u003e= intersection.end,\n            MathError::InvalidArgument\n        );\n        let offset = range.start;\n        let start = intersection.start - offset;\n        let end = intersection.end - offset;\n\n        let start: usize = start.try_into().map_err(|_| MathError::Overflow)?;\n        let end: usize = end.try_into().map_err(|_| MathError::Overflow)?;\n        Ok(Range { start, end })\n    }\n}\n\n/// Gets prices for two given assets `asset1` and `asset2` only for those price periods that\n/// are present in both price logs.\n/// Returns tuple which contains respectively prices from the log for `asset1`, prices from the log\n/// to `asset2`, a time range which is common for both `asset1` and `asset2` price logs.\nfn get_prices_for_common_periods\u003cT: Trait\u003e(\n    asset1: T::Asset,\n    asset2: T::Asset,\n) -\u003e MathResult\u003c(Vec\u003cT::FixedNumber\u003e, Vec\u003cT::FixedNumber\u003e, Range\u003cDuration\u003e)\u003e {\n    let price_period = PricePeriod(T::PricePeriod::get());\n\n    let log1 = PriceLogs::\u003cT\u003e::get(asset1).ok_or(MathError::NotEnoughPoints)?;\n    let period_id_range1 =\n        get_period_id_range(\u0026price_period, log1.prices.len(), log1.latest_timestamp)?;\n\n    let log2 = PriceLogs::\u003cT\u003e::get(asset2).ok_or(MathError::NotEnoughPoints)?;\n    let period_id_range2 =\n        get_period_id_range(\u0026price_period, log2.prices.len(), log2.latest_timestamp)?;\n\n    let intersection = get_range_intersection2(\u0026period_id_range1, \u0026period_id_range2);\n\n    let index_range1 = get_index_range(\u0026period_id_range1, \u0026intersection)?;\n    let prices1: Vec\u003c_\u003e = log1.prices.iter_range(\u0026index_range1).copied().collect();\n\n    let index_range2 = get_index_range(\u0026period_id_range2, \u0026intersection)?;\n    let prices2: Vec\u003c_\u003e = log2.prices.iter_range(\u0026index_range2).copied().collect();\n    let temporal_range = Range {\n        start: price_period.get_period_id_start(intersection.start)?,\n        end: price_period.get_period_id_start(intersection.end)?,\n    };\n\n    Ok((prices1, prices2, temporal_range))\n}\n\nimpl\u003cT: Trait\u003e Financial for Module\u003cT\u003e {\n    type Asset = T::Asset;\n    type Price = T::Price;\n    type AccountId = \u003cT as frame_system::Trait\u003e::AccountId;\n\n    fn calc_return(\n        return_type: CalcReturnType,\n        asset: T::Asset,\n    ) -\u003e Result\u003cVec\u003cT::Price\u003e, DispatchError\u003e {\n        let log = PriceLogs::\u003cT\u003e::get(asset).ok_or(Error::\u003cT\u003e::NotEnoughPoints)?;\n        let prices: Vec\u003c_\u003e = log.prices.iter().cloned().collect();\n\n        let ret =\n            Ret::\u003cT::FixedNumber\u003e::new(\u0026prices, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n        let result: Vec\u003cT::Price\u003e = ret.ret.into_iter().map(|x| x.into()).collect();\n\n        if result.len() == 0 {\n            Err(Error::\u003cT\u003e::NotEnoughPoints.into())\n        } else {\n            Ok(result)\n        }\n    }\n\n    fn calc_vol(\n        return_type: CalcReturnType,\n        volatility_type: CalcVolatilityType,\n        asset: T::Asset,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e {\n        let log = PriceLogs::\u003cT\u003e::get(asset).ok_or(Error::\u003cT\u003e::NotEnoughPoints)?;\n        let prices: Vec\u003c_\u003e = log.prices.iter().cloned().collect();\n\n        let returns =\n            Ret::\u003cT::FixedNumber\u003e::new(\u0026prices, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n        let result = Vol::\u003cT::FixedNumber\u003e::new(\u0026returns, volatility_type)\n            .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        Ok(result.vol.into())\n    }\n\n    fn calc_corr(\n        return_type: CalcReturnType,\n        correlation_type: CalcVolatilityType,\n        asset1: T::Asset,\n        asset2: T::Asset,\n    ) -\u003e Result\u003c(Self::Price, Range\u003cDuration\u003e), DispatchError\u003e {\n        // We should only use those points for which price periods are present in both price logs\n        let (prices1, prices2, temporal_range) =\n            get_prices_for_common_periods::\u003cT\u003e(asset1, asset2).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let ret1 =\n            Ret::\u003cT::FixedNumber\u003e::new(\u0026prices1, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n        let vol1 =\n            Vol::\u003cT::FixedNumber\u003e::new(\u0026ret1, correlation_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let ret2 =\n            Ret::\u003cT::FixedNumber\u003e::new(\u0026prices2, return_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n        let vol2 =\n            Vol::\u003cT::FixedNumber\u003e::new(\u0026ret2, correlation_type).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let corre = cor(\u0026ret1, \u0026vol1, \u0026ret2, \u0026vol2).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        Ok((corre.into(), temporal_range))\n    }\n\n    fn calc_portf_vol(\n        return_type: CalcReturnType,\n        vol_cor_type: CalcVolatilityType,\n        account_id: Self::AccountId,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e {\n        let price_period = PricePeriod(T::PricePeriod::get());\n\n        let mut asset_logs: Vec\u003c_\u003e = PriceLogs::\u003cT\u003e::iter().collect();\n        ensure!(asset_logs.len() \u003e 0, Error::\u003cT\u003e::NotEnoughPoints);\n        asset_logs.sort_by(|(a1, _), (a2, _)| a1.cmp(a2));\n\n        let metrics = financial_metrics::\u003cT::Asset, T::FixedNumber, T::FixedNumber\u003e(\n            return_type,\n            vol_cor_type,\n            \u0026price_period,\n            \u0026asset_logs,\n        )\n        .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let prices = latest_prices::\u003cT::Asset, T::FixedNumber\u003e(\u0026asset_logs)\n            .collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()\n            .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let balances = T::Balances::balances(\u0026account_id, \u0026metrics.assets)?\n            .into_iter()\n            .map(|x| x.into())\n            .collect::\u003cVec\u003c_\u003e\u003e();\n\n        let ws = weights(\u0026balances, \u0026prices).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let vol = portfolio_vol(\u0026ws, \u0026metrics.covariances).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        Ok(vol.into())\n    }\n\n    fn calc_portf_var(\n        return_type: CalcReturnType,\n        vol_cor_type: CalcVolatilityType,\n        account_id: Self::AccountId,\n        z_score: u32,\n    ) -\u003e Result\u003cSelf::Price, DispatchError\u003e {\n        let price_period = PricePeriod(T::PricePeriod::get());\n\n        let mut asset_logs: Vec\u003c_\u003e = PriceLogs::\u003cT\u003e::iter().collect();\n        ensure!(asset_logs.len() \u003e 0, Error::\u003cT\u003e::NotEnoughPoints);\n        asset_logs.sort_by(|(a1, _), (a2, _)| a1.cmp(a2));\n\n        let metrics = financial_metrics::\u003cT::Asset, T::FixedNumber, T::FixedNumber\u003e(\n            return_type,\n            vol_cor_type,\n            \u0026price_period,\n            \u0026asset_logs,\n        )\n        .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let prices = latest_prices::\u003cT::Asset, T::FixedNumber\u003e(\u0026asset_logs)\n            .collect::\u003cMathResult\u003cVec\u003c_\u003e\u003e\u003e()\n            .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let balances = T::Balances::balances(\u0026account_id, \u0026metrics.assets)?\n            .into_iter()\n            .map(|x| x.into())\n            .collect::\u003cVec\u003c_\u003e\u003e();\n\n        let ws = weights(\u0026balances, \u0026prices).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        let vol = portfolio_vol(\u0026ws, \u0026metrics.covariances).map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n        let total_weighted_mean_return = sum(mul(ws.into_iter(), metrics.mean_returns.into_iter()))\n            .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n\n        match return_type {\n            CalcReturnType::Regular =\u003e {\n                let portf_var = regular_value_at_risk(z_score, vol, total_weighted_mean_return)\n                    .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n                Ok(portf_var.into())\n            }\n            CalcReturnType::Log =\u003e {\n                let portf_var = log_value_at_risk(z_score, vol, total_weighted_mean_return)\n                    .map_err(Into::\u003cError\u003cT\u003e\u003e::into)?;\n                Ok(portf_var.into())\n            }\n        }\n    }\n}\n","traces":[{"line":117,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":190,"address":[4614912,4614864,4614816,4616448,4616752,4616636,4616656,4616551,4616864,4616832,4614828,4616544,4616759,4616844,4614929,4616736,4616417,4616368,4616624,4616528,4614876],"length":1,"stats":{"Line":38},"fn_name":"updates\u003cfinancial_pallet::mock::Test,financial_pallet::mock::Asset\u003e"},{"line":209,"address":[4616380,4615060,4614976],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Test\u003e"},{"line":210,"address":[4614999],"length":1,"stats":{"Line":2},"fn_name":null},{"line":212,"address":[4615018],"length":1,"stats":{"Line":2},"fn_name":null},{"line":214,"address":[4615039],"length":1,"stats":{"Line":2},"fn_name":null},{"line":215,"address":[4615131,4615082],"length":1,"stats":{"Line":2},"fn_name":null},{"line":217,"address":[4615100],"length":1,"stats":{"Line":2},"fn_name":null},{"line":218,"address":[4615384,4615322],"length":1,"stats":{"Line":2},"fn_name":null},{"line":222,"address":[4615722,4616299,4615584,4615348],"length":1,"stats":{"Line":6},"fn_name":null},{"line":223,"address":[4615791],"length":1,"stats":{"Line":2},"fn_name":null},{"line":225,"address":[4615893,4615839],"length":1,"stats":{"Line":2},"fn_name":null},{"line":227,"address":[4616286,4616182,4615876,4615936],"length":1,"stats":{"Line":6},"fn_name":null},{"line":228,"address":[4616216],"length":1,"stats":{"Line":2},"fn_name":null},{"line":231,"address":[4616115],"length":1,"stats":{"Line":2},"fn_name":null},{"line":232,"address":[4616069],"length":1,"stats":{"Line":2},"fn_name":null},{"line":233,"address":[4616075],"length":1,"stats":{"Line":2},"fn_name":null},{"line":240,"address":[5101038],"length":1,"stats":{"Line":0},"fn_name":null},{"line":246,"address":[5112384,5111789,5112080],"length":1,"stats":{"Line":0},"fn_name":null},{"line":288,"address":[5074086],"length":1,"stats":{"Line":0},"fn_name":null},{"line":289,"address":[5074150],"length":1,"stats":{"Line":0},"fn_name":null},{"line":292,"address":[5116717,5116687,5116002],"length":1,"stats":{"Line":0},"fn_name":null},{"line":294,"address":[5081009,5081216,5080877,5080986],"length":1,"stats":{"Line":0},"fn_name":null},{"line":296,"address":[5088580,5081472,5088576,5081265],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":297,"address":[5081457,5088352,5081713,5088356,5081538],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":299,"address":[5081706],"length":1,"stats":{"Line":0},"fn_name":null},{"line":301,"address":[5081779],"length":1,"stats":{"Line":0},"fn_name":null},{"line":302,"address":[5081922,5082042,5081833],"length":1,"stats":{"Line":0},"fn_name":null},{"line":303,"address":[5088384,5081899,5082063,5088403],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":305,"address":[5082070],"length":1,"stats":{"Line":0},"fn_name":null},{"line":306,"address":[5082106,5088465,5088448,5082411],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":309,"address":[5082511,5082785,5082709,5082388],"length":1,"stats":{"Line":0},"fn_name":null},{"line":311,"address":[5082686,5083244,5082806,5088192,5088211],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":312,"address":[5083324,5083170,5083459],"length":1,"stats":{"Line":0},"fn_name":null},{"line":313,"address":[5083541,5083429],"length":1,"stats":{"Line":0},"fn_name":null},{"line":315,"address":[5083680,5083957,5083875,5083579],"length":1,"stats":{"Line":0},"fn_name":null},{"line":316,"address":[5084366,5084274,5083997,5083868],"length":1,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[5084405,5086496,5084760,5084251],"length":1,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[5086494,5084849,5085070],"length":1,"stats":{"Line":0},"fn_name":null},{"line":321,"address":[5084940],"length":1,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[5085301,5084894,5085091,5085223],"length":1,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[5085193,5085322],"length":1,"stats":{"Line":0},"fn_name":null},{"line":326,"address":[5085360,5085636,5085449,5085712],"length":1,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[5085629,5086044,5085751,5086120],"length":1,"stats":{"Line":0},"fn_name":null},{"line":329,"address":[5086369,5086037,5086295,5086159],"length":1,"stats":{"Line":0},"fn_name":null},{"line":331,"address":[5086378,5086264],"length":1,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[5086869],"length":1,"stats":{"Line":0},"fn_name":null},{"line":336,"address":[5086677,5086517,5084722],"length":1,"stats":{"Line":0},"fn_name":null},{"line":337,"address":[5086619,5086759,5086969],"length":1,"stats":{"Line":0},"fn_name":null},{"line":340,"address":[5088128,5086903,5087049,5088147],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":341,"address":[5087087],"length":1,"stats":{"Line":0},"fn_name":null},{"line":343,"address":[5087255],"length":1,"stats":{"Line":0},"fn_name":null},{"line":344,"address":[5087144],"length":1,"stats":{"Line":0},"fn_name":null},{"line":345,"address":[5087159],"length":1,"stats":{"Line":0},"fn_name":null},{"line":346,"address":[5087175],"length":1,"stats":{"Line":0},"fn_name":null},{"line":348,"address":[5087215],"length":1,"stats":{"Line":0},"fn_name":null},{"line":352,"address":[5087389],"length":1,"stats":{"Line":0},"fn_name":null},{"line":354,"address":[5087426],"length":1,"stats":{"Line":0},"fn_name":null},{"line":358,"address":[5116657,5116324],"length":1,"stats":{"Line":0},"fn_name":null},{"line":360,"address":[5091021,5091044,5091251,5090912],"length":1,"stats":{"Line":0},"fn_name":null},{"line":362,"address":[5092852,5092848,5091507,5091300],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":363,"address":[5091744,5092816,5091573,5092820,5091492],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":365,"address":[5091733,5091814],"length":1,"stats":{"Line":0},"fn_name":null},{"line":367,"address":[5091829],"length":1,"stats":{"Line":0},"fn_name":null},{"line":368,"address":[5092033,5091867,5091944],"length":1,"stats":{"Line":0},"fn_name":null},{"line":369,"address":[5092048,5091927,5092899,5092880],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":371,"address":[5092394,5092063,5092461],"length":1,"stats":{"Line":0},"fn_name":null},{"line":373,"address":[5092330],"length":1,"stats":{"Line":0},"fn_name":null},{"line":375,"address":[5092485],"length":1,"stats":{"Line":0},"fn_name":null},{"line":377,"address":[5092516],"length":1,"stats":{"Line":0},"fn_name":null},{"line":387,"address":[4575869,4576404,4575776,4576288],"length":1,"stats":{"Line":4},"fn_name":"get_new_prices\u003cu32\u003e"},{"line":395,"address":[4576043,4575812,4576509,4575974,4576340,4576578],"length":1,"stats":{"Line":10},"fn_name":null},{"line":397,"address":[4575892,4575995,4576452,4575917,4576530,4576366,4575963,4575838,4576498,4576427],"length":1,"stats":{"Line":15},"fn_name":null},{"line":399,"address":[4576483,4575948,4576557,4576532,4575997,4576022],"length":1,"stats":{"Line":6},"fn_name":null},{"line":403,"address":[4576600,4576065],"length":1,"stats":{"Line":3},"fn_name":null},{"line":405,"address":[4576645,4576101],"length":1,"stats":{"Line":3},"fn_name":null},{"line":407,"address":[4576678,4576129],"length":1,"stats":{"Line":3},"fn_name":null},{"line":411,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":412,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":413,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":439,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":440,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":441,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":442,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":449,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":450,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":451,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":452,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":453,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":460,"address":[5497520],"length":1,"stats":{"Line":2},"fn_name":"get_curr_period_info"},{"line":465,"address":[5497705,5497763,5497569],"length":1,"stats":{"Line":2},"fn_name":null},{"line":466,"address":[5497785,5497670,5497875],"length":1,"stats":{"Line":4},"fn_name":null},{"line":468,"address":[5498039,5497860,5498084,5497954],"length":1,"stats":{"Line":6},"fn_name":null},{"line":470,"address":[4576964,4576960],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":471,"address":[5498290,5498069,5498248,5498163],"length":1,"stats":{"Line":6},"fn_name":null},{"line":473,"address":[4576992,4576996],"length":1,"stats":{"Line":5},"fn_name":"{{closure}}"},{"line":474,"address":[5498359,5498269],"length":1,"stats":{"Line":4},"fn_name":null},{"line":476,"address":[5498416,5498757],"length":1,"stats":{"Line":2},"fn_name":null},{"line":480,"address":[5498832],"length":1,"stats":{"Line":2},"fn_name":"get_period_change"},{"line":485,"address":[5498866,5499099],"length":1,"stats":{"Line":4},"fn_name":null},{"line":486,"address":[5499020,5499106],"length":1,"stats":{"Line":3},"fn_name":null},{"line":487,"address":[5499087,5499028,5498939],"length":1,"stats":{"Line":3},"fn_name":null},{"line":488,"address":[5499101],"length":1,"stats":{"Line":1},"fn_name":null},{"line":492,"address":[5500075,5499238,5499454],"length":1,"stats":{"Line":4},"fn_name":null},{"line":494,"address":[5499142],"length":1,"stats":{"Line":2},"fn_name":null},{"line":495,"address":[5499240,5499459],"length":1,"stats":{"Line":2},"fn_name":null},{"line":497,"address":[5499367],"length":1,"stats":{"Line":2},"fn_name":null},{"line":499,"address":[5499345],"length":1,"stats":{"Line":2},"fn_name":null},{"line":502,"address":[5499157],"length":1,"stats":{"Line":2},"fn_name":null},{"line":503,"address":[5499179,5499719,5499516],"length":1,"stats":{"Line":4},"fn_name":null},{"line":506,"address":[5500073,5499699,5499810],"length":1,"stats":{"Line":5},"fn_name":null},{"line":509,"address":[5499790],"length":1,"stats":{"Line":1},"fn_name":null},{"line":510,"address":[5499946,5499783],"length":1,"stats":{"Line":3},"fn_name":null},{"line":513,"address":[5499854],"length":1,"stats":{"Line":1},"fn_name":null},{"line":515,"address":[5499838],"length":1,"stats":{"Line":1},"fn_name":null},{"line":520,"address":[5500080,5499951,5499819,5500110],"length":1,"stats":{"Line":4},"fn_name":null},{"line":522,"address":[5499981],"length":1,"stats":{"Line":2},"fn_name":null},{"line":524,"address":[5499958],"length":1,"stats":{"Line":2},"fn_name":null},{"line":535,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":536,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":537,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":538,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":540,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":541,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":544,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":545,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":546,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":547,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":551,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":552,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":553,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":554,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":556,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":560,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":561,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":563,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":564,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":565,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":566,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":567,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":571,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":572,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":573,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":578,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":579,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":582,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":584,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":585,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":587,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":588,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":591,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":593,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":594,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":603,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":604,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":605,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":606,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":607,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":610,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":614,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":672,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":673,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":675,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":676,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":677,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":678,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":697,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":701,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":703,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":704,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":705,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":707,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":708,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":709,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":710,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":712,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":713,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":714,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":715,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":716,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":717,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":720,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":721,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":722,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":723,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":725,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":726,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":727,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":728,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":729,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":730,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":737,"address":[4583264],"length":1,"stats":{"Line":6},"fn_name":"cor\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":747,"address":[4583317],"length":1,"stats":{"Line":6},"fn_name":null},{"line":749,"address":[4583365,4584711,4583622,4583744,4583523,4585732],"length":1,"stats":{"Line":12},"fn_name":null},{"line":750,"address":[4583397,4583581],"length":1,"stats":{"Line":7},"fn_name":null},{"line":751,"address":[4583627],"length":1,"stats":{"Line":6},"fn_name":null},{"line":754,"address":[4583749],"length":1,"stats":{"Line":4},"fn_name":null},{"line":755,"address":[4583807],"length":1,"stats":{"Line":2},"fn_name":null},{"line":756,"address":[4583832],"length":1,"stats":{"Line":2},"fn_name":null},{"line":760,"address":[4583468],"length":1,"stats":{"Line":2},"fn_name":null},{"line":761,"address":[4583858],"length":1,"stats":{"Line":2},"fn_name":null},{"line":762,"address":[4583884],"length":1,"stats":{"Line":2},"fn_name":null},{"line":766,"address":[4583910],"length":1,"stats":{"Line":2},"fn_name":null},{"line":768,"address":[4584381,4584445,4584180],"length":1,"stats":{"Line":4},"fn_name":null},{"line":769,"address":[4584340,4584467],"length":1,"stats":{"Line":4},"fn_name":null},{"line":770,"address":[4584716,4584535],"length":1,"stats":{"Line":2},"fn_name":null},{"line":771,"address":[4584700],"length":1,"stats":{"Line":2},"fn_name":null},{"line":775,"address":[4584939],"length":1,"stats":{"Line":2},"fn_name":null},{"line":776,"address":[4584775],"length":1,"stats":{"Line":2},"fn_name":null},{"line":777,"address":[4583528,4584986],"length":1,"stats":{"Line":4},"fn_name":null},{"line":778,"address":[4584816],"length":1,"stats":{"Line":2},"fn_name":null},{"line":782,"address":[4583546,4585035],"length":1,"stats":{"Line":4},"fn_name":null},{"line":783,"address":[4584857],"length":1,"stats":{"Line":2},"fn_name":null},{"line":784,"address":[4584898],"length":1,"stats":{"Line":2},"fn_name":null},{"line":787,"address":[4585147,4585084],"length":1,"stats":{"Line":2},"fn_name":null},{"line":788,"address":[4585116,4585168],"length":1,"stats":{"Line":4},"fn_name":null},{"line":790,"address":[4585314],"length":1,"stats":{"Line":2},"fn_name":null},{"line":791,"address":[4585570,4585345],"length":1,"stats":{"Line":2},"fn_name":null},{"line":792,"address":[4585734,4585503,4585625],"length":1,"stats":{"Line":4},"fn_name":null},{"line":793,"address":[4585721],"length":1,"stats":{"Line":2},"fn_name":null},{"line":795,"address":[4583494],"length":1,"stats":{"Line":0},"fn_name":null},{"line":799,"address":[4585792,4585968],"length":1,"stats":{"Line":1},"fn_name":"financial_metrics\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":811,"address":[4586098,4586037,4585991,4585869],"length":1,"stats":{"Line":4},"fn_name":null},{"line":813,"address":[4586106,4586022],"length":1,"stats":{"Line":4},"fn_name":null},{"line":814,"address":[4586151],"length":1,"stats":{"Line":2},"fn_name":null},{"line":815,"address":[4586213,4592210],"length":1,"stats":{"Line":2},"fn_name":null},{"line":817,"address":[4586386,4586347,4586593,4586495],"length":1,"stats":{"Line":6},"fn_name":null},{"line":819,"address":[4586378,4592625,4592608],"length":1,"stats":{"Line":6},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":823,"address":[4586785,4586968,4586567,4587045],"length":1,"stats":{"Line":4},"fn_name":null},{"line":825,"address":[4587378,4590404,4586945,4587090],"length":1,"stats":{"Line":6},"fn_name":null},{"line":826,"address":[4587483,4587648],"length":1,"stats":{"Line":2},"fn_name":null},{"line":827,"address":[4587618,4587731],"length":1,"stats":{"Line":4},"fn_name":null},{"line":829,"address":[4587870,4588111,4587769,4588034],"length":1,"stats":{"Line":4},"fn_name":null},{"line":830,"address":[4588404,4588481,4588150,4588027],"length":1,"stats":{"Line":4},"fn_name":null},{"line":832,"address":[4588373],"length":1,"stats":{"Line":2},"fn_name":null},{"line":833,"address":[4588504],"length":1,"stats":{"Line":2},"fn_name":null},{"line":835,"address":[4588886,4588551,4590369],"length":1,"stats":{"Line":4},"fn_name":null},{"line":836,"address":[4588967,4589111,4590367],"length":1,"stats":{"Line":6},"fn_name":null},{"line":838,"address":[4589057],"length":1,"stats":{"Line":2},"fn_name":null},{"line":840,"address":[4589321,4589045,4589132,4589244],"length":1,"stats":{"Line":4},"fn_name":null},{"line":841,"address":[4589214,4589342],"length":1,"stats":{"Line":4},"fn_name":null},{"line":843,"address":[4589722,4589380,4589481,4589645],"length":1,"stats":{"Line":4},"fn_name":null},{"line":844,"address":[4590108,4589638,4590031,4589761],"length":1,"stats":{"Line":4},"fn_name":null},{"line":846,"address":[4590147,4590317,4590242,4590024],"length":1,"stats":{"Line":4},"fn_name":null},{"line":848,"address":[4590229],"length":1,"stats":{"Line":2},"fn_name":null},{"line":853,"address":[4590612,4590449,4590711,4587352],"length":1,"stats":{"Line":6},"fn_name":null},{"line":854,"address":[4592784,4592750,4592736,4592796],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":858,"address":[4590676,4590922,4590996,4590788],"length":1,"stats":{"Line":4},"fn_name":null},{"line":859,"address":[4591001,4590864,4591208],"length":1,"stats":{"Line":4},"fn_name":null},{"line":862,"address":[4591764],"length":1,"stats":{"Line":2},"fn_name":null},{"line":863,"address":[4591119],"length":1,"stats":{"Line":2},"fn_name":null},{"line":864,"address":[4591134],"length":1,"stats":{"Line":2},"fn_name":null},{"line":865,"address":[4591163,4592861,4591280,4592848],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":866,"address":[4591349,4591469,4592899,4592880],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":867,"address":[4592963,4592944,4591570,4591476],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":868,"address":[4591697,4591600,4593027,4593008],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":869,"address":[4591727],"length":1,"stats":{"Line":2},"fn_name":null},{"line":873,"address":[4593072],"length":1,"stats":{"Line":2},"fn_name":"latest_prices\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":879,"address":[4593086,4593217,4593200],"length":1,"stats":{"Line":6},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":880,"address":[4593229,4593289],"length":1,"stats":{"Line":4},"fn_name":null},{"line":882,"address":[4593152,4593161],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}\u003cfinancial_pallet::mock::Asset,substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":883,"address":[4593284],"length":1,"stats":{"Line":2},"fn_name":null},{"line":887,"address":[4593447,4593344],"length":1,"stats":{"Line":2},"fn_name":"weights\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":891,"address":[4593825,4593394,4593478,4593773],"length":1,"stats":{"Line":4},"fn_name":null},{"line":893,"address":[4593756,4594151,4593873,4594084],"length":1,"stats":{"Line":4},"fn_name":null},{"line":895,"address":[4594166,4594067,4594225],"length":1,"stats":{"Line":6},"fn_name":null},{"line":898,"address":[4594374,4594217,4594352],"length":1,"stats":{"Line":6},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":902,"address":[4594616,4594496],"length":1,"stats":{"Line":2},"fn_name":"portfolio_vol\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":907,"address":[4594538],"length":1,"stats":{"Line":2},"fn_name":null},{"line":908,"address":[4594641,4594789,4594737,4595567],"length":1,"stats":{"Line":2},"fn_name":null},{"line":910,"address":[4594707,4594813,4594911,4595046],"length":1,"stats":{"Line":6},"fn_name":null},{"line":912,"address":[4595664,4595698,4594797],"length":1,"stats":{"Line":6},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":915,"address":[4595390,4595132,4595452,4595526,4594983],"length":1,"stats":{"Line":4},"fn_name":null},{"line":917,"address":[4595888,4595480,4595892,4595362],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":921,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":922,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":923,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":924,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":930,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":931,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":932,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":933,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":934,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":935,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":936,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":943,"address":[5500112],"length":1,"stats":{"Line":2},"fn_name":"get_period_id_range"},{"line":948,"address":[5500273,5500154,5500332],"length":1,"stats":{"Line":2},"fn_name":null},{"line":949,"address":[5500248,5500475,5500344],"length":1,"stats":{"Line":4},"fn_name":null},{"line":950,"address":[4596020,4596016],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}"},{"line":951,"address":[5500852,5500699,5500770,5500619],"length":1,"stats":{"Line":6},"fn_name":null},{"line":953,"address":[5500751,5500691,5500854],"length":1,"stats":{"Line":5},"fn_name":null},{"line":955,"address":[5500794],"length":1,"stats":{"Line":1},"fn_name":null},{"line":961,"address":[4596048,4596160],"length":1,"stats":{"Line":7},"fn_name":"get_range_intersection2\u003ci32\u003e"},{"line":965,"address":[4596174,4596062],"length":1,"stats":{"Line":7},"fn_name":null},{"line":966,"address":[4596099,4596217],"length":1,"stats":{"Line":10},"fn_name":null},{"line":971,"address":[4596288,4596351,4596464,4596527],"length":1,"stats":{"Line":3},"fn_name":"get_range_intersection\u003ci32,core::slice::Iter\u003ccore::ops::range::Range\u003ci32\u003e\u003e\u003e"},{"line":976,"address":[4596960,4596308,4596484,4596656],"length":1,"stats":{"Line":9},"fn_name":"{{closure}}\u003cu64,core::slice::Iter\u003ccore::ops::range::Range\u003cu64\u003e\u003e\u003e"},{"line":977,"address":[4596977,4596738,4596682,4597152,4597034,4596879],"length":1,"stats":{"Line":16},"fn_name":null},{"line":978,"address":[4597058,4596766],"length":1,"stats":{"Line":6},"fn_name":null},{"line":979,"address":[4597139,4597071,4596781,4596865],"length":1,"stats":{"Line":10},"fn_name":null},{"line":980,"address":[4597146,4596872],"length":1,"stats":{"Line":2},"fn_name":null},{"line":982,"address":[4596805,4597095],"length":1,"stats":{"Line":4},"fn_name":null},{"line":985,"address":[4596886,4597158,4596713,4597014],"length":1,"stats":{"Line":16},"fn_name":null},{"line":989,"address":[4596542,4596363,4596405,4596592],"length":1,"stats":{"Line":6},"fn_name":null},{"line":990,"address":[4597252,4597220,4597216,4597248],"length":1,"stats":{"Line":6},"fn_name":"{{closure}}\u003ci32,core::slice::Iter\u003ccore::ops::range::Range\u003ci32\u003e\u003e\u003e"},{"line":991,"address":[4596400,4596584],"length":1,"stats":{"Line":3},"fn_name":null},{"line":996,"address":[5500912],"length":1,"stats":{"Line":6},"fn_name":"get_index_range"},{"line":997,"address":[5500943,5501615,5501050],"length":1,"stats":{"Line":16},"fn_name":null},{"line":998,"address":[5501000],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1000,"address":[5501176,5501217,5501102],"length":1,"stats":{"Line":10},"fn_name":null},{"line":1001,"address":[5501055,5500985],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1002,"address":[5501168],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1004,"address":[5501120],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1005,"address":[5501230,5501672,5501136],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1006,"address":[5501243,5501702,5501732],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1008,"address":[4597284,4597280],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}"},{"line":1009,"address":[4597312,4597316],"length":1,"stats":{"Line":16},"fn_name":"{{closure}}"},{"line":1010,"address":[5501567],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1018,"address":[4597399,4597344],"length":1,"stats":{"Line":1},"fn_name":"get_prices_for_common_periods\u003cfinancial_pallet::mock::Test\u003e"},{"line":1022,"address":[4597418,4597388],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1024,"address":[4597637,4597686,4597422],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1025,"address":[4597876,4597723,4597625,4597942],"length":1,"stats":{"Line":5},"fn_name":null},{"line":1028,"address":[4597858,4598149,4597947],"length":1,"stats":{"Line":5},"fn_name":null},{"line":1029,"address":[4598137,4598387,4598455,4598223],"length":1,"stats":{"Line":4},"fn_name":null},{"line":1032,"address":[4598465,4598370],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1034,"address":[4598638,4598510],"length":1,"stats":{"Line":6},"fn_name":null},{"line":1035,"address":[4598607,4598712],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1037,"address":[4598980,4598814,4598766,4598912],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1038,"address":[4598881,4599001],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1040,"address":[4599108,4599212,4599031,4599283],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1041,"address":[4599681,4599157,4599288],"length":1,"stats":{"Line":16},"fn_name":null},{"line":1044,"address":[4599406],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1052,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1056,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1057,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1059,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1060,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1061,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1063,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1064,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1066,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1070,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1075,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":1076,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1078,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1079,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1080,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1081,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1083,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1086,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1093,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":1094,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1096,"address":[],"length":0,"stats":{"Line":18},"fn_name":null},{"line":1097,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1098,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":1099,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1101,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":1102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1103,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":1104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1106,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":1108,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1111,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1116,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1118,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1119,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1120,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1123,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1124,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1125,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1126,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1128,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1130,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1132,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1134,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1136,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1139,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1141,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1143,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1146,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1152,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1154,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1155,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1156,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1159,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1160,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1161,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1162,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1164,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1166,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1168,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1170,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1172,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1175,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1177,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1178,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1179,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1181,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1182,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1183,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1184,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1185,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1187,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1188,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1189,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1190,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":307,"coverable":407},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","financial","src","math.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nuse core::ops::{AddAssign, BitOrAssign, ShlAssign};\nuse financial_primitives::CalcReturnType;\nuse substrate_fixed::traits::{Fixed, FixedSigned, ToFixed};\nuse substrate_fixed::transcendental::{exp, ln};\nuse substrate_fixed::types::I9F23;\n\n// Type of constants for transcendental operations declared in substrate_fixed crate\npub type ConstType = I9F23;\n\n#[derive(Debug, Eq, PartialEq, Clone, Copy)]\npub enum MathError {\n    Overflow,\n    DivisionByZero,\n    Transcendental,\n    NotEnoughPoints,\n    InvalidArgument,\n}\n\npub type MathResult\u003cT\u003e = Result\u003cT, MathError\u003e;\n\n/// Indicates the method for calculating correlations: `Regular` or `Exponential`.\n///\n/// * `Regular` type is a standard statistical approach of calculating Pearson correlation coefficient between\n/// two return series;\n/// * `Exponential` type uses exponentially weighted moving average\n/// to give more weights to most recent observations of pair of returns.\n///\n/// Note: correlations on lower periods are more susceptible to data noise and reflect actual\n/// dependencies between returns poorly. For robustness we recommend to use daily or weekly periods\n/// for correlations.\n#[derive(Copy, Clone)]\npub enum CalcCorrelationType {\n    /// Regular correlation type.\n    Regular,\n    /// Exponentially weighted correlation type.\n    Exponential(u32),\n}\n\npub fn calc_return\u003cF: Fixed\u003e(x1: F, x2: F) -\u003e Result\u003cF, MathError\u003e {\n    let ratio = x2.checked_div(x1).ok_or(MathError::DivisionByZero)?;\n\n    ratio.checked_sub(F::from_num(1)).ok_or(MathError::Overflow)\n}\n\npub fn calc_log_return\u003cF\u003e(x1: F, x2: F) -\u003e Result\u003cF, MathError\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    let ratio = x2.checked_div(x1).ok_or(MathError::DivisionByZero)?;\n    ln(ratio).map_err(|_| MathError::Transcendental)\n}\n\npub fn calc_return_func\u003cF\u003e(return_type: CalcReturnType) -\u003e impl Fn(F, F) -\u003e MathResult\u003cF\u003e + Copy\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    match return_type {\n        CalcReturnType::Regular =\u003e calc_return,\n        CalcReturnType::Log =\u003e calc_log_return,\n    }\n}\n\npub fn calc_return_iter\u003c'a, T: Copy, F: 'a + Fn(T, T) -\u003e MathResult\u003cT\u003e\u003e(\n    items: \u0026'a [T],\n    return_func: F,\n) -\u003e impl Iterator\u003cItem = MathResult\u003cT\u003e\u003e + 'a {\n    items.windows(2).map(move |x| return_func(x[0], x[1]))\n}\n\npub fn decay\u003cF: Fixed\u003e(ewma_length: u32) -\u003e MathResult\u003cF\u003e {\n    let nom = F::from_num(2);\n    let denom = F::from_num(1)\n        .checked_add(F::from_num(ewma_length))\n        .ok_or(MathError::Overflow)?;\n\n    nom.checked_div(denom).ok_or(MathError::DivisionByZero)\n}\n\nfn recurrent_ewma_step\u003cF: Fixed\u003e(\n    diff: MathResult\u003cF\u003e,\n    decay: F,\n    prev_var: MathResult\u003cF\u003e,\n) -\u003e MathResult\u003cF\u003e {\n    let diff = diff?;\n    let prev_var = prev_var?;\n\n    let a = diff.checked_mul(decay).ok_or(MathError::Overflow)?;\n    let b = F::from_num(1)\n        .checked_sub(decay)\n        .ok_or(MathError::Overflow)?;\n    let c = b.checked_mul(prev_var).ok_or(MathError::Overflow)?;\n\n    a.checked_add(c).ok_or(MathError::Overflow)\n}\n\npub fn last_recurrent_ewma\u003cF: Fixed, I: Iterator\u003cItem = MathResult\u003cF\u003e\u003e\u003e(\n    diffs: I,\n    decay: F,\n) -\u003e MathResult\u003cF\u003e {\n    diffs\n        .fold(None, move |state, diff| {\n            if let Some(prev_var) = state {\n                let var = recurrent_ewma_step(diff, decay, prev_var);\n                Some(var)\n            } else {\n                Some(diff)\n            }\n        })\n        .ok_or(MathError::NotEnoughPoints)\n        .and_then(|x| x)\n}\n\npub fn sum\u003c'a, F: 'a + Fixed, I: 'a + Iterator\u003cItem = MathResult\u003cF\u003e\u003e\u003e(\n    mut iter: I,\n) -\u003e MathResult\u003cF\u003e {\n    Ok(iter.try_fold(F::from_num(0), |acc, x| {\n        let x = x?;\n        acc.checked_add(x).ok_or(MathError::Overflow)\n    })?)\n}\n\npub fn mean\u003cF: Fixed\u003e(items: \u0026[F]) -\u003e MathResult\u003cF\u003e {\n    let sum = sum(items.iter().map(|\u0026x| Ok(x)))?;\n    sum.checked_div(F::from_num(items.len()))\n        .ok_or(MathError::DivisionByZero)\n}\n\npub fn demeaned\u003c'a, F: 'a + Fixed, I: 'a + Iterator\u003cItem = \u0026'a F\u003e\u003e(\n    iter: I,\n    mean: F,\n) -\u003e impl Iterator\u003cItem = MathResult\u003cF\u003e\u003e + 'a {\n    iter.map(move |\u0026x| x.checked_sub(mean).ok_or(MathError::Overflow))\n}\n\npub fn squared\u003c'a, F: 'a + Fixed, I: 'a + Iterator\u003cItem = MathResult\u003cF\u003e\u003e\u003e(\n    iter: I,\n) -\u003e impl Iterator\u003cItem = MathResult\u003cF\u003e\u003e + 'a {\n    iter.map(|x| x.and_then(|y| y.checked_mul(y).ok_or(MathError::Overflow)))\n}\n\npub fn regular_vola\u003cF: Fixed\u003e(n: usize, sum: F) -\u003e MathResult\u003cF\u003e {\n    let a = n.checked_sub(1).ok_or(MathError::Overflow)?;\n    let b = F::from_num(1)\n        .checked_div(F::from_num(a))\n        .ok_or(MathError::DivisionByZero)?;\n    let c = b.checked_mul(sum).ok_or(MathError::Overflow)?;\n    Ok(c)\n}\n\npub fn mul\u003c'a, F, I1, I2\u003e(iter1: I1, iter2: I2) -\u003e impl Iterator\u003cItem = MathResult\u003cF\u003e\u003e + 'a\nwhere\n    F: 'a + Fixed,\n    I1: 'a + Iterator\u003cItem = F\u003e,\n    I2: 'a + Iterator\u003cItem = F\u003e,\n{\n    iter1\n        .zip(iter2)\n        .map(|(x1, x2)| x1.checked_mul(x2).ok_or(MathError::Overflow))\n}\n\npub fn regular_corr\u003cF: Fixed\u003e(n: usize, sum: F, vol1: F, vol2: F) -\u003e MathResult\u003cF\u003e {\n    let a = n.checked_sub(1).ok_or(MathError::Overflow)?;\n    let b = F::from_num(1)\n        .checked_div(F::from_num(a))\n        .ok_or(MathError::DivisionByZero)?;\n    let c = b.checked_mul(sum).ok_or(MathError::Overflow)?;\n    let d = c.checked_div(vol1).ok_or(MathError::DivisionByZero)?;\n    let e = d.checked_div(vol2).ok_or(MathError::DivisionByZero)?;\n    Ok(e)\n}\n\npub fn exp_corr\u003cF: Fixed\u003e(covariance: F, vol1: F, vol2: F) -\u003e MathResult\u003cF\u003e {\n    let d = covariance\n        .checked_div(vol1)\n        .ok_or(MathError::DivisionByZero)?;\n    let e = d.checked_div(vol2).ok_or(MathError::DivisionByZero)?;\n    Ok(e)\n}\n\npub fn from_num\u003cF: Fixed\u003e(n: i8) -\u003e F {\n    F::from_num(n)\n}\n\npub fn covariance\u003c'a, F\u003e(\n    correlation_matrix: \u0026'a [F],\n    volatilities: \u0026'a [F],\n) -\u003e impl Iterator\u003cItem = MathResult\u003cF\u003e\u003e + 'a\nwhere\n    F: Fixed,\n{\n    volatilities\n        .iter()\n        .copied()\n        .flat_map(move |v1| volatilities.iter().map(move |v2| (v1, v2)))\n        .zip(correlation_matrix.iter())\n        .map(|((v1, \u0026v2), \u0026c)| {\n            v1.checked_mul(v2)\n                .and_then(|v1v2| v1v2.checked_mul(c))\n                .ok_or(MathError::Overflow)\n        })\n}\n\npub fn regular_value_at_risk\u003cF\u003e(\n    z_score: u32,\n    portfolio_volatility: F,\n    total_weighted_mean_return: F,\n) -\u003e MathResult\u003cF\u003e\nwhere\n    F: Fixed,\n{\n    let a = portfolio_volatility\n        .checked_mul(F::from_num(z_score))\n        .ok_or(MathError::Overflow)?;\n    a.checked_sub(total_weighted_mean_return)\n        .ok_or(MathError::Overflow)\n}\n\npub fn log_value_at_risk\u003cF\u003e(\n    z_score: u32,\n    portfolio_volatility: F,\n    total_weighted_mean_return: F,\n) -\u003e MathResult\u003cF\u003e\nwhere\n    F: FixedSigned + PartialOrd\u003cConstType\u003e + From\u003cConstType\u003e,\n    F::Bits: Copy + ToFixed + AddAssign + BitOrAssign + ShlAssign,\n{\n    let a = portfolio_volatility\n        .checked_mul(F::from_num(z_score))\n        .ok_or(MathError::Overflow)?;\n    let b = total_weighted_mean_return\n        .checked_sub(a)\n        .ok_or(MathError::Overflow)?;\n    let c = exp::\u003cF, F\u003e(b).map_err(|_| MathError::Transcendental)?;\n\n    F::from_num(1).checked_sub(c).ok_or(MathError::Overflow)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use approx::assert_abs_diff_eq;\n    use frame_support::assert_ok;\n    use substrate_fixed::traits::LossyInto;\n    use substrate_fixed::types::I64F64;\n\n    pub type FixedNumber = I64F64;\n\n    #[test]\n    fn squared_example() {\n        let diffs: Vec\u003c_\u003e = vec![\n            312.51, 121.18, 19.04, 109.93, 115.73, 11.46, 993.98, -142.49, 206.22, 123.83, -91.13,\n            15.18, 90.42, 265.69, 682.76, -108.85, -248.77, -837.47, -154.63, 202.68, 465.51,\n            463.73, -405.52, 48.81, 293.73, 55.83, 2.47, -206.06, -441.22,\n        ]\n        .into_iter()\n        .map(|x| Ok(FixedNumber::from_num(x)))\n        .collect();\n\n        let actual: MathResult\u003cVec\u003c_\u003e\u003e = squared(diffs.into_iter()).collect();\n        assert_ok!(\u0026actual);\n        let actual: Vec\u003cf64\u003e = actual\n            .unwrap()\n            .into_iter()\n            .map(|x| x.lossy_into())\n            .collect();\n\n        let expected: Vec\u003c_\u003e = vec![\n            97662.5001000001,\n            14684.5923999999,\n            362.5216000000,\n            12084.6049000001,\n            13393.4329000001,\n            131.3316000000,\n            987996.2404000010,\n            20303.4001000005,\n            42526.6884000005,\n            15333.8689000000,\n            8304.6769000002,\n            230.4324000000,\n            8175.7764000000,\n            70591.1761000003,\n            466161.2176000000,\n            11848.3225000001,\n            61886.5129000002,\n            701356.0008999990,\n            23910.4369000003,\n            41079.1824000001,\n            216699.5601000000,\n            215045.5129000000,\n            164446.4703999990,\n            2382.4161000000,\n            86277.3128999997,\n            3116.9889000000,\n            6.1009000000,\n            42460.7236000005,\n            194675.0883999990,\n        ];\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    }\n\n    #[test]\n    fn last_recurrent_ewma_example() {\n        let squared_diffs: Vec\u003c_\u003e = vec![\n            97662.50010000010000,\n            14684.59239999990000,\n            362.52159999999900,\n            12084.60490000010000,\n            13393.43290000010000,\n            131.33160000000100,\n            987996.24040000100000,\n            20303.40010000050000,\n            42526.68840000050000,\n            15333.86890000000000,\n            8304.67690000019000,\n            230.43240000000900,\n            8175.77640000001000,\n            70591.17610000030000,\n            466161.21760000000000,\n            11848.32250000010000,\n            61886.51290000020000,\n            701356.00089999900000,\n            23910.43690000030000,\n            41079.18240000010000,\n            216699.56010000000000,\n            215045.51290000000000,\n            164446.47039999900000,\n            2382.41609999995000,\n            86277.31289999970000,\n            3116.98889999999000,\n            6.10090000000575,\n            42460.72360000050000,\n            194675.08839999900000,\n        ]\n        .into_iter()\n        .map(|x| Ok(FixedNumber::from_num(x)))\n        .collect();\n        let decay = FixedNumber::from_num(0.0540540540540541);\n\n        let actual = last_recurrent_ewma(squared_diffs.into_iter(), decay);\n        assert_ok!(\u0026actual);\n        let actual: f64 = actual.unwrap().lossy_into();\n\n        let expected = 114954.3177623650;\n        assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n    }\n\n    #[test]\n    fn recurrent_ewma_step_example() {\n        let diff = Ok(FixedNumber::from_num(14684.59239999990000));\n        let decay = FixedNumber::from_num(0.0540540540540541);\n        let prev_var = Ok(FixedNumber::from_num(97662.5001000001));\n        let actual = recurrent_ewma_step(diff, decay, prev_var);\n        assert_ok!(\u0026actual);\n        let actual: f64 = actual.unwrap().lossy_into();\n        let expected = 93177.2077918920;\n\n        assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n    }\n\n    #[cfg(test)]\n    mod recurrent_ewma_step {\n        use super::super::*;\n        use super::FixedNumber;\n        use approx::assert_abs_diff_eq;\n        use frame_support::assert_ok;\n        use substrate_fixed::traits::LossyInto;\n\n        #[test]\n        fn recurrent_ewma_step_diff_is_zero() {\n            let diff = Ok(FixedNumber::from_num(0));\n            let decay = FixedNumber::from_num(0.054);\n            let prev_var = Ok(FixedNumber::from_num(9762.51));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            assert_ok!(\u0026actual);\n            let actual: f64 = actual.unwrap().lossy_into();\n            let expected = 9235.33446;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn recurrent_ewma_step_mul_overflow() {\n            let diff = Ok(FixedNumber::max_value());\n            let decay = FixedNumber::from_num(2);\n            let prev_var = Ok(FixedNumber::from_num(9762.51));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            let expected = Err(MathError::Overflow);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn recurrent_ewma_step_add_overflow() {\n            let diff = Ok(FixedNumber::from_num(2));\n            let decay = FixedNumber::max_value();\n            let prev_var = Ok(FixedNumber::from_num(9762.51));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            let expected = Err(MathError::Overflow);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn recurrent_ewma_step_valid_negative() {\n            let diff = Ok(FixedNumber::from_num(-0.051));\n            let decay = FixedNumber::from_num(-0.054);\n            let prev_var = Ok(FixedNumber::from_num(-976.51));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            assert_ok!(\u0026actual);\n            let actual: f64 = actual.unwrap().lossy_into();\n            let expected = -1029.238786;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn recurrent_ewma_step_valid_zero() {\n            let diff = Ok(FixedNumber::from_num(0.0));\n            let decay = FixedNumber::from_num(0.0);\n            let prev_var = Ok(FixedNumber::from_num(0.0));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            assert_ok!(\u0026actual);\n            let actual: f64 = actual.unwrap().lossy_into();\n            let expected = 0.0;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn recurrent_ewma_step_example() {\n            let diff = Ok(FixedNumber::from_num(14684.59239999990000));\n            let decay = FixedNumber::from_num(0.0540540540540541);\n            let prev_var = Ok(FixedNumber::from_num(97662.5001000001));\n            let actual = recurrent_ewma_step(diff, decay, prev_var);\n            assert_ok!(\u0026actual);\n            let actual: f64 = actual.unwrap().lossy_into();\n            let expected = 93177.2077918920;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n    }\n\n    #[cfg(test)]\n    mod decay {\n        use super::super::*;\n        use super::FixedNumber;\n        use approx::assert_abs_diff_eq;\n        use frame_support::assert_ok;\n        use substrate_fixed::traits::LossyInto;\n\n        #[test]\n        fn decay_zero() {\n            let actual = decay(0);\n            assert_ok!(actual);\n            let actual: FixedNumber = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 2.0;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn decay_simple() {\n            let actual = decay(1);\n            assert_ok!(actual);\n            let actual: FixedNumber = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 1.0;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn decay_expample() {\n            let actual = decay(36);\n            assert_ok!(actual);\n            let actual: FixedNumber = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.05405405405;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n    }\n\n    #[cfg(test)]\n    mod calc_return {\n        use super::super::*;\n        use super::FixedNumber;\n        use approx::assert_abs_diff_eq;\n        use frame_support::assert_ok;\n        use substrate_fixed::traits::LossyInto;\n\n        #[test]\n        fn calc_return_valid() {\n            let x1 = FixedNumber::from_num(8);\n            let x2 = FixedNumber::from_num(6);\n            let actual = calc_return(x1, x2);\n            let expected = Ok(FixedNumber::from_num(-0.25));\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_return_valid_positive() {\n            let x1 = FixedNumber::from_num(8);\n            let x2 = FixedNumber::from_num(10);\n            let actual = calc_return(x1, x2);\n            let expected = Ok(FixedNumber::from_num(0.25));\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_return_x1_is_zero() {\n            let x1 = FixedNumber::from_num(0);\n            let x2 = FixedNumber::from_num(6);\n            let actual = calc_return(x1, x2);\n            let expected = Err(MathError::DivisionByZero);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_log_return_valid() {\n            let x1 = FixedNumber::from_num(8);\n            let x2 = FixedNumber::from_num(6);\n            let actual: f64 = calc_log_return(x1, x2).unwrap().lossy_into();\n            let expected = -0.287682072452;\n\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        }\n\n        #[test]\n        fn calc_log_return_x1_is_zero() {\n            let x1 = FixedNumber::from_num(0);\n            let x2 = FixedNumber::from_num(6);\n            let actual = calc_log_return(x1, x2);\n            let expected = Err(MathError::DivisionByZero);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_log_return_x1_is_negative() {\n            let x1 = FixedNumber::from_num(-3);\n            let x2 = FixedNumber::from_num(6);\n            let actual = calc_log_return(x1, x2);\n            let expected = Err(MathError::Transcendental);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_return_iter_empty() {\n            let prices: Vec\u003cFixedNumber\u003e = Vec::new();\n            let func = calc_return_func(CalcReturnType::Regular);\n\n            let actual: MathResult\u003cVec\u003cFixedNumber\u003e\u003e = calc_return_iter(\u0026prices, func).collect();\n            let expected = Ok(vec![]);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_return_vec_one_item() {\n            let prices: Vec\u003cFixedNumber\u003e =\n                vec![1.5].into_iter().map(FixedNumber::from_num).collect();\n            let func = calc_return_func(CalcReturnType::Regular);\n\n            let actual: MathResult\u003cVec\u003cFixedNumber\u003e\u003e = calc_return_iter(\u0026prices, func).collect();\n            let expected = Ok(vec![]);\n\n            assert_eq!(actual, expected);\n        }\n\n        #[test]\n        fn calc_return_vec_regular_valid() {\n            let prices: Vec\u003cFixedNumber\u003e = vec![\n                7_117.21, 7_429.72, 7_550.90, 7_569.94, 7_679.87, 7_795.60, 7_807.06, 8_801.04,\n                8_658.55, 8_864.77,\n            ]\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n            let func = calc_return_func(CalcReturnType::Regular);\n\n            let actual: MathResult\u003cVec\u003cFixedNumber\u003e\u003e = calc_return_iter(\u0026prices, func).collect();\n            assert_ok!(\u0026actual);\n            let actual: Vec\u003cf64\u003e = actual\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n\n            let expected: Vec\u003cf64\u003e = vec![\n                0.04390906,\n                0.01631017,\n                0.00252155,\n                0.01452191,\n                0.01506927,\n                0.00147006,\n                0.12731809,\n                -0.01619013,\n                0.02381692,\n            ];\n\n            assert_eq!(actual.len(), expected.len());\n            for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n                assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n            }\n        }\n\n        #[test]\n        fn calc_return_vec_log_valid() {\n            let prices: Vec\u003cFixedNumber\u003e = vec![\n                7_117.21, 7_429.72, 7_550.90, 7_569.94, 7_679.87, 7_795.60, 7_807.06, 8_801.04,\n                8_658.55, 8_864.77,\n            ]\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n            let func = calc_return_func(CalcReturnType::Log);\n\n            let actual: MathResult\u003cVec\u003cFixedNumber\u003e\u003e = calc_return_iter(\u0026prices, func).collect();\n            assert_ok!(\u0026actual);\n            let actual: Vec\u003cf64\u003e = actual\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n\n            let expected: Vec\u003cf64\u003e = vec![\n                0.042972378,\n                0.016178588,\n                0.002518380,\n                0.014417479,\n                0.014956852,\n                0.001468981,\n                0.119841444,\n                -0.016322624,\n                0.023537722,\n            ];\n\n            assert_eq!(actual.len(), expected.len());\n            for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n                assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n            }\n        }\n    }\n}\n","traces":[{"line":54,"address":[5370528],"length":1,"stats":{"Line":3},"fn_name":"calc_return\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":55,"address":[5370839,5370575,5370790],"length":1,"stats":{"Line":4},"fn_name":null},{"line":57,"address":[5370869,5370758],"length":1,"stats":{"Line":4},"fn_name":null},{"line":60,"address":[5370944],"length":1,"stats":{"Line":1},"fn_name":"calc_log_return\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":65,"address":[5370991,5371239,5371190],"length":1,"stats":{"Line":2},"fn_name":null},{"line":66,"address":[5371280,5371162,5371269,5371284],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":69,"address":[5371312],"length":1,"stats":{"Line":4},"fn_name":"calc_return_func\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":74,"address":[5371351],"length":1,"stats":{"Line":1},"fn_name":null},{"line":75,"address":[5371325,5371355],"length":1,"stats":{"Line":7},"fn_name":null},{"line":76,"address":[5371339],"length":1,"stats":{"Line":1},"fn_name":null},{"line":80,"address":[5371462,5371392],"length":1,"stats":{"Line":3},"fn_name":"calc_return_iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,fn(substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e) -\u003e core::result::Result\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, financial_pallet::math::MathError\u003e\u003e"},{"line":84,"address":[5371580,5371474,5371414,5371552],"length":1,"stats":{"Line":11},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,fn(substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e) -\u003e core::result::Result\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, financial_pallet::math::MathError\u003e\u003e"},{"line":87,"address":[5371824],"length":1,"stats":{"Line":2},"fn_name":"decay\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":88,"address":[5371854],"length":1,"stats":{"Line":2},"fn_name":null},{"line":90,"address":[5371926],"length":1,"stats":{"Line":2},"fn_name":null},{"line":91,"address":[5371981,5372153,5372206,5372049],"length":1,"stats":{"Line":4},"fn_name":null},{"line":93,"address":[5372126,5372216],"length":1,"stats":{"Line":4},"fn_name":null},{"line":96,"address":[5372272],"length":1,"stats":{"Line":7},"fn_name":"recurrent_ewma_step\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":101,"address":[5372298,5372549,5372613],"length":1,"stats":{"Line":7},"fn_name":null},{"line":102,"address":[5372625,5372475,5372777],"length":1,"stats":{"Line":14},"fn_name":null},{"line":104,"address":[5373017,5372838,5372735],"length":1,"stats":{"Line":14},"fn_name":null},{"line":107,"address":[5373118,5373186,5373299],"length":1,"stats":{"Line":10},"fn_name":null},{"line":108,"address":[5373525,5373352,5373253],"length":1,"stats":{"Line":8},"fn_name":null},{"line":110,"address":[5373500,5373578],"length":1,"stats":{"Line":10},"fn_name":null},{"line":113,"address":[5374000,5373632,5373824],"length":1,"stats":{"Line":7},"fn_name":"last_recurrent_ewma\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Map\u003ccore::iter::adapters::zip::Zip\u003ccore::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e, core::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e\u003e, closure-0\u003e\u003e"},{"line":117,"address":[5373771,5373948,5373850,5374103,5374057,5373888,5373708,5373658],"length":1,"stats":{"Line":17},"fn_name":null},{"line":118,"address":[5374544,5373684,5374160,5373867,5374928,5374042],"length":1,"stats":{"Line":14},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,alloc::vec::IntoIter\u003ccore::result::Result\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, financial_pallet::math::MathError\u003e\u003e\u003e"},{"line":119,"address":[5374700,5374568,5374952,5374184,5374316,5375084],"length":1,"stats":{"Line":13},"fn_name":null},{"line":120,"address":[5375116,5374348,5374732],"length":1,"stats":{"Line":7},"fn_name":null},{"line":121,"address":[5374438,5375206,5374822],"length":1,"stats":{"Line":7},"fn_name":null},{"line":123,"address":[5374625,5374241,5375009],"length":1,"stats":{"Line":7},"fn_name":null},{"line":126,"address":[5373940,5373763,5374098],"length":1,"stats":{"Line":7},"fn_name":null},{"line":127,"address":[5375348,5375380,5375376,5375316,5375344,5375312],"length":1,"stats":{"Line":14},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Map\u003ccore::iter::adapters::zip::Zip\u003ccore::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e, core::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e\u003e, closure-0\u003e\u003e"},{"line":130,"address":[5376464,5375936,5376720,5375731,5376771,5375987,5376510,5375408,5376192,5375680,5375454,5376238],"length":1,"stats":{"Line":19},"fn_name":"sum\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Map\u003ccore::iter::adapters::zip::Zip\u003calloc::vec::IntoIter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e, alloc::vec::IntoIter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e, closure-0\u003e\u003e"},{"line":133,"address":[5375515,5375707,5376889,5376019,5375425,5377264,5375805,5376584,5376322,5376481,5377840,5376105,5376270,5376376,5375763,5376061,5376561,5375849,5378128,5376209,5375963,5375782,5376747,5375486,5377552,5376299,5376542,5378416,5376822,5375592,5376845,5376803,5375538,5376628,5376038,5376976],"length":1,"stats":{"Line":95},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Map\u003ccore::iter::adapters::zip::Zip\u003calloc::vec::IntoIter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e, core::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e\u003e, closure-0\u003e\u003e"},{"line":134,"address":[5378316,5378604,5377213,5377871,5378653,5377295,5377740,5378159,5377007,5377789,5378077,5378447,5378028,5377501,5377452,5377164,5377583,5378365],"length":1,"stats":{"Line":19},"fn_name":null},{"line":135,"address":[5377511,5377715,5377223,5378003,5377427,5377799,5377139,5378375,5378291,5378663,5378087,5378579],"length":1,"stats":{"Line":38},"fn_name":null},{"line":139,"address":[5378704],"length":1,"stats":{"Line":8},"fn_name":"mean\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":140,"address":[5379120,5378942,5378738,5379136,5378997],"length":1,"stats":{"Line":24},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":141,"address":[5379074,5379012,5378930],"length":1,"stats":{"Line":24},"fn_name":null},{"line":142,"address":[5379066],"length":1,"stats":{"Line":8},"fn_name":null},{"line":145,"address":[5379184],"length":1,"stats":{"Line":8},"fn_name":"demeaned\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e"},{"line":149,"address":[5379264,5379211,5379281],"length":1,"stats":{"Line":24},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e"},{"line":152,"address":[5379408,5379488],"length":1,"stats":{"Line":9},"fn_name":"squared\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,alloc::vec::IntoIter\u003ccore::result::Result\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, financial_pallet::math::MathError\u003e\u003e\u003e"},{"line":155,"address":[5379686,5379804,5379856,5379558,5379664,5379868,5379415,5379792,5379502,5379536],"length":1,"stats":{"Line":33},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Map\u003ccore::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e, fn(substrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e) -\u003e core::result::Result\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e, financial_pallet::math::MathError\u003e\u003e\u003e"},{"line":158,"address":[5379920],"length":1,"stats":{"Line":4},"fn_name":"regular_vola\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":159,"address":[5379962,5380197,5380139],"length":1,"stats":{"Line":4},"fn_name":null},{"line":161,"address":[5380214],"length":1,"stats":{"Line":4},"fn_name":null},{"line":162,"address":[5380269,5380450,5380337],"length":1,"stats":{"Line":8},"fn_name":null},{"line":163,"address":[5380503,5380662,5380404],"length":1,"stats":{"Line":8},"fn_name":null},{"line":164,"address":[5380646],"length":1,"stats":{"Line":4},"fn_name":null},{"line":167,"address":[5380960,5380880,5380720],"length":1,"stats":{"Line":5},"fn_name":"mul\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,alloc::vec::IntoIter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e,alloc::vec::IntoIter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e"},{"line":173,"address":[5380983,5380907,5380730,5380812],"length":1,"stats":{"Line":8},"fn_name":null},{"line":174,"address":[5380765],"length":1,"stats":{"Line":1},"fn_name":null},{"line":175,"address":[5381072,5381104,5381360,5381216,5381248,5381392],"length":1,"stats":{"Line":10},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e,core::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e,core::iter::adapters::Copied\u003ccore::slice::Iter\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e\u003e\u003e"},{"line":178,"address":[5381504],"length":1,"stats":{"Line":2},"fn_name":"regular_corr\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":179,"address":[5381808,5381872,5381578],"length":1,"stats":{"Line":2},"fn_name":null},{"line":181,"address":[5381892],"length":1,"stats":{"Line":3},"fn_name":null},{"line":182,"address":[5382146,5382033,5381965],"length":1,"stats":{"Line":8},"fn_name":null},{"line":183,"address":[5382100,5382378,5382199],"length":1,"stats":{"Line":10},"fn_name":null},{"line":184,"address":[5382334,5382433,5382612],"length":1,"stats":{"Line":10},"fn_name":null},{"line":185,"address":[5382667,5382826,5382568],"length":1,"stats":{"Line":7},"fn_name":null},{"line":186,"address":[5382810],"length":1,"stats":{"Line":2},"fn_name":null},{"line":189,"address":[5382880],"length":1,"stats":{"Line":2},"fn_name":"exp_corr\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":190,"address":[5382951,5383006,5383073,5383153],"length":1,"stats":{"Line":6},"fn_name":null},{"line":192,"address":[5383057,5382998,5383155,5383202],"length":1,"stats":{"Line":4},"fn_name":null},{"line":193,"address":[5383115,5383214,5383370],"length":1,"stats":{"Line":4},"fn_name":null},{"line":194,"address":[5383354],"length":1,"stats":{"Line":2},"fn_name":null},{"line":197,"address":[5383424],"length":1,"stats":{"Line":6},"fn_name":"from_num\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":198,"address":[5383433],"length":1,"stats":{"Line":6},"fn_name":null},{"line":201,"address":[5383472],"length":1,"stats":{"Line":2},"fn_name":"covariance\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":208,"address":[5383519,5383616,5383679],"length":1,"stats":{"Line":6},"fn_name":null},{"line":211,"address":[5383830,5383595,5383758,5383808,5383744],"length":1,"stats":{"Line":10},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":212,"address":[5383665],"length":1,"stats":{"Line":2},"fn_name":null},{"line":213,"address":[5384016,5384031],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":214,"address":[5384155,5384200,5384104],"length":1,"stats":{"Line":6},"fn_name":null},{"line":215,"address":[5383955,5384150,5383936],"length":1,"stats":{"Line":6},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":216,"address":[5384195],"length":1,"stats":{"Line":2},"fn_name":null},{"line":220,"address":[5384256],"length":1,"stats":{"Line":1},"fn_name":"regular_value_at_risk\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":228,"address":[5384473,5384372,5384559,5384400],"length":1,"stats":{"Line":3},"fn_name":null},{"line":229,"address":[5384310],"length":1,"stats":{"Line":1},"fn_name":null},{"line":230,"address":[5384561,5384392,5384608,5384457],"length":1,"stats":{"Line":2},"fn_name":null},{"line":231,"address":[5384521,5384626],"length":1,"stats":{"Line":2},"fn_name":null},{"line":232,"address":[5384618],"length":1,"stats":{"Line":1},"fn_name":null},{"line":235,"address":[5384672],"length":1,"stats":{"Line":0},"fn_name":"log_value_at_risk\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":244,"address":[5385038,5384949,5384824,5384861],"length":1,"stats":{"Line":0},"fn_name":null},{"line":245,"address":[5384729],"length":1,"stats":{"Line":0},"fn_name":null},{"line":246,"address":[5384930,5385096,5384853,5385040],"length":1,"stats":{"Line":0},"fn_name":null},{"line":247,"address":[5385195,5385116,5385271,5385013],"length":1,"stats":{"Line":0},"fn_name":null},{"line":249,"address":[5385176,5385273,5385108],"length":1,"stats":{"Line":0},"fn_name":null},{"line":250,"address":[5385349,5385243,5385636,5385632,5385474],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003csubstrate_fixed::FixedI128\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UInt\u003ctypenum::uint::UTerm, typenum::bit::B1\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e, typenum::bit::B0\u003e\u003e\u003e"},{"line":266,"address":[5123102,5122352],"length":1,"stats":{"Line":3},"fn_name":"squared_example"},{"line":267,"address":[5123117,5122364],"length":1,"stats":{"Line":2},"fn_name":null},{"line":273,"address":[5721468,5721440],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":276,"address":[5123180],"length":1,"stats":{"Line":1},"fn_name":null},{"line":277,"address":[5123299],"length":1,"stats":{"Line":1},"fn_name":null},{"line":278,"address":[5123556],"length":1,"stats":{"Line":1},"fn_name":null},{"line":281,"address":[5721539,5721520],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":284,"address":[5123713,5124204],"length":1,"stats":{"Line":2},"fn_name":null},{"line":315,"address":[5124212,5124464],"length":1,"stats":{"Line":1},"fn_name":null},{"line":316,"address":[5125082,5126295,5124833,5124398,5125047,5125321],"length":1,"stats":{"Line":4},"fn_name":null},{"line":317,"address":[5125164,5125326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":322,"address":[5127158,5126432],"length":1,"stats":{"Line":3},"fn_name":"last_recurrent_ewma_example"},{"line":323,"address":[5126444,5127173],"length":1,"stats":{"Line":2},"fn_name":null},{"line":355,"address":[5721628,5721600],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":357,"address":[5127252],"length":1,"stats":{"Line":1},"fn_name":null},{"line":359,"address":[5127307],"length":1,"stats":{"Line":1},"fn_name":null},{"line":360,"address":[5127409],"length":1,"stats":{"Line":1},"fn_name":null},{"line":361,"address":[5127666],"length":1,"stats":{"Line":1},"fn_name":null},{"line":363,"address":[5127796],"length":1,"stats":{"Line":1},"fn_name":null},{"line":364,"address":[5127812,5127990],"length":1,"stats":{"Line":1},"fn_name":null},{"line":368,"address":[5128880],"length":1,"stats":{"Line":3},"fn_name":"recurrent_ewma_step_example"},{"line":369,"address":[5128902],"length":1,"stats":{"Line":1},"fn_name":null},{"line":370,"address":[5128971],"length":1,"stats":{"Line":1},"fn_name":null},{"line":371,"address":[5129022],"length":1,"stats":{"Line":1},"fn_name":null},{"line":372,"address":[5129083],"length":1,"stats":{"Line":1},"fn_name":null},{"line":373,"address":[5129224],"length":1,"stats":{"Line":1},"fn_name":null},{"line":374,"address":[5129502],"length":1,"stats":{"Line":1},"fn_name":null},{"line":375,"address":[5129620],"length":1,"stats":{"Line":1},"fn_name":null},{"line":377,"address":[5129629,5129810],"length":1,"stats":{"Line":1},"fn_name":null},{"line":389,"address":[4687008,4687013],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":390,"address":[5693648],"length":1,"stats":{"Line":1},"fn_name":null},{"line":391,"address":[5693717],"length":1,"stats":{"Line":1},"fn_name":null},{"line":392,"address":[5693768],"length":1,"stats":{"Line":1},"fn_name":null},{"line":393,"address":[5693829],"length":1,"stats":{"Line":1},"fn_name":null},{"line":394,"address":[5693970],"length":1,"stats":{"Line":1},"fn_name":null},{"line":395,"address":[5694248],"length":1,"stats":{"Line":1},"fn_name":null},{"line":396,"address":[5694366],"length":1,"stats":{"Line":1},"fn_name":null},{"line":398,"address":[5694556,5694375],"length":1,"stats":{"Line":1},"fn_name":null},{"line":402,"address":[4687040,4687045],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":403,"address":[5695191],"length":1,"stats":{"Line":1},"fn_name":null},{"line":404,"address":[5695245],"length":1,"stats":{"Line":1},"fn_name":null},{"line":405,"address":[5695290],"length":1,"stats":{"Line":1},"fn_name":null},{"line":406,"address":[5695339],"length":1,"stats":{"Line":1},"fn_name":null},{"line":407,"address":[5695474],"length":1,"stats":{"Line":1},"fn_name":null},{"line":409,"address":[5695611,5695504],"length":1,"stats":{"Line":1},"fn_name":null},{"line":413,"address":[4687072,4687077],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":414,"address":[5695911],"length":1,"stats":{"Line":1},"fn_name":null},{"line":415,"address":[5695965],"length":1,"stats":{"Line":1},"fn_name":null},{"line":416,"address":[5696010],"length":1,"stats":{"Line":1},"fn_name":null},{"line":417,"address":[5696059],"length":1,"stats":{"Line":1},"fn_name":null},{"line":418,"address":[5696194],"length":1,"stats":{"Line":1},"fn_name":null},{"line":420,"address":[5696331,5696224],"length":1,"stats":{"Line":1},"fn_name":null},{"line":424,"address":[4687104,4687109],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":425,"address":[5696646],"length":1,"stats":{"Line":1},"fn_name":null},{"line":426,"address":[5696715],"length":1,"stats":{"Line":1},"fn_name":null},{"line":427,"address":[5696766],"length":1,"stats":{"Line":1},"fn_name":null},{"line":428,"address":[5696827],"length":1,"stats":{"Line":1},"fn_name":null},{"line":429,"address":[5696968],"length":1,"stats":{"Line":1},"fn_name":null},{"line":430,"address":[5697246],"length":1,"stats":{"Line":1},"fn_name":null},{"line":431,"address":[5697364],"length":1,"stats":{"Line":1},"fn_name":null},{"line":433,"address":[5697373,5697554],"length":1,"stats":{"Line":1},"fn_name":null},{"line":437,"address":[4687136,4687141],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":438,"address":[5698206],"length":1,"stats":{"Line":1},"fn_name":null},{"line":439,"address":[5698273],"length":1,"stats":{"Line":1},"fn_name":null},{"line":440,"address":[5698316],"length":1,"stats":{"Line":1},"fn_name":null},{"line":441,"address":[5698380],"length":1,"stats":{"Line":1},"fn_name":null},{"line":442,"address":[5698521],"length":1,"stats":{"Line":1},"fn_name":null},{"line":443,"address":[5698799],"length":1,"stats":{"Line":1},"fn_name":null},{"line":444,"address":[5698909],"length":1,"stats":{"Line":1},"fn_name":null},{"line":446,"address":[5698921,5699102],"length":1,"stats":{"Line":1},"fn_name":null},{"line":450,"address":[4687173,4687168],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":451,"address":[5699766],"length":1,"stats":{"Line":1},"fn_name":null},{"line":452,"address":[5699835],"length":1,"stats":{"Line":1},"fn_name":null},{"line":453,"address":[5699886],"length":1,"stats":{"Line":1},"fn_name":null},{"line":454,"address":[5699947],"length":1,"stats":{"Line":1},"fn_name":null},{"line":455,"address":[5700088],"length":1,"stats":{"Line":1},"fn_name":null},{"line":456,"address":[5700366],"length":1,"stats":{"Line":1},"fn_name":null},{"line":457,"address":[5700484],"length":1,"stats":{"Line":1},"fn_name":null},{"line":459,"address":[5700493,5700674],"length":1,"stats":{"Line":1},"fn_name":null},{"line":472,"address":[4625168,4625173],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":473,"address":[5726336],"length":1,"stats":{"Line":1},"fn_name":null},{"line":474,"address":[5726349],"length":1,"stats":{"Line":1},"fn_name":null},{"line":475,"address":[5726649],"length":1,"stats":{"Line":1},"fn_name":null},{"line":476,"address":[5726755],"length":1,"stats":{"Line":1},"fn_name":null},{"line":477,"address":[5726777],"length":1,"stats":{"Line":1},"fn_name":null},{"line":479,"address":[5726967,5726786],"length":1,"stats":{"Line":1},"fn_name":null},{"line":483,"address":[4625200,4625205],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":484,"address":[5727614],"length":1,"stats":{"Line":1},"fn_name":null},{"line":485,"address":[5727632],"length":1,"stats":{"Line":1},"fn_name":null},{"line":486,"address":[5727932],"length":1,"stats":{"Line":1},"fn_name":null},{"line":487,"address":[5728038],"length":1,"stats":{"Line":1},"fn_name":null},{"line":488,"address":[5728060],"length":1,"stats":{"Line":1},"fn_name":null},{"line":490,"address":[5728250,5728069],"length":1,"stats":{"Line":1},"fn_name":null},{"line":494,"address":[4625237,4625232],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":495,"address":[5728894],"length":1,"stats":{"Line":1},"fn_name":null},{"line":496,"address":[5728912],"length":1,"stats":{"Line":1},"fn_name":null},{"line":497,"address":[5729212],"length":1,"stats":{"Line":1},"fn_name":null},{"line":498,"address":[5729318],"length":1,"stats":{"Line":1},"fn_name":null},{"line":499,"address":[5729340],"length":1,"stats":{"Line":1},"fn_name":null},{"line":501,"address":[5729530,5729349],"length":1,"stats":{"Line":1},"fn_name":null},{"line":514,"address":[4518656,4518661],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":515,"address":[5707548],"length":1,"stats":{"Line":1},"fn_name":null},{"line":516,"address":[5707593],"length":1,"stats":{"Line":1},"fn_name":null},{"line":517,"address":[5707661],"length":1,"stats":{"Line":1},"fn_name":null},{"line":518,"address":[5707674],"length":1,"stats":{"Line":1},"fn_name":null},{"line":520,"address":[5707723,5707827],"length":1,"stats":{"Line":1},"fn_name":null},{"line":524,"address":[4518688,4518693],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":525,"address":[5708140],"length":1,"stats":{"Line":1},"fn_name":null},{"line":526,"address":[5708185],"length":1,"stats":{"Line":1},"fn_name":null},{"line":527,"address":[5708253],"length":1,"stats":{"Line":1},"fn_name":null},{"line":528,"address":[5708266],"length":1,"stats":{"Line":1},"fn_name":null},{"line":530,"address":[5708315,5708419],"length":1,"stats":{"Line":1},"fn_name":null},{"line":534,"address":[4518720,4518725],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":535,"address":[5708729],"length":1,"stats":{"Line":1},"fn_name":null},{"line":536,"address":[5708771],"length":1,"stats":{"Line":1},"fn_name":null},{"line":537,"address":[5708833],"length":1,"stats":{"Line":1},"fn_name":null},{"line":538,"address":[5708838],"length":1,"stats":{"Line":1},"fn_name":null},{"line":540,"address":[5708972,5708868],"length":1,"stats":{"Line":1},"fn_name":null},{"line":544,"address":[4518757,4518752],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":545,"address":[5709283],"length":1,"stats":{"Line":1},"fn_name":null},{"line":546,"address":[5709331],"length":1,"stats":{"Line":1},"fn_name":null},{"line":547,"address":[5709414],"length":1,"stats":{"Line":1},"fn_name":null},{"line":548,"address":[5709496],"length":1,"stats":{"Line":1},"fn_name":null},{"line":550,"address":[5709686,5709505],"length":1,"stats":{"Line":1},"fn_name":null},{"line":554,"address":[4518789,4518784],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":555,"address":[5710329],"length":1,"stats":{"Line":1},"fn_name":null},{"line":556,"address":[5710371],"length":1,"stats":{"Line":1},"fn_name":null},{"line":557,"address":[5710433],"length":1,"stats":{"Line":1},"fn_name":null},{"line":558,"address":[5710438],"length":1,"stats":{"Line":1},"fn_name":null},{"line":560,"address":[5710572,5710468],"length":1,"stats":{"Line":1},"fn_name":null},{"line":564,"address":[4518821,4518816],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":565,"address":[5710876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":566,"address":[5710918],"length":1,"stats":{"Line":1},"fn_name":null},{"line":567,"address":[5710980],"length":1,"stats":{"Line":1},"fn_name":null},{"line":568,"address":[5710985],"length":1,"stats":{"Line":1},"fn_name":null},{"line":570,"address":[5711119,5711015],"length":1,"stats":{"Line":1},"fn_name":null},{"line":574,"address":[4518848,4518853],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":575,"address":[5711415],"length":1,"stats":{"Line":1},"fn_name":null},{"line":576,"address":[5711442],"length":1,"stats":{"Line":1},"fn_name":null},{"line":578,"address":[5711488,5711540],"length":1,"stats":{"Line":2},"fn_name":null},{"line":579,"address":[5711578],"length":1,"stats":{"Line":1},"fn_name":null},{"line":581,"address":[5711738,5711779,5711633],"length":1,"stats":{"Line":2},"fn_name":null},{"line":585,"address":[4518880,4518885],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":586,"address":[5712268,5712199],"length":1,"stats":{"Line":2},"fn_name":null},{"line":588,"address":[5712328],"length":1,"stats":{"Line":1},"fn_name":null},{"line":590,"address":[5712429,5712374],"length":1,"stats":{"Line":2},"fn_name":null},{"line":591,"address":[5712467],"length":1,"stats":{"Line":1},"fn_name":null},{"line":593,"address":[5712668,5712627,5712522],"length":1,"stats":{"Line":2},"fn_name":null},{"line":597,"address":[4518912,4518917],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":598,"address":[5713305,5713084],"length":1,"stats":{"Line":2},"fn_name":null},{"line":605,"address":[5713368],"length":1,"stats":{"Line":1},"fn_name":null},{"line":607,"address":[5713423,5713496],"length":1,"stats":{"Line":2},"fn_name":null},{"line":608,"address":[5713534],"length":1,"stats":{"Line":1},"fn_name":null},{"line":609,"address":[5713791],"length":1,"stats":{"Line":1},"fn_name":null},{"line":612,"address":[4518963,4518944],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":615,"address":[5713948,5714120],"length":1,"stats":{"Line":2},"fn_name":null},{"line":627,"address":[5714128,5714380],"length":1,"stats":{"Line":1},"fn_name":null},{"line":628,"address":[5714749,5714314,5714998,5716218,5714963,5715237],"length":1,"stats":{"Line":4},"fn_name":null},{"line":629,"address":[5715080,5715242],"length":1,"stats":{"Line":1},"fn_name":null},{"line":634,"address":[4518992,4518997],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":635,"address":[5716396,5716617],"length":1,"stats":{"Line":2},"fn_name":null},{"line":642,"address":[5716680],"length":1,"stats":{"Line":1},"fn_name":null},{"line":644,"address":[5716808,5716735],"length":1,"stats":{"Line":2},"fn_name":null},{"line":645,"address":[5716846],"length":1,"stats":{"Line":1},"fn_name":null},{"line":646,"address":[5717103],"length":1,"stats":{"Line":1},"fn_name":null},{"line":649,"address":[4519024,4519043],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":652,"address":[5717432,5717260],"length":1,"stats":{"Line":2},"fn_name":null},{"line":664,"address":[5717440,5717692],"length":1,"stats":{"Line":1},"fn_name":null},{"line":665,"address":[5717626,5718275,5719530,5718061,5718310,5718549],"length":1,"stats":{"Line":4},"fn_name":null},{"line":666,"address":[5718392,5718554],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":254,"coverable":261},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","financial","src","mock.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nuse crate::{Module, Trait};\nuse chrono::prelude::*;\nuse core::time::Duration;\nuse financial_primitives::{BalanceAware, CalcReturnType, CalcVolatilityType};\nuse frame_support::codec::{Decode, Encode};\nuse frame_support::dispatch::DispatchError;\nuse frame_support::traits::UnixTime;\nuse frame_support::{impl_outer_origin, parameter_types, weights::Weight};\nuse frame_system as system;\nuse sp_core::H256;\nuse sp_runtime::{\n    testing::Header,\n    traits::{BlakeTwo256, IdentityLookup},\n    Perbill,\n};\nuse std::cell::RefCell;\nuse std::collections::HashMap;\nuse substrate_fixed::types::I64F64;\n\nimpl_outer_origin! {\n    pub enum Origin for Test {}\n}\n\ntype AccountId = u64;\n\nthread_local! {\n    pub static NOW: RefCell\u003cDuration\u003e = RefCell::new(Duration::from_secs(0));\n    pub static BALANCES: RefCell\u003cHashMap\u003c(AccountId, Asset), FixedNumber\u003e\u003e = RefCell::new(HashMap::new());\n}\n\npub fn set_now(now: Duration) {\n    NOW.with(|n| *n.borrow_mut() = now);\n}\n\n#[allow(dead_code)]\npub fn set_balance(account_id: AccountId, asset: Asset, balance: FixedNumber) {\n    BALANCES.with(|b| b.borrow_mut().insert((account_id, asset), balance));\n}\n\n#[derive(Clone, Eq, PartialEq)]\npub struct Test;\nparameter_types! {\n    pub const BlockHashCount: u64 = 250;\n    pub const MaximumBlockWeight: Weight = 1024;\n    pub const MaximumBlockLength: u32 = 2 * 1024;\n    pub const AvailableBlockRatio: Perbill = Perbill::from_percent(75);\n}\n\nimpl system::Trait for Test {\n    type BaseCallFilter = ();\n    type Origin = Origin;\n    type Call = ();\n    type Index = u64;\n    type BlockNumber = u64;\n    type Hash = H256;\n    type Hashing = BlakeTwo256;\n    type AccountId = AccountId;\n    type Lookup = IdentityLookup\u003cSelf::AccountId\u003e;\n    type Header = Header;\n    type Event = ();\n    type BlockHashCount = BlockHashCount;\n    type MaximumBlockWeight = MaximumBlockWeight;\n    type DbWeight = ();\n    type BlockExecutionWeight = ();\n    type ExtrinsicBaseWeight = ();\n    type MaximumExtrinsicWeight = MaximumBlockWeight;\n    type MaximumBlockLength = MaximumBlockLength;\n    type AvailableBlockRatio = AvailableBlockRatio;\n    type Version = ();\n    type ModuleToIndex = ();\n    type AccountData = ();\n    type OnNewAccount = ();\n    type OnKilledAccount = ();\n    type SystemWeightInfo = ();\n}\n\npub type FixedNumber = I64F64;\n\nparameter_types! {\n    pub const PriceCount: u32 = 10;\n    pub const PricePeriod: u32 = 60;\n    pub const ReturnType: u32 = CalcReturnType::Regular.into_u32();\n    pub const VolCorType: i64 = CalcVolatilityType::Regular.into_i64();\n}\n\npub struct TestUnixTime;\n\nimpl UnixTime for TestUnixTime {\n    fn now() -\u003e Duration {\n        NOW.with(|n| *n.borrow())\n    }\n}\n\nimpl Trait for Test {\n    type Event = ();\n    type PriceCount = PriceCount;\n    type PricePeriod = PricePeriod;\n    type ReturnType = ReturnType;\n    type VolCorType = VolCorType;\n    type UnixTime = TestUnixTime;\n    type Asset = Asset;\n    type FixedNumberBits = i128;\n    type FixedNumber = FixedNumber;\n    type Price = FixedNumber;\n    type Balances = Balances;\n}\n\npub type FinancialModule = Module\u003cTest\u003e;\n\n#[derive(Clone, Copy, Debug, Eq, PartialEq, Encode, Decode, Hash, Ord, PartialOrd)]\npub enum Asset {\n    Usd,\n    Btc,\n    Eos,\n    Eq,\n    Eth,\n}\n\npub struct Balances;\n\nimpl BalanceAware for Balances {\n    type AccountId = AccountId;\n    type Asset = Asset;\n    type Balance = FixedNumber;\n\n    fn balances(\n        account_id: \u0026Self::AccountId,\n        assets: \u0026[Self::Asset],\n    ) -\u003e Result\u003cVec\u003cSelf::Balance\u003e, DispatchError\u003e {\n        BALANCES.with(|b| {\n            Ok(assets\n                .iter()\n                .map(|\u0026a| {\n                    b.borrow()\n                        .get(\u0026(*account_id, a))\n                        .copied()\n                        .unwrap_or(FixedNumber::default())\n                })\n                .collect())\n        })\n    }\n}\n\npub fn initial_btc_prices() -\u003e Vec\u003cf64\u003e {\n    vec![\n        7_117.21, 7_429.72, 7_550.90, 7_569.94, 7_679.87, 7_795.60, 7_807.06, 8_801.04, 8_658.55,\n        8_864.77,\n    ]\n}\n\npub fn initial_eos_prices() -\u003e Vec\u003cf64\u003e {\n    vec![2.62, 2.67, 2.72, 2.72, 2.74, 2.75, 2.78, 3.02, 2.83, 2.89]\n}\n\npub fn initial_eq_prices() -\u003e Vec\u003cFixedNumber\u003e {\n    vec![\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n        FixedNumber::max_value(),\n    ]\n}\n\npub fn initial_eth_prices() -\u003e Vec\u003cf64\u003e {\n    vec![0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\n}\n\nfn create_duration(\n    year: i32,\n    month: u32,\n    day: u32,\n    hour: u32,\n    minute: u32,\n    second: u32,\n) -\u003e Duration {\n    let timestamp = Utc\n        .ymd(year, month, day)\n        .and_hms(hour, minute, second)\n        .timestamp();\n    Duration::from_secs(timestamp as u64)\n}\n\npub fn new_test_ext() -\u003e sp_io::TestExternalities {\n    let mut t = system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap();\n\n    let prev_period_now = create_duration(2020, 9, 14, 11, 25, 0);\n    crate::GenesisConfig::\u003cTest\u003e {\n        prices: vec![\n            (\n                Asset::Btc,\n                initial_btc_prices()\n                    .into_iter()\n                    .map(FixedNumber::from_num)\n                    .collect(),\n                prev_period_now,\n            ),\n            (\n                Asset::Eos,\n                initial_eos_prices()\n                    .into_iter()\n                    .map(FixedNumber::from_num)\n                    .collect(),\n                prev_period_now,\n            ),\n            (Asset::Eq, initial_eq_prices(), prev_period_now),\n            (\n                Asset::Eth,\n                initial_eth_prices()\n                    .into_iter()\n                    .map(FixedNumber::from_num)\n                    .collect(),\n                prev_period_now,\n            ),\n        ],\n    }\n    .assimilate_storage(\u0026mut t)\n    .unwrap();\n\n    t.into()\n}\n\npub fn new_test_ext_empty_storage() -\u003e sp_io::TestExternalities {\n    system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap()\n        .into()\n}\n\npub fn new_test_ext_btc_eos_only() -\u003e sp_io::TestExternalities {\n    let mut t = system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap();\n\n    let prev_period_now = create_duration(2020, 9, 14, 11, 25, 0);\n    crate::GenesisConfig::\u003cTest\u003e {\n        prices: vec![\n            (\n                Asset::Btc,\n                initial_btc_prices()\n                    .into_iter()\n                    .map(FixedNumber::from_num)\n                    .collect(),\n                prev_period_now,\n            ),\n            (\n                Asset::Eos,\n                initial_eos_prices()\n                    .into_iter()\n                    .map(FixedNumber::from_num)\n                    .collect(),\n                prev_period_now,\n            ),\n        ],\n    }\n    .assimilate_storage(\u0026mut t)\n    .unwrap();\n\n    t.into()\n}\n","traces":[{"line":35,"address":[5491397,5491328],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[5510640],"length":1,"stats":{"Line":1},"fn_name":null},{"line":43,"address":[5510759],"length":1,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[5503936],"length":1,"stats":{"Line":1},"fn_name":"set_now"},{"line":47,"address":[5490160,5490174],"length":1,"stats":{"Line":5},"fn_name":"{{closure}}"},{"line":51,"address":[5503984],"length":1,"stats":{"Line":1},"fn_name":"set_balance"},{"line":52,"address":[5504007],"length":1,"stats":{"Line":4},"fn_name":null},{"line":61,"address":[5510977],"length":1,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[5511041],"length":1,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[5511073],"length":1,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":141,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[5504192],"length":1,"stats":{"Line":2},"fn_name":"initial_btc_prices"},{"line":160,"address":[5504199],"length":1,"stats":{"Line":2},"fn_name":null},{"line":166,"address":[5504400],"length":1,"stats":{"Line":2},"fn_name":"initial_eos_prices"},{"line":167,"address":[5504407],"length":1,"stats":{"Line":2},"fn_name":null},{"line":170,"address":[5504592,5504677],"length":1,"stats":{"Line":2},"fn_name":"initial_eq_prices"},{"line":171,"address":[5505115,5504850,5504630],"length":1,"stats":{"Line":4},"fn_name":null},{"line":172,"address":[5504654],"length":1,"stats":{"Line":2},"fn_name":null},{"line":173,"address":[5504692],"length":1,"stats":{"Line":2},"fn_name":null},{"line":174,"address":[5504715],"length":1,"stats":{"Line":2},"fn_name":null},{"line":175,"address":[5504732],"length":1,"stats":{"Line":2},"fn_name":null},{"line":176,"address":[5504749],"length":1,"stats":{"Line":2},"fn_name":null},{"line":177,"address":[5504766],"length":1,"stats":{"Line":2},"fn_name":null},{"line":178,"address":[5504783],"length":1,"stats":{"Line":2},"fn_name":null},{"line":179,"address":[5504800],"length":1,"stats":{"Line":2},"fn_name":null},{"line":180,"address":[5504817],"length":1,"stats":{"Line":2},"fn_name":null},{"line":181,"address":[5504834],"length":1,"stats":{"Line":2},"fn_name":null},{"line":185,"address":[5505152],"length":1,"stats":{"Line":2},"fn_name":"initial_eth_prices"},{"line":186,"address":[5505159],"length":1,"stats":{"Line":2},"fn_name":null},{"line":189,"address":[5505280],"length":1,"stats":{"Line":2},"fn_name":"create_duration"},{"line":197,"address":[5505311],"length":1,"stats":{"Line":2},"fn_name":null},{"line":201,"address":[5505432],"length":1,"stats":{"Line":2},"fn_name":null},{"line":204,"address":[5505472,5505519],"length":1,"stats":{"Line":2},"fn_name":"new_test_ext"},{"line":205,"address":[5505482,5505550],"length":1,"stats":{"Line":4},"fn_name":null},{"line":209,"address":[5505656],"length":1,"stats":{"Line":2},"fn_name":null},{"line":211,"address":[5506106,5506217,5506365,5505716,5505926,5506824],"length":1,"stats":{"Line":4},"fn_name":null},{"line":242,"address":[5506671],"length":1,"stats":{"Line":2},"fn_name":null},{"line":245,"address":[5506976,5507015],"length":1,"stats":{"Line":1},"fn_name":"new_test_ext_empty_storage"},{"line":246,"address":[5507043,5506986,5507100],"length":1,"stats":{"Line":3},"fn_name":null},{"line":252,"address":[5507199,5507152],"length":1,"stats":{"Line":2},"fn_name":"new_test_ext_btc_eos_only"},{"line":253,"address":[5507230,5507162],"length":1,"stats":{"Line":4},"fn_name":null},{"line":257,"address":[5507336],"length":1,"stats":{"Line":2},"fn_name":null},{"line":259,"address":[5507757,5507606,5507396,5508132],"length":1,"stats":{"Line":4},"fn_name":null},{"line":281,"address":[5507979],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":48,"coverable":55},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","financial","src","tests.rs"],"content":"// Copyright (C) 2020 equilibrium.\n// SPDX-License-Identifier: Apache-2.0\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nuse super::*;\nuse crate::mock::*;\nuse crate::{CalcReturnType, CalcVolatilityType, Error, Financial, PriceUpdate};\nuse approx::assert_abs_diff_eq;\nuse chrono::prelude::*;\nuse core::time::Duration;\nuse financial_primitives::OnPriceSet;\nuse frame_support::assert_ok;\nuse frame_support::dispatch::DispatchError;\nuse sp_std::ops::Range;\nuse substrate_fixed::traits::LossyInto;\n\nfn create_duration(\n    year: i32,\n    month: u32,\n    day: u32,\n    hour: u32,\n    minute: u32,\n    second: u32,\n) -\u003e Duration {\n    let timestamp = Utc\n        .ymd(year, month, day)\n        .and_hms(hour, minute, second)\n        .timestamp();\n    Duration::from_secs(timestamp as u64)\n}\n\n#[cfg(test)]\nmod price_period {\n    use super::super::*;\n    use super::create_duration;\n\n    #[test]\n    fn info_for_neighbour_periods() {\n        let period_start = create_duration(2020, 9, 14, 12, 31, 0);\n        let now = create_duration(2020, 9, 14, 13, 2, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_curr_period_info(\u0026period, period_start, now);\n        let expected = Ok((create_duration(2020, 9, 14, 13, 0, 0), 1));\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn info_for_distant_periods() {\n        let period_start = create_duration(2020, 9, 14, 12, 31, 0);\n        let now = create_duration(2020, 9, 15, 7, 2, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_curr_period_info(\u0026period, period_start, now);\n        let expected = Ok((create_duration(2020, 9, 15, 7, 0, 0), 19));\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn invalid_period_start() {\n        let period_start = create_duration(2020, 9, 14, 12, 31, 0);\n        let now = create_duration(2020, 9, 14, 12, 42, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Err(PricePeriodChangeError::InvalidPeriodStart);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn period_remains_unchanged() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 12, 42, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Ok(PricePeriodChange {\n            period_start,\n            action: PricePeriodAction::RemainsUnchanged,\n        });\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn period_changed_slightly() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 13, 2, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Ok(PricePeriodChange {\n            period_start: create_duration(2020, 9, 14, 13, 0, 0),\n            action: PricePeriodAction::StartedNew(0),\n        });\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn period_changed_significantly() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 15, 7, 2, 0);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Ok(PricePeriodChange {\n            period_start: create_duration(2020, 9, 15, 7, 0, 0),\n            action: PricePeriodAction::StartedNew(18),\n        });\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn period_is_in_the_past() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 12, 16, 27, 10);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Err(PricePeriodChangeError::PeriodIsInThePast);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn zero_period() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 15, 7, 2, 0);\n\n        // period is one hour\n        let period = PricePeriod(0);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Err(PricePeriodChangeError::DivisionByZero);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn elapsed_period_count_is_too_large() {\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = Duration::from_secs(u64::MAX);\n\n        // period is one hour\n        let period = PricePeriod(60);\n\n        let actual = get_period_change(\u0026period, Some(period_start), now);\n        let expected = Err(PricePeriodChangeError::Overflow);\n\n        assert_eq!(actual, expected);\n    }\n}\n\n#[cfg(test)]\nmod new_prices {\n    use crate::*;\n\n    #[test]\n    fn some_last_price_no_empty_periods() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 0, 5);\n        let expected = Ok(vec![123]);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn some_last_price_some_empty_periods_less_than_max() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 3, 5);\n        let expected = Ok(vec![555, 555, 555, 123]);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn some_last_price_some_empty_periods_equal_to_max() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 4, 5);\n        let expected = Ok(vec![555, 555, 555, 555, 123]);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn some_last_price_some_empty_periods_slightly_more_than_max() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 5, 5);\n        let expected = Ok(vec![555, 555, 555, 555, 123]);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn some_last_price_some_empty_periods_significantly_more_than_max() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 27, 5);\n        let expected = Ok(vec![555, 555, 555, 555, 123]);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn max_periods_is_zero() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 27, 0);\n        let expected = Err(GetNewPricesError::Overflow);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn max_periods_is_one() {\n        let actual = get_new_prices::\u003cu32\u003e(555, 123, 3, 1);\n        let expected = Ok(vec![123]);\n\n        assert_eq!(actual, expected);\n    }\n}\n\n#[cfg(test)]\nmod index_range {\n    use crate::*;\n\n    #[test]\n    fn empty_range() {\n        let actual = get_index_range(\u0026(3..3), \u0026(0..1));\n        let expected = Err(MathError::InvalidArgument);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn empty_intersaction() {\n        let actual = get_index_range(\u0026(0..5), \u0026(4..4));\n        let expected = Ok(0..0);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn intersaction_not_included_completely() {\n        let actual = get_index_range(\u0026(0..5), \u0026(4..6));\n        let expected = Err(MathError::InvalidArgument);\n\n        assert_eq!(actual, expected);\n    }\n}\n\n#[cfg(test)]\nmod range_intersection {\n    use crate::*;\n\n    #[test]\n    fn one_range() {\n        let r = 0..10;\n        let v: Vec\u003c_\u003e = vec![r.clone()];\n        let actual = get_range_intersection(v.iter()).unwrap();\n        let expected = r;\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn empty_range() {\n        let r = 0..0;\n        let v: Vec\u003c_\u003e = vec![r.clone()];\n        let actual = get_range_intersection(v.iter()).unwrap();\n        let expected = r;\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn empty_iterator() {\n        let v: Vec\u003cRange\u003ci32\u003e\u003e = vec![];\n        let actual = get_range_intersection(v.iter());\n        let expected = Err(MathError::NotEnoughPoints);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn not_intersected_ranges() {\n        let v: Vec\u003c_\u003e = vec![0..10, 11..12];\n        let actual = get_range_intersection(v.iter());\n        let expected = Err(MathError::NotEnoughPoints);\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn two_intersected_ranges() {\n        let v: Vec\u003c_\u003e = vec![0..10, 9..12];\n        let actual = get_range_intersection(v.iter()).unwrap();\n        let expected = 9..10;\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn three_intersected_ranges() {\n        let v: Vec\u003c_\u003e = vec![0..11, 9..12, 8..10];\n        let actual = get_range_intersection(v.iter()).unwrap();\n        let expected = 9..10;\n\n        assert_eq!(actual, expected);\n    }\n\n    #[test]\n    fn two_ranges_one_empty() {\n        let v: Vec\u003c_\u003e = vec![0..10, 9..9];\n        let actual = get_range_intersection(v.iter());\n        let expected = Err(MathError::NotEnoughPoints);\n\n        assert_eq!(actual, expected);\n    }\n}\n\n#[cfg(test)]\nmod stateful_calculations {\n    use super::super::*;\n    use super::{btc_prices, eos_prices};\n    use crate::mock::FixedNumber;\n    use approx::assert_abs_diff_eq;\n    use frame_support::assert_ok;\n    use substrate_fixed::traits::LossyInto;\n\n    macro_rules! ret_tests {\n        ($($name:ident: $value:expr,)*) =\u003e {\n        $(\n            #[test]\n            fn $name() {\n                let (return_type, prices, expected) = $value;\n                let actual = Ret::\u003cFixedNumber\u003e::new(\u0026prices, return_type);\n\n                assert_ok!(\u0026actual);\n                let actual = actual.unwrap().ret;\n\n                assert_eq!(actual.len(), expected.len());\n                for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n                    let a: f64 = a.lossy_into();\n                    assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n                }\n            }\n        )*\n        }\n    }\n\n    ret_tests! {\n        btc_regular_ret: (CalcReturnType::Regular, btc_prices(), vec![\n            0.04390906,\n            0.01631017,\n            0.00252155,\n            0.01452191,\n            0.01506927,\n            0.00147006,\n            0.12731809,\n            -0.01619013,\n            0.02381692,\n            0.01396878,\n            -0.01013840,\n            0.00170610,\n            0.01014513,\n            0.02951104,\n            0.07366250,\n            -0.01093803,\n            -0.02527465,\n            -0.08729193,\n            -0.01765902,\n            0.02356251,\n            0.05287195,\n            0.05002487,\n            -0.04166136,\n            0.00523252,\n            0.03132448,\n            0.00577308,\n            0.00025394,\n            -0.02117989,\n            -0.04633214,\n        ]),\n        eos_regular_ret: (CalcReturnType::Regular, eos_prices(), vec![\n            0.01908397,\n            0.01872659,\n            0.00000000,\n            0.00735294,\n            0.00364964,\n            0.01090909,\n            0.08633094,\n            -0.06291391,\n            0.02120141,\n            0.02076125,\n            -0.03728814,\n            -0.02112676,\n            -0.00359712,\n            -0.02888087,\n            0.02602230,\n            0.00000000,\n            0.00000000,\n            -0.11231884,\n            -0.01632653,\n            0.01244813,\n            0.03688525,\n            0.03162055,\n            -0.00766284,\n            0.01544402,\n            -0.00380228,\n            0.01526718,\n            -0.01127820,\n            -0.01140684,\n            -0.05000000,\n        ]),\n        btc_log_ret: (CalcReturnType::Log, btc_prices(), vec![\n            0.042972378,\n            0.016178588,\n            0.002518380,\n            0.014417479,\n            0.014956852,\n            0.001468981,\n            0.119841444,\n            -0.016322624,\n            0.023537722,\n            0.013872113,\n            -0.010190141,\n            0.001704649,\n            0.010094014,\n            0.029083976,\n            0.071075698,\n            -0.010998288,\n            -0.025599536,\n            -0.091339192,\n            -0.017816804,\n            0.023289199,\n            0.051521618,\n            0.048813845,\n            -0.042554076,\n            0.005218879,\n            0.030843883,\n            0.005756484,\n            0.000253911,\n            -0.021407402,\n            -0.047439819,\n        ]),\n        eos_log_ret: (CalcReturnType::Log, eos_prices(), vec![\n            0.018904155,\n            0.018553408,\n            0.000000000,\n            0.007326040,\n            0.003642991,\n            0.010850016,\n            0.082805904,\n            -0.064980120,\n            0.020979790,\n            0.020548668,\n            -0.038001118,\n            -0.021353124,\n            -0.003603608,\n            -0.029306127,\n            0.025689486,\n            0.000000000,\n            0.000000000,\n            -0.119142655,\n            -0.016461277,\n            0.012371292,\n            0.036221263,\n            0.031130919,\n            -0.007692346,\n            0.015325970,\n            -0.003809528,\n            0.015151805,\n            -0.011342277,\n            -0.011472401,\n            -0.051293294,\n        ]),\n    }\n\n    macro_rules! vol_tests {\n        ($($name:ident: $value:expr,)*) =\u003e {\n        $(\n            #[test]\n            fn $name() {\n                let (return_type, vol_cor_type, prices, expected) = $value;\n                let ret = Ret::\u003cFixedNumber\u003e::new(\u0026prices, return_type);\n\n                assert_ok!(\u0026ret);\n                let ret = ret.unwrap();\n\n                let actual = Vol::\u003cFixedNumber\u003e::new(\u0026ret, vol_cor_type);\n\n                assert_ok!(\u0026actual);\n                let actual: f64 = actual.unwrap().vol.lossy_into();\n\n                assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n            }\n        )*\n        }\n    }\n\n    vol_tests! {\n        btc_regular_regular_vol: (CalcReturnType::Regular, CalcVolatilityType::Regular, btc_prices(), 0.03957419747),\n        eos_regular_regular_vol: (CalcReturnType::Regular, CalcVolatilityType::Regular, eos_prices(), 0.03545408186),\n        btc_log_regular_vol: (CalcReturnType::Log, CalcVolatilityType::Regular, btc_prices(), 0.03897272754),\n        eos_log_regular_vol: (CalcReturnType::Log, CalcVolatilityType::Regular, eos_prices(), 0.03608986052),\n        btc_regular_exp_vol: (CalcReturnType::Regular, CalcVolatilityType::Exponential(36), btc_prices(), 0.03780489568156),\n        eos_regular_exp_vol: (CalcReturnType::Regular, CalcVolatilityType::Exponential(36), eos_prices(), 0.03163066694536),\n        btc_log_exp_vol: (CalcReturnType::Log, CalcVolatilityType::Exponential(36), btc_prices(), 0.03755128719775),\n        eos_log_exp_vol: (CalcReturnType::Log, CalcVolatilityType::Exponential(36), eos_prices(), 0.03234405779893),\n    }\n\n    macro_rules! cor_tests {\n        ($($name:ident: $value:expr,)*) =\u003e {\n        $(\n            #[test]\n            fn $name() {\n                let (return_type, vol_cor_type, prices1, prices2, expected) = $value;\n\n                let ret1 = Ret::\u003cFixedNumber\u003e::new(\u0026prices1, return_type);\n                let ret2 = Ret::\u003cFixedNumber\u003e::new(\u0026prices2, return_type);\n\n                assert_ok!(\u0026ret1);\n                let ret1 = ret1.unwrap();\n                assert_ok!(\u0026ret2);\n                let ret2 = ret2.unwrap();\n\n                let vol1 = Vol::\u003cFixedNumber\u003e::new(\u0026ret1, vol_cor_type);\n                let vol2 = Vol::\u003cFixedNumber\u003e::new(\u0026ret2, vol_cor_type);\n\n                assert_ok!(\u0026vol1);\n                let vol1 = vol1.unwrap();\n                assert_ok!(\u0026vol2);\n                let vol2 = vol2.unwrap();\n\n                let actual = cor(\u0026ret1, \u0026vol1, \u0026ret2, \u0026vol2);\n\n                assert_ok!(\u0026actual);\n                let actual: f64 = actual.unwrap().lossy_into();\n\n                assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n            }\n        )*\n        }\n    }\n\n    cor_tests! {\n        btc_eos_regular_regular_cor: (CalcReturnType::Regular, CalcVolatilityType::Regular, btc_prices(), eos_prices(), 0.83272869396),\n        btc_eos_log_regular_cor: (CalcReturnType::Log, CalcVolatilityType::Regular, btc_prices(), eos_prices(), 0.83127977977),\n        btc_eos_regular_exp_cor: (CalcReturnType::Regular, CalcVolatilityType::Exponential(36), btc_prices(), eos_prices(), 0.8417527336731),\n        btc_eos_log_exp_cor: (CalcReturnType::Log, CalcVolatilityType::Exponential(36), btc_prices(), eos_prices(), 0.8414762672002),\n    }\n}\n\n#[test]\nfn calc_linear_return_for_btc_using_only_genesis() {\n    new_test_ext().execute_with(|| {\n        let actual: Vec\u003cf64\u003e =\n            \u003cFinancialModule as Financial\u003e::calc_return(CalcReturnType::Regular, Asset::Btc)\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n        let expected = vec![\n            0.04390906,\n            0.01631017,\n            0.00252155,\n            0.01452191,\n            0.01506927,\n            0.00147006,\n            0.12731809,\n            -0.01619013,\n            0.02381692,\n        ];\n\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    });\n}\n\n#[test]\nfn calc_log_return_for_btc_using_only_genesis() {\n    new_test_ext().execute_with(|| {\n        let actual: Vec\u003cf64\u003e =\n            \u003cFinancialModule as Financial\u003e::calc_return(CalcReturnType::Log, Asset::Btc)\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n        let expected = vec![\n            0.042972378,\n            0.016178588,\n            0.002518380,\n            0.014417479,\n            0.014956852,\n            0.001468981,\n            0.119841444,\n            -0.016322624,\n            0.023537722,\n        ];\n\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    });\n}\n\n#[test]\nfn calc_linear_return_for_eos_using_only_genesis() {\n    new_test_ext().execute_with(|| {\n        let actual: Vec\u003cf64\u003e =\n            \u003cFinancialModule as Financial\u003e::calc_return(CalcReturnType::Regular, Asset::Eos)\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n        let expected = vec![\n            0.01908397,\n            0.01872659,\n            0.00000000,\n            0.00735294,\n            0.00364964,\n            0.01090909,\n            0.08633094,\n            -0.06291391,\n            0.02120141,\n        ];\n\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    });\n}\n\n#[test]\nfn calc_log_return_for_eos_using_only_genesis() {\n    new_test_ext().execute_with(|| {\n        let actual: Vec\u003cf64\u003e =\n            \u003cFinancialModule as Financial\u003e::calc_return(CalcReturnType::Log, Asset::Eos)\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n        let expected = vec![\n            0.018904155,\n            0.018553408,\n            0.000000000,\n            0.007326040,\n            0.003642991,\n            0.010850016,\n            0.082805904,\n            -0.064980120,\n            0.020979790,\n        ];\n\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    });\n}\n\n#[test]\nfn calc_linear_return_for_btc_using_some_oracle_prices() {\n    new_test_ext().execute_with(|| {\n        let prices: Vec\u003c_\u003e = vec![8_988.60, 8_897.47, 8_912.65, 9_003.07]\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n\n        let mut now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        for p in prices.into_iter() {\n            let result = \u003cFinancialModule as OnPriceSet\u003e::on_price_set(Asset::Btc, p);\n\n            assert_ok!(result);\n\n            now = now + Duration::from_secs(60 * 60);\n            set_now(now);\n        }\n\n        let actual: Vec\u003cf64\u003e =\n            \u003cFinancialModule as Financial\u003e::calc_return(CalcReturnType::Regular, Asset::Btc)\n                .unwrap()\n                .into_iter()\n                .map(|x| x.lossy_into())\n                .collect();\n        let expected = vec![\n            0.01506927,\n            0.00147006,\n            0.12731809,\n            -0.01619013,\n            0.02381692,\n            0.01396878,\n            -0.01013840,\n            0.00170610,\n            0.01014513,\n        ];\n\n        assert_eq!(actual.len(), expected.len());\n        for (a, e) in actual.into_iter().zip(expected.into_iter()) {\n            assert_abs_diff_eq!(a, e, epsilon = 1e-8);\n        }\n    });\n}\n\n#[test]\nfn initial_prices_state_with_empty_genesis() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = None;\n\n        let log = FinancialModule::price_logs(asset);\n        let expected_log = None;\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(log, expected_log);\n    });\n}\n\n#[test]\nfn initial_prices_state_with_nonempty_genesis() {\n    new_test_ext().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = None;\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = initial_btc_prices()\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn first_price_with_empty_genesis() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(period_start, now, price));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_is_in_the_past() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let past_price = FixedNumber::from_num(7_300);\n        let past_now = create_duration(2020, 9, 13, 0, 3, 0);\n        set_now(past_now);\n\n        let result = \u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, past_price);\n        let expected_result: Result\u003c(), DispatchError\u003e =\n            Err(Error::\u003cTest\u003e::PeriodIsInThePast.into());\n        assert_eq!(result, expected_result);\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(period_start, now, price));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_is_in_current_period() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let same_period_price = FixedNumber::from_num(9_100);\n        let same_period_now = create_duration(2020, 9, 14, 12, 48, 0);\n        set_now(same_period_now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(\n            asset,\n            same_period_price\n        ));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(\n            period_start,\n            same_period_now,\n            same_period_price,\n        ));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_is_in_next_period() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let next_period_start = create_duration(2020, 9, 14, 13, 0, 0);\n        let next_period_price = FixedNumber::from_num(9_100);\n        let next_period_now = create_duration(2020, 9, 14, 13, 27, 0);\n        set_now(next_period_now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(\n            asset,\n            next_period_price\n        ));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(\n            next_period_start,\n            next_period_now,\n            next_period_price,\n        ));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price, next_period_price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_is_a_few_periods_ahead() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let new_period_start = create_duration(2020, 9, 14, 16, 0, 0);\n        let new_period_price = FixedNumber::from_num(9_100);\n        let new_period_now = create_duration(2020, 9, 14, 16, 27, 0);\n        set_now(new_period_now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(\n            asset,\n            new_period_price\n        ));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(\n            new_period_start,\n            new_period_now,\n            new_period_price,\n        ));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price, price, price, price, new_period_price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_is_many_periods_ahead() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let new_period_start = create_duration(2020, 10, 3, 22, 0, 0);\n        let new_period_price = FixedNumber::from_num(9_100);\n        let new_period_now = create_duration(2020, 10, 3, 22, 27, 0);\n        set_now(new_period_now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(\n            asset,\n            new_period_price\n        ));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(\n            new_period_start,\n            new_period_now,\n            new_period_price,\n        ));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let mut expected_prices: Vec\u003cFixedNumber\u003e = vec![price; PriceCount::get() as usize - 1];\n        expected_prices.push(new_period_price);\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn wrong_now_in_the_distant_future() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let price = FixedNumber::from_num(9_000);\n\n        let period_start = create_duration(2020, 9, 14, 12, 0, 0);\n        let now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, price));\n\n        let distant_future_price = FixedNumber::from_num(9_100);\n        let distant_future_now = Duration::from_secs(u64::MAX);\n        set_now(distant_future_now);\n\n        let result = \u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, distant_future_price);\n        let expected_result: Result\u003c(), DispatchError\u003e = Err(Error::\u003cTest\u003e::Overflow.into());\n        assert_eq!(result, expected_result);\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(period_start, now, price));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let expected_prices: Vec\u003cFixedNumber\u003e = vec![price];\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\n#[test]\nfn new_price_has_arravied_while_prices_countainer_is_full() {\n    new_test_ext_empty_storage().execute_with(|| {\n        let asset = Asset::Btc;\n\n        let prices: Vec\u003c_\u003e = vec![1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n\n        let mut now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        for \u0026p in prices.iter() {\n            let result = \u003cFinancialModule as OnPriceSet\u003e::on_price_set(asset, p);\n\n            assert_ok!(result);\n\n            now = now + Duration::from_secs(60 * 60);\n            set_now(now);\n        }\n\n        let new_period_start = create_duration(2020, 9, 14, 22, 0, 0);\n        let new_period_price = FixedNumber::from_num(11);\n\n        assert_ok!(\u003cFinancialModule as OnPriceSet\u003e::on_price_set(\n            asset,\n            new_period_price\n        ));\n\n        let updates = FinancialModule::updates(asset);\n        let expected_updates = Some(PriceUpdate::new(new_period_start, now, new_period_price));\n\n        let log = FinancialModule::price_logs(asset).unwrap();\n        let actual_prices: Vec\u003c_\u003e = log.prices.iter().copied().collect();\n        let mut expected_prices: Vec\u003c_\u003e = prices[1..].iter().copied().collect();\n        expected_prices.push(new_period_price);\n\n        let prices_cap = log.prices.len_cap();\n        let expected_price_cap = PriceCount::get();\n\n        assert_eq!(updates, expected_updates);\n        assert_eq!(actual_prices, expected_prices);\n        assert_eq!(prices_cap, expected_price_cap);\n    });\n}\n\nfn btc_prices() -\u003e Vec\u003cFixedNumber\u003e {\n    vec![\n        7_117.21, 7_429.72, 7_550.90, 7_569.94, 7_679.87, 7_795.60, 7_807.06, 8_801.04, 8_658.55,\n        8_864.77, 8_988.60, 8_897.47, 8_912.65, 9_003.07, 9_268.76, 9_951.52, 9_842.67, 9_593.90,\n        8_756.43, 8_601.80, 8_804.48, 9_269.99, 9_733.72, 9_328.20, 9_377.01, 9_670.74, 9_726.57,\n        9_729.04, 9_522.98, 9_081.76,\n    ]\n    .into_iter()\n    .map(FixedNumber::from_num)\n    .collect()\n}\n\nfn eos_prices() -\u003e Vec\u003cFixedNumber\u003e {\n    vec![\n        2.62, 2.67, 2.72, 2.72, 2.74, 2.75, 2.78, 3.02, 2.83, 2.89, 2.95, 2.84, 2.78, 2.77, 2.69,\n        2.76, 2.76, 2.76, 2.45, 2.41, 2.44, 2.53, 2.61, 2.59, 2.63, 2.62, 2.66, 2.63, 2.6, 2.47,\n    ]\n    .into_iter()\n    .map(FixedNumber::from_num)\n    .collect()\n}\n\n#[test]\nfn calc_correlation_different_price_periods_results_in_periods_intersection() {\n    new_test_ext().execute_with(|| {\n        let prices: Vec\u003c_\u003e = vec![8_988.60, 8_897.47]\n            .into_iter()\n            .map(FixedNumber::from_num)\n            .collect();\n\n        let mut now = create_duration(2020, 9, 14, 12, 31, 0);\n        set_now(now);\n\n        for p in prices.into_iter() {\n            let result = \u003cFinancialModule as OnPriceSet\u003e::on_price_set(Asset::Btc, p);\n\n            assert_ok!(result);\n\n            now = now + Duration::from_secs(60 * 60);\n            set_now(now);\n        }\n\n        let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n            CalcReturnType::Regular,\n            CalcVolatilityType::Regular,\n            Asset::Btc,\n            Asset::Eos,\n        );\n        assert_ok!(\u0026actual);\n        let (_, actual_period) = actual.unwrap();\n        let expected_period = Range {\n            start: create_duration(2020, 9, 14, 4, 0, 0),\n            end: create_duration(2020, 9, 14, 12, 0, 0),\n        };\n\n        assert_eq!(actual_period, expected_period);\n    });\n}\n\n#[cfg(test)]\nmod calc_vol {\n    use crate::*;\n    use approx::assert_abs_diff_eq;\n    use frame_support::assert_ok;\n    use mock::{new_test_ext, Asset, FinancialModule, Test};\n    use substrate_fixed::traits::LossyInto;\n\n    #[test]\n    fn calc_vol_btc_regular_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.04163212889;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_eos_regular_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0380004985;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_btc_log_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.03932894975;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_eos_log_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.03764429688;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_btc_regular_exp() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0294825719888474;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_btc_log_exp() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0282782458740207;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_eos_regular_exp() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Exponential(36),\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0246077778994953;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_eos_log_exp() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0245077247817629;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_vol_asset_without_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Usd,\n            );\n            let expected: Result\u003c\u003cmock::Test as Trait\u003e::Price, DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::NotEnoughPoints.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_vol_regular_asset_with_big_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Eq,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0;\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_vol_exponential_asset_with_big_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Eq,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0;\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_vol_regular_asset_with_zero_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Eth,\n            );\n            let expected: Result\u003c\u003cmock::Test as Trait\u003e::Price, DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::DivisionByZero.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_vol_exponential_asset_with_zero_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_vol(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Eth,\n            );\n            let expected: Result\u003c\u003cmock::Test as Trait\u003e::Price, DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::DivisionByZero.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n}\n\n#[cfg(test)]\nmod calc_corr {\n    use crate::*;\n    use approx::assert_abs_diff_eq;\n    use frame_support::assert_ok;\n    use mock::{new_test_ext, Asset, FinancialModule, Test};\n    use substrate_fixed::traits::LossyInto;\n\n    #[test]\n    fn calc_corr_btc_eos_regular_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.8836901525;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_corr_btc_eos_log_regular() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.87585873751;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_corr_btc_eos_regular_exp() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.866920411417432;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_corr_btc_eos_log_exponential() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n                Asset::Eos,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.860312211443148;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_corr_asset_without_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n                Asset::Usd,\n            );\n\n            let expected: Result\u003c(\u003cmock::Test as Trait\u003e::Price, Range\u003cDuration\u003e), DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::NotEnoughPoints.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_corr_regular_asset_with_big_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n                Asset::Eq,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0;\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_corr_exponential_asset_with_big_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n                Asset::Eq,\n            );\n            assert_ok!(\u0026actual);\n            let (actual, _) = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.0;\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_corr_regular_asset_with_zero_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Regular,\n                Asset::Btc,\n                Asset::Eth,\n            );\n            let expected: Result\u003c(\u003cmock::Test as Trait\u003e::Price, Range\u003cDuration\u003e), DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::DivisionByZero.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n\n    #[test]\n    fn calc_corr_exponential_asset_with_zero_prices() {\n        new_test_ext().execute_with(|| {\n            let actual = \u003cFinancialModule as Financial\u003e::calc_corr(\n                CalcReturnType::Log,\n                CalcVolatilityType::Exponential(36),\n                Asset::Btc,\n                Asset::Eth,\n            );\n            let expected: Result\u003c(\u003cmock::Test as Trait\u003e::Price, Range\u003cDuration\u003e), DispatchError\u003e =\n                Err(Error::\u003cTest\u003e::DivisionByZero.into());\n\n            assert_eq!(actual, expected);\n        });\n    }\n}\n\n#[cfg(test)]\nmod calc_portf {\n    use crate::*;\n    use approx::assert_abs_diff_eq;\n    use frame_support::assert_ok;\n    use mock::{new_test_ext_btc_eos_only, set_balance, Asset, FinancialModule, FixedNumber};\n    use substrate_fixed::traits::LossyInto;\n\n    #[test]\n    fn calc_portf_vol_btc_eos_regular_regular_1() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Btc, FixedNumber::from_num(10));\n            set_balance(333, Asset::Eos, FixedNumber::from_num(10000));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.03989302699122;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_portf_vol_btc_eos_regular_regular_2() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Eos, FixedNumber::from_num(35));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.03800049849557;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_portf_vol_btc_eos_regular_regular_3() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Btc, FixedNumber::from_num(15));\n            set_balance(333, Asset::Eos, FixedNumber::from_num(725));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_vol(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.04150814612241;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_portf_var_btc_eos_regular_regular_1() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Btc, FixedNumber::from_num(10));\n            set_balance(333, Asset::Eos, FixedNumber::from_num(10000));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_var(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n                5,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.17744728149940;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_portf_var_btc_eos_regular_regular_2() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Eos, FixedNumber::from_num(35));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_var(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n                5,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.17840908472867;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n\n    #[test]\n    fn calc_portf_var_btc_eos_regular_regular_3() {\n        new_test_ext_btc_eos_only().execute_with(|| {\n            set_balance(333, Asset::Btc, FixedNumber::from_num(15));\n            set_balance(333, Asset::Eos, FixedNumber::from_num(725));\n\n            let actual = \u003cFinancialModule as Financial\u003e::calc_portf_var(\n                CalcReturnType::Regular,\n                CalcVolatilityType::Regular,\n                333,\n                5,\n            );\n            assert_ok!(\u0026actual);\n            let actual = actual.unwrap();\n            let actual: f64 = actual.lossy_into();\n            let expected = 0.18233883857922;\n            assert_abs_diff_eq!(actual, expected, epsilon = 1e-8);\n        });\n    }\n}\n","traces":[{"line":28,"address":[4323120],"length":1,"stats":{"Line":1},"fn_name":"create_duration"},{"line":36,"address":[4323151],"length":1,"stats":{"Line":1},"fn_name":null},{"line":40,"address":[4323272],"length":1,"stats":{"Line":1},"fn_name":null},{"line":49,"address":[5408357,5408352],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":50,"address":[5737610],"length":1,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[5737671],"length":1,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[5737726],"length":1,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[5737737],"length":1,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[5737782],"length":1,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[5738017,5737913],"length":1,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[5408384,5408389],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":64,"address":[5738314],"length":1,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[5738375],"length":1,"stats":{"Line":1},"fn_name":null},{"line":68,"address":[5738430],"length":1,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[5738441],"length":1,"stats":{"Line":1},"fn_name":null},{"line":71,"address":[5738486],"length":1,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[5738617,5738721],"length":1,"stats":{"Line":1},"fn_name":null},{"line":77,"address":[5408416,5408421],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":78,"address":[5739018],"length":1,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[5739076],"length":1,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[5739131],"length":1,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[5739144],"length":1,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[5739214],"length":1,"stats":{"Line":1},"fn_name":null},{"line":87,"address":[5739244,5739348],"length":1,"stats":{"Line":1},"fn_name":null},{"line":91,"address":[5408453,5408448],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":92,"address":[5739657],"length":1,"stats":{"Line":1},"fn_name":null},{"line":93,"address":[5739715],"length":1,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[5739770],"length":1,"stats":{"Line":1},"fn_name":null},{"line":98,"address":[5739783],"length":1,"stats":{"Line":1},"fn_name":null},{"line":99,"address":[5739872],"length":1,"stats":{"Line":1},"fn_name":null},{"line":101,"address":[5739856],"length":1,"stats":{"Line":1},"fn_name":null},{"line":104,"address":[5740079,5739975],"length":1,"stats":{"Line":1},"fn_name":null},{"line":108,"address":[5408480,5408485],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":109,"address":[5740377],"length":1,"stats":{"Line":1},"fn_name":null},{"line":110,"address":[5740438],"length":1,"stats":{"Line":1},"fn_name":null},{"line":113,"address":[5740493],"length":1,"stats":{"Line":1},"fn_name":null},{"line":115,"address":[5740512],"length":1,"stats":{"Line":1},"fn_name":null},{"line":116,"address":[5740657],"length":1,"stats":{"Line":1},"fn_name":null},{"line":117,"address":[5740590],"length":1,"stats":{"Line":1},"fn_name":null},{"line":118,"address":[5740630],"length":1,"stats":{"Line":1},"fn_name":null},{"line":121,"address":[5740760,5740864],"length":1,"stats":{"Line":1},"fn_name":null},{"line":125,"address":[5408512,5408517],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":126,"address":[5741161],"length":1,"stats":{"Line":1},"fn_name":null},{"line":127,"address":[5741222],"length":1,"stats":{"Line":1},"fn_name":null},{"line":130,"address":[5741277],"length":1,"stats":{"Line":1},"fn_name":null},{"line":132,"address":[5741296],"length":1,"stats":{"Line":1},"fn_name":null},{"line":133,"address":[5741441],"length":1,"stats":{"Line":1},"fn_name":null},{"line":134,"address":[5741374],"length":1,"stats":{"Line":1},"fn_name":null},{"line":135,"address":[5741414],"length":1,"stats":{"Line":1},"fn_name":null},{"line":138,"address":[5741544,5741648],"length":1,"stats":{"Line":1},"fn_name":null},{"line":142,"address":[5408544,5408549],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":143,"address":[5741945],"length":1,"stats":{"Line":1},"fn_name":null},{"line":144,"address":[5742000],"length":1,"stats":{"Line":1},"fn_name":null},{"line":147,"address":[5742061],"length":1,"stats":{"Line":1},"fn_name":null},{"line":149,"address":[5742074],"length":1,"stats":{"Line":1},"fn_name":null},{"line":150,"address":[5742144],"length":1,"stats":{"Line":1},"fn_name":null},{"line":152,"address":[5742278,5742174],"length":1,"stats":{"Line":1},"fn_name":null},{"line":156,"address":[5408576,5408581],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":157,"address":[5742585],"length":1,"stats":{"Line":1},"fn_name":null},{"line":158,"address":[5742643],"length":1,"stats":{"Line":1},"fn_name":null},{"line":161,"address":[5742698],"length":1,"stats":{"Line":1},"fn_name":null},{"line":163,"address":[5742711],"length":1,"stats":{"Line":1},"fn_name":null},{"line":164,"address":[5742781],"length":1,"stats":{"Line":1},"fn_name":null},{"line":166,"address":[5742915,5742811],"length":1,"stats":{"Line":1},"fn_name":null},{"line":170,"address":[5408613,5408608],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":171,"address":[5743209],"length":1,"stats":{"Line":1},"fn_name":null},{"line":172,"address":[5743264],"length":1,"stats":{"Line":1},"fn_name":null},{"line":175,"address":[5743300],"length":1,"stats":{"Line":1},"fn_name":null},{"line":177,"address":[5743313],"length":1,"stats":{"Line":1},"fn_name":null},{"line":178,"address":[5743383],"length":1,"stats":{"Line":1},"fn_name":null},{"line":180,"address":[5743517,5743413],"length":1,"stats":{"Line":1},"fn_name":null},{"line":189,"address":[4686784,4686789],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":190,"address":[5492265],"length":1,"stats":{"Line":1},"fn_name":null},{"line":191,"address":[5492369,5492313],"length":1,"stats":{"Line":2},"fn_name":null},{"line":193,"address":[5492525,5492403],"length":1,"stats":{"Line":1},"fn_name":null},{"line":197,"address":[4686816,4686821],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":198,"address":[5492903],"length":1,"stats":{"Line":1},"fn_name":null},{"line":199,"address":[5493040,5492961],"length":1,"stats":{"Line":2},"fn_name":null},{"line":201,"address":[5493077,5493208],"length":1,"stats":{"Line":1},"fn_name":null},{"line":205,"address":[4686853,4686848],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":206,"address":[5493591],"length":1,"stats":{"Line":1},"fn_name":null},{"line":207,"address":[5493649,5493727],"length":1,"stats":{"Line":2},"fn_name":null},{"line":209,"address":[5493761,5493883],"length":1,"stats":{"Line":1},"fn_name":null},{"line":213,"address":[4686880,4686885],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":214,"address":[5494263],"length":1,"stats":{"Line":1},"fn_name":null},{"line":215,"address":[5494398,5494320],"length":1,"stats":{"Line":2},"fn_name":null},{"line":217,"address":[5494554,5494432],"length":1,"stats":{"Line":1},"fn_name":null},{"line":221,"address":[4686917,4686912],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":222,"address":[5494935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":223,"address":[5495071,5494993],"length":1,"stats":{"Line":2},"fn_name":null},{"line":225,"address":[5495105,5495227],"length":1,"stats":{"Line":1},"fn_name":null},{"line":229,"address":[4686949,4686944],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":230,"address":[5495610],"length":1,"stats":{"Line":1},"fn_name":null},{"line":231,"address":[5495652],"length":1,"stats":{"Line":1},"fn_name":null},{"line":233,"address":[5495666,5495800],"length":1,"stats":{"Line":1},"fn_name":null},{"line":237,"address":[4686976,4686981],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":238,"address":[5496183],"length":1,"stats":{"Line":1},"fn_name":null},{"line":239,"address":[5496236,5496292],"length":1,"stats":{"Line":2},"fn_name":null},{"line":241,"address":[5496448,5496326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":250,"address":[5332885,5332880],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":251,"address":[5793591],"length":1,"stats":{"Line":1},"fn_name":null},{"line":252,"address":[5793615],"length":1,"stats":{"Line":1},"fn_name":null},{"line":254,"address":[5793639,5793740],"length":1,"stats":{"Line":1},"fn_name":null},{"line":258,"address":[5332912,5332917],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":259,"address":[5794039],"length":1,"stats":{"Line":1},"fn_name":null},{"line":260,"address":[5794063],"length":1,"stats":{"Line":1},"fn_name":null},{"line":262,"address":[5794222,5794121],"length":1,"stats":{"Line":1},"fn_name":null},{"line":266,"address":[5332949,5332944],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":267,"address":[5794519],"length":1,"stats":{"Line":1},"fn_name":null},{"line":268,"address":[5794543],"length":1,"stats":{"Line":1},"fn_name":null},{"line":270,"address":[5794668,5794567],"length":1,"stats":{"Line":1},"fn_name":null},{"line":279,"address":[5409697,5409616],"length":1,"stats":{"Line":3},"fn_name":"one_range"},{"line":280,"address":[5409623],"length":1,"stats":{"Line":1},"fn_name":null},{"line":281,"address":[5410376,5409655,5409712],"length":1,"stats":{"Line":2},"fn_name":null},{"line":282,"address":[5409862,5409776],"length":1,"stats":{"Line":2},"fn_name":null},{"line":283,"address":[5409921],"length":1,"stats":{"Line":1},"fn_name":null},{"line":285,"address":[5410065,5409957],"length":1,"stats":{"Line":1},"fn_name":null},{"line":289,"address":[5410448,5410529],"length":1,"stats":{"Line":3},"fn_name":"empty_range"},{"line":290,"address":[5410455],"length":1,"stats":{"Line":1},"fn_name":null},{"line":291,"address":[5410487,5411208,5410544],"length":1,"stats":{"Line":2},"fn_name":null},{"line":292,"address":[5410694,5410608],"length":1,"stats":{"Line":2},"fn_name":null},{"line":293,"address":[5410753],"length":1,"stats":{"Line":1},"fn_name":null},{"line":295,"address":[5410789,5410897],"length":1,"stats":{"Line":1},"fn_name":null},{"line":299,"address":[5411302,5411280],"length":1,"stats":{"Line":3},"fn_name":"empty_iterator"},{"line":300,"address":[5411287],"length":1,"stats":{"Line":1},"fn_name":null},{"line":301,"address":[5411325,5411402],"length":1,"stats":{"Line":2},"fn_name":null},{"line":302,"address":[5411409],"length":1,"stats":{"Line":1},"fn_name":null},{"line":304,"address":[5411447,5411558],"length":1,"stats":{"Line":1},"fn_name":null},{"line":308,"address":[5411904,5412039],"length":1,"stats":{"Line":3},"fn_name":"not_intersected_ranges"},{"line":309,"address":[5411911],"length":1,"stats":{"Line":1},"fn_name":null},{"line":310,"address":[5412062,5412139],"length":1,"stats":{"Line":2},"fn_name":null},{"line":311,"address":[5412146],"length":1,"stats":{"Line":1},"fn_name":null},{"line":313,"address":[5412184,5412295],"length":1,"stats":{"Line":1},"fn_name":null},{"line":317,"address":[5412775,5412640],"length":1,"stats":{"Line":3},"fn_name":"two_intersected_ranges"},{"line":318,"address":[5412647],"length":1,"stats":{"Line":1},"fn_name":null},{"line":319,"address":[5412798,5412875],"length":1,"stats":{"Line":2},"fn_name":null},{"line":320,"address":[5412934],"length":1,"stats":{"Line":1},"fn_name":null},{"line":322,"address":[5413072,5412964],"length":1,"stats":{"Line":1},"fn_name":null},{"line":326,"address":[5413408,5413587],"length":1,"stats":{"Line":3},"fn_name":"three_intersected_ranges"},{"line":327,"address":[5413415],"length":1,"stats":{"Line":1},"fn_name":null},{"line":328,"address":[5413610,5413693],"length":1,"stats":{"Line":2},"fn_name":null},{"line":329,"address":[5413752],"length":1,"stats":{"Line":1},"fn_name":null},{"line":331,"address":[5413782,5413890],"length":1,"stats":{"Line":1},"fn_name":null},{"line":335,"address":[5414359,5414224],"length":1,"stats":{"Line":3},"fn_name":"two_ranges_one_empty"},{"line":336,"address":[5414231],"length":1,"stats":{"Line":1},"fn_name":null},{"line":337,"address":[5414382,5414459],"length":1,"stats":{"Line":2},"fn_name":null},{"line":338,"address":[5414466],"length":1,"stats":{"Line":1},"fn_name":null},{"line":340,"address":[5414504,5414615],"length":1,"stats":{"Line":1},"fn_name":null},{"line":357,"address":[4230560,4234128,4237712,4237779,4226976,4227043,4230627,4234195],"length":1,"stats":{"Line":12},"fn_name":"btc_regular_ret"},{"line":358,"address":[4234782,4238348,4231196,4227630],"length":1,"stats":{"Line":4},"fn_name":null},{"line":359,"address":[4234947,4234883,4227795,4238513,4231297,4227731,4238449,4231361],"length":1,"stats":{"Line":8},"fn_name":null},{"line":361,"address":[4227840,4234992,4238558,4231406],"length":1,"stats":{"Line":4},"fn_name":null},{"line":362,"address":[4235249,4228097,4238815,4231663],"length":1,"stats":{"Line":4},"fn_name":null},{"line":364,"address":[4231813,4235441,4228506,4238965,4235399,4235658,4239007,4228289,4239224,4232072,4231855,4228247],"length":1,"stats":{"Line":8},"fn_name":null},{"line":365,"address":[4236241,4237548,4232690,4229089,4235592,4232655,4229431,4232997,4228875,4239842,4236027,4229124,4239807,4232441,4232006,4228440,4239593,4236276,4239158,4233962,4241114,4240149,4236583,4230396],"length":1,"stats":{"Line":16},"fn_name":null},{"line":366,"address":[4236378,4239944,4229226,4232792],"length":1,"stats":{"Line":4},"fn_name":null},{"line":367,"address":[4236588,4239992,4233002,4240154,4229436,4236426,4229274,4232840],"length":1,"stats":{"Line":4},"fn_name":null},{"line":375,"address":[4227068,4226988,4227558],"length":1,"stats":{"Line":3},"fn_name":null},{"line":406,"address":[4231124,4230652,4230572],"length":1,"stats":{"Line":3},"fn_name":null},{"line":437,"address":[4234710,4234140,4234220],"length":1,"stats":{"Line":3},"fn_name":null},{"line":468,"address":[4237804,4238276,4237724],"length":1,"stats":{"Line":3},"fn_name":null},{"line":505,"address":[4256457,4251401,4253929,4246304,4256384,4251328,4246366,4243792,4258985,4253856,4241342,4258912,4241280,4243854,4248816,4248878],"length":1,"stats":{"Line":24},"fn_name":"btc_regular_regular_vol"},{"line":506,"address":[4248979,4243955,4251502,4256558,4259086,4241443,4254030,4246467],"length":1,"stats":{"Line":8},"fn_name":null},{"line":507,"address":[4249103,4244127,4249151,4251626,4254154,4256682,4244079,4251674,4259210,4259258,4246591,4254202,4246639,4256730,4241567,4241615],"length":1,"stats":{"Line":16},"fn_name":null},{"line":509,"address":[4254247,4241660,4246684,4249196,4256775,4251719,4259303,4244172],"length":1,"stats":{"Line":8},"fn_name":null},{"line":510,"address":[4254504,4249453,4259560,4241917,4251976,4257032,4246941,4244429],"length":1,"stats":{"Line":8},"fn_name":null},{"line":512,"address":[4257164,4249585,4247073,4259692,4244561,4254636,4252108,4242049],"length":1,"stats":{"Line":8},"fn_name":null},{"line":514,"address":[4247088,4242128,4259707,4252123,4254715,4259771,4257179,4257243,4249600,4249664,4244576,4247152,4242064,4254651,4244640,4252187],"length":1,"stats":{"Line":8},"fn_name":null},{"line":515,"address":[4242341,4254928,4244853,4249877,4247365,4259984,4257456,4252400],"length":1,"stats":{"Line":8},"fn_name":null},{"line":517,"address":[4250102,4245261,4260392,4242566,4260209,4245078,4257681,4257864,4247590,4242749,4255153,4255336,4252808,4247773,4252625,4250285],"length":1,"stats":{"Line":8},"fn_name":null},{"line":524,"address":[4241292,4241357],"length":1,"stats":{"Line":2},"fn_name":null},{"line":525,"address":[4243804,4243869],"length":1,"stats":{"Line":2},"fn_name":null},{"line":526,"address":[4246381,4246316],"length":1,"stats":{"Line":2},"fn_name":null},{"line":527,"address":[4248893,4248828],"length":1,"stats":{"Line":2},"fn_name":null},{"line":528,"address":[4251340,4251416],"length":1,"stats":{"Line":2},"fn_name":null},{"line":529,"address":[4253868,4253944],"length":1,"stats":{"Line":2},"fn_name":null},{"line":530,"address":[4256472,4256396],"length":1,"stats":{"Line":2},"fn_name":null},{"line":531,"address":[4258924,4259000],"length":1,"stats":{"Line":2},"fn_name":null},{"line":538,"address":[4265632,4274016,4269824,4269913,4265710,4261440,4274105,4261518],"length":1,"stats":{"Line":12},"fn_name":"btc_eos_regular_regular_cor"},{"line":539,"address":[4265858,4270061,4274253,4261666],"length":1,"stats":{"Line":4},"fn_name":null},{"line":541,"address":[4266014,4270217,4274409,4261822,4274490,4266095,4270298,4261903],"length":1,"stats":{"Line":8},"fn_name":null},{"line":542,"address":[4261956,4274543,4270351,4266148],"length":1,"stats":{"Line":4},"fn_name":null},{"line":544,"address":[4270426,4262031,4266223,4274618],"length":1,"stats":{"Line":4},"fn_name":null},{"line":545,"address":[4274875,4266480,4270683,4262288],"length":1,"stats":{"Line":4},"fn_name":null},{"line":546,"address":[4270785,4262390,4274977,4266582,4262636,4271031,4275223,4266828],"length":1,"stats":{"Line":4},"fn_name":null},{"line":547,"address":[4266857,4262665,4271060,4275252],"length":1,"stats":{"Line":4},"fn_name":null},{"line":549,"address":[4275384,4271192,4262797,4266989],"length":1,"stats":{"Line":4},"fn_name":null},{"line":550,"address":[4262842,4275429,4271262,4275454,4267034,4267059,4271237,4262867],"length":1,"stats":{"Line":8},"fn_name":null},{"line":552,"address":[4262875,4275462,4267067,4271270],"length":1,"stats":{"Line":4},"fn_name":null},{"line":553,"address":[4267324,4263132,4271527,4275719],"length":1,"stats":{"Line":4},"fn_name":null},{"line":554,"address":[4267458,4271661,4271907,4267704,4263512,4276099,4275853,4263266],"length":1,"stats":{"Line":4},"fn_name":null},{"line":555,"address":[4276128,4267733,4271936,4263541],"length":1,"stats":{"Line":4},"fn_name":null},{"line":557,"address":[4272110,4276302,4267907,4263715],"length":1,"stats":{"Line":4},"fn_name":null},{"line":559,"address":[4267914,4276309,4263722,4263786,4272117,4267978,4276373,4272181],"length":1,"stats":{"Line":4},"fn_name":null},{"line":560,"address":[4276586,4272394,4263999,4268191],"length":1,"stats":{"Line":4},"fn_name":null},{"line":562,"address":[4272697,4268319,4268494,4272522,4276714,4264302,4276889,4264127],"length":1,"stats":{"Line":4},"fn_name":null},{"line":569,"address":[4261452,4261541,4261845],"length":1,"stats":{"Line":2},"fn_name":null},{"line":570,"address":[4265733,4265644,4266037],"length":1,"stats":{"Line":2},"fn_name":null},{"line":571,"address":[4269836,4270240,4269936],"length":1,"stats":{"Line":2},"fn_name":null},{"line":572,"address":[4274432,4274028,4274128],"length":1,"stats":{"Line":2},"fn_name":null},{"line":577,"address":[4324707,4324688],"length":1,"stats":{"Line":3},"fn_name":"calc_linear_return_for_btc_using_only_genesis"},{"line":578,"address":[4324727,4324695],"length":1,"stats":{"Line":3},"fn_name":null},{"line":579,"address":[5278300],"length":1,"stats":{"Line":1},"fn_name":null},{"line":580,"address":[5278324,5278397],"length":1,"stats":{"Line":2},"fn_name":null},{"line":583,"address":[5278240,5278259],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":584,"address":[5278484],"length":1,"stats":{"Line":1},"fn_name":null},{"line":585,"address":[5278674,5278502],"length":1,"stats":{"Line":2},"fn_name":null},{"line":597,"address":[5278934,5278682],"length":1,"stats":{"Line":1},"fn_name":null},{"line":598,"address":[5279552,5279303,5279791,5280705,5279517,5278868],"length":1,"stats":{"Line":4},"fn_name":null},{"line":599,"address":[5279634,5279796],"length":1,"stats":{"Line":1},"fn_name":null},{"line":605,"address":[4324784,4324803],"length":1,"stats":{"Line":3},"fn_name":"calc_log_return_for_btc_using_only_genesis"},{"line":606,"address":[4324823,4324791],"length":1,"stats":{"Line":3},"fn_name":null},{"line":607,"address":[5280908],"length":1,"stats":{"Line":1},"fn_name":null},{"line":608,"address":[5280932,5281005],"length":1,"stats":{"Line":2},"fn_name":null},{"line":611,"address":[5280867,5280848],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":612,"address":[5281092],"length":1,"stats":{"Line":1},"fn_name":null},{"line":613,"address":[5281282,5281110],"length":1,"stats":{"Line":2},"fn_name":null},{"line":625,"address":[5281290,5281542],"length":1,"stats":{"Line":1},"fn_name":null},{"line":626,"address":[5282399,5282160,5281911,5282125,5283313,5281476],"length":1,"stats":{"Line":4},"fn_name":null},{"line":627,"address":[5282404,5282242],"length":1,"stats":{"Line":1},"fn_name":null},{"line":633,"address":[4324880,4324899],"length":1,"stats":{"Line":3},"fn_name":"calc_linear_return_for_eos_using_only_genesis"},{"line":634,"address":[4324887,4324919],"length":1,"stats":{"Line":3},"fn_name":null},{"line":635,"address":[5283516],"length":1,"stats":{"Line":1},"fn_name":null},{"line":636,"address":[5283540,5283613],"length":1,"stats":{"Line":2},"fn_name":null},{"line":639,"address":[5283456,5283475],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":640,"address":[5283700],"length":1,"stats":{"Line":1},"fn_name":null},{"line":641,"address":[5283884,5283718],"length":1,"stats":{"Line":2},"fn_name":null},{"line":653,"address":[5283892,5284144],"length":1,"stats":{"Line":1},"fn_name":null},{"line":654,"address":[5284727,5284762,5284513,5285915,5285001,5284078],"length":1,"stats":{"Line":4},"fn_name":null},{"line":655,"address":[5284844,5285006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":661,"address":[4324995,4324976],"length":1,"stats":{"Line":3},"fn_name":"calc_log_return_for_eos_using_only_genesis"},{"line":662,"address":[4324983,4325015],"length":1,"stats":{"Line":3},"fn_name":null},{"line":663,"address":[5286124],"length":1,"stats":{"Line":1},"fn_name":null},{"line":664,"address":[5286148,5286221],"length":1,"stats":{"Line":2},"fn_name":null},{"line":667,"address":[5286083,5286064],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":668,"address":[5286308],"length":1,"stats":{"Line":1},"fn_name":null},{"line":669,"address":[5286492,5286326],"length":1,"stats":{"Line":2},"fn_name":null},{"line":681,"address":[5286752,5286500],"length":1,"stats":{"Line":1},"fn_name":null},{"line":682,"address":[5287335,5287609,5287121,5288523,5286686,5287370],"length":1,"stats":{"Line":4},"fn_name":null},{"line":683,"address":[5287452,5287614],"length":1,"stats":{"Line":1},"fn_name":null},{"line":689,"address":[4325091,4325072],"length":1,"stats":{"Line":3},"fn_name":"calc_linear_return_for_btc_using_some_oracle_prices"},{"line":690,"address":[4325079,4325111],"length":1,"stats":{"Line":3},"fn_name":null},{"line":691,"address":[5288732,5288871],"length":1,"stats":{"Line":2},"fn_name":null},{"line":694,"address":[5288934],"length":1,"stats":{"Line":1},"fn_name":null},{"line":696,"address":[5288971],"length":1,"stats":{"Line":1},"fn_name":null},{"line":697,"address":[5289023],"length":1,"stats":{"Line":1},"fn_name":null},{"line":699,"address":[5289335,5289903,5289045,5289260],"length":1,"stats":{"Line":3},"fn_name":null},{"line":700,"address":[5289401],"length":1,"stats":{"Line":1},"fn_name":null},{"line":702,"address":[5289439],"length":1,"stats":{"Line":1},"fn_name":null},{"line":704,"address":[5289735],"length":1,"stats":{"Line":1},"fn_name":null},{"line":705,"address":[5289881],"length":1,"stats":{"Line":1},"fn_name":null},{"line":709,"address":[5289908],"length":1,"stats":{"Line":1},"fn_name":null},{"line":712,"address":[5288672,5288691],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":713,"address":[5290054],"length":1,"stats":{"Line":1},"fn_name":null},{"line":714,"address":[5290072,5290244],"length":1,"stats":{"Line":2},"fn_name":null},{"line":726,"address":[5290504,5290252],"length":1,"stats":{"Line":1},"fn_name":null},{"line":727,"address":[5292329,5291122,5290873,5291361,5290438,5291087],"length":1,"stats":{"Line":4},"fn_name":null},{"line":728,"address":[5291366,5291204],"length":1,"stats":{"Line":1},"fn_name":null},{"line":734,"address":[4325168,4325187],"length":1,"stats":{"Line":3},"fn_name":"initial_prices_state_with_empty_genesis"},{"line":735,"address":[4325175,4325207],"length":1,"stats":{"Line":3},"fn_name":null},{"line":736,"address":[5292535],"length":1,"stats":{"Line":1},"fn_name":null},{"line":738,"address":[5292543],"length":1,"stats":{"Line":1},"fn_name":null},{"line":739,"address":[5292578],"length":1,"stats":{"Line":1},"fn_name":null},{"line":741,"address":[5292590],"length":1,"stats":{"Line":1},"fn_name":null},{"line":742,"address":[5292611],"length":1,"stats":{"Line":1},"fn_name":null},{"line":744,"address":[5292878,5292631],"length":1,"stats":{"Line":1},"fn_name":null},{"line":745,"address":[5293203,5293227,5292783],"length":1,"stats":{"Line":2},"fn_name":null},{"line":750,"address":[4325264,4325283],"length":1,"stats":{"Line":3},"fn_name":"initial_prices_state_with_nonempty_genesis"},{"line":751,"address":[4325271,4325303],"length":1,"stats":{"Line":3},"fn_name":null},{"line":752,"address":[5293639],"length":1,"stats":{"Line":1},"fn_name":null},{"line":754,"address":[5293647],"length":1,"stats":{"Line":1},"fn_name":null},{"line":755,"address":[5293682],"length":1,"stats":{"Line":1},"fn_name":null},{"line":757,"address":[5293694],"length":1,"stats":{"Line":1},"fn_name":null},{"line":758,"address":[5293746,5293826],"length":1,"stats":{"Line":2},"fn_name":null},{"line":759,"address":[5293902,5293841],"length":1,"stats":{"Line":2},"fn_name":null},{"line":764,"address":[5293932],"length":1,"stats":{"Line":1},"fn_name":null},{"line":765,"address":[5294003],"length":1,"stats":{"Line":1},"fn_name":null},{"line":766,"address":[5294075,5294039],"length":1,"stats":{"Line":2},"fn_name":null},{"line":768,"address":[5294298,5294090],"length":1,"stats":{"Line":1},"fn_name":null},{"line":769,"address":[5294665,5294778,5294203],"length":1,"stats":{"Line":2},"fn_name":null},{"line":770,"address":[5295108,5294671],"length":1,"stats":{"Line":1},"fn_name":null},{"line":775,"address":[4325379,4325360],"length":1,"stats":{"Line":3},"fn_name":"first_price_with_empty_genesis"},{"line":776,"address":[4325399,4325367],"length":1,"stats":{"Line":3},"fn_name":null},{"line":777,"address":[5295607],"length":1,"stats":{"Line":1},"fn_name":null},{"line":779,"address":[5295620],"length":1,"stats":{"Line":1},"fn_name":null},{"line":781,"address":[5295682],"length":1,"stats":{"Line":1},"fn_name":null},{"line":782,"address":[5295746],"length":1,"stats":{"Line":1},"fn_name":null},{"line":783,"address":[5295822],"length":1,"stats":{"Line":1},"fn_name":null},{"line":785,"address":[5295827],"length":1,"stats":{"Line":1},"fn_name":null},{"line":787,"address":[5296129],"length":1,"stats":{"Line":1},"fn_name":null},{"line":788,"address":[5296150],"length":1,"stats":{"Line":1},"fn_name":null},{"line":790,"address":[5296266],"length":1,"stats":{"Line":1},"fn_name":null},{"line":791,"address":[5296398,5296318],"length":1,"stats":{"Line":2},"fn_name":null},{"line":792,"address":[5296415],"length":1,"stats":{"Line":1},"fn_name":null},{"line":794,"address":[5296481],"length":1,"stats":{"Line":1},"fn_name":null},{"line":795,"address":[5296517,5296553],"length":1,"stats":{"Line":2},"fn_name":null},{"line":797,"address":[5296776,5296568],"length":1,"stats":{"Line":1},"fn_name":null},{"line":798,"address":[5297256,5296681,5297143],"length":1,"stats":{"Line":2},"fn_name":null},{"line":799,"address":[5297592,5297149],"length":1,"stats":{"Line":1},"fn_name":null},{"line":804,"address":[4325475,4325456],"length":1,"stats":{"Line":3},"fn_name":"new_price_is_in_the_past"},{"line":805,"address":[4325463,4325495],"length":1,"stats":{"Line":3},"fn_name":null},{"line":806,"address":[5298055],"length":1,"stats":{"Line":1},"fn_name":null},{"line":808,"address":[5298068],"length":1,"stats":{"Line":1},"fn_name":null},{"line":810,"address":[5298130],"length":1,"stats":{"Line":1},"fn_name":null},{"line":811,"address":[5298194],"length":1,"stats":{"Line":1},"fn_name":null},{"line":812,"address":[5298270],"length":1,"stats":{"Line":1},"fn_name":null},{"line":814,"address":[5298275],"length":1,"stats":{"Line":1},"fn_name":null},{"line":816,"address":[5298582],"length":1,"stats":{"Line":1},"fn_name":null},{"line":817,"address":[5298627],"length":1,"stats":{"Line":1},"fn_name":null},{"line":818,"address":[5298703],"length":1,"stats":{"Line":1},"fn_name":null},{"line":820,"address":[5298708],"length":1,"stats":{"Line":1},"fn_name":null},{"line":822,"address":[5298747],"length":1,"stats":{"Line":1},"fn_name":null},{"line":823,"address":[5298961,5298824],"length":1,"stats":{"Line":1},"fn_name":null},{"line":825,"address":[5298935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":826,"address":[5299296],"length":1,"stats":{"Line":1},"fn_name":null},{"line":828,"address":[5299412],"length":1,"stats":{"Line":1},"fn_name":null},{"line":829,"address":[5299464,5299544],"length":1,"stats":{"Line":2},"fn_name":null},{"line":830,"address":[5299561],"length":1,"stats":{"Line":1},"fn_name":null},{"line":832,"address":[5299627],"length":1,"stats":{"Line":1},"fn_name":null},{"line":833,"address":[5299699,5299663],"length":1,"stats":{"Line":2},"fn_name":null},{"line":835,"address":[5299714,5299922],"length":1,"stats":{"Line":1},"fn_name":null},{"line":836,"address":[5300402,5300289,5299827],"length":1,"stats":{"Line":2},"fn_name":null},{"line":837,"address":[5300295,5300738],"length":1,"stats":{"Line":1},"fn_name":null},{"line":842,"address":[4325571,4325552],"length":1,"stats":{"Line":3},"fn_name":"new_price_is_in_current_period"},{"line":843,"address":[4325591,4325559],"length":1,"stats":{"Line":3},"fn_name":null},{"line":844,"address":[5301207],"length":1,"stats":{"Line":1},"fn_name":null},{"line":846,"address":[5301220],"length":1,"stats":{"Line":1},"fn_name":null},{"line":848,"address":[5301282],"length":1,"stats":{"Line":1},"fn_name":null},{"line":849,"address":[5301346],"length":1,"stats":{"Line":1},"fn_name":null},{"line":850,"address":[5301422],"length":1,"stats":{"Line":1},"fn_name":null},{"line":852,"address":[5301427],"length":1,"stats":{"Line":1},"fn_name":null},{"line":854,"address":[5301734],"length":1,"stats":{"Line":1},"fn_name":null},{"line":855,"address":[5301780],"length":1,"stats":{"Line":1},"fn_name":null},{"line":856,"address":[5301856],"length":1,"stats":{"Line":1},"fn_name":null},{"line":858,"address":[5301868],"length":1,"stats":{"Line":1},"fn_name":null},{"line":859,"address":[5301861],"length":1,"stats":{"Line":1},"fn_name":null},{"line":863,"address":[5302163],"length":1,"stats":{"Line":1},"fn_name":null},{"line":864,"address":[5302184],"length":1,"stats":{"Line":1},"fn_name":null},{"line":870,"address":[5302300],"length":1,"stats":{"Line":1},"fn_name":null},{"line":871,"address":[5302432,5302352],"length":1,"stats":{"Line":2},"fn_name":null},{"line":872,"address":[5302449],"length":1,"stats":{"Line":1},"fn_name":null},{"line":874,"address":[5302515],"length":1,"stats":{"Line":1},"fn_name":null},{"line":875,"address":[5302587,5302551],"length":1,"stats":{"Line":2},"fn_name":null},{"line":877,"address":[5302602,5302810],"length":1,"stats":{"Line":1},"fn_name":null},{"line":878,"address":[5302715,5303290,5303177],"length":1,"stats":{"Line":2},"fn_name":null},{"line":879,"address":[5303626,5303183],"length":1,"stats":{"Line":1},"fn_name":null},{"line":884,"address":[4325648,4325667],"length":1,"stats":{"Line":3},"fn_name":"new_price_is_in_next_period"},{"line":885,"address":[4325655,4325687],"length":1,"stats":{"Line":3},"fn_name":null},{"line":886,"address":[5304087],"length":1,"stats":{"Line":1},"fn_name":null},{"line":888,"address":[5304100],"length":1,"stats":{"Line":1},"fn_name":null},{"line":890,"address":[5304163],"length":1,"stats":{"Line":1},"fn_name":null},{"line":891,"address":[5304239],"length":1,"stats":{"Line":1},"fn_name":null},{"line":893,"address":[5304244],"length":1,"stats":{"Line":1},"fn_name":null},{"line":895,"address":[5304548],"length":1,"stats":{"Line":1},"fn_name":null},{"line":896,"address":[5304614],"length":1,"stats":{"Line":1},"fn_name":null},{"line":897,"address":[5304660],"length":1,"stats":{"Line":1},"fn_name":null},{"line":898,"address":[5304736],"length":1,"stats":{"Line":1},"fn_name":null},{"line":900,"address":[5304748],"length":1,"stats":{"Line":1},"fn_name":null},{"line":901,"address":[5304741],"length":1,"stats":{"Line":1},"fn_name":null},{"line":905,"address":[5305043],"length":1,"stats":{"Line":1},"fn_name":null},{"line":906,"address":[5305064],"length":1,"stats":{"Line":1},"fn_name":null},{"line":912,"address":[5305180],"length":1,"stats":{"Line":1},"fn_name":null},{"line":913,"address":[5305232,5305312],"length":1,"stats":{"Line":2},"fn_name":null},{"line":914,"address":[5305329],"length":1,"stats":{"Line":1},"fn_name":null},{"line":916,"address":[5305422],"length":1,"stats":{"Line":1},"fn_name":null},{"line":917,"address":[5305494,5305458],"length":1,"stats":{"Line":2},"fn_name":null},{"line":919,"address":[5305717,5305509],"length":1,"stats":{"Line":1},"fn_name":null},{"line":920,"address":[5305622,5306197,5306084],"length":1,"stats":{"Line":2},"fn_name":null},{"line":921,"address":[5306533,5306090],"length":1,"stats":{"Line":1},"fn_name":null},{"line":926,"address":[4325744,4325763],"length":1,"stats":{"Line":3},"fn_name":"new_price_is_a_few_periods_ahead"},{"line":927,"address":[4325783,4325751],"length":1,"stats":{"Line":3},"fn_name":null},{"line":928,"address":[5306999],"length":1,"stats":{"Line":1},"fn_name":null},{"line":930,"address":[5307012],"length":1,"stats":{"Line":1},"fn_name":null},{"line":932,"address":[5307075],"length":1,"stats":{"Line":1},"fn_name":null},{"line":933,"address":[5307151],"length":1,"stats":{"Line":1},"fn_name":null},{"line":935,"address":[5307156],"length":1,"stats":{"Line":1},"fn_name":null},{"line":937,"address":[5307460],"length":1,"stats":{"Line":1},"fn_name":null},{"line":938,"address":[5307526],"length":1,"stats":{"Line":1},"fn_name":null},{"line":939,"address":[5307572],"length":1,"stats":{"Line":1},"fn_name":null},{"line":940,"address":[5307648],"length":1,"stats":{"Line":1},"fn_name":null},{"line":942,"address":[5307660],"length":1,"stats":{"Line":1},"fn_name":null},{"line":943,"address":[5307653],"length":1,"stats":{"Line":1},"fn_name":null},{"line":947,"address":[5307955],"length":1,"stats":{"Line":1},"fn_name":null},{"line":948,"address":[5307976],"length":1,"stats":{"Line":1},"fn_name":null},{"line":954,"address":[5308092],"length":1,"stats":{"Line":1},"fn_name":null},{"line":955,"address":[5308144,5308224],"length":1,"stats":{"Line":2},"fn_name":null},{"line":956,"address":[5308241],"length":1,"stats":{"Line":1},"fn_name":null},{"line":958,"address":[5308358],"length":1,"stats":{"Line":1},"fn_name":null},{"line":959,"address":[5308394,5308430],"length":1,"stats":{"Line":2},"fn_name":null},{"line":961,"address":[5308653,5308445],"length":1,"stats":{"Line":1},"fn_name":null},{"line":962,"address":[5308558,5309020,5309133],"length":1,"stats":{"Line":2},"fn_name":null},{"line":963,"address":[5309469,5309026],"length":1,"stats":{"Line":1},"fn_name":null},{"line":968,"address":[4325859,4325840],"length":1,"stats":{"Line":3},"fn_name":"new_price_is_many_periods_ahead"},{"line":969,"address":[4325847,4325879],"length":1,"stats":{"Line":3},"fn_name":null},{"line":970,"address":[5309927],"length":1,"stats":{"Line":1},"fn_name":null},{"line":972,"address":[5309940],"length":1,"stats":{"Line":1},"fn_name":null},{"line":974,"address":[5310003],"length":1,"stats":{"Line":1},"fn_name":null},{"line":975,"address":[5310079],"length":1,"stats":{"Line":1},"fn_name":null},{"line":977,"address":[5310084],"length":1,"stats":{"Line":1},"fn_name":null},{"line":979,"address":[5310388],"length":1,"stats":{"Line":1},"fn_name":null},{"line":980,"address":[5310454],"length":1,"stats":{"Line":1},"fn_name":null},{"line":981,"address":[5310500],"length":1,"stats":{"Line":1},"fn_name":null},{"line":982,"address":[5310576],"length":1,"stats":{"Line":1},"fn_name":null},{"line":984,"address":[5310588],"length":1,"stats":{"Line":1},"fn_name":null},{"line":985,"address":[5310581],"length":1,"stats":{"Line":1},"fn_name":null},{"line":989,"address":[5310883],"length":1,"stats":{"Line":1},"fn_name":null},{"line":990,"address":[5310904],"length":1,"stats":{"Line":1},"fn_name":null},{"line":996,"address":[5311020],"length":1,"stats":{"Line":1},"fn_name":null},{"line":997,"address":[5311072,5311152],"length":1,"stats":{"Line":2},"fn_name":null},{"line":998,"address":[5312805,5311159,5311262],"length":1,"stats":{"Line":2},"fn_name":null},{"line":999,"address":[5311293],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1001,"address":[5311344,5311300],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1002,"address":[5311351],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1004,"address":[5311387,5311595],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1005,"address":[5311962,5311500,5312075],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1006,"address":[5312411,5311968],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1011,"address":[4325936,4325955],"length":1,"stats":{"Line":3},"fn_name":"wrong_now_in_the_distant_future"},{"line":1012,"address":[4325975,4325943],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1013,"address":[5312903],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1015,"address":[5312916],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1017,"address":[5312978],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1018,"address":[5313042],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1019,"address":[5313118],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1021,"address":[5313123],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1023,"address":[5313430],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1024,"address":[5313473],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1025,"address":[5313530],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1027,"address":[5313535],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1028,"address":[5313574],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1029,"address":[5313651,5313788],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1031,"address":[5313762],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1032,"address":[5314123],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1034,"address":[5314239],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1035,"address":[5314371,5314291],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1036,"address":[5314388],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1038,"address":[5314454],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1039,"address":[5314490,5314526],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1041,"address":[5314749,5314541],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1042,"address":[5314654,5315116,5315229],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1043,"address":[5315565,5315122],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1048,"address":[4326032,4326051],"length":1,"stats":{"Line":3},"fn_name":"new_price_has_arravied_while_prices_countainer_is_full"},{"line":1049,"address":[4326039,4326071],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1050,"address":[5316023],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1052,"address":[5316156,5316031],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1057,"address":[5316248],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1058,"address":[5316300],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1060,"address":[5316598,5317144,5316348],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1061,"address":[5316647],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1063,"address":[5316680],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1065,"address":[5316976],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1066,"address":[5317122],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1069,"address":[5317172,5316567],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1070,"address":[5317214],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1072,"address":[5317269],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1077,"address":[5317544],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1078,"address":[5317567],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1080,"address":[5317702],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1081,"address":[5317755,5317835],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1082,"address":[5317973,5317842],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1083,"address":[5318051],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1085,"address":[5318058,5318105],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1086,"address":[5318112],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1088,"address":[5318356,5318148],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1089,"address":[5318723,5318261,5318836],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1090,"address":[5319172,5318729],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1094,"address":[4323312],"length":1,"stats":{"Line":1},"fn_name":"btc_prices"},{"line":1095,"address":[4323322],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1106,"address":[4324064],"length":1,"stats":{"Line":1},"fn_name":"eos_prices"},{"line":1107,"address":[4324074],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1117,"address":[4326147,4326128],"length":1,"stats":{"Line":3},"fn_name":"calc_correlation_different_price_periods_results_in_periods_intersection"},{"line":1118,"address":[4326167,4326135],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1119,"address":[5319671,5319760],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1122,"address":[5319823],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1124,"address":[5319860],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1125,"address":[5319912],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1127,"address":[5320792,5320149,5319934,5320224],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1128,"address":[5320290],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1130,"address":[5320328],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1132,"address":[5320624],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1133,"address":[5320770],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1136,"address":[5320832],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1137,"address":[5320797],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1138,"address":[5320805],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1139,"address":[5320816],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1140,"address":[5320824],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1142,"address":[5320887],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1143,"address":[5321134],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1144,"address":[5321385],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1145,"address":[5321282],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1146,"address":[5321353],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1149,"address":[5321542,5321436],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1162,"address":[5632288,5632293],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1163,"address":[5632320],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1164,"address":[5632361],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1165,"address":[5632334],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1166,"address":[5632342],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1167,"address":[5632353],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1169,"address":[5632409],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1170,"address":[5632670],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1171,"address":[5632776],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1172,"address":[5632798],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1173,"address":[5632988,5632807],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1178,"address":[5633621,5633616],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1179,"address":[5633648],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1180,"address":[5633689],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1181,"address":[5633662],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1182,"address":[5633670],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1183,"address":[5633681],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1185,"address":[5633737],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1186,"address":[5633998],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1187,"address":[5634104],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1188,"address":[5634126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1189,"address":[5634316,5634135],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1194,"address":[5634949,5634944],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1195,"address":[5634976],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1196,"address":[5635017],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1197,"address":[5634990],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1198,"address":[5634998],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1199,"address":[5635009],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1201,"address":[5635065],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1202,"address":[5635326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1203,"address":[5635432],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1204,"address":[5635454],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1205,"address":[5635644,5635463],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1210,"address":[5636272,5636277],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1211,"address":[5636304],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1212,"address":[5636345],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1213,"address":[5636318],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1214,"address":[5636326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1215,"address":[5636337],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1217,"address":[5636393],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1218,"address":[5636654],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1219,"address":[5636760],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1220,"address":[5636782],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1221,"address":[5636791,5636972],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1226,"address":[5637605,5637600],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1227,"address":[5637632],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1228,"address":[5637684],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1229,"address":[5637646],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1230,"address":[5637654],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1231,"address":[5637676],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1233,"address":[5637732],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1234,"address":[5637993],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1235,"address":[5638099],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1236,"address":[5638121],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1237,"address":[5638311,5638130],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1242,"address":[5638949,5638944],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1243,"address":[5638976],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1244,"address":[5639028],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1245,"address":[5638990],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1246,"address":[5638998],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1247,"address":[5639020],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1249,"address":[5639076],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1250,"address":[5639337],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1251,"address":[5639443],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1252,"address":[5639465],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1253,"address":[5639474,5639655],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1258,"address":[5640293,5640288],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1259,"address":[5640320],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1260,"address":[5640372],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1261,"address":[5640334],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1262,"address":[5640342],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1263,"address":[5640364],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1265,"address":[5640420],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1266,"address":[5640681],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1267,"address":[5640787],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1268,"address":[5640809],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1269,"address":[5640818,5640999],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1274,"address":[5641637,5641632],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1275,"address":[5641664],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1276,"address":[5641716],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1277,"address":[5641678],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1278,"address":[5641686],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1279,"address":[5641708],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1281,"address":[5641764],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1282,"address":[5642025],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1283,"address":[5642131],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1284,"address":[5642153],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1285,"address":[5642162,5642343],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1290,"address":[5642976,5642981],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1291,"address":[5643008],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1292,"address":[5643050],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1293,"address":[5643015],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1294,"address":[5643020],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1295,"address":[5643042],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1298,"address":[5643092],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1300,"address":[5643285,5643181],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1305,"address":[5643589,5643584],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1306,"address":[5643616],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1307,"address":[5643650],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1308,"address":[5643623],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1309,"address":[5643631],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1310,"address":[5643642],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1312,"address":[5643698],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1313,"address":[5643935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1314,"address":[5644029],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1315,"address":[5644043],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1317,"address":[5644170,5644055],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1322,"address":[5644448,5644453],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1323,"address":[5644480],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1324,"address":[5644525],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1325,"address":[5644487],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1326,"address":[5644495],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1327,"address":[5644517],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1329,"address":[5644573],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1330,"address":[5644810],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1331,"address":[5644904],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1332,"address":[5644918],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1334,"address":[5644930,5645045],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1339,"address":[5645328,5645333],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1340,"address":[5645360],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1341,"address":[5645391],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1342,"address":[5645367],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1343,"address":[5645372],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1344,"address":[5645383],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1347,"address":[5645433],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1349,"address":[5645522,5645626],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1354,"address":[5645925,5645920],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1355,"address":[5645952],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1356,"address":[5645994],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1357,"address":[5645959],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1358,"address":[5645964],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1359,"address":[5645986],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1362,"address":[5646036],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1364,"address":[5646229,5646125],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1378,"address":[4630005,4630000],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1379,"address":[4630032],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1380,"address":[4630081],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1381,"address":[4630046],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1382,"address":[4630054],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1383,"address":[4630065],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1384,"address":[4630073],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1386,"address":[4630160],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1387,"address":[4630428],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1388,"address":[4630537],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1389,"address":[4630565],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1390,"address":[4630755,4630574],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1395,"address":[4631397,4631392],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1396,"address":[4631424],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1397,"address":[4631473],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1398,"address":[4631438],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1399,"address":[4631446],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1400,"address":[4631457],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1401,"address":[4631465],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1403,"address":[4631552],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1404,"address":[4631820],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1405,"address":[4631929],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1406,"address":[4631957],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1407,"address":[4632147,4631966],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1412,"address":[4632784,4632789],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1413,"address":[4632816],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1414,"address":[4632876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1415,"address":[4632830],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1416,"address":[4632838],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1417,"address":[4632860],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1418,"address":[4632868],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1420,"address":[4632955],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1421,"address":[4633223],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1422,"address":[4633332],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1423,"address":[4633360],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1424,"address":[4633550,4633369],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1429,"address":[4634181,4634176],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1430,"address":[4634208],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1431,"address":[4634268],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1432,"address":[4634222],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1433,"address":[4634230],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1434,"address":[4634252],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1435,"address":[4634260],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1437,"address":[4634347],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1438,"address":[4634615],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1439,"address":[4634724],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1440,"address":[4634752],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1441,"address":[4634942,4634761],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1446,"address":[4635573,4635568],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1447,"address":[4635600],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1448,"address":[4635653],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1449,"address":[4635607],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1450,"address":[4635615],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1451,"address":[4635637],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1452,"address":[4635645],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1456,"address":[4635723],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1458,"address":[4635916,4635812],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1463,"address":[4636213,4636208],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1464,"address":[4636240],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1465,"address":[4636282],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1466,"address":[4636247],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1467,"address":[4636255],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1468,"address":[4636266],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1469,"address":[4636274],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1471,"address":[4636361],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1472,"address":[4636605],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1473,"address":[4636702],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1474,"address":[4636722],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1476,"address":[4636849,4636734],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1481,"address":[4637136,4637141],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1482,"address":[4637168],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1483,"address":[4637221],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1484,"address":[4637175],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1485,"address":[4637183],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1486,"address":[4637205],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1487,"address":[4637213],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1489,"address":[4637300],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1490,"address":[4637544],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1491,"address":[4637641],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1492,"address":[4637661],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1494,"address":[4637788,4637673],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1499,"address":[4638080,4638085],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1500,"address":[4638112],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1501,"address":[4638154],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1502,"address":[4638119],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1503,"address":[4638127],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1504,"address":[4638138],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1505,"address":[4638146],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1508,"address":[4638224],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1510,"address":[4638313,4638417],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1515,"address":[4638709,4638704],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1516,"address":[4638736],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":1517,"address":[4638789],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1518,"address":[4638743],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1519,"address":[4638751],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1520,"address":[4638773],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1521,"address":[4638781],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1524,"address":[4638859],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1526,"address":[4639052,4638948],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1540,"address":[4626419,4626400],"length":1,"stats":{"Line":3},"fn_name":"calc_portf_vol_btc_eos_regular_regular"},{"line":1541,"address":[4626407,4626439],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1542,"address":[5415006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1543,"address":[5415076],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1545,"address":[5415165],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1546,"address":[5415146],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1547,"address":[5415154],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1550,"address":[5415210],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1551,"address":[5415471],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1552,"address":[5415577],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1553,"address":[5415599],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1554,"address":[5415608,5415789],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1559,"address":[4626515,4626496],"length":1,"stats":{"Line":3},"fn_name":"calc_portf_var_btc_eos_regular_regular"},{"line":1560,"address":[4626503,4626535],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1561,"address":[5416462],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1562,"address":[5416532],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1564,"address":[5416621],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1565,"address":[5416602],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1566,"address":[5416610],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1570,"address":[5416672],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1571,"address":[5416933],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1572,"address":[5417039],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1573,"address":[5417061],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1574,"address":[5417251,5417070],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":748,"coverable":748},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","manual-timestamp","src","lib.rs"],"content":"#![cfg_attr(not(feature = \"std\"), no_std)]\n\nuse frame_support::traits::UnixTime;\nuse frame_support::{decl_error, decl_event, decl_module, decl_storage, dispatch, traits::Get};\nuse frame_system::ensure_signed;\n\n#[cfg(test)]\nmod mock;\n\n#[cfg(test)]\nmod tests;\n\npub trait Trait: frame_system::Trait {\n    type Event: From\u003cEvent\u003cSelf\u003e\u003e + Into\u003c\u003cSelf as frame_system::Trait\u003e::Event\u003e;\n}\n\ndecl_storage! {\n    trait Store for Module\u003cT: Trait\u003e as OracleModule {\n        pub Now get(fn now): u64;\n    }\n    add_extra_genesis {\n        config(timestamp): u64;\n\n        build(|config| {\n            Now::put(config.timestamp);\n        });\n    }\n}\n\ndecl_event!(\n    pub enum Event\u003cT\u003e\n    where\n        AccountId = \u003cT as frame_system::Trait\u003e::AccountId,\n    {\n        NowAdvanced(u64, AccountId),\n    }\n);\n\ndecl_error! {\n    pub enum Error for Module\u003cT: Trait\u003e {}\n}\n\ndecl_module! {\n    pub struct Module\u003cT: Trait\u003e for enum Call where origin: T::Origin {\n        type Error = Error\u003cT\u003e;\n\n        fn deposit_event() = default;\n\n        #[weight = 10_000 + T::DbWeight::get().writes(1)]\n        pub fn advance_secs(origin, secs: u32) -\u003e dispatch::DispatchResult {\n            let who = ensure_signed(origin)?;\n            let new_now = Self::now() + 1000 * (secs as u64);\n\n            \u003cSelf as Store\u003e::Now::put(new_now);\n\n            Self::deposit_event(RawEvent::NowAdvanced(new_now, who));\n            Ok(())\n        }\n    }\n}\n\nimpl\u003cT: Trait\u003e UnixTime for Module\u003cT\u003e {\n    fn now() -\u003e core::time::Duration {\n        core::time::Duration::from_millis(Self::now())\n    }\n}\n","traces":[{"line":17,"address":[91425680,91426329,91425636,91425833,91426389,91426597,91426512,91426320,91426576,91425632,91426533,91426286,91426448,91425698,91426112,91426480,91426368,91426129,91425922,91426496,91426272,91426256,91426176],"length":1,"stats":{"Line":16},"fn_name":"default"},{"line":24,"address":[4956416,4956460],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}"},{"line":25,"address":[84696382],"length":1,"stats":{"Line":2},"fn_name":null},{"line":35,"address":[67900625,67900792,67900916,67901076,67900952,67900924,67901084],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[67899550,67899182,67899294,67899474,67899370,67899432],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[4338803,4338372,4338773],"length":1,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[4958860,4958680,4958807,4958718,4958587],"length":1,"stats":{"Line":3},"fn_name":null},{"line":52,"address":[4958941,4959320,4958795],"length":1,"stats":{"Line":2},"fn_name":null},{"line":54,"address":[4959016],"length":1,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[67898148],"length":1,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[4959090],"length":1,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":10,"coverable":13},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","manual-timestamp","src","mock.rs"],"content":"use crate::{Module, Trait};\nuse frame_support::{impl_outer_origin, parameter_types, weights::Weight};\nuse frame_system as system;\nuse sp_core::H256;\nuse sp_runtime::{\n    testing::Header,\n    traits::{BlakeTwo256, IdentityLookup},\n    Perbill,\n};\n\nimpl_outer_origin! {\n    pub enum Origin for Test {}\n}\n\n// Configure a mock runtime to test the pallet.\n\n#[derive(Clone, Eq, PartialEq)]\npub struct Test;\nparameter_types! {\n    pub const BlockHashCount: u64 = 250;\n    pub const MaximumBlockWeight: Weight = 1024;\n    pub const MaximumBlockLength: u32 = 2 * 1024;\n    pub const AvailableBlockRatio: Perbill = Perbill::from_percent(75);\n}\n\nimpl system::Trait for Test {\n    type BaseCallFilter = ();\n    type Origin = Origin;\n    type Call = ();\n    type Index = u64;\n    type BlockNumber = u64;\n    type Hash = H256;\n    type Hashing = BlakeTwo256;\n    type AccountId = u64;\n    type Lookup = IdentityLookup\u003cSelf::AccountId\u003e;\n    type Header = Header;\n    type Event = ();\n    type BlockHashCount = BlockHashCount;\n    type MaximumBlockWeight = MaximumBlockWeight;\n    type DbWeight = ();\n    type BlockExecutionWeight = ();\n    type ExtrinsicBaseWeight = ();\n    type MaximumExtrinsicWeight = MaximumBlockWeight;\n    type MaximumBlockLength = MaximumBlockLength;\n    type AvailableBlockRatio = AvailableBlockRatio;\n    type Version = ();\n    type ModuleToIndex = ();\n    type AccountData = ();\n    type OnNewAccount = ();\n    type OnKilledAccount = ();\n    type SystemWeightInfo = ();\n}\n\nimpl Trait for Test {\n    type Event = ();\n}\n\npub type TimestampModule = Module\u003cTest\u003e;\n\npub const INITIAL_TIMESTAMP: u64 = 11223344000;\n\n// Build genesis storage according to the mock runtime.\npub fn new_test_ext() -\u003e sp_io::TestExternalities {\n    let mut t = system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap();\n\n    crate::GenesisConfig {\n        timestamp: INITIAL_TIMESTAMP,\n    }\n    .assimilate_storage(\u0026mut t)\n    .unwrap();\n\n    t.into()\n}\n","traces":[{"line":11,"address":[4901888,4901957],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[4254881],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[4252047,4252000],"length":1,"stats":{"Line":2},"fn_name":"new_test_ext"},{"line":64,"address":[4252075,4252010],"length":1,"stats":{"Line":4},"fn_name":null},{"line":74,"address":[4252198],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":3,"coverable":5},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","manual-timestamp","src","tests.rs"],"content":"use crate::mock::*;\nuse core::time::Duration;\nuse frame_support::assert_ok;\nuse frame_support::traits::UnixTime;\n\n#[test]\nfn genesis_timestamp() {\n    new_test_ext().execute_with(|| {\n        assert_eq!(\n            \u003cTimestampModule as UnixTime\u003e::now(),\n            Duration::from_millis(INITIAL_TIMESTAMP)\n        );\n    });\n}\n\n#[test]\nfn advance_secs() {\n    new_test_ext().execute_with(|| {\n        let delta = 543;\n        assert_ok!(TimestampModule::advance_secs(Origin::signed(1), delta));\n        assert_eq!(\n            \u003cTimestampModule as UnixTime\u003e::now(),\n            Duration::from_millis(INITIAL_TIMESTAMP + (1000 * delta as u64))\n        );\n    });\n}\n","traces":[{"line":7,"address":[4620656,4620675],"length":1,"stats":{"Line":3},"fn_name":"genesis_timestamp"},{"line":8,"address":[4620663,4620695],"length":1,"stats":{"Line":3},"fn_name":null},{"line":9,"address":[5138109,5138205],"length":1,"stats":{"Line":1},"fn_name":null},{"line":10,"address":[5138071],"length":1,"stats":{"Line":1},"fn_name":null},{"line":11,"address":[5138095],"length":1,"stats":{"Line":1},"fn_name":null},{"line":17,"address":[4620771,4620752],"length":1,"stats":{"Line":3},"fn_name":"advance_secs"},{"line":18,"address":[4620759,4620791],"length":1,"stats":{"Line":3},"fn_name":null},{"line":19,"address":[5138519],"length":1,"stats":{"Line":1},"fn_name":null},{"line":20,"address":[5138530],"length":1,"stats":{"Line":1},"fn_name":null},{"line":21,"address":[5139045,5138931],"length":1,"stats":{"Line":1},"fn_name":null},{"line":22,"address":[5138819],"length":1,"stats":{"Line":1},"fn_name":null},{"line":23,"address":[5139322,5138839],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":12,"coverable":12},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","oracle","src","lib.rs"],"content":"#![cfg_attr(not(feature = \"std\"), no_std)]\n\nuse financial_primitives::OnPriceSet;\nuse frame_support::codec::Codec;\nuse frame_support::dispatch::Parameter;\nuse frame_support::{decl_error, decl_event, decl_module, decl_storage, dispatch, traits::Get};\nuse frame_system::ensure_signed;\n\n#[cfg(test)]\nmod mock;\n\n#[cfg(test)]\nmod tests;\n\npub trait Trait: frame_system::Trait {\n    type Event: From\u003cEvent\u003cSelf\u003e\u003e + Into\u003c\u003cSelf as frame_system::Trait\u003e::Event\u003e;\n    type Asset: Codec + Parameter + Default + Copy;\n    type Price: Codec + Parameter + Default + Copy;\n    type OnPriceSet: OnPriceSet\u003cPrice = Self::Price, Asset = Self::Asset\u003e;\n}\n\ndecl_storage! {\n    trait Store for Module\u003cT: Trait\u003e as OracleModule {\n        PricePoints get(fn price_points): map hasher(identity) T::Asset =\u003e T::Price;\n    }\n    add_extra_genesis {\n        config(prices): Vec\u003c(T::Asset, T::Price)\u003e;\n\n        build(|config| {\n            for \u0026(asset, value) in config.prices.iter() {\n                PricePoints::\u003cT\u003e::insert(asset, value);\n            }\n        });\n    }\n}\n\ndecl_event!(\n    pub enum Event\u003cT\u003e\n    where\n        AccountId = \u003cT as frame_system::Trait\u003e::AccountId,\n        Asset = \u003cT as Trait\u003e::Asset,\n        Price = \u003cT as Trait\u003e::Price,\n    {\n        PriceSet(Asset, Price, AccountId),\n    }\n);\n\ndecl_error! {\n    pub enum Error for Module\u003cT: Trait\u003e {}\n}\n\ndecl_module! {\n    pub struct Module\u003cT: Trait\u003e for enum Call where origin: T::Origin {\n        type Error = Error\u003cT\u003e;\n\n        fn deposit_event() = default;\n\n        #[weight = 10_000 + T::DbWeight::get().writes(1)]\n        pub fn set_price(origin, asset: T::Asset, value: T::Price) -\u003e dispatch::DispatchResult {\n            let who = ensure_signed(origin)?;\n\n            PricePoints::\u003cT\u003e::insert(asset, value);\n\n            let _ = T::OnPriceSet::on_price_set(asset, value);\n            Self::deposit_event(RawEvent::PriceSet(asset, value, who));\n            Ok(())\n        }\n    }\n}\n","traces":[{"line":22,"address":[67594032,67602272,67595200,67599200,67599250,67602279,67592949,67595337,67599136,67595210,67592928,67602192,67599153,67602216,67594112],"length":1,"stats":{"Line":6},"fn_name":"build_module_genesis_storage\u003cnode_template_runtime::Runtime,oracle::__InherentHiddenInstance\u003e"},{"line":29,"address":[67599280,67599219],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":30,"address":[74334896,74334689,74334898,74334826],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[67599478],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[5831157,5830537,5830715,5830987,5830436,5830884],"length":1,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[67600561,67600591,67600038],"length":1,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[4518175,4518074,4517943,4518228,4518036],"length":1,"stats":{"Line":3},"fn_name":null},{"line":62,"address":[74332996],"length":1,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[4518309],"length":1,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[4518334],"length":1,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[4518406],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":6,"coverable":11},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","oracle","src","mock.rs"],"content":"use crate::{Module, Trait};\nuse common::Asset;\nuse financial_primitives::OnPriceSet;\nuse frame_support::dispatch::DispatchError;\nuse frame_support::{impl_outer_origin, parameter_types, weights::Weight};\nuse frame_system as system;\nuse sp_core::H256;\nuse sp_runtime::{\n    testing::Header,\n    traits::{BlakeTwo256, IdentityLookup},\n    Perbill,\n};\n\nimpl_outer_origin! {\n    pub enum Origin for Test {}\n}\n\n// Configure a mock runtime to test the pallet.\n\n#[derive(Clone, Eq, PartialEq)]\npub struct Test;\nparameter_types! {\n    pub const BlockHashCount: u64 = 250;\n    pub const MaximumBlockWeight: Weight = 1024;\n    pub const MaximumBlockLength: u32 = 2 * 1024;\n    pub const AvailableBlockRatio: Perbill = Perbill::from_percent(75);\n}\n\nimpl system::Trait for Test {\n    type BaseCallFilter = ();\n    type Origin = Origin;\n    type Call = ();\n    type Index = u64;\n    type BlockNumber = u64;\n    type Hash = H256;\n    type Hashing = BlakeTwo256;\n    type AccountId = u64;\n    type Lookup = IdentityLookup\u003cSelf::AccountId\u003e;\n    type Header = Header;\n    type Event = ();\n    type BlockHashCount = BlockHashCount;\n    type MaximumBlockWeight = MaximumBlockWeight;\n    type DbWeight = ();\n    type BlockExecutionWeight = ();\n    type ExtrinsicBaseWeight = ();\n    type MaximumExtrinsicWeight = MaximumBlockWeight;\n    type MaximumBlockLength = MaximumBlockLength;\n    type AvailableBlockRatio = AvailableBlockRatio;\n    type Version = ();\n    type ModuleToIndex = ();\n    type AccountData = ();\n    type OnNewAccount = ();\n    type OnKilledAccount = ();\n    type SystemWeightInfo = ();\n}\n\nimpl Trait for Test {\n    type Event = ();\n    type Asset = Asset;\n    type Price = u32;\n    type OnPriceSet = TestOnPriceSet;\n}\n\npub struct TestOnPriceSet;\n\nimpl OnPriceSet for TestOnPriceSet {\n    type Asset = Asset;\n    type Price = u32;\n    fn on_price_set(_asset: Asset, _value: u32) -\u003e Result\u003c(), DispatchError\u003e {\n        Ok(())\n    }\n}\n\npub type OracleModule = Module\u003cTest\u003e;\n\n// Build genesis storage according to the mock runtime.\npub fn new_test_ext() -\u003e sp_io::TestExternalities {\n    system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap()\n        .into()\n}\n","traces":[{"line":14,"address":[5151653,5151584],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[4838705],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":77,"address":[4836048,4836087],"length":1,"stats":{"Line":1},"fn_name":"new_test_ext"},{"line":78,"address":[4836172,4836058,4836115],"length":1,"stats":{"Line":3},"fn_name":null}],"covered":4,"coverable":6},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","oracle","src","tests.rs"],"content":"use crate::mock::*;\nuse common::Asset;\nuse frame_support::assert_ok;\n\n#[test]\nfn set_price_is_visible_through_storage() {\n    new_test_ext().execute_with(|| {\n        assert_ok!(OracleModule::set_price(Origin::signed(1), Asset::Btc, 42));\n        assert_eq!(OracleModule::price_points(Asset::Btc), 42);\n    });\n}\n","traces":[{"line":6,"address":[4701333,4701328],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":7,"address":[4701360],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":8,"address":[4701367],"length":1,"stats":{"Line":1},"fn_name":null},{"line":9,"address":[4701794,4701660],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":4,"coverable":4},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","portfolio","src","lib.rs"],"content":"#![cfg_attr(not(feature = \"std\"), no_std)]\n\nuse financial_primitives::BalanceAware;\nuse frame_support::codec::Codec;\nuse frame_support::dispatch::{DispatchError, DispatchResult, Parameter};\nuse frame_support::{decl_error, decl_event, decl_module, decl_storage, dispatch, traits::Get};\nuse frame_system::ensure_signed;\nuse sp_std::vec::Vec;\n\n#[cfg(test)]\nmod mock;\n\n#[cfg(test)]\nmod tests;\n\npub trait Trait: frame_system::Trait {\n    type Event: From\u003cEvent\u003cSelf\u003e\u003e + Into\u003c\u003cSelf as frame_system::Trait\u003e::Event\u003e;\n    type Asset: Codec + Parameter + Default + Copy;\n    type Balance: Codec + Parameter + Default + Copy;\n}\n\ndecl_storage! {\n    trait Store for Module\u003cT: Trait\u003e as OracleModule {\n        Balances get(fn balances): double_map hasher(blake2_128_concat) T::AccountId, hasher(identity) T::Asset =\u003e T::Balance;\n    }\n}\n\ndecl_event!(\n    pub enum Event\u003cT\u003e\n    where\n        AccountId = \u003cT as frame_system::Trait\u003e::AccountId,\n        Asset = \u003cT as Trait\u003e::Asset,\n        Balance = \u003cT as Trait\u003e::Balance,\n    {\n        BalanceSet(AccountId, Asset, Balance, AccountId),\n    }\n);\n\ndecl_error! {\n    pub enum Error for Module\u003cT: Trait\u003e {}\n}\n\ndecl_module! {\n    pub struct Module\u003cT: Trait\u003e for enum Call where origin: T::Origin {\n        type Error = Error\u003cT\u003e;\n\n        fn deposit_event() = default;\n\n        #[weight = 10_000 + T::DbWeight::get().writes(1)]\n        pub fn set_balance(origin, account_id: T::AccountId,  asset: T::Asset, balance: T::Balance) -\u003e dispatch::DispatchResult {\n            let who = ensure_signed(origin)?;\n\n            Balances::\u003cT\u003e::mutate(\u0026account_id, asset, |b| -\u003e DispatchResult {\n                *b = balance;\n                Ok(())\n            })?;\n\n            Self::deposit_event(RawEvent::BalanceSet(account_id, asset, balance, who));\n            Ok(())\n        }\n    }\n}\n\nimpl\u003cT: Trait\u003e BalanceAware for Module\u003cT\u003e {\n    type AccountId = T::AccountId;\n    type Asset = T::Asset;\n    type Balance = T::Balance;\n\n    fn balances(\n        account_id: \u0026T::AccountId,\n        assets: \u0026[Self::Asset],\n    ) -\u003e Result\u003cVec\u003cSelf::Balance\u003e, DispatchError\u003e {\n        Ok(assets\n            .iter()\n            .map(|a| \u003cBalances\u003cT\u003e\u003e::get(account_id, a))\n            .collect())\n    }\n}\n","traces":[{"line":22,"address":[5032320,5032304,5032192,5032213,5032272],"length":1,"stats":{"Line":10},"fn_name":"fmt"},{"line":35,"address":[4221159,4221340,4221295,4222207,4221807,4221563,4221963],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[4220128,4219638,4220098],"length":1,"stats":{"Line":0},"fn_name":"dispatch_bypass_filter\u003cnode_template_runtime::Runtime\u003e"},{"line":51,"address":[74835848,74835988,74835945,74836185,74836148],"length":1,"stats":{"Line":3},"fn_name":null},{"line":53,"address":[4225025,4224783,4225424,4224580],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}\u003cnode_template_runtime::Runtime\u003e"},{"line":54,"address":[74836976],"length":1,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[4225454],"length":1,"stats":{"Line":1},"fn_name":null},{"line":58,"address":[5025772],"length":1,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[68101310],"length":1,"stats":{"Line":1},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":10,"coverable":14},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","portfolio","src","mock.rs"],"content":"use crate::{Module, Trait};\nuse common::Asset;\nuse frame_support::{impl_outer_origin, parameter_types, weights::Weight};\nuse frame_system as system;\nuse sp_core::H256;\nuse sp_runtime::{\n    testing::Header,\n    traits::{BlakeTwo256, IdentityLookup},\n    Perbill,\n};\n\nimpl_outer_origin! {\n    pub enum Origin for Test {}\n}\n\n// Configure a mock runtime to test the pallet.\n\n#[derive(Clone, Eq, PartialEq)]\npub struct Test;\nparameter_types! {\n    pub const BlockHashCount: u64 = 250;\n    pub const MaximumBlockWeight: Weight = 1024;\n    pub const MaximumBlockLength: u32 = 2 * 1024;\n    pub const AvailableBlockRatio: Perbill = Perbill::from_percent(75);\n}\n\nimpl system::Trait for Test {\n    type BaseCallFilter = ();\n    type Origin = Origin;\n    type Call = ();\n    type Index = u64;\n    type BlockNumber = u64;\n    type Hash = H256;\n    type Hashing = BlakeTwo256;\n    type AccountId = u64;\n    type Lookup = IdentityLookup\u003cSelf::AccountId\u003e;\n    type Header = Header;\n    type Event = ();\n    type BlockHashCount = BlockHashCount;\n    type MaximumBlockWeight = MaximumBlockWeight;\n    type DbWeight = ();\n    type BlockExecutionWeight = ();\n    type ExtrinsicBaseWeight = ();\n    type MaximumExtrinsicWeight = MaximumBlockWeight;\n    type MaximumBlockLength = MaximumBlockLength;\n    type AvailableBlockRatio = AvailableBlockRatio;\n    type Version = ();\n    type ModuleToIndex = ();\n    type AccountData = ();\n    type OnNewAccount = ();\n    type OnKilledAccount = ();\n    type SystemWeightInfo = ();\n}\n\nimpl Trait for Test {\n    type Event = ();\n    type Asset = Asset;\n    type Balance = u32;\n}\n\npub type PortfolioModule = Module\u003cTest\u003e;\n\n// Build genesis storage according to the mock runtime.\npub fn new_test_ext() -\u003e sp_io::TestExternalities {\n    system::GenesisConfig::default()\n        .build_storage::\u003cTest\u003e()\n        .unwrap()\n        .into()\n}\n","traces":[{"line":12,"address":[4742656,4742725],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[5137937],"length":1,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[5135319,5135280],"length":1,"stats":{"Line":1},"fn_name":"new_test_ext"},{"line":65,"address":[5135347,5135404,5135290],"length":1,"stats":{"Line":3},"fn_name":null}],"covered":2,"coverable":4},{"path":["/","home","rotor","work","src","polka","financial-pallet","pallets","portfolio","src","tests.rs"],"content":"use crate::mock::*;\nuse common::Asset;\nuse financial_primitives::BalanceAware;\nuse frame_support::assert_ok;\n\n#[test]\nfn default_balance_is_zero() {\n    new_test_ext().execute_with(|| {\n        //assert_ok!(OracleModule::set_price(Origin::signed(1), Asset::Btc, 42));\n        assert_eq!(PortfolioModule::balances(123, Asset::Btc), 0);\n    });\n}\n\n#[test]\nfn set_balance() {\n    new_test_ext().execute_with(|| {\n        assert_ok!(PortfolioModule::set_balance(\n            Origin::signed(1),\n            456,\n            Asset::Btc,\n            42\n        ));\n        assert_eq!(PortfolioModule::balances(456, Asset::Btc), 42);\n    });\n}\n\n#[test]\nfn balance_aware_balances() {\n    new_test_ext().execute_with(|| {\n        assert_ok!(PortfolioModule::set_balance(\n            Origin::signed(1),\n            456,\n            Asset::Btc,\n            42\n        ));\n        assert_ok!(PortfolioModule::set_balance(\n            Origin::signed(1),\n            456,\n            Asset::Eos,\n            11\n        ));\n        let actual = \u003cPortfolioModule as BalanceAware\u003e::balances(\n            \u0026456,\n            \u0026vec![Asset::Eos, Asset::Btc, Asset::Usd],\n        );\n\n        assert_eq!(actual, Ok(vec![11, 42, 0]));\n    });\n}\n","traces":[{"line":7,"address":[4310325,4310320],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":8,"address":[4813639,4813607],"length":1,"stats":{"Line":3},"fn_name":null},{"line":10,"address":[4310474,4310359],"length":1,"stats":{"Line":1},"fn_name":null},{"line":15,"address":[4813715,4813696],"length":1,"stats":{"Line":3},"fn_name":"set_balance"},{"line":16,"address":[4813735,4813703],"length":1,"stats":{"Line":3},"fn_name":null},{"line":17,"address":[4310817],"length":1,"stats":{"Line":1},"fn_name":null},{"line":18,"address":[4310791],"length":1,"stats":{"Line":1},"fn_name":null},{"line":20,"address":[4310809],"length":1,"stats":{"Line":1},"fn_name":null},{"line":23,"address":[4311090,4311229],"length":1,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[4311525,4311520],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":29,"address":[4311552,4311579],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":30,"address":[4311602],"length":1,"stats":{"Line":1},"fn_name":null},{"line":31,"address":[4311559],"length":1,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[4311594],"length":1,"stats":{"Line":1},"fn_name":null},{"line":36,"address":[4311931],"length":1,"stats":{"Line":1},"fn_name":null},{"line":37,"address":[4311905],"length":1,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[4311923],"length":1,"stats":{"Line":1},"fn_name":null},{"line":42,"address":[4312401],"length":1,"stats":{"Line":1},"fn_name":null},{"line":43,"address":[4312228],"length":1,"stats":{"Line":1},"fn_name":null},{"line":44,"address":[4312235],"length":1,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[4312451],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":21,"coverable":21},{"path":["/","home","rotor","work","src","polka","financial-pallet","runtime","build.rs"],"content":"use wasm_builder_runner::WasmBuilder;\n\nfn main() {\n    WasmBuilder::new()\n        .with_current_project()\n        .with_wasm_builder_from_crates(\"2.0.0\")\n        .export_heap_base()\n        .import_memory()\n        .build()\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","rotor","work","src","polka","financial-pallet","runtime","src","lib.rs"],"content":"#![cfg_attr(not(feature = \"std\"), no_std)]\n// `construct_runtime!` does a lot of recursion and requires us to increase the limit to 256.\n#![recursion_limit = \"256\"]\n\n// Make the WASM binary available.\n#[cfg(feature = \"std\")]\ninclude!(concat!(env!(\"OUT_DIR\"), \"/wasm_binary.rs\"));\n\nuse common::Asset;\nuse pallet_grandpa::fg_primitives;\nuse pallet_grandpa::{AuthorityId as GrandpaId, AuthorityList as GrandpaAuthorityList};\nuse sp_api::impl_runtime_apis;\nuse sp_consensus_aura::sr25519::AuthorityId as AuraId;\nuse sp_core::{crypto::KeyTypeId, OpaqueMetadata};\nuse sp_runtime::traits::{\n    BlakeTwo256, Block as BlockT, IdentifyAccount, IdentityLookup, NumberFor, Saturating, Verify,\n};\nuse sp_runtime::{\n    create_runtime_str, generic, impl_opaque_keys,\n    transaction_validity::{TransactionSource, TransactionValidity},\n    ApplyExtrinsicResult, MultiSignature,\n};\nuse sp_std::prelude::*;\n#[cfg(feature = \"std\")]\nuse sp_version::NativeVersion;\nuse sp_version::RuntimeVersion;\n\nuse financial_primitives::{CalcReturnType, CalcVolatilityType};\n\n// A few exports that help ease life for downstream crates.\npub use frame_support::{\n    construct_runtime, parameter_types,\n    traits::{KeyOwnerProofSystem, Randomness},\n    weights::{\n        constants::{BlockExecutionWeight, ExtrinsicBaseWeight, RocksDbWeight, WEIGHT_PER_SECOND},\n        IdentityFee, Weight,\n    },\n    StorageValue,\n};\npub use pallet_balances::Call as BalancesCall;\npub use pallet_timestamp::Call as TimestampCall;\n#[cfg(any(feature = \"std\", test))]\npub use sp_runtime::BuildStorage;\npub use sp_runtime::{Perbill, Permill};\n\n/// Import the financial pallet.\npub use financial_pallet;\n\n/// Import the oracle pallet.\npub use oracle;\n\n/// Import the manual-timestamp pallet.\npub use manual_timestamp;\n\n/// Import the portfolio pallet.\npub use portfolio;\n\n/// An index to a block.\npub type BlockNumber = u32;\n\n/// Alias to 512-bit hash when used in the context of a transaction signature on the chain.\npub type Signature = MultiSignature;\n\n/// Some way of identifying an account on the chain. We intentionally make it equivalent\n/// to the public key of our transaction signing scheme.\npub type AccountId = \u003c\u003cSignature as Verify\u003e::Signer as IdentifyAccount\u003e::AccountId;\n\n/// The type for looking up accounts. We don't expect more than 4 billion of them, but you\n/// never know...\npub type AccountIndex = u32;\n\n/// Balance of an account.\npub type Balance = u128;\n\n/// Index of a transaction in the chain.\npub type Index = u32;\n\n/// A hash of some data used by the chain.\npub type Hash = sp_core::H256;\n\n/// Digest item type.\npub type DigestItem = generic::DigestItem\u003cHash\u003e;\n\n/// Opaque types. These are used by the CLI to instantiate machinery that don't need to know\n/// the specifics of the runtime. They can then be made to be agnostic over specific formats\n/// of data like extrinsics, allowing for them to continue syncing the network through upgrades\n/// to even the core data structures.\npub mod opaque {\n    use super::*;\n\n    pub use sp_runtime::OpaqueExtrinsic as UncheckedExtrinsic;\n\n    /// Opaque block header type.\n    pub type Header = generic::Header\u003cBlockNumber, BlakeTwo256\u003e;\n    /// Opaque block type.\n    pub type Block = generic::Block\u003cHeader, UncheckedExtrinsic\u003e;\n    /// Opaque block identifier type.\n    pub type BlockId = generic::BlockId\u003cBlock\u003e;\n\n    impl_opaque_keys! {\n        pub struct SessionKeys {\n            pub aura: Aura,\n            pub grandpa: Grandpa,\n        }\n    }\n}\n\npub const VERSION: RuntimeVersion = RuntimeVersion {\n    spec_name: create_runtime_str!(\"node-template\"),\n    impl_name: create_runtime_str!(\"node-template\"),\n    authoring_version: 1,\n    spec_version: 1,\n    impl_version: 1,\n    apis: RUNTIME_API_VERSIONS,\n    transaction_version: 1,\n};\n\npub const MILLISECS_PER_BLOCK: u64 = 6000;\n\npub const SLOT_DURATION: u64 = MILLISECS_PER_BLOCK;\n\n// Time is measured by number of blocks.\npub const MINUTES: BlockNumber = 60_000 / (MILLISECS_PER_BLOCK as BlockNumber);\npub const HOURS: BlockNumber = MINUTES * 60;\npub const DAYS: BlockNumber = HOURS * 24;\n\n/// The version information used to identify this runtime when compiled natively.\n#[cfg(feature = \"std\")]\npub fn native_version() -\u003e NativeVersion {\n    NativeVersion {\n        runtime_version: VERSION,\n        can_author_with: Default::default(),\n    }\n}\n\nparameter_types! {\n    pub const BlockHashCount: BlockNumber = 2400;\n    /// We allow for 2 seconds of compute with a 6 second average block time.\n    pub const MaximumBlockWeight: Weight = 2 * WEIGHT_PER_SECOND;\n    pub const AvailableBlockRatio: Perbill = Perbill::from_percent(75);\n    /// Assume 10% of weight for average on_initialize calls.\n    pub MaximumExtrinsicWeight: Weight = AvailableBlockRatio::get()\n        .saturating_sub(Perbill::from_percent(10)) * MaximumBlockWeight::get();\n    pub const MaximumBlockLength: u32 = 5 * 1024 * 1024;\n    pub const Version: RuntimeVersion = VERSION;\n}\n\n// Configure FRAME pallets to include in runtime.\n\nimpl frame_system::Trait for Runtime {\n    /// The basic call filter to use in dispatchable.\n    type BaseCallFilter = ();\n    /// The identifier used to distinguish between accounts.\n    type AccountId = AccountId;\n    /// The aggregated dispatch type that is available for extrinsics.\n    type Call = Call;\n    /// The lookup mechanism to get account ID from whatever is passed in dispatchers.\n    type Lookup = IdentityLookup\u003cAccountId\u003e;\n    /// The index type for storing how many extrinsics an account has signed.\n    type Index = Index;\n    /// The index type for blocks.\n    type BlockNumber = BlockNumber;\n    /// The type for hashing blocks and tries.\n    type Hash = Hash;\n    /// The hashing algorithm used.\n    type Hashing = BlakeTwo256;\n    /// The header type.\n    type Header = generic::Header\u003cBlockNumber, BlakeTwo256\u003e;\n    /// The ubiquitous event type.\n    type Event = Event;\n    /// The ubiquitous origin type.\n    type Origin = Origin;\n    /// Maximum number of block number to block hash mappings to keep (oldest pruned first).\n    type BlockHashCount = BlockHashCount;\n    /// Maximum weight of each block.\n    type MaximumBlockWeight = MaximumBlockWeight;\n    /// The weight of database operations that the runtime can invoke.\n    type DbWeight = RocksDbWeight;\n    /// The weight of the overhead invoked on the block import process, independent of the\n    /// extrinsics included in that block.\n    type BlockExecutionWeight = BlockExecutionWeight;\n    /// The base weight of any extrinsic processed by the runtime, independent of the\n    /// logic of that extrinsic. (Signature verification, nonce increment, fee, etc...)\n    type ExtrinsicBaseWeight = ExtrinsicBaseWeight;\n    /// The maximum weight that a single extrinsic of `Normal` dispatch class can have,\n    /// idependent of the logic of that extrinsics. (Roughly max block weight - average on\n    /// initialize cost).\n    type MaximumExtrinsicWeight = MaximumExtrinsicWeight;\n    /// Maximum size of all encoded transactions (in bytes) that are allowed in one block.\n    type MaximumBlockLength = MaximumBlockLength;\n    /// Portion of the block weight that is available to all normal transactions.\n    type AvailableBlockRatio = AvailableBlockRatio;\n    /// Version of the runtime.\n    type Version = Version;\n    /// Converts a module to the index of the module in `construct_runtime!`.\n    ///\n    /// This type is being generated by `construct_runtime!`.\n    type ModuleToIndex = ModuleToIndex;\n    /// What to do if a new account is created.\n    type OnNewAccount = ();\n    /// What to do if an account is fully reaped from the system.\n    type OnKilledAccount = ();\n    /// The data to be stored in an account.\n    type AccountData = pallet_balances::AccountData\u003cBalance\u003e;\n    /// Weight information for the extrinsics of this pallet.\n    type SystemWeightInfo = ();\n}\n\nimpl pallet_aura::Trait for Runtime {\n    type AuthorityId = AuraId;\n}\n\nimpl pallet_grandpa::Trait for Runtime {\n    type Event = Event;\n    type Call = Call;\n\n    type KeyOwnerProofSystem = ();\n\n    type KeyOwnerProof =\n        \u003cSelf::KeyOwnerProofSystem as KeyOwnerProofSystem\u003c(KeyTypeId, GrandpaId)\u003e\u003e::Proof;\n\n    type KeyOwnerIdentification = \u003cSelf::KeyOwnerProofSystem as KeyOwnerProofSystem\u003c(\n        KeyTypeId,\n        GrandpaId,\n    )\u003e\u003e::IdentificationTuple;\n\n    type HandleEquivocation = ();\n}\n\nparameter_types! {\n    pub const MinimumPeriod: u64 = SLOT_DURATION / 2;\n}\n\nimpl pallet_timestamp::Trait for Runtime {\n    /// A timestamp: milliseconds since the unix epoch.\n    type Moment = u64;\n    type OnTimestampSet = Aura;\n    type MinimumPeriod = MinimumPeriod;\n    type WeightInfo = ();\n}\n\nparameter_types! {\n    pub const ExistentialDeposit: u128 = 500;\n}\n\nimpl pallet_balances::Trait for Runtime {\n    /// The type for recording an account's balance.\n    type Balance = Balance;\n    /// The ubiquitous event type.\n    type Event = Event;\n    type DustRemoval = ();\n    type ExistentialDeposit = ExistentialDeposit;\n    type AccountStore = System;\n    type WeightInfo = ();\n}\n\nparameter_types! {\n    pub const TransactionByteFee: Balance = 1;\n}\n\nimpl pallet_transaction_payment::Trait for Runtime {\n    type Currency = Balances;\n    type OnTransactionPayment = ();\n    type TransactionByteFee = TransactionByteFee;\n    type WeightToFee = IdentityFee\u003cBalance\u003e;\n    type FeeMultiplierUpdate = ();\n}\n\nimpl pallet_sudo::Trait for Runtime {\n    type Event = Event;\n    type Call = Call;\n}\n\nparameter_types! {\n    pub const PriceCount: u32 = 30;\n    pub const PricePeriod: u32 = 1440;\n    pub const ReturnType: u32 = CalcReturnType::Log.into_u32();\n    pub const VolCorType: i64 = CalcVolatilityType::Regular.into_i64();\n}\n\npub type FixedNumber = substrate_fixed::types::I64F64;\n\n/// Configure the pallet financial in pallets/financial.\nimpl financial_pallet::Trait for Runtime {\n    type Event = Event;\n    type UnixTime = manual_timestamp::Module\u003cRuntime\u003e;\n    type PriceCount = PriceCount;\n    type PricePeriod = PricePeriod;\n    type ReturnType = ReturnType;\n    type VolCorType = VolCorType;\n    type FixedNumberBits = i128;\n    type FixedNumber = FixedNumber;\n    type Price = FixedNumber;\n    type Asset = Asset;\n    type Balances = portfolio::Module\u003cRuntime\u003e;\n}\n\n/// Configure the pallet oracle in pallets/oracle.\nimpl oracle::Trait for Runtime {\n    type Event = Event;\n    type Price = FixedNumber;\n    type OnPriceSet = financial_pallet::Module\u003cRuntime\u003e;\n    type Asset = Asset;\n}\n\n/// Configure the pallet manual-timestamp in pallets/manual-timestamp.\nimpl manual_timestamp::Trait for Runtime {\n    type Event = Event;\n}\n\n/// Configure the pallet portfolio in pallets/portfolio.\nimpl portfolio::Trait for Runtime {\n    type Event = Event;\n    type Asset = Asset;\n    type Balance = FixedNumber;\n}\n\n// Create the runtime by composing the FRAME pallets that were previously configured.\nconstruct_runtime!(\n    pub enum Runtime where\n        Block = Block,\n        NodeBlock = opaque::Block,\n        UncheckedExtrinsic = UncheckedExtrinsic\n    {\n        System: frame_system::{Module, Call, Config, Storage, Event\u003cT\u003e},\n        RandomnessCollectiveFlip: pallet_randomness_collective_flip::{Module, Call, Storage},\n        Timestamp: pallet_timestamp::{Module, Call, Storage, Inherent},\n        Aura: pallet_aura::{Module, Config\u003cT\u003e, Inherent},\n        Grandpa: pallet_grandpa::{Module, Call, Storage, Config, Event},\n        Balances: pallet_balances::{Module, Call, Storage, Config\u003cT\u003e, Event\u003cT\u003e},\n        TransactionPayment: pallet_transaction_payment::{Module, Storage},\n        Sudo: pallet_sudo::{Module, Call, Config\u003cT\u003e, Storage, Event\u003cT\u003e},\n\n        Financial: financial_pallet::{Module, Call, Storage, Event\u003cT\u003e, Config\u003cT\u003e},\n        Oracle: oracle::{Module, Call, Storage, Event\u003cT\u003e, Config\u003cT\u003e},\n        ManualTimestamp: manual_timestamp::{Module, Call, Storage, Event\u003cT\u003e, Config},\n        Portfolio: portfolio::{Module, Call, Storage, Event\u003cT\u003e},\n    }\n);\n\n/// The address format for describing accounts.\npub type Address = AccountId;\n/// Block header type as expected by this runtime.\npub type Header = generic::Header\u003cBlockNumber, BlakeTwo256\u003e;\n/// Block type as expected by this runtime.\npub type Block = generic::Block\u003cHeader, UncheckedExtrinsic\u003e;\n/// A Block signed with a Justification\npub type SignedBlock = generic::SignedBlock\u003cBlock\u003e;\n/// BlockId type as expected by this runtime.\npub type BlockId = generic::BlockId\u003cBlock\u003e;\n/// The SignedExtension to the basic transaction logic.\npub type SignedExtra = (\n    frame_system::CheckSpecVersion\u003cRuntime\u003e,\n    frame_system::CheckTxVersion\u003cRuntime\u003e,\n    frame_system::CheckGenesis\u003cRuntime\u003e,\n    frame_system::CheckEra\u003cRuntime\u003e,\n    frame_system::CheckNonce\u003cRuntime\u003e,\n    frame_system::CheckWeight\u003cRuntime\u003e,\n    pallet_transaction_payment::ChargeTransactionPayment\u003cRuntime\u003e,\n);\n/// Unchecked extrinsic type as expected by this runtime.\npub type UncheckedExtrinsic = generic::UncheckedExtrinsic\u003cAddress, Call, Signature, SignedExtra\u003e;\n/// Extrinsic type that has already been checked.\npub type CheckedExtrinsic = generic::CheckedExtrinsic\u003cAccountId, Call, SignedExtra\u003e;\n/// Executive: handles dispatch to the various modules.\npub type Executive = frame_executive::Executive\u003c\n    Runtime,\n    Block,\n    frame_system::ChainContext\u003cRuntime\u003e,\n    Runtime,\n    AllModules,\n\u003e;\n\nimpl_runtime_apis! {\n    impl sp_api::Core\u003cBlock\u003e for Runtime {\n        fn version() -\u003e RuntimeVersion {\n            VERSION\n        }\n\n        fn execute_block(block: Block) {\n            Executive::execute_block(block)\n        }\n\n        fn initialize_block(header: \u0026\u003cBlock as BlockT\u003e::Header) {\n            Executive::initialize_block(header)\n        }\n    }\n\n    impl sp_api::Metadata\u003cBlock\u003e for Runtime {\n        fn metadata() -\u003e OpaqueMetadata {\n            Runtime::metadata().into()\n        }\n    }\n\n    impl sp_block_builder::BlockBuilder\u003cBlock\u003e for Runtime {\n        fn apply_extrinsic(extrinsic: \u003cBlock as BlockT\u003e::Extrinsic) -\u003e ApplyExtrinsicResult {\n            Executive::apply_extrinsic(extrinsic)\n        }\n\n        fn finalize_block() -\u003e \u003cBlock as BlockT\u003e::Header {\n            Executive::finalize_block()\n        }\n\n        fn inherent_extrinsics(data: sp_inherents::InherentData) -\u003e Vec\u003c\u003cBlock as BlockT\u003e::Extrinsic\u003e {\n            data.create_extrinsics()\n        }\n\n        fn check_inherents(\n            block: Block,\n            data: sp_inherents::InherentData,\n        ) -\u003e sp_inherents::CheckInherentsResult {\n            data.check_extrinsics(\u0026block)\n        }\n\n        fn random_seed() -\u003e \u003cBlock as BlockT\u003e::Hash {\n            RandomnessCollectiveFlip::random_seed()\n        }\n    }\n\n    impl sp_transaction_pool::runtime_api::TaggedTransactionQueue\u003cBlock\u003e for Runtime {\n        fn validate_transaction(\n            source: TransactionSource,\n            tx: \u003cBlock as BlockT\u003e::Extrinsic,\n        ) -\u003e TransactionValidity {\n            Executive::validate_transaction(source, tx)\n        }\n    }\n\n    impl sp_offchain::OffchainWorkerApi\u003cBlock\u003e for Runtime {\n        fn offchain_worker(header: \u0026\u003cBlock as BlockT\u003e::Header) {\n            Executive::offchain_worker(header)\n        }\n    }\n\n    impl sp_consensus_aura::AuraApi\u003cBlock, AuraId\u003e for Runtime {\n        fn slot_duration() -\u003e u64 {\n            Aura::slot_duration()\n        }\n\n        fn authorities() -\u003e Vec\u003cAuraId\u003e {\n            Aura::authorities()\n        }\n    }\n\n    impl sp_session::SessionKeys\u003cBlock\u003e for Runtime {\n        fn generate_session_keys(seed: Option\u003cVec\u003cu8\u003e\u003e) -\u003e Vec\u003cu8\u003e {\n            opaque::SessionKeys::generate(seed)\n        }\n\n        fn decode_session_keys(\n            encoded: Vec\u003cu8\u003e,\n        ) -\u003e Option\u003cVec\u003c(Vec\u003cu8\u003e, KeyTypeId)\u003e\u003e {\n            opaque::SessionKeys::decode_into_raw_public_keys(\u0026encoded)\n        }\n    }\n\n    impl fg_primitives::GrandpaApi\u003cBlock\u003e for Runtime {\n        fn grandpa_authorities() -\u003e GrandpaAuthorityList {\n            Grandpa::grandpa_authorities()\n        }\n\n        fn submit_report_equivocation_unsigned_extrinsic(\n            _equivocation_proof: fg_primitives::EquivocationProof\u003c\n                \u003cBlock as BlockT\u003e::Hash,\n                NumberFor\u003cBlock\u003e,\n            \u003e,\n            _key_owner_proof: fg_primitives::OpaqueKeyOwnershipProof,\n        ) -\u003e Option\u003c()\u003e {\n            None\n        }\n\n        fn generate_key_ownership_proof(\n            _set_id: fg_primitives::SetId,\n            _authority_id: GrandpaId,\n        ) -\u003e Option\u003cfg_primitives::OpaqueKeyOwnershipProof\u003e {\n            // NOTE: this is the only implementation possible since we've\n            // defined our key owner proof type as a bottom type (i.e. a type\n            // with no values).\n            None\n        }\n    }\n\n    impl frame_system_rpc_runtime_api::AccountNonceApi\u003cBlock, AccountId, Index\u003e for Runtime {\n        fn account_nonce(account: AccountId) -\u003e Index {\n            System::account_nonce(account)\n        }\n    }\n\n    impl pallet_transaction_payment_rpc_runtime_api::TransactionPaymentApi\u003cBlock, Balance\u003e for Runtime {\n        fn query_info(\n            uxt: \u003cBlock as BlockT\u003e::Extrinsic,\n            len: u32,\n        ) -\u003e pallet_transaction_payment_rpc_runtime_api::RuntimeDispatchInfo\u003cBalance\u003e {\n            TransactionPayment::query_info(uxt, len)\n        }\n    }\n}\n","traces":[{"line":100,"address":[4356882,4356925,4356565,4356306],"length":1,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[5435552],"length":1,"stats":{"Line":0},"fn_name":"native_version"},{"line":132,"address":[5435559],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[5435697],"length":1,"stats":{"Line":1},"fn_name":null},{"line":142,"address":[5435793,5435732,5435764],"length":1,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[5435774,5435741],"length":1,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[5435844],"length":1,"stats":{"Line":0},"fn_name":null},{"line":277,"address":[5435953],"length":1,"stats":{"Line":0},"fn_name":null},{"line":278,"address":[5435985],"length":1,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[5436037,5436016,5436096,5437451,5436112,5436521,5437188,5438244,5436144,5436884,5437620,5436213,5437924],"length":1,"stats":{"Line":4},"fn_name":"fmt"},{"line":325,"address":[5765935,5766079],"length":1,"stats":{"Line":0},"fn_name":null},{"line":326,"address":[5766116,5766514],"length":1,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[5766559,5766668],"length":1,"stats":{"Line":0},"fn_name":null},{"line":329,"address":[5766705,5766930],"length":1,"stats":{"Line":0},"fn_name":null},{"line":330,"address":[5767330,5766967],"length":1,"stats":{"Line":0},"fn_name":null},{"line":332,"address":[5767367,5767730],"length":1,"stats":{"Line":0},"fn_name":null},{"line":334,"address":[5768126,5767767],"length":1,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[5768376,5768163],"length":1,"stats":{"Line":0},"fn_name":null},{"line":336,"address":[5768413,5768674],"length":1,"stats":{"Line":0},"fn_name":null},{"line":337,"address":[5768711,5768923],"length":1,"stats":{"Line":0},"fn_name":null},{"line":374,"address":[5959507,5964174,5966123,5957188,5961019,5963785,5956170,5958987,5963501,5952576,5967760,5967410,5966994,5964968,5961507,5961424,5958904,5964563,5955292,5959920,5952631,5968904,5958215,5954903,5968559,5965051,5964279,5962320,5960025,5966535,5956815,5954538,5958499,5966518,5957577,5965627],"length":1,"stats":{"Line":0},"fn_name":"dispatch"},{"line":376,"address":[5458224],"length":1,"stats":{"Line":0},"fn_name":"version"},{"line":377,"address":[5458228],"length":1,"stats":{"Line":0},"fn_name":null},{"line":380,"address":[5458256],"length":1,"stats":{"Line":0},"fn_name":"execute_block"},{"line":381,"address":[5458263],"length":1,"stats":{"Line":0},"fn_name":null},{"line":384,"address":[5458320],"length":1,"stats":{"Line":0},"fn_name":"initialize_block"},{"line":385,"address":[5458325],"length":1,"stats":{"Line":0},"fn_name":null},{"line":390,"address":[5458336],"length":1,"stats":{"Line":0},"fn_name":"metadata"},{"line":391,"address":[5458343],"length":1,"stats":{"Line":0},"fn_name":null},{"line":396,"address":[5458400],"length":1,"stats":{"Line":0},"fn_name":"apply_extrinsic"},{"line":397,"address":[5458410],"length":1,"stats":{"Line":0},"fn_name":null},{"line":400,"address":[5458480],"length":1,"stats":{"Line":0},"fn_name":"finalize_block"},{"line":401,"address":[5458488],"length":1,"stats":{"Line":0},"fn_name":null},{"line":404,"address":[5458536,5458512],"length":1,"stats":{"Line":0},"fn_name":"inherent_extrinsics"},{"line":405,"address":[5458529],"length":1,"stats":{"Line":0},"fn_name":null},{"line":408,"address":[5458608,5458647],"length":1,"stats":{"Line":0},"fn_name":"check_inherents"},{"line":409,"address":[5959266,5959373],"length":1,"stats":{"Line":0},"fn_name":null},{"line":410,"address":[5959435,5959333],"length":1,"stats":{"Line":0},"fn_name":null},{"line":412,"address":[5458620],"length":1,"stats":{"Line":0},"fn_name":null},{"line":415,"address":[5458752],"length":1,"stats":{"Line":0},"fn_name":"random_seed"},{"line":416,"address":[5458760],"length":1,"stats":{"Line":0},"fn_name":null},{"line":421,"address":[5458784],"length":1,"stats":{"Line":0},"fn_name":"validate_transaction"},{"line":422,"address":[5960840],"length":1,"stats":{"Line":0},"fn_name":null},{"line":423,"address":[5960851],"length":1,"stats":{"Line":0},"fn_name":null},{"line":425,"address":[5458802],"length":1,"stats":{"Line":0},"fn_name":null},{"line":430,"address":[5458896],"length":1,"stats":{"Line":0},"fn_name":"offchain_worker"},{"line":431,"address":[5458901],"length":1,"stats":{"Line":0},"fn_name":null},{"line":436,"address":[5458912],"length":1,"stats":{"Line":0},"fn_name":"slot_duration"},{"line":437,"address":[5458913],"length":1,"stats":{"Line":0},"fn_name":null},{"line":440,"address":[5458928],"length":1,"stats":{"Line":0},"fn_name":"authorities"},{"line":441,"address":[5458936],"length":1,"stats":{"Line":0},"fn_name":null},{"line":446,"address":[5458960],"length":1,"stats":{"Line":0},"fn_name":"generate_session_keys"},{"line":447,"address":[5458967],"length":1,"stats":{"Line":0},"fn_name":null},{"line":450,"address":[5459069,5459024],"length":1,"stats":{"Line":0},"fn_name":"decode_session_keys"},{"line":451,"address":[5964507],"length":1,"stats":{"Line":0},"fn_name":null},{"line":453,"address":[5459095,5459031],"length":1,"stats":{"Line":0},"fn_name":null},{"line":458,"address":[5459152],"length":1,"stats":{"Line":0},"fn_name":"grandpa_authorities"},{"line":459,"address":[5459160],"length":1,"stats":{"Line":0},"fn_name":null},{"line":462,"address":[5459184],"length":1,"stats":{"Line":0},"fn_name":"submit_report_equivocation_unsigned_extrinsic"},{"line":463,"address":[5965919,5966013],"length":1,"stats":{"Line":0},"fn_name":null},{"line":467,"address":[5965965,5966059],"length":1,"stats":{"Line":0},"fn_name":null},{"line":469,"address":[5459188],"length":1,"stats":{"Line":0},"fn_name":null},{"line":472,"address":[5459232],"length":1,"stats":{"Line":0},"fn_name":"generate_key_ownership_proof"},{"line":473,"address":[5966850],"length":1,"stats":{"Line":0},"fn_name":null},{"line":474,"address":[5966866],"length":1,"stats":{"Line":0},"fn_name":null},{"line":479,"address":[5459240],"length":1,"stats":{"Line":0},"fn_name":null},{"line":484,"address":[5459264],"length":1,"stats":{"Line":0},"fn_name":"account_nonce"},{"line":485,"address":[5459268],"length":1,"stats":{"Line":0},"fn_name":null},{"line":490,"address":[5459328],"length":1,"stats":{"Line":0},"fn_name":"query_info"},{"line":491,"address":[5968482,5968411],"length":1,"stats":{"Line":0},"fn_name":null},{"line":492,"address":[5968466],"length":1,"stats":{"Line":0},"fn_name":null},{"line":494,"address":[5459345],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":2,"coverable":72}]};
    </script>
    <script crossorigin>/** @license React v16.13.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
'use strict';(function(d,r){"object"===typeof exports&&"undefined"!==typeof module?r(exports):"function"===typeof define&&define.amd?define(["exports"],r):(d=d||self,r(d.React={}))})(this,function(d){function r(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}
function w(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function da(){}function L(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function ea(a,b,c){var g,e={},fa=null,d=null;if(null!=b)for(g in void 0!==b.ref&&(d=b.ref),void 0!==b.key&&(fa=""+b.key),b)ha.call(b,g)&&!ia.hasOwnProperty(g)&&(e[g]=b[g]);var h=arguments.length-2;if(1===h)e.children=c;else if(1<h){for(var k=Array(h),f=0;f<h;f++)k[f]=arguments[f+2];e.children=k}if(a&&a.defaultProps)for(g in h=a.defaultProps,
h)void 0===e[g]&&(e[g]=h[g]);return{$$typeof:x,type:a,key:fa,ref:d,props:e,_owner:M.current}}function va(a,b){return{$$typeof:x,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function N(a){return"object"===typeof a&&null!==a&&a.$$typeof===x}function wa(a){var b={"=":"=0",":":"=2"};return"$"+(""+a).replace(/[=:]/g,function(a){return b[a]})}function ja(a,b,c,g){if(C.length){var e=C.pop();e.result=a;e.keyPrefix=b;e.func=c;e.context=g;e.count=0;return e}return{result:a,keyPrefix:b,func:c,
context:g,count:0}}function ka(a){a.result=null;a.keyPrefix=null;a.func=null;a.context=null;a.count=0;10>C.length&&C.push(a)}function O(a,b,c,g){var e=typeof a;if("undefined"===e||"boolean"===e)a=null;var d=!1;if(null===a)d=!0;else switch(e){case "string":case "number":d=!0;break;case "object":switch(a.$$typeof){case x:case xa:d=!0}}if(d)return c(g,a,""===b?"."+P(a,0):b),1;d=0;b=""===b?".":b+":";if(Array.isArray(a))for(var f=0;f<a.length;f++){e=a[f];var h=b+P(e,f);d+=O(e,h,c,g)}else if(null===a||
"object"!==typeof a?h=null:(h=la&&a[la]||a["@@iterator"],h="function"===typeof h?h:null),"function"===typeof h)for(a=h.call(a),f=0;!(e=a.next()).done;)e=e.value,h=b+P(e,f++),d+=O(e,h,c,g);else if("object"===e)throw c=""+a,Error(r(31,"[object Object]"===c?"object with keys {"+Object.keys(a).join(", ")+"}":c,""));return d}function Q(a,b,c){return null==a?0:O(a,"",b,c)}function P(a,b){return"object"===typeof a&&null!==a&&null!=a.key?wa(a.key):b.toString(36)}function ya(a,b,c){a.func.call(a.context,b,
a.count++)}function za(a,b,c){var g=a.result,e=a.keyPrefix;a=a.func.call(a.context,b,a.count++);Array.isArray(a)?R(a,g,c,function(a){return a}):null!=a&&(N(a)&&(a=va(a,e+(!a.key||b&&b.key===a.key?"":(""+a.key).replace(ma,"$&/")+"/")+c)),g.push(a))}function R(a,b,c,g,e){var d="";null!=c&&(d=(""+c).replace(ma,"$&/")+"/");b=ja(b,d,g,e);Q(a,za,b);ka(b)}function t(){var a=na.current;if(null===a)throw Error(r(321));return a}function S(a,b){var c=a.length;a.push(b);a:for(;;){var g=c-1>>>1,e=a[g];if(void 0!==
e&&0<D(e,b))a[g]=b,a[c]=e,c=g;else break a}}function n(a){a=a[0];return void 0===a?null:a}function E(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;a:for(var g=0,e=a.length;g<e;){var d=2*(g+1)-1,f=a[d],h=d+1,k=a[h];if(void 0!==f&&0>D(f,c))void 0!==k&&0>D(k,f)?(a[g]=k,a[h]=c,g=h):(a[g]=f,a[d]=c,g=d);else if(void 0!==k&&0>D(k,c))a[g]=k,a[h]=c,g=h;else break a}}return b}return null}function D(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}function F(a){for(var b=n(u);null!==
b;){if(null===b.callback)E(u);else if(b.startTime<=a)E(u),b.sortIndex=b.expirationTime,S(p,b);else break;b=n(u)}}function T(a){y=!1;F(a);if(!v)if(null!==n(p))v=!0,z(U);else{var b=n(u);null!==b&&G(T,b.startTime-a)}}function U(a,b){v=!1;y&&(y=!1,V());H=!0;var c=m;try{F(b);for(l=n(p);null!==l&&(!(l.expirationTime>b)||a&&!W());){var g=l.callback;if(null!==g){l.callback=null;m=l.priorityLevel;var e=g(l.expirationTime<=b);b=q();"function"===typeof e?l.callback=e:l===n(p)&&E(p);F(b)}else E(p);l=n(p)}if(null!==
l)var d=!0;else{var f=n(u);null!==f&&G(T,f.startTime-b);d=!1}return d}finally{l=null,m=c,H=!1}}function oa(a){switch(a){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1E4;default:return 5E3}}var f="function"===typeof Symbol&&Symbol.for,x=f?Symbol.for("react.element"):60103,xa=f?Symbol.for("react.portal"):60106,Aa=f?Symbol.for("react.fragment"):60107,Ba=f?Symbol.for("react.strict_mode"):60108,Ca=f?Symbol.for("react.profiler"):60114,Da=f?Symbol.for("react.provider"):60109,
Ea=f?Symbol.for("react.context"):60110,Fa=f?Symbol.for("react.forward_ref"):60112,Ga=f?Symbol.for("react.suspense"):60113,Ha=f?Symbol.for("react.memo"):60115,Ia=f?Symbol.for("react.lazy"):60116,la="function"===typeof Symbol&&Symbol.iterator,pa=Object.getOwnPropertySymbols,Ja=Object.prototype.hasOwnProperty,Ka=Object.prototype.propertyIsEnumerable,I=function(){try{if(!Object.assign)return!1;var a=new String("abc");a[5]="de";if("5"===Object.getOwnPropertyNames(a)[0])return!1;var b={};for(a=0;10>a;a++)b["_"+
String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(b).map(function(a){return b[a]}).join(""))return!1;var c={};"abcdefghijklmnopqrst".split("").forEach(function(a){c[a]=a});return"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},c)).join("")?!1:!0}catch(g){return!1}}()?Object.assign:function(a,b){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");var c=Object(a);for(var g,e=1;e<arguments.length;e++){var d=Object(arguments[e]);
for(var f in d)Ja.call(d,f)&&(c[f]=d[f]);if(pa){g=pa(d);for(var h=0;h<g.length;h++)Ka.call(d,g[h])&&(c[g[h]]=d[g[h]])}}return c},ca={isMounted:function(a){return!1},enqueueForceUpdate:function(a,b,c){},enqueueReplaceState:function(a,b,c,d){},enqueueSetState:function(a,b,c,d){}},ba={};w.prototype.isReactComponent={};w.prototype.setState=function(a,b){if("object"!==typeof a&&"function"!==typeof a&&null!=a)throw Error(r(85));this.updater.enqueueSetState(this,a,b,"setState")};w.prototype.forceUpdate=
function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};da.prototype=w.prototype;f=L.prototype=new da;f.constructor=L;I(f,w.prototype);f.isPureReactComponent=!0;var M={current:null},ha=Object.prototype.hasOwnProperty,ia={key:!0,ref:!0,__self:!0,__source:!0},ma=/\/+/g,C=[],na={current:null},X;if("undefined"===typeof window||"function"!==typeof MessageChannel){var A=null,qa=null,ra=function(){if(null!==A)try{var a=q();A(!0,a);A=null}catch(b){throw setTimeout(ra,0),b;}},La=Date.now();var q=
function(){return Date.now()-La};var z=function(a){null!==A?setTimeout(z,0,a):(A=a,setTimeout(ra,0))};var G=function(a,b){qa=setTimeout(a,b)};var V=function(){clearTimeout(qa)};var W=function(){return!1};f=X=function(){}}else{var Y=window.performance,sa=window.Date,Ma=window.setTimeout,Na=window.clearTimeout;"undefined"!==typeof console&&(f=window.cancelAnimationFrame,"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),
"function"!==typeof f&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));if("object"===typeof Y&&"function"===typeof Y.now)q=function(){return Y.now()};else{var Oa=sa.now();q=function(){return sa.now()-Oa}}var J=!1,K=null,Z=-1,ta=5,ua=0;W=function(){return q()>=ua};f=function(){};X=function(a){0>a||125<a?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):
ta=0<a?Math.floor(1E3/a):5};var B=new MessageChannel,aa=B.port2;B.port1.onmessage=function(){if(null!==K){var a=q();ua=a+ta;try{K(!0,a)?aa.postMessage(null):(J=!1,K=null)}catch(b){throw aa.postMessage(null),b;}}else J=!1};z=function(a){K=a;J||(J=!0,aa.postMessage(null))};G=function(a,b){Z=Ma(function(){a(q())},b)};V=function(){Na(Z);Z=-1}}var p=[],u=[],Pa=1,l=null,m=3,H=!1,v=!1,y=!1,Qa=0;B={ReactCurrentDispatcher:na,ReactCurrentOwner:M,IsSomeRendererActing:{current:!1},assign:I};I(B,{Scheduler:{__proto__:null,
unstable_ImmediatePriority:1,unstable_UserBlockingPriority:2,unstable_NormalPriority:3,unstable_IdlePriority:5,unstable_LowPriority:4,unstable_runWithPriority:function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=m;m=a;try{return b()}finally{m=c}},unstable_next:function(a){switch(m){case 1:case 2:case 3:var b=3;break;default:b=m}var c=m;m=b;try{return a()}finally{m=c}},unstable_scheduleCallback:function(a,b,c){var d=q();if("object"===typeof c&&null!==c){var e=c.delay;
e="number"===typeof e&&0<e?d+e:d;c="number"===typeof c.timeout?c.timeout:oa(a)}else c=oa(a),e=d;c=e+c;a={id:Pa++,callback:b,priorityLevel:a,startTime:e,expirationTime:c,sortIndex:-1};e>d?(a.sortIndex=e,S(u,a),null===n(p)&&a===n(u)&&(y?V():y=!0,G(T,e-d))):(a.sortIndex=c,S(p,a),v||H||(v=!0,z(U)));return a},unstable_cancelCallback:function(a){a.callback=null},unstable_wrapCallback:function(a){var b=m;return function(){var c=m;m=b;try{return a.apply(this,arguments)}finally{m=c}}},unstable_getCurrentPriorityLevel:function(){return m},
unstable_shouldYield:function(){var a=q();F(a);var b=n(p);return b!==l&&null!==l&&null!==b&&null!==b.callback&&b.startTime<=a&&b.expirationTime<l.expirationTime||W()},unstable_requestPaint:f,unstable_continueExecution:function(){v||H||(v=!0,z(U))},unstable_pauseExecution:function(){},unstable_getFirstCallbackNode:function(){return n(p)},get unstable_now(){return q},get unstable_forceFrameRate(){return X},unstable_Profiling:null},SchedulerTracing:{__proto__:null,__interactionsRef:null,__subscriberRef:null,
unstable_clear:function(a){return a()},unstable_getCurrent:function(){return null},unstable_getThreadID:function(){return++Qa},unstable_trace:function(a,b,c){return c()},unstable_wrap:function(a){return a},unstable_subscribe:function(a){},unstable_unsubscribe:function(a){}}});d.Children={map:function(a,b,c){if(null==a)return a;var d=[];R(a,d,null,b,c);return d},forEach:function(a,b,c){if(null==a)return a;b=ja(null,null,b,c);Q(a,ya,b);ka(b)},count:function(a){return Q(a,function(){return null},null)},
toArray:function(a){var b=[];R(a,b,null,function(a){return a});return b},only:function(a){if(!N(a))throw Error(r(143));return a}};d.Component=w;d.Fragment=Aa;d.Profiler=Ca;d.PureComponent=L;d.StrictMode=Ba;d.Suspense=Ga;d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B;d.cloneElement=function(a,b,c){if(null===a||void 0===a)throw Error(r(267,a));var d=I({},a.props),e=a.key,f=a.ref,m=a._owner;if(null!=b){void 0!==b.ref&&(f=b.ref,m=M.current);void 0!==b.key&&(e=""+b.key);if(a.type&&a.type.defaultProps)var h=
a.type.defaultProps;for(k in b)ha.call(b,k)&&!ia.hasOwnProperty(k)&&(d[k]=void 0===b[k]&&void 0!==h?h[k]:b[k])}var k=arguments.length-2;if(1===k)d.children=c;else if(1<k){h=Array(k);for(var l=0;l<k;l++)h[l]=arguments[l+2];d.children=h}return{$$typeof:x,type:a.type,key:e,ref:f,props:d,_owner:m}};d.createContext=function(a,b){void 0===b&&(b=null);a={$$typeof:Ea,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:Da,_context:a};return a.Consumer=
a};d.createElement=ea;d.createFactory=function(a){var b=ea.bind(null,a);b.type=a;return b};d.createRef=function(){return{current:null}};d.forwardRef=function(a){return{$$typeof:Fa,render:a}};d.isValidElement=N;d.lazy=function(a){return{$$typeof:Ia,_ctor:a,_status:-1,_result:null}};d.memo=function(a,b){return{$$typeof:Ha,type:a,compare:void 0===b?null:b}};d.useCallback=function(a,b){return t().useCallback(a,b)};d.useContext=function(a,b){return t().useContext(a,b)};d.useDebugValue=function(a,b){};
d.useEffect=function(a,b){return t().useEffect(a,b)};d.useImperativeHandle=function(a,b,c){return t().useImperativeHandle(a,b,c)};d.useLayoutEffect=function(a,b){return t().useLayoutEffect(a,b)};d.useMemo=function(a,b){return t().useMemo(a,b)};d.useReducer=function(a,b,c){return t().useReducer(a,b,c)};d.useRef=function(a){return t().useRef(a)};d.useState=function(a){return t().useState(a)};d.version="16.13.1"});
</script>
    <script crossorigin>/** @license React v16.13.1
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
/*
 Modernizr 3.0.0pre (Custom Build) | MIT
*/
'use strict';(function(I,ea){"object"===typeof exports&&"undefined"!==typeof module?ea(exports,require("react")):"function"===typeof define&&define.amd?define(["exports","react"],ea):(I=I||self,ea(I.ReactDOM={},I.React))})(this,function(I,ea){function k(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}
function ji(a,b,c,d,e,f,g,h,m){yb=!1;gc=null;ki.apply(li,arguments)}function mi(a,b,c,d,e,f,g,h,m){ji.apply(this,arguments);if(yb){if(yb){var n=gc;yb=!1;gc=null}else throw Error(k(198));hc||(hc=!0,pd=n)}}function lf(a,b,c){var d=a.type||"unknown-event";a.currentTarget=mf(c);mi(d,b,void 0,a);a.currentTarget=null}function nf(){if(ic)for(var a in cb){var b=cb[a],c=ic.indexOf(a);if(!(-1<c))throw Error(k(96,a));if(!jc[c]){if(!b.extractEvents)throw Error(k(97,a));jc[c]=b;c=b.eventTypes;for(var d in c){var e=
void 0;var f=c[d],g=b,h=d;if(qd.hasOwnProperty(h))throw Error(k(99,h));qd[h]=f;var m=f.phasedRegistrationNames;if(m){for(e in m)m.hasOwnProperty(e)&&of(m[e],g,h);e=!0}else f.registrationName?(of(f.registrationName,g,h),e=!0):e=!1;if(!e)throw Error(k(98,d,a));}}}}function of(a,b,c){if(db[a])throw Error(k(100,a));db[a]=b;rd[a]=b.eventTypes[c].dependencies}function pf(a){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];if(!cb.hasOwnProperty(c)||cb[c]!==d){if(cb[c])throw Error(k(102,c));cb[c]=
d;b=!0}}b&&nf()}function qf(a){if(a=rf(a)){if("function"!==typeof sd)throw Error(k(280));var b=a.stateNode;b&&(b=td(b),sd(a.stateNode,a.type,b))}}function sf(a){eb?fb?fb.push(a):fb=[a]:eb=a}function tf(){if(eb){var a=eb,b=fb;fb=eb=null;qf(a);if(b)for(a=0;a<b.length;a++)qf(b[a])}}function ud(){if(null!==eb||null!==fb)vd(),tf()}function uf(a,b,c){if(wd)return a(b,c);wd=!0;try{return vf(a,b,c)}finally{wd=!1,ud()}}function ni(a){if(wf.call(xf,a))return!0;if(wf.call(yf,a))return!1;if(oi.test(a))return xf[a]=
!0;yf[a]=!0;return!1}function pi(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case "function":case "symbol":return!0;case "boolean":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return"data-"!==a&&"aria-"!==a;default:return!1}}function qi(a,b,c,d){if(null===b||"undefined"===typeof b||pi(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function L(a,
b,c,d,e,f){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f}function xd(a,b,c,d){var e=E.hasOwnProperty(b)?E[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||"o"!==b[0]&&"O"!==b[0]||"n"!==b[1]&&"N"!==b[1]?!1:!0;f||(qi(b,c,e,d)&&(c=null),d||null===e?ni(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,""+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:"":c:(b=e.attributeName,
d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?"":""+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c))))}function zb(a){if(null===a||"object"!==typeof a)return null;a=zf&&a[zf]||a["@@iterator"];return"function"===typeof a?a:null}function ri(a){if(-1===a._status){a._status=0;var b=a._ctor;b=b();a._result=b;b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)})}}function na(a){if(null==a)return null;
if("function"===typeof a)return a.displayName||a.name||null;if("string"===typeof a)return a;switch(a){case Ma:return"Fragment";case gb:return"Portal";case kc:return"Profiler";case Af:return"StrictMode";case lc:return"Suspense";case yd:return"SuspenseList"}if("object"===typeof a)switch(a.$$typeof){case Bf:return"Context.Consumer";case Cf:return"Context.Provider";case zd:var b=a.render;b=b.displayName||b.name||"";return a.displayName||(""!==b?"ForwardRef("+b+")":"ForwardRef");case Ad:return na(a.type);
case Df:return na(a.render);case Ef:if(a=1===a._status?a._result:null)return na(a)}return null}function Bd(a){var b="";do{a:switch(a.tag){case 3:case 4:case 6:case 7:case 10:case 9:var c="";break a;default:var d=a._debugOwner,e=a._debugSource,f=na(a.type);c=null;d&&(c=na(d.type));d=f;f="";e?f=" (at "+e.fileName.replace(si,"")+":"+e.lineNumber+")":c&&(f=" (created by "+c+")");c="\n    in "+(d||"Unknown")+f}b+=c;a=a.return}while(a);return b}function va(a){switch(typeof a){case "boolean":case "number":case "object":case "string":case "undefined":return a;
default:return""}}function Ff(a){var b=a.type;return(a=a.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===b||"radio"===b)}function ti(a){var b=Ff(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=""+a[b];if(!a.hasOwnProperty(b)&&"undefined"!==typeof c&&"function"===typeof c.get&&"function"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=""+a;f.call(this,a)}});Object.defineProperty(a,
b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=""+a},stopTracking:function(){a._valueTracker=null;delete a[b]}}}}function mc(a){a._valueTracker||(a._valueTracker=ti(a))}function Gf(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d="";a&&(d=Ff(a)?a.checked?"true":"false":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Cd(a,b){var c=b.checked;return M({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=
c?c:a._wrapperState.initialChecked})}function Hf(a,b){var c=null==b.defaultValue?"":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=va(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:"checkbox"===b.type||"radio"===b.type?null!=b.checked:null!=b.value}}function If(a,b){b=b.checked;null!=b&&xd(a,"checked",b,!1)}function Dd(a,b){If(a,b);var c=va(b.value),d=b.type;if(null!=c)if("number"===d){if(0===c&&""===a.value||a.value!=c)a.value=""+c}else a.value!==
""+c&&(a.value=""+c);else if("submit"===d||"reset"===d){a.removeAttribute("value");return}b.hasOwnProperty("value")?Ed(a,b.type,c):b.hasOwnProperty("defaultValue")&&Ed(a,b.type,va(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}function Jf(a,b,c){if(b.hasOwnProperty("value")||b.hasOwnProperty("defaultValue")){var d=b.type;if(!("submit"!==d&&"reset"!==d||void 0!==b.value&&null!==b.value))return;b=""+a._wrapperState.initialValue;c||b===a.value||(a.value=
b);a.defaultValue=b}c=a.name;""!==c&&(a.name="");a.defaultChecked=!!a._wrapperState.initialChecked;""!==c&&(a.name=c)}function Ed(a,b,c){if("number"!==b||a.ownerDocument.activeElement!==a)null==c?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+c&&(a.defaultValue=""+c)}function ui(a){var b="";ea.Children.forEach(a,function(a){null!=a&&(b+=a)});return b}function Fd(a,b){a=M({children:void 0},b);if(b=ui(b.children))a.children=b;return a}function hb(a,b,c,d){a=a.options;if(b){b={};
for(var e=0;e<c.length;e++)b["$"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty("$"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=""+va(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}function Gd(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(k(91));return M({},b,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}
function Kf(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(k(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(k(93));c=c[0]}b=c}null==b&&(b="");c=b}a._wrapperState={initialValue:va(c)}}function Lf(a,b){var c=va(b.value),d=va(b.defaultValue);null!=c&&(c=""+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=""+d)}function Mf(a,b){b=a.textContent;b===a._wrapperState.initialValue&&""!==
b&&null!==b&&(a.value=b)}function Nf(a){switch(a){case "svg":return"http://www.w3.org/2000/svg";case "math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hd(a,b){return null==a||"http://www.w3.org/1999/xhtml"===a?Nf(b):"http://www.w3.org/2000/svg"===a&&"foreignObject"===b?"http://www.w3.org/1999/xhtml":a}function nc(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c["Webkit"+a]="webkit"+b;c["Moz"+a]="moz"+b;return c}function oc(a){if(Id[a])return Id[a];
if(!ib[a])return a;var b=ib[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Of)return Id[a]=b[c];return a}function Jd(a){var b=Pf.get(a);void 0===b&&(b=new Map,Pf.set(a,b));return b}function Na(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.effectTag&1026)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function Qf(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function Rf(a){if(Na(a)!==
a)throw Error(k(188));}function vi(a){var b=a.alternate;if(!b){b=Na(a);if(null===b)throw Error(k(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Rf(e),a;if(f===d)return Rf(e),b;f=f.sibling}throw Error(k(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=
f.child;h;){if(h===c){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(k(189));}}if(c.alternate!==d)throw Error(k(190));}if(3!==c.tag)throw Error(k(188));return c.stateNode.current===c?a:b}function Sf(a){a=vi(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}}return null}function jb(a,b){if(null==
b)throw Error(k(30));if(null==a)return b;if(Array.isArray(a)){if(Array.isArray(b))return a.push.apply(a,b),a;a.push(b);return a}return Array.isArray(b)?[a].concat(b):[a,b]}function Kd(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}function pc(a){null!==a&&(Ab=jb(Ab,a));a=Ab;Ab=null;if(a){Kd(a,wi);if(Ab)throw Error(k(95));if(hc)throw a=pd,hc=!1,pd=null,a;}}function Ld(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:
a}function Tf(a){if(!wa)return!1;a="on"+a;var b=a in document;b||(b=document.createElement("div"),b.setAttribute(a,"return;"),b="function"===typeof b[a]);return b}function Uf(a){a.topLevelType=null;a.nativeEvent=null;a.targetInst=null;a.ancestors.length=0;10>qc.length&&qc.push(a)}function Vf(a,b,c,d){if(qc.length){var e=qc.pop();e.topLevelType=a;e.eventSystemFlags=d;e.nativeEvent=b;e.targetInst=c;return e}return{topLevelType:a,eventSystemFlags:d,nativeEvent:b,targetInst:c,ancestors:[]}}function Wf(a){var b=
a.targetInst,c=b;do{if(!c){a.ancestors.push(c);break}var d=c;if(3===d.tag)d=d.stateNode.containerInfo;else{for(;d.return;)d=d.return;d=3!==d.tag?null:d.stateNode.containerInfo}if(!d)break;b=c.tag;5!==b&&6!==b||a.ancestors.push(c);c=Bb(d)}while(c);for(c=0;c<a.ancestors.length;c++){b=a.ancestors[c];var e=Ld(a.nativeEvent);d=a.topLevelType;var f=a.nativeEvent,g=a.eventSystemFlags;0===c&&(g|=64);for(var h=null,m=0;m<jc.length;m++){var n=jc[m];n&&(n=n.extractEvents(d,b,f,e,g))&&(h=jb(h,n))}pc(h)}}function Md(a,
b,c){if(!c.has(a)){switch(a){case "scroll":Cb(b,"scroll",!0);break;case "focus":case "blur":Cb(b,"focus",!0);Cb(b,"blur",!0);c.set("blur",null);c.set("focus",null);break;case "cancel":case "close":Tf(a)&&Cb(b,a,!0);break;case "invalid":case "submit":case "reset":break;default:-1===Db.indexOf(a)&&w(a,b)}c.set(a,null)}}function xi(a,b){var c=Jd(b);Nd.forEach(function(a){Md(a,b,c)});yi.forEach(function(a){Md(a,b,c)})}function Od(a,b,c,d,e){return{blockedOn:a,topLevelType:b,eventSystemFlags:c|32,nativeEvent:e,
container:d}}function Xf(a,b){switch(a){case "focus":case "blur":xa=null;break;case "dragenter":case "dragleave":ya=null;break;case "mouseover":case "mouseout":za=null;break;case "pointerover":case "pointerout":Eb.delete(b.pointerId);break;case "gotpointercapture":case "lostpointercapture":Fb.delete(b.pointerId)}}function Gb(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a=Od(b,c,d,e,f),null!==b&&(b=Hb(b),null!==b&&Yf(b)),a;a.eventSystemFlags|=d;return a}function zi(a,b,c,d,e){switch(b){case "focus":return xa=
Gb(xa,a,b,c,d,e),!0;case "dragenter":return ya=Gb(ya,a,b,c,d,e),!0;case "mouseover":return za=Gb(za,a,b,c,d,e),!0;case "pointerover":var f=e.pointerId;Eb.set(f,Gb(Eb.get(f)||null,a,b,c,d,e));return!0;case "gotpointercapture":return f=e.pointerId,Fb.set(f,Gb(Fb.get(f)||null,a,b,c,d,e)),!0}return!1}function Ai(a){var b=Bb(a.target);if(null!==b){var c=Na(b);if(null!==c)if(b=c.tag,13===b){if(b=Qf(c),null!==b){a.blockedOn=b;Pd(a.priority,function(){Bi(c)});return}}else if(3===b&&c.stateNode.hydrate){a.blockedOn=
3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}function rc(a){if(null!==a.blockedOn)return!1;var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);if(null!==b){var c=Hb(b);null!==c&&Yf(c);a.blockedOn=b;return!1}return!0}function Zf(a,b,c){rc(a)&&c.delete(b)}function Ci(){for(Rd=!1;0<fa.length;){var a=fa[0];if(null!==a.blockedOn){a=Hb(a.blockedOn);null!==a&&Di(a);break}var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);null!==b?a.blockedOn=b:fa.shift()}null!==
xa&&rc(xa)&&(xa=null);null!==ya&&rc(ya)&&(ya=null);null!==za&&rc(za)&&(za=null);Eb.forEach(Zf);Fb.forEach(Zf)}function Ib(a,b){a.blockedOn===b&&(a.blockedOn=null,Rd||(Rd=!0,$f(ag,Ci)))}function bg(a){if(0<fa.length){Ib(fa[0],a);for(var b=1;b<fa.length;b++){var c=fa[b];c.blockedOn===a&&(c.blockedOn=null)}}null!==xa&&Ib(xa,a);null!==ya&&Ib(ya,a);null!==za&&Ib(za,a);b=function(b){return Ib(b,a)};Eb.forEach(b);Fb.forEach(b);for(b=0;b<Jb.length;b++)c=Jb[b],c.blockedOn===a&&(c.blockedOn=null);for(;0<Jb.length&&
(b=Jb[0],null===b.blockedOn);)Ai(b),null===b.blockedOn&&Jb.shift()}function Sd(a,b){for(var c=0;c<a.length;c+=2){var d=a[c],e=a[c+1],f="on"+(e[0].toUpperCase()+e.slice(1));f={phasedRegistrationNames:{bubbled:f,captured:f+"Capture"},dependencies:[d],eventPriority:b};Td.set(d,b);cg.set(d,f);dg[e]=f}}function w(a,b){Cb(b,a,!1)}function Cb(a,b,c){var d=Td.get(b);switch(void 0===d?2:d){case 0:d=Ei.bind(null,b,1,a);break;case 1:d=Fi.bind(null,b,1,a);break;default:d=sc.bind(null,b,1,a)}c?a.addEventListener(b,
d,!0):a.addEventListener(b,d,!1)}function Ei(a,b,c,d){Oa||vd();var e=sc,f=Oa;Oa=!0;try{eg(e,a,b,c,d)}finally{(Oa=f)||ud()}}function Fi(a,b,c,d){Gi(Hi,sc.bind(null,a,b,c,d))}function sc(a,b,c,d){if(tc)if(0<fa.length&&-1<Nd.indexOf(a))a=Od(null,a,b,c,d),fa.push(a);else{var e=Qd(a,b,c,d);if(null===e)Xf(a,d);else if(-1<Nd.indexOf(a))a=Od(e,a,b,c,d),fa.push(a);else if(!zi(e,a,b,c,d)){Xf(a,d);a=Vf(a,d,null,b);try{uf(Wf,a)}finally{Uf(a)}}}}function Qd(a,b,c,d){c=Ld(d);c=Bb(c);if(null!==c){var e=Na(c);if(null===
e)c=null;else{var f=e.tag;if(13===f){c=Qf(e);if(null!==c)return c;c=null}else if(3===f){if(e.stateNode.hydrate)return 3===e.tag?e.stateNode.containerInfo:null;c=null}else e!==c&&(c=null)}}a=Vf(a,d,c,b);try{uf(Wf,a)}finally{Uf(a)}return null}function fg(a,b,c){return null==b||"boolean"===typeof b||""===b?"":c||"number"!==typeof b||0===b||Kb.hasOwnProperty(a)&&Kb[a]?(""+b).trim():b+"px"}function gg(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf("--"),e=fg(c,b[c],d);"float"===
c&&(c="cssFloat");d?a.setProperty(c,e):a[c]=e}}function Ud(a,b){if(b){if(Ii[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(k(137,a,""));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(k(60));if(!("object"===typeof b.dangerouslySetInnerHTML&&"__html"in b.dangerouslySetInnerHTML))throw Error(k(61));}if(null!=b.style&&"object"!==typeof b.style)throw Error(k(62,""));}}function Vd(a,b){if(-1===a.indexOf("-"))return"string"===typeof b.is;switch(a){case "annotation-xml":case "color-profile":case "font-face":case "font-face-src":case "font-face-uri":case "font-face-format":case "font-face-name":case "missing-glyph":return!1;
default:return!0}}function oa(a,b){a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument;var c=Jd(a);b=rd[b];for(var d=0;d<b.length;d++)Md(b[d],a,c)}function uc(){}function Wd(a){a=a||("undefined"!==typeof document?document:void 0);if("undefined"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}function hg(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function ig(a,b){var c=hg(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,
offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=hg(c)}}function jg(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?jg(a,b.parentNode):"contains"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}function kg(){for(var a=window,b=Wd();b instanceof a.HTMLIFrameElement;){try{var c="string"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Wd(a.document)}return b}
function Xd(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&("input"===b&&("text"===a.type||"search"===a.type||"tel"===a.type||"url"===a.type||"password"===a.type)||"textarea"===b||"true"===a.contentEditable)}function lg(a,b){switch(a){case "button":case "input":case "select":case "textarea":return!!b.autoFocus}return!1}function Yd(a,b){return"textarea"===a||"option"===a||"noscript"===a||"string"===typeof b.children||"number"===typeof b.children||"object"===typeof b.dangerouslySetInnerHTML&&
null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}function kb(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break}return a}function mg(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(c===ng||c===Zd||c===$d){if(0===b)return a;b--}else c===og&&b++}a=a.previousSibling}return null}function Bb(a){var b=a[Aa];if(b)return b;for(var c=a.parentNode;c;){if(b=c[Lb]||c[Aa]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=mg(a);null!==
a;){if(c=a[Aa])return c;a=mg(a)}return b}a=c;c=a.parentNode}return null}function Hb(a){a=a[Aa]||a[Lb];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function Pa(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(k(33));}function ae(a){return a[vc]||null}function pa(a){do a=a.return;while(a&&5!==a.tag);return a?a:null}function pg(a,b){var c=a.stateNode;if(!c)return null;var d=td(c);if(!d)return null;c=d[b];a:switch(b){case "onClick":case "onClickCapture":case "onDoubleClick":case "onDoubleClickCapture":case "onMouseDown":case "onMouseDownCapture":case "onMouseMove":case "onMouseMoveCapture":case "onMouseUp":case "onMouseUpCapture":case "onMouseEnter":(d=
!d.disabled)||(a=a.type,d=!("button"===a||"input"===a||"select"===a||"textarea"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&"function"!==typeof c)throw Error(k(231,b,typeof c));return c}function qg(a,b,c){if(b=pg(a,c.dispatchConfig.phasedRegistrationNames[b]))c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a)}function Ji(a){if(a&&a.dispatchConfig.phasedRegistrationNames){for(var b=a._targetInst,c=[];b;)c.push(b),b=pa(b);for(b=c.length;0<b--;)qg(c[b],
"captured",a);for(b=0;b<c.length;b++)qg(c[b],"bubbled",a)}}function be(a,b,c){a&&c&&c.dispatchConfig.registrationName&&(b=pg(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a))}function Ki(a){a&&a.dispatchConfig.registrationName&&be(a._targetInst,null,a)}function lb(a){Kd(a,Ji)}function rg(){if(wc)return wc;var a,b=ce,c=b.length,d,e="value"in Ba?Ba.value:Ba.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=
c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return wc=e.slice(a,1<d?1-d:void 0)}function xc(){return!0}function yc(){return!1}function R(a,b,c,d){this.dispatchConfig=a;this._targetInst=b;this.nativeEvent=c;a=this.constructor.Interface;for(var e in a)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):"target"===e?this.target=d:this[e]=c[e]);this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue)?xc:yc;this.isPropagationStopped=yc;return this}function Li(a,b,c,d){if(this.eventPool.length){var e=
this.eventPool.pop();this.call(e,a,b,c,d);return e}return new this(a,b,c,d)}function Mi(a){if(!(a instanceof this))throw Error(k(279));a.destructor();10>this.eventPool.length&&this.eventPool.push(a)}function sg(a){a.eventPool=[];a.getPooled=Li;a.release=Mi}function tg(a,b){switch(a){case "keyup":return-1!==Ni.indexOf(b.keyCode);case "keydown":return 229!==b.keyCode;case "keypress":case "mousedown":case "blur":return!0;default:return!1}}function ug(a){a=a.detail;return"object"===typeof a&&"data"in
a?a.data:null}function Oi(a,b){switch(a){case "compositionend":return ug(b);case "keypress":if(32!==b.which)return null;vg=!0;return wg;case "textInput":return a=b.data,a===wg&&vg?null:a;default:return null}}function Pi(a,b){if(mb)return"compositionend"===a||!de&&tg(a,b)?(a=rg(),wc=ce=Ba=null,mb=!1,a):null;switch(a){case "paste":return null;case "keypress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;
case "compositionend":return xg&&"ko"!==b.locale?null:b.data;default:return null}}function yg(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return"input"===b?!!Qi[a.type]:"textarea"===b?!0:!1}function zg(a,b,c){a=R.getPooled(Ag.change,a,b,c);a.type="change";sf(c);lb(a);return a}function Ri(a){pc(a)}function zc(a){var b=Pa(a);if(Gf(b))return a}function Si(a,b){if("change"===a)return b}function Bg(){Mb&&(Mb.detachEvent("onpropertychange",Cg),Nb=Mb=null)}function Cg(a){if("value"===a.propertyName&&
zc(Nb))if(a=zg(Nb,a,Ld(a)),Oa)pc(a);else{Oa=!0;try{ee(Ri,a)}finally{Oa=!1,ud()}}}function Ti(a,b,c){"focus"===a?(Bg(),Mb=b,Nb=c,Mb.attachEvent("onpropertychange",Cg)):"blur"===a&&Bg()}function Ui(a,b){if("selectionchange"===a||"keyup"===a||"keydown"===a)return zc(Nb)}function Vi(a,b){if("click"===a)return zc(b)}function Wi(a,b){if("input"===a||"change"===a)return zc(b)}function Xi(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Yi[a])?!!b[a]:!1}function fe(a){return Xi}
function Zi(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}function Ob(a,b){if(Qa(a,b))return!0;if("object"!==typeof a||null===a||"object"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++)if(!$i.call(b,c[d])||!Qa(a[c[d]],b[c[d]]))return!1;return!0}function Dg(a,b){var c=b.window===b?b.document:9===b.nodeType?b:b.ownerDocument;if(ge||null==nb||nb!==Wd(c))return null;c=nb;"selectionStart"in c&&Xd(c)?c={start:c.selectionStart,
end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset});return Pb&&Ob(Pb,c)?null:(Pb=c,a=R.getPooled(Eg.select,he,a,b),a.type="select",a.target=nb,lb(a),a)}function Ac(a){var b=a.keyCode;"charCode"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function q(a,b){0>ob||(a.current=ie[ob],ie[ob]=null,ob--)}function y(a,b,c){ob++;
ie[ob]=a.current;a.current=b}function pb(a,b){var c=a.type.contextTypes;if(!c)return Ca;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}function N(a){a=a.childContextTypes;return null!==a&&void 0!==a}function Fg(a,b,c){if(B.current!==Ca)throw Error(k(168));y(B,b);y(G,c)}
function Gg(a,b,c){var d=a.stateNode;a=b.childContextTypes;if("function"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in a))throw Error(k(108,na(b)||"Unknown",e));return M({},c,{},d)}function Bc(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Ca;Ra=B.current;y(B,a);y(G,G.current);return!0}function Hg(a,b,c){var d=a.stateNode;if(!d)throw Error(k(169));c?(a=Gg(a,b,Ra),d.__reactInternalMemoizedMergedChildContext=a,q(G),q(B),y(B,a)):q(G);y(G,c)}function Cc(){switch(aj()){case Dc:return 99;
case Ig:return 98;case Jg:return 97;case Kg:return 96;case Lg:return 95;default:throw Error(k(332));}}function Mg(a){switch(a){case 99:return Dc;case 98:return Ig;case 97:return Jg;case 96:return Kg;case 95:return Lg;default:throw Error(k(332));}}function Da(a,b){a=Mg(a);return bj(a,b)}function Ng(a,b,c){a=Mg(a);return je(a,b,c)}function Og(a){null===qa?(qa=[a],Ec=je(Dc,Pg)):qa.push(a);return Qg}function ha(){if(null!==Ec){var a=Ec;Ec=null;Rg(a)}Pg()}function Pg(){if(!ke&&null!==qa){ke=!0;var a=0;
try{var b=qa;Da(99,function(){for(;a<b.length;a++){var c=b[a];do c=c(!0);while(null!==c)}});qa=null}catch(c){throw null!==qa&&(qa=qa.slice(a+1)),je(Dc,ha),c;}finally{ke=!1}}}function Fc(a,b,c){c/=10;return 1073741821-(((1073741821-a+b/10)/c|0)+1)*c}function aa(a,b){if(a&&a.defaultProps){b=M({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c])}return b}function le(){Gc=qb=Hc=null}function me(a){var b=Ic.current;q(Ic);a.type._context._currentValue=b}function Sg(a,b){for(;null!==a;){var c=
a.alternate;if(a.childExpirationTime<b)a.childExpirationTime=b,null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);else if(null!==c&&c.childExpirationTime<b)c.childExpirationTime=b;else break;a=a.return}}function rb(a,b){Hc=a;Gc=qb=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(a.expirationTime>=b&&(ia=!0),a.firstContext=null)}function W(a,b){if(Gc!==a&&!1!==b&&0!==b){if("number"!==typeof b||1073741823===b)Gc=a,b=1073741823;b={context:a,observedBits:b,next:null};if(null===qb){if(null===
Hc)throw Error(k(308));qb=b;Hc.dependencies={expirationTime:0,firstContext:b,responders:null}}else qb=qb.next=b}return a._currentValue}function ne(a){a.updateQueue={baseState:a.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function oe(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,baseQueue:a.baseQueue,shared:a.shared,effects:a.effects})}function Ea(a,b){a={expirationTime:a,suspenseConfig:b,tag:Tg,payload:null,callback:null,next:null};return a.next=
a}function Fa(a,b){a=a.updateQueue;if(null!==a){a=a.shared;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}}function Ug(a,b){var c=a.alternate;null!==c&&oe(c,a);a=a.updateQueue;c=a.baseQueue;null===c?(a.baseQueue=b.next=b,b.next=b):(b.next=c.next,c.next=b)}function Qb(a,b,c,d){var e=a.updateQueue;Ga=!1;var f=e.baseQueue,g=e.shared.pending;if(null!==g){if(null!==f){var h=f.next;f.next=g.next;g.next=h}f=g;e.shared.pending=null;h=a.alternate;null!==h&&(h=h.updateQueue,null!==h&&
(h.baseQueue=g))}if(null!==f){h=f.next;var m=e.baseState,n=0,k=null,ba=null,l=null;if(null!==h){var p=h;do{g=p.expirationTime;if(g<d){var t={expirationTime:p.expirationTime,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null};null===l?(ba=l=t,k=m):l=l.next=t;g>n&&(n=g)}else{null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null});Vg(g,p.suspenseConfig);a:{var q=a,r=p;g=b;t=c;switch(r.tag){case 1:q=
r.payload;if("function"===typeof q){m=q.call(t,m,g);break a}m=q;break a;case 3:q.effectTag=q.effectTag&-4097|64;case Tg:q=r.payload;g="function"===typeof q?q.call(t,m,g):q;if(null===g||void 0===g)break a;m=M({},m,g);break a;case Jc:Ga=!0}}null!==p.callback&&(a.effectTag|=32,g=e.effects,null===g?e.effects=[p]:g.push(p))}p=p.next;if(null===p||p===h)if(g=e.shared.pending,null===g)break;else p=f.next=g.next,g.next=h,e.baseQueue=f=g,e.shared.pending=null}while(1)}null===l?k=m:l.next=ba;e.baseState=k;e.baseQueue=
l;Kc(n);a.expirationTime=n;a.memoizedState=m}}function Wg(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=e;e=c;if("function"!==typeof d)throw Error(k(191,d));d.call(e)}}}function Lc(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:M({},b,c);a.memoizedState=c;0===a.expirationTime&&(a.updateQueue.baseState=c)}function Xg(a,b,c,d,e,f,g){a=a.stateNode;return"function"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,
f,g):b.prototype&&b.prototype.isPureReactComponent?!Ob(c,d)||!Ob(e,f):!0}function Yg(a,b,c){var d=!1,e=Ca;var f=b.contextType;"object"===typeof f&&null!==f?f=W(f):(e=N(b)?Ra:B.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?pb(a,e):Ca);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Mc;a.stateNode=b;b._reactInternalFiber=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}function Zg(a,
b,c,d){a=b.state;"function"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);"function"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Mc.enqueueReplaceState(b,b.state,null)}function pe(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=$g;ne(a);var f=b.contextType;"object"===typeof f&&null!==f?e.context=W(f):(f=N(b)?Ra:B.current,e.context=pb(a,f));Qb(a,c,e,d);e.state=a.memoizedState;f=b.getDerivedStateFromProps;
"function"===typeof f&&(Lc(a,b,f,c),e.state=a.memoizedState);"function"===typeof b.getDerivedStateFromProps||"function"===typeof e.getSnapshotBeforeUpdate||"function"!==typeof e.UNSAFE_componentWillMount&&"function"!==typeof e.componentWillMount||(b=e.state,"function"===typeof e.componentWillMount&&e.componentWillMount(),"function"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Mc.enqueueReplaceState(e,e.state,null),Qb(a,c,e,d),e.state=a.memoizedState);"function"===
typeof e.componentDidMount&&(a.effectTag|=4)}function Rb(a,b,c){a=c.ref;if(null!==a&&"function"!==typeof a&&"object"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(k(309));var d=c.stateNode}if(!d)throw Error(k(147,a));var e=""+a;if(null!==b&&null!==b.ref&&"function"===typeof b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs;b===$g&&(b=d.refs={});null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}if("string"!==typeof a)throw Error(k(284));if(!c._owner)throw Error(k(290,
a));}return a}function Nc(a,b){if("textarea"!==a.type)throw Error(k(31,"[object Object]"===Object.prototype.toString.call(b)?"object with keys {"+Object.keys(b).join(", ")+"}":b,""));}function ah(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,
b),b=b.sibling;return a}function e(a,b){a=Sa(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.effectTag=2,c):d;b.effectTag=2;return c}function g(b){a&&null===b.alternate&&(b.effectTag=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=qe(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function m(a,b,c,d){if(null!==b&&b.elementType===c.type)return d=e(b,c.props),d.ref=Rb(a,b,c),d.return=a,d;d=Oc(c.type,
c.key,c.props,null,a.mode,d);d.ref=Rb(a,b,c);d.return=a;return d}function n(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=re(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function l(a,b,c,d,f){if(null===b||7!==b.tag)return b=Ha(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function ba(a,b,c){if("string"===typeof b||"number"===typeof b)return b=qe(""+b,a.mode,c),b.return=a,b;if("object"===
typeof b&&null!==b){switch(b.$$typeof){case Pc:return c=Oc(b.type,b.key,b.props,null,a.mode,c),c.ref=Rb(a,null,b),c.return=a,c;case gb:return b=re(b,a.mode,c),b.return=a,b}if(Qc(b)||zb(b))return b=Ha(b,a.mode,c,null),b.return=a,b;Nc(a,b)}return null}function p(a,b,c,d){var e=null!==b?b.key:null;if("string"===typeof c||"number"===typeof c)return null!==e?null:h(a,b,""+c,d);if("object"===typeof c&&null!==c){switch(c.$$typeof){case Pc:return c.key===e?c.type===Ma?l(a,b,c.props.children,d,e):m(a,b,c,
d):null;case gb:return c.key===e?n(a,b,c,d):null}if(Qc(c)||zb(c))return null!==e?null:l(a,b,c,d,null);Nc(a,c)}return null}function t(a,b,c,d,e){if("string"===typeof d||"number"===typeof d)return a=a.get(c)||null,h(b,a,""+d,e);if("object"===typeof d&&null!==d){switch(d.$$typeof){case Pc:return a=a.get(null===d.key?c:d.key)||null,d.type===Ma?l(b,a,d.props.children,e,d.key):m(b,a,d,e);case gb:return a=a.get(null===d.key?c:d.key)||null,n(b,a,d,e)}if(Qc(d)||zb(d))return a=a.get(c)||null,l(b,a,d,e,null);
Nc(b,d)}return null}function q(e,g,h,m){for(var n=null,k=null,l=g,r=g=0,C=null;null!==l&&r<h.length;r++){l.index>r?(C=l,l=null):C=l.sibling;var O=p(e,l,h[r],m);if(null===O){null===l&&(l=C);break}a&&l&&null===O.alternate&&b(e,l);g=f(O,g,r);null===k?n=O:k.sibling=O;k=O;l=C}if(r===h.length)return c(e,l),n;if(null===l){for(;r<h.length;r++)l=ba(e,h[r],m),null!==l&&(g=f(l,g,r),null===k?n=l:k.sibling=l,k=l);return n}for(l=d(e,l);r<h.length;r++)C=t(l,e,r,h[r],m),null!==C&&(a&&null!==C.alternate&&l.delete(null===
C.key?r:C.key),g=f(C,g,r),null===k?n=C:k.sibling=C,k=C);a&&l.forEach(function(a){return b(e,a)});return n}function w(e,g,h,n){var m=zb(h);if("function"!==typeof m)throw Error(k(150));h=m.call(h);if(null==h)throw Error(k(151));for(var l=m=null,r=g,C=g=0,O=null,v=h.next();null!==r&&!v.done;C++,v=h.next()){r.index>C?(O=r,r=null):O=r.sibling;var q=p(e,r,v.value,n);if(null===q){null===r&&(r=O);break}a&&r&&null===q.alternate&&b(e,r);g=f(q,g,C);null===l?m=q:l.sibling=q;l=q;r=O}if(v.done)return c(e,r),m;
if(null===r){for(;!v.done;C++,v=h.next())v=ba(e,v.value,n),null!==v&&(g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);return m}for(r=d(e,r);!v.done;C++,v=h.next())v=t(r,e,C,v.value,n),null!==v&&(a&&null!==v.alternate&&r.delete(null===v.key?C:v.key),g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);a&&r.forEach(function(a){return b(e,a)});return m}return function(a,d,f,h){var m="object"===typeof f&&null!==f&&f.type===Ma&&null===f.key;m&&(f=f.props.children);var n="object"===typeof f&&null!==f;if(n)switch(f.$$typeof){case Pc:a:{n=
f.key;for(m=d;null!==m;){if(m.key===n){switch(m.tag){case 7:if(f.type===Ma){c(a,m.sibling);d=e(m,f.props.children);d.return=a;a=d;break a}break;default:if(m.elementType===f.type){c(a,m.sibling);d=e(m,f.props);d.ref=Rb(a,m,f);d.return=a;a=d;break a}}c(a,m);break}else b(a,m);m=m.sibling}f.type===Ma?(d=Ha(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Oc(f.type,f.key,f.props,null,a.mode,h),h.ref=Rb(a,d,f),h.return=a,a=h)}return g(a);case gb:a:{for(m=f.key;null!==d;){if(d.key===m)if(4===d.tag&&d.stateNode.containerInfo===
f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=re(f,a.mode,h);d.return=a;a=d}return g(a)}if("string"===typeof f||"number"===typeof f)return f=""+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):(c(a,d),d=qe(f,a.mode,h),d.return=a,a=d),g(a);if(Qc(f))return q(a,d,f,h);if(zb(f))return w(a,d,f,h);n&&Nc(a,f);if("undefined"===typeof f&&!m)switch(a.tag){case 1:case 0:throw a=
a.type,Error(k(152,a.displayName||a.name||"Component"));}return c(a,d)}}function Ta(a){if(a===Sb)throw Error(k(174));return a}function se(a,b){y(Tb,b);y(Ub,a);y(ja,Sb);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:Hd(null,"");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=Hd(b,a)}q(ja);y(ja,b)}function tb(a){q(ja);q(Ub);q(Tb)}function bh(a){Ta(Tb.current);var b=Ta(ja.current);var c=Hd(b,a.type);b!==c&&(y(Ub,a),y(ja,c))}function te(a){Ub.current===
a&&(q(ja),q(Ub))}function Rc(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||c.data===$d||c.data===Zd))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.effectTag&64))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}function ue(a,b){return{responder:a,props:b}}
function S(){throw Error(k(321));}function ve(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!Qa(a[c],b[c]))return!1;return!0}function we(a,b,c,d,e,f){Ia=f;z=b;b.memoizedState=null;b.updateQueue=null;b.expirationTime=0;Sc.current=null===a||null===a.memoizedState?dj:ej;a=c(d,e);if(b.expirationTime===Ia){f=0;do{b.expirationTime=0;if(!(25>f))throw Error(k(301));f+=1;J=K=null;b.updateQueue=null;Sc.current=fj;a=c(d,e)}while(b.expirationTime===Ia)}Sc.current=Tc;b=null!==K&&null!==K.next;
Ia=0;J=K=z=null;Uc=!1;if(b)throw Error(k(300));return a}function ub(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===J?z.memoizedState=J=a:J=J.next=a;return J}function vb(){if(null===K){var a=z.alternate;a=null!==a?a.memoizedState:null}else a=K.next;var b=null===J?z.memoizedState:J.next;if(null!==b)J=b,K=a;else{if(null===a)throw Error(k(310));K=a;a={memoizedState:K.memoizedState,baseState:K.baseState,baseQueue:K.baseQueue,queue:K.queue,next:null};null===J?z.memoizedState=
J=a:J=J.next=a}return J}function Ua(a,b){return"function"===typeof b?b(a):b}function Vc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=K,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){e=e.next;d=d.baseState;var h=g=f=null,m=e;do{var n=m.expirationTime;if(n<Ia){var l={expirationTime:m.expirationTime,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,
next:null};null===h?(g=h=l,f=d):h=h.next=l;n>z.expirationTime&&(z.expirationTime=n,Kc(n))}else null!==h&&(h=h.next={expirationTime:1073741823,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,next:null}),Vg(n,m.suspenseConfig),d=m.eagerReducer===a?m.eagerState:a(d,m.action);m=m.next}while(null!==m&&m!==e);null===h?f=d:h.next=g;Qa(d,b.memoizedState)||(ia=!0);b.memoizedState=d;b.baseState=f;b.baseQueue=h;c.lastRenderedState=d}return[b.memoizedState,
c.dispatch]}function Wc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);Qa(f,b.memoizedState)||(ia=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}function xe(a){var b=ub();"function"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a=b.queue={pending:null,dispatch:null,lastRenderedReducer:Ua,
lastRenderedState:a};a=a.dispatch=ch.bind(null,z,a);return[b.memoizedState,a]}function ye(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=z.updateQueue;null===b?(b={lastEffect:null},z.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function dh(a){return vb().memoizedState}function ze(a,b,c,d){var e=ub();z.effectTag|=a;e.memoizedState=ye(1|b,c,void 0,void 0===d?null:d)}function Ae(a,b,c,d){var e=vb();
d=void 0===d?null:d;var f=void 0;if(null!==K){var g=K.memoizedState;f=g.destroy;if(null!==d&&ve(d,g.deps)){ye(b,c,f,d);return}}z.effectTag|=a;e.memoizedState=ye(1|b,c,f,d)}function eh(a,b){return ze(516,4,a,b)}function Xc(a,b){return Ae(516,4,a,b)}function fh(a,b){return Ae(4,2,a,b)}function gh(a,b){if("function"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function hh(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;
return Ae(4,2,gh.bind(null,b,a),c)}function Be(a,b){}function ih(a,b){ub().memoizedState=[a,void 0===b?null:b];return a}function Yc(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];c.memoizedState=[a,b];return a}function jh(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function Ce(a,b,c){var d=Cc();Da(98>d?98:d,function(){a(!0)});Da(97<d?97:d,function(){var d=
X.suspense;X.suspense=void 0===b?null:b;try{a(!1),c()}finally{X.suspense=d}})}function ch(a,b,c){var d=ka(),e=Vb.suspense;d=Va(d,a,e);e={expirationTime:d,suspenseConfig:e,action:c,eagerReducer:null,eagerState:null,next:null};var f=b.pending;null===f?e.next=e:(e.next=f.next,f.next=e);b.pending=e;f=a.alternate;if(a===z||null!==f&&f===z)Uc=!0,e.expirationTime=Ia,z.expirationTime=Ia;else{if(0===a.expirationTime&&(null===f||0===f.expirationTime)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,
h=f(g,c);e.eagerReducer=f;e.eagerState=h;if(Qa(h,g))return}catch(m){}finally{}Ja(a,d)}}function kh(a,b){var c=la(5,null,null,0);c.elementType="DELETED";c.type="DELETED";c.stateNode=b;c.return=a;c.effectTag=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}function lh(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,!0):!1;case 6:return b=""===a.pendingProps||3!==b.nodeType?
null:b,null!==b?(a.stateNode=b,!0):!1;case 13:return!1;default:return!1}}function De(a){if(Wa){var b=Ka;if(b){var c=b;if(!lh(a,b)){b=kb(c.nextSibling);if(!b||!lh(a,b)){a.effectTag=a.effectTag&-1025|2;Wa=!1;ra=a;return}kh(ra,c)}ra=a;Ka=kb(b.firstChild)}else a.effectTag=a.effectTag&-1025|2,Wa=!1,ra=a}}function mh(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;ra=a}function Zc(a){if(a!==ra)return!1;if(!Wa)return mh(a),Wa=!0,!1;var b=a.type;if(5!==a.tag||"head"!==b&&"body"!==
b&&!Yd(b,a.memoizedProps))for(b=Ka;b;)kh(a,b),b=kb(b.nextSibling);mh(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(k(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(c===og){if(0===b){Ka=kb(a.nextSibling);break a}b--}else c!==ng&&c!==Zd&&c!==$d||b++}a=a.nextSibling}Ka=null}}else Ka=ra?kb(a.stateNode.nextSibling):null;return!0}function Ee(){Ka=ra=null;Wa=!1}function T(a,b,c,d){b.child=null===a?Fe(b,null,c,d):wb(b,a.child,c,d)}function nh(a,
b,c,d,e){c=c.render;var f=b.ref;rb(b,e);d=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,d,e);return b.child}function oh(a,b,c,d,e,f){if(null===a){var g=c.type;if("function"===typeof g&&!Ge(g)&&void 0===g.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=g,ph(a,b,g,d,e,f);a=Oc(c.type,null,d,null,b.mode,f);a.ref=b.ref;a.return=b;return b.child=a}g=a.child;if(e<
f&&(e=g.memoizedProps,c=c.compare,c=null!==c?c:Ob,c(e,d)&&a.ref===b.ref))return sa(a,b,f);b.effectTag|=1;a=Sa(g,d);a.ref=b.ref;a.return=b;return b.child=a}function ph(a,b,c,d,e,f){return null!==a&&Ob(a.memoizedProps,d)&&a.ref===b.ref&&(ia=!1,e<f)?(b.expirationTime=a.expirationTime,sa(a,b,f)):He(a,b,c,d,f)}function qh(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.effectTag|=128}function He(a,b,c,d,e){var f=N(c)?Ra:B.current;f=pb(b,f);rb(b,e);c=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=
a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,c,e);return b.child}function rh(a,b,c,d,e){if(N(c)){var f=!0;Bc(b)}else f=!1;rb(b,e);if(null===b.stateNode)null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),Yg(b,c,d),pe(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var m=g.context,n=c.contextType;"object"===typeof n&&null!==n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n));var l=c.getDerivedStateFromProps,k="function"===
typeof l||"function"===typeof g.getSnapshotBeforeUpdate;k||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n);Ga=!1;var p=b.memoizedState;g.state=p;Qb(b,d,g,e);m=b.memoizedState;h!==d||p!==m||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),m=b.memoizedState),(h=Ga||Xg(b,c,h,d,p,m,n))?(k||"function"!==typeof g.UNSAFE_componentWillMount&&"function"!==typeof g.componentWillMount||("function"===typeof g.componentWillMount&&
g.componentWillMount(),"function"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),"function"===typeof g.componentDidMount&&(b.effectTag|=4)):("function"===typeof g.componentDidMount&&(b.effectTag|=4),b.memoizedProps=d,b.memoizedState=m),g.props=d,g.state=m,g.context=n,d=h):("function"===typeof g.componentDidMount&&(b.effectTag|=4),d=!1)}else g=b.stateNode,oe(a,b),h=b.memoizedProps,g.props=b.type===b.elementType?h:aa(b.type,h),m=g.context,n=c.contextType,"object"===typeof n&&null!==
n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n)),l=c.getDerivedStateFromProps,(k="function"===typeof l||"function"===typeof g.getSnapshotBeforeUpdate)||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n),Ga=!1,m=b.memoizedState,g.state=m,Qb(b,d,g,e),p=b.memoizedState,h!==d||m!==p||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),p=b.memoizedState),(l=Ga||Xg(b,c,h,d,m,p,n))?(k||"function"!==typeof g.UNSAFE_componentWillUpdate&&
"function"!==typeof g.componentWillUpdate||("function"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,p,n),"function"===typeof g.UNSAFE_componentWillUpdate&&g.UNSAFE_componentWillUpdate(d,p,n)),"function"===typeof g.componentDidUpdate&&(b.effectTag|=4),"function"===typeof g.getSnapshotBeforeUpdate&&(b.effectTag|=256)):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===
a.memoizedState||(b.effectTag|=256),b.memoizedProps=d,b.memoizedState=p),g.props=d,g.state=p,g.context=n,d=l):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=256),d=!1);return Ie(a,b,c,d,f,e)}function Ie(a,b,c,d,e,f){qh(a,b);var g=0!==(b.effectTag&64);if(!d&&!g)return e&&Hg(b,c,!1),sa(a,b,f);d=b.stateNode;gj.current=b;var h=g&&"function"!==typeof c.getDerivedStateFromError?
null:d.render();b.effectTag|=1;null!==a&&g?(b.child=wb(b,a.child,null,f),b.child=wb(b,null,h,f)):T(a,b,h,f);b.memoizedState=d.state;e&&Hg(b,c,!0);return b.child}function sh(a){var b=a.stateNode;b.pendingContext?Fg(a,b.pendingContext,b.pendingContext!==b.context):b.context&&Fg(a,b.context,!1);se(a,b.containerInfo)}function th(a,b,c){var d=b.mode,e=b.pendingProps,f=D.current,g=!1,h;(h=0!==(b.effectTag&64))||(h=0!==(f&2)&&(null===a||null!==a.memoizedState));h?(g=!0,b.effectTag&=-65):null!==a&&null===
a.memoizedState||void 0===e.fallback||!0===e.unstable_avoidThisFallback||(f|=1);y(D,f&1);if(null===a){void 0!==e.fallback&&De(b);if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;b.memoizedState=Je;b.child=e;return c}d=e.children;b.memoizedState=null;return b.child=Fe(b,null,d,c)}if(null!==a.memoizedState){a=a.child;d=a.sibling;if(g){e=e.fallback;
c=Sa(a,a.pendingProps);c.return=b;if(0===(b.mode&2)&&(g=null!==b.memoizedState?b.child.child:b.child,g!==a.child))for(c.child=g;null!==g;)g.return=c,g=g.sibling;d=Sa(d,e);d.return=b;c.sibling=d;c.childExpirationTime=0;b.memoizedState=Je;b.child=c;return d}c=wb(b,a.child,e.children,c);b.memoizedState=null;return b.child=c}a=a.child;if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;e.child=a;null!==a&&(a.return=e);if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==
a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;c.effectTag|=2;e.childExpirationTime=0;b.memoizedState=Je;b.child=e;return c}b.memoizedState=null;return b.child=wb(b,a,e.children,c)}function uh(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);Sg(a.return,b)}function Ke(a,b,c,d,e,f){var g=a.memoizedState;null===g?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailExpiration:0,tailMode:e,
lastEffect:f}:(g.isBackwards=b,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=c,g.tailExpiration=0,g.tailMode=e,g.lastEffect=f)}function vh(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;T(a,b,d.children,c);d=D.current;if(0!==(d&2))d=d&1|2,b.effectTag|=64;else{if(null!==a&&0!==(a.effectTag&64))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&uh(a,c);else if(19===a.tag)uh(a,c);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===
a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}y(D,d);if(0===(b.mode&2))b.memoizedState=null;else switch(e){case "forwards":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===Rc(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);Ke(b,!1,e,c,f,b.lastEffect);break;case "backwards":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===Rc(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}Ke(b,
!0,c,null,f,b.lastEffect);break;case "together":Ke(b,!1,null,null,void 0,b.lastEffect);break;default:b.memoizedState=null}return b.child}function sa(a,b,c){null!==a&&(b.dependencies=a.dependencies);var d=b.expirationTime;0!==d&&Kc(d);if(b.childExpirationTime<c)return null;if(null!==a&&b.child!==a.child)throw Error(k(153));if(null!==b.child){a=b.child;c=Sa(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Sa(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}
function $c(a,b){switch(a.tailMode){case "hidden":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case "collapsed":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}function hj(a,b,c){var d=b.pendingProps;switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return N(b.type)&&(q(G),q(B)),
null;case 3:return tb(),q(G),q(B),c=b.stateNode,c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),null!==a&&null!==a.child||!Zc(b)||(b.effectTag|=4),wh(b),null;case 5:te(b);c=Ta(Tb.current);var e=b.type;if(null!==a&&null!=b.stateNode)ij(a,b,e,d,c),a.ref!==b.ref&&(b.effectTag|=128);else{if(!d){if(null===b.stateNode)throw Error(k(166));return null}a=Ta(ja.current);if(Zc(b)){d=b.stateNode;e=b.type;var f=b.memoizedProps;d[Aa]=b;d[vc]=f;switch(e){case "iframe":case "object":case "embed":w("load",
d);break;case "video":case "audio":for(a=0;a<Db.length;a++)w(Db[a],d);break;case "source":w("error",d);break;case "img":case "image":case "link":w("error",d);w("load",d);break;case "form":w("reset",d);w("submit",d);break;case "details":w("toggle",d);break;case "input":Hf(d,f);w("invalid",d);oa(c,"onChange");break;case "select":d._wrapperState={wasMultiple:!!f.multiple};w("invalid",d);oa(c,"onChange");break;case "textarea":Kf(d,f),w("invalid",d),oa(c,"onChange")}Ud(e,f);a=null;for(var g in f)if(f.hasOwnProperty(g)){var h=
f[g];"children"===g?"string"===typeof h?d.textContent!==h&&(a=["children",h]):"number"===typeof h&&d.textContent!==""+h&&(a=["children",""+h]):db.hasOwnProperty(g)&&null!=h&&oa(c,g)}switch(e){case "input":mc(d);Jf(d,f,!0);break;case "textarea":mc(d);Mf(d);break;case "select":case "option":break;default:"function"===typeof f.onClick&&(d.onclick=uc)}c=a;b.updateQueue=c;null!==c&&(b.effectTag|=4)}else{g=9===c.nodeType?c:c.ownerDocument;"http://www.w3.org/1999/xhtml"===a&&(a=Nf(e));"http://www.w3.org/1999/xhtml"===
a?"script"===e?(a=g.createElement("div"),a.innerHTML="<script>\x3c/script>",a=a.removeChild(a.firstChild)):"string"===typeof d.is?a=g.createElement(e,{is:d.is}):(a=g.createElement(e),"select"===e&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,e);a[Aa]=b;a[vc]=d;jj(a,b,!1,!1);b.stateNode=a;g=Vd(e,d);switch(e){case "iframe":case "object":case "embed":w("load",a);h=d;break;case "video":case "audio":for(h=0;h<Db.length;h++)w(Db[h],a);h=d;break;case "source":w("error",a);
h=d;break;case "img":case "image":case "link":w("error",a);w("load",a);h=d;break;case "form":w("reset",a);w("submit",a);h=d;break;case "details":w("toggle",a);h=d;break;case "input":Hf(a,d);h=Cd(a,d);w("invalid",a);oa(c,"onChange");break;case "option":h=Fd(a,d);break;case "select":a._wrapperState={wasMultiple:!!d.multiple};h=M({},d,{value:void 0});w("invalid",a);oa(c,"onChange");break;case "textarea":Kf(a,d);h=Gd(a,d);w("invalid",a);oa(c,"onChange");break;default:h=d}Ud(e,h);var m=h;for(f in m)if(m.hasOwnProperty(f)){var n=
m[f];"style"===f?gg(a,n):"dangerouslySetInnerHTML"===f?(n=n?n.__html:void 0,null!=n&&xh(a,n)):"children"===f?"string"===typeof n?("textarea"!==e||""!==n)&&Wb(a,n):"number"===typeof n&&Wb(a,""+n):"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&"autoFocus"!==f&&(db.hasOwnProperty(f)?null!=n&&oa(c,f):null!=n&&xd(a,f,n,g))}switch(e){case "input":mc(a);Jf(a,d,!1);break;case "textarea":mc(a);Mf(a);break;case "option":null!=d.value&&a.setAttribute("value",""+va(d.value));break;case "select":a.multiple=
!!d.multiple;c=d.value;null!=c?hb(a,!!d.multiple,c,!1):null!=d.defaultValue&&hb(a,!!d.multiple,d.defaultValue,!0);break;default:"function"===typeof h.onClick&&(a.onclick=uc)}lg(e,d)&&(b.effectTag|=4)}null!==b.ref&&(b.effectTag|=128)}return null;case 6:if(a&&null!=b.stateNode)kj(a,b,a.memoizedProps,d);else{if("string"!==typeof d&&null===b.stateNode)throw Error(k(166));c=Ta(Tb.current);Ta(ja.current);Zc(b)?(c=b.stateNode,d=b.memoizedProps,c[Aa]=b,c.nodeValue!==d&&(b.effectTag|=4)):(c=(9===c.nodeType?
c:c.ownerDocument).createTextNode(d),c[Aa]=b,b.stateNode=c)}return null;case 13:q(D);d=b.memoizedState;if(0!==(b.effectTag&64))return b.expirationTime=c,b;c=null!==d;d=!1;null===a?void 0!==b.memoizedProps.fallback&&Zc(b):(e=a.memoizedState,d=null!==e,c||null===e||(e=a.child.sibling,null!==e&&(f=b.firstEffect,null!==f?(b.firstEffect=e,e.nextEffect=f):(b.firstEffect=b.lastEffect=e,e.nextEffect=null),e.effectTag=8)));if(c&&!d&&0!==(b.mode&2))if(null===a&&!0!==b.memoizedProps.unstable_avoidThisFallback||
0!==(D.current&1))F===Xa&&(F=ad);else{if(F===Xa||F===ad)F=bd;0!==Xb&&null!==U&&(Ya(U,P),yh(U,Xb))}if(c||d)b.effectTag|=4;return null;case 4:return tb(),wh(b),null;case 10:return me(b),null;case 17:return N(b.type)&&(q(G),q(B)),null;case 19:q(D);d=b.memoizedState;if(null===d)return null;e=0!==(b.effectTag&64);f=d.rendering;if(null===f)if(e)$c(d,!1);else{if(F!==Xa||null!==a&&0!==(a.effectTag&64))for(f=b.child;null!==f;){a=Rc(f);if(null!==a){b.effectTag|=64;$c(d,!1);e=a.updateQueue;null!==e&&(b.updateQueue=
e,b.effectTag|=4);null===d.lastEffect&&(b.firstEffect=null);b.lastEffect=d.lastEffect;for(d=b.child;null!==d;)e=d,f=c,e.effectTag&=2,e.nextEffect=null,e.firstEffect=null,e.lastEffect=null,a=e.alternate,null===a?(e.childExpirationTime=0,e.expirationTime=f,e.child=null,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null):(e.childExpirationTime=a.childExpirationTime,e.expirationTime=a.expirationTime,e.child=a.child,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,
e.updateQueue=a.updateQueue,f=a.dependencies,e.dependencies=null===f?null:{expirationTime:f.expirationTime,firstContext:f.firstContext,responders:f.responders}),d=d.sibling;y(D,D.current&1|2);return b.child}f=f.sibling}}else{if(!e)if(a=Rc(f),null!==a){if(b.effectTag|=64,e=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.effectTag|=4),$c(d,!0),null===d.tail&&"hidden"===d.tailMode&&!f.alternate)return b=b.lastEffect=d.lastEffect,null!==b&&(b.nextEffect=null),null}else 2*Y()-d.renderingStartTime>d.tailExpiration&&
1<c&&(b.effectTag|=64,e=!0,$c(d,!1),b.expirationTime=b.childExpirationTime=c-1);d.isBackwards?(f.sibling=b.child,b.child=f):(c=d.last,null!==c?c.sibling=f:b.child=f,d.last=f)}return null!==d.tail?(0===d.tailExpiration&&(d.tailExpiration=Y()+500),c=d.tail,d.rendering=c,d.tail=c.sibling,d.lastEffect=b.lastEffect,d.renderingStartTime=Y(),c.sibling=null,b=D.current,y(D,e?b&1|2:b&1),c):null}throw Error(k(156,b.tag));}function lj(a,b){switch(a.tag){case 1:return N(a.type)&&(q(G),q(B)),b=a.effectTag,b&4096?
(a.effectTag=b&-4097|64,a):null;case 3:tb();q(G);q(B);b=a.effectTag;if(0!==(b&64))throw Error(k(285));a.effectTag=b&-4097|64;return a;case 5:return te(a),null;case 13:return q(D),b=a.effectTag,b&4096?(a.effectTag=b&-4097|64,a):null;case 19:return q(D),null;case 4:return tb(),null;case 10:return me(a),null;default:return null}}function Le(a,b){return{value:a,source:b,stack:Bd(b)}}function Me(a,b){var c=b.source,d=b.stack;null===d&&null!==c&&(d=Bd(c));null!==c&&na(c.type);b=b.value;null!==a&&1===a.tag&&
na(a.type);try{console.error(b)}catch(e){setTimeout(function(){throw e;})}}function mj(a,b){try{b.props=a.memoizedProps,b.state=a.memoizedState,b.componentWillUnmount()}catch(c){Za(a,c)}}function zh(a){var b=a.ref;if(null!==b)if("function"===typeof b)try{b(null)}catch(c){Za(a,c)}else b.current=null}function nj(a,b){switch(b.tag){case 0:case 11:case 15:case 22:return;case 1:if(b.effectTag&256&&null!==a){var c=a.memoizedProps,d=a.memoizedState;a=b.stateNode;b=a.getSnapshotBeforeUpdate(b.elementType===
b.type?c:aa(b.type,c),d);a.__reactInternalSnapshotBeforeUpdate=b}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(k(163));}function Ah(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.destroy;c.destroy=void 0;void 0!==d&&d()}c=c.next}while(c!==b)}}function Bh(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}function oj(a,b,c,d){switch(c.tag){case 0:case 11:case 15:case 22:Bh(3,
c);return;case 1:a=c.stateNode;c.effectTag&4&&(null===b?a.componentDidMount():(d=c.elementType===c.type?b.memoizedProps:aa(c.type,b.memoizedProps),a.componentDidUpdate(d,b.memoizedState,a.__reactInternalSnapshotBeforeUpdate)));b=c.updateQueue;null!==b&&Wg(c,b,a);return;case 3:b=c.updateQueue;if(null!==b){a=null;if(null!==c.child)switch(c.child.tag){case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}Wg(c,b,a)}return;case 5:a=c.stateNode;null===b&&c.effectTag&4&&lg(c.type,c.memoizedProps)&&
a.focus();return;case 6:return;case 4:return;case 12:return;case 13:null===c.memoizedState&&(c=c.alternate,null!==c&&(c=c.memoizedState,null!==c&&(c=c.dehydrated,null!==c&&bg(c))));return;case 19:case 17:case 20:case 21:return}throw Error(k(163));}function Ch(a,b,c){"function"===typeof Ne&&Ne(b);switch(b.tag){case 0:case 11:case 14:case 15:case 22:a=b.updateQueue;if(null!==a&&(a=a.lastEffect,null!==a)){var d=a.next;Da(97<c?97:c,function(){var a=d;do{var c=a.destroy;if(void 0!==c){var g=b;try{c()}catch(h){Za(g,
h)}}a=a.next}while(a!==d)})}break;case 1:zh(b);c=b.stateNode;"function"===typeof c.componentWillUnmount&&mj(b,c);break;case 5:zh(b);break;case 4:Dh(a,b,c)}}function Eh(a){var b=a.alternate;a.return=null;a.child=null;a.memoizedState=null;a.updateQueue=null;a.dependencies=null;a.alternate=null;a.firstEffect=null;a.lastEffect=null;a.pendingProps=null;a.memoizedProps=null;a.stateNode=null;null!==b&&Eh(b)}function Fh(a){return 5===a.tag||3===a.tag||4===a.tag}function Gh(a){a:{for(var b=a.return;null!==
b;){if(Fh(b)){var c=b;break a}b=b.return}throw Error(k(160));}b=c.stateNode;switch(c.tag){case 5:var d=!1;break;case 3:b=b.containerInfo;d=!0;break;case 4:b=b.containerInfo;d=!0;break;default:throw Error(k(161));}c.effectTag&16&&(Wb(b,""),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||Fh(c.return)){c=null;break a}c=c.return}c.sibling.return=c.return;for(c=c.sibling;5!==c.tag&&6!==c.tag&&18!==c.tag;){if(c.effectTag&2)continue b;if(null===c.child||4===c.tag)continue b;
else c.child.return=c,c=c.child}if(!(c.effectTag&2)){c=c.stateNode;break a}}d?Oe(a,c,b):Pe(a,c,b)}function Oe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=uc));else if(4!==d&&(a=a.child,null!==a))for(Oe(a,b,c),a=a.sibling;null!==a;)Oe(a,b,c),a=a.sibling}
function Pe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Pe(a,b,c),a=a.sibling;null!==a;)Pe(a,b,c),a=a.sibling}function Dh(a,b,c){for(var d=b,e=!1,f,g;;){if(!e){e=d.return;a:for(;;){if(null===e)throw Error(k(160));f=e.stateNode;switch(e.tag){case 5:g=!1;break a;case 3:f=f.containerInfo;g=!0;break a;case 4:f=f.containerInfo;g=!0;break a}e=e.return}e=!0}if(5===d.tag||6===d.tag){a:for(var h=
a,m=d,n=c,l=m;;)if(Ch(h,l,n),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===m)break a;for(;null===l.sibling;){if(null===l.return||l.return===m)break a;l=l.return}l.sibling.return=l.return;l=l.sibling}g?(h=f,m=d.stateNode,8===h.nodeType?h.parentNode.removeChild(m):h.removeChild(m)):f.removeChild(d.stateNode)}else if(4===d.tag){if(null!==d.child){f=d.stateNode.containerInfo;g=!0;d.child.return=d;d=d.child;continue}}else if(Ch(a,d,c),null!==d.child){d.child.return=d;d=d.child;continue}if(d===
b)break;for(;null===d.sibling;){if(null===d.return||d.return===b)return;d=d.return;4===d.tag&&(e=!1)}d.sibling.return=d.return;d=d.sibling}}function Qe(a,b){switch(b.tag){case 0:case 11:case 14:case 15:case 22:Ah(3,b);return;case 1:return;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps,e=null!==a?a.memoizedProps:d;a=b.type;var f=b.updateQueue;b.updateQueue=null;if(null!==f){c[vc]=d;"input"===a&&"radio"===d.type&&null!=d.name&&If(c,d);Vd(a,e);b=Vd(a,d);for(e=0;e<f.length;e+=2){var g=f[e],
h=f[e+1];"style"===g?gg(c,h):"dangerouslySetInnerHTML"===g?xh(c,h):"children"===g?Wb(c,h):xd(c,g,h,b)}switch(a){case "input":Dd(c,d);break;case "textarea":Lf(c,d);break;case "select":b=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!d.multiple,a=d.value,null!=a?hb(c,!!d.multiple,a,!1):b!==!!d.multiple&&(null!=d.defaultValue?hb(c,!!d.multiple,d.defaultValue,!0):hb(c,!!d.multiple,d.multiple?[]:"",!1))}}}return;case 6:if(null===b.stateNode)throw Error(k(162));b.stateNode.nodeValue=b.memoizedProps;
return;case 3:b=b.stateNode;b.hydrate&&(b.hydrate=!1,bg(b.containerInfo));return;case 12:return;case 13:c=b;null===b.memoizedState?d=!1:(d=!0,c=b.child,Re=Y());if(null!==c)a:for(a=c;;){if(5===a.tag)f=a.stateNode,d?(f=f.style,"function"===typeof f.setProperty?f.setProperty("display","none","important"):f.display="none"):(f=a.stateNode,e=a.memoizedProps.style,e=void 0!==e&&null!==e&&e.hasOwnProperty("display")?e.display:null,f.style.display=fg("display",e));else if(6===a.tag)a.stateNode.nodeValue=d?
"":a.memoizedProps;else if(13===a.tag&&null!==a.memoizedState&&null===a.memoizedState.dehydrated){f=a.child.sibling;f.return=a;a=f;continue}else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===c)break;for(;null===a.sibling;){if(null===a.return||a.return===c)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}Hh(b);return;case 19:Hh(b);return;case 17:return}throw Error(k(163));}function Hh(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=
new pj);b.forEach(function(b){var d=qj.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}function Ih(a,b,c){c=Ea(c,null);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){cd||(cd=!0,Se=d);Me(a,b)};return c}function Jh(a,b,c){c=Ea(c,null);c.tag=3;var d=a.type.getDerivedStateFromError;if("function"===typeof d){var e=b.value;c.payload=function(){Me(a,b);return d(e)}}var f=a.stateNode;null!==f&&"function"===typeof f.componentDidCatch&&(c.callback=function(){"function"!==typeof d&&
(null===La?La=new Set([this]):La.add(this),Me(a,b));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:""})});return c}function ka(){return(p&(ca|ma))!==H?1073741821-(Y()/10|0):0!==dd?dd:dd=1073741821-(Y()/10|0)}function Va(a,b,c){b=b.mode;if(0===(b&2))return 1073741823;var d=Cc();if(0===(b&4))return 99===d?1073741823:1073741822;if((p&ca)!==H)return P;if(null!==c)a=Fc(a,c.timeoutMs|0||5E3,250);else switch(d){case 99:a=1073741823;break;case 98:a=Fc(a,150,100);break;case 97:case 96:a=
Fc(a,5E3,250);break;case 95:a=2;break;default:throw Error(k(326));}null!==U&&a===P&&--a;return a}function ed(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);var d=a.return,e=null;if(null===d&&3===a.tag)e=a.stateNode;else for(;null!==d;){c=d.alternate;d.childExpirationTime<b&&(d.childExpirationTime=b);null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);if(null===d.return&&3===d.tag){e=d.stateNode;break}d=d.return}null!==e&&
(U===e&&(Kc(b),F===bd&&Ya(e,P)),yh(e,b));return e}function fd(a){var b=a.lastExpiredTime;if(0!==b)return b;b=a.firstPendingTime;if(!Kh(a,b))return b;var c=a.lastPingedTime;a=a.nextKnownPendingLevel;a=c>a?c:a;return 2>=a&&b!==a?0:a}function V(a){if(0!==a.lastExpiredTime)a.callbackExpirationTime=1073741823,a.callbackPriority=99,a.callbackNode=Og(Te.bind(null,a));else{var b=fd(a),c=a.callbackNode;if(0===b)null!==c&&(a.callbackNode=null,a.callbackExpirationTime=0,a.callbackPriority=90);else{var d=ka();
1073741823===b?d=99:1===b||2===b?d=95:(d=10*(1073741821-b)-10*(1073741821-d),d=0>=d?99:250>=d?98:5250>=d?97:95);if(null!==c){var e=a.callbackPriority;if(a.callbackExpirationTime===b&&e>=d)return;c!==Qg&&Rg(c)}a.callbackExpirationTime=b;a.callbackPriority=d;b=1073741823===b?Og(Te.bind(null,a)):Ng(d,Lh.bind(null,a),{timeout:10*(1073741821-b)-Y()});a.callbackNode=b}}}function Lh(a,b){dd=0;if(b)return b=ka(),Ue(a,b),V(a),null;var c=fd(a);if(0!==c){b=a.callbackNode;if((p&(ca|ma))!==H)throw Error(k(327));
xb();a===U&&c===P||$a(a,c);if(null!==t){var d=p;p|=ca;var e=Mh();do try{rj();break}catch(h){Nh(a,h)}while(1);le();p=d;gd.current=e;if(F===hd)throw b=id,$a(a,c),Ya(a,c),V(a),b;if(null===t)switch(e=a.finishedWork=a.current.alternate,a.finishedExpirationTime=c,d=F,U=null,d){case Xa:case hd:throw Error(k(345));case Oh:Ue(a,2<c?2:c);break;case ad:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(1073741823===ta&&(e=Re+Ph-Y(),10<e)){if(jd){var f=a.lastPingedTime;if(0===f||f>=c){a.lastPingedTime=
c;$a(a,c);break}}f=fd(a);if(0!==f&&f!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}a.timeoutHandle=We(ab.bind(null,a),e);break}ab(a);break;case bd:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(jd&&(e=a.lastPingedTime,0===e||e>=c)){a.lastPingedTime=c;$a(a,c);break}e=fd(a);if(0!==e&&e!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}1073741823!==Yb?d=10*(1073741821-Yb)-Y():1073741823===ta?d=0:(d=10*(1073741821-ta)-5E3,e=Y(),c=10*(1073741821-c)-e,d=e-d,0>d&&(d=0),d=
(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*sj(d/1960))-d,c<d&&(d=c));if(10<d){a.timeoutHandle=We(ab.bind(null,a),d);break}ab(a);break;case Xe:if(1073741823!==ta&&null!==kd){f=ta;var g=kd;d=g.busyMinDurationMs|0;0>=d?d=0:(e=g.busyDelayMs|0,f=Y()-(10*(1073741821-f)-(g.timeoutMs|0||5E3)),d=f<=e?0:e+d-f);if(10<d){Ya(a,c);a.timeoutHandle=We(ab.bind(null,a),d);break}}ab(a);break;default:throw Error(k(329));}V(a);if(a.callbackNode===b)return Lh.bind(null,a)}}return null}function Te(a){var b=
a.lastExpiredTime;b=0!==b?b:1073741823;if((p&(ca|ma))!==H)throw Error(k(327));xb();a===U&&b===P||$a(a,b);if(null!==t){var c=p;p|=ca;var d=Mh();do try{tj();break}catch(e){Nh(a,e)}while(1);le();p=c;gd.current=d;if(F===hd)throw c=id,$a(a,b),Ya(a,b),V(a),c;if(null!==t)throw Error(k(261));a.finishedWork=a.current.alternate;a.finishedExpirationTime=b;U=null;ab(a);V(a)}return null}function uj(){if(null!==bb){var a=bb;bb=null;a.forEach(function(a,c){Ue(c,a);V(c)});ha()}}function Qh(a,b){var c=p;p|=1;try{return a(b)}finally{p=
c,p===H&&ha()}}function Rh(a,b){var c=p;p&=-2;p|=Ye;try{return a(b)}finally{p=c,p===H&&ha()}}function $a(a,b){a.finishedWork=null;a.finishedExpirationTime=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,vj(c));if(null!==t)for(c=t.return;null!==c;){var d=c;switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&(q(G),q(B));break;case 3:tb();q(G);q(B);break;case 5:te(d);break;case 4:tb();break;case 13:q(D);break;case 19:q(D);break;case 10:me(d)}c=c.return}U=a;t=Sa(a.current,null);
P=b;F=Xa;id=null;Yb=ta=1073741823;kd=null;Xb=0;jd=!1}function Nh(a,b){do{try{le();Sc.current=Tc;if(Uc)for(var c=z.memoizedState;null!==c;){var d=c.queue;null!==d&&(d.pending=null);c=c.next}Ia=0;J=K=z=null;Uc=!1;if(null===t||null===t.return)return F=hd,id=b,t=null;a:{var e=a,f=t.return,g=t,h=b;b=P;g.effectTag|=2048;g.firstEffect=g.lastEffect=null;if(null!==h&&"object"===typeof h&&"function"===typeof h.then){var m=h;if(0===(g.mode&2)){var n=g.alternate;n?(g.updateQueue=n.updateQueue,g.memoizedState=
n.memoizedState,g.expirationTime=n.expirationTime):(g.updateQueue=null,g.memoizedState=null)}var l=0!==(D.current&1),k=f;do{var p;if(p=13===k.tag){var q=k.memoizedState;if(null!==q)p=null!==q.dehydrated?!0:!1;else{var w=k.memoizedProps;p=void 0===w.fallback?!1:!0!==w.unstable_avoidThisFallback?!0:l?!1:!0}}if(p){var y=k.updateQueue;if(null===y){var r=new Set;r.add(m);k.updateQueue=r}else y.add(m);if(0===(k.mode&2)){k.effectTag|=64;g.effectTag&=-2981;if(1===g.tag)if(null===g.alternate)g.tag=17;else{var O=
Ea(1073741823,null);O.tag=Jc;Fa(g,O)}g.expirationTime=1073741823;break a}h=void 0;g=b;var v=e.pingCache;null===v?(v=e.pingCache=new wj,h=new Set,v.set(m,h)):(h=v.get(m),void 0===h&&(h=new Set,v.set(m,h)));if(!h.has(g)){h.add(g);var x=xj.bind(null,e,m,g);m.then(x,x)}k.effectTag|=4096;k.expirationTime=b;break a}k=k.return}while(null!==k);h=Error((na(g.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+
Bd(g))}F!==Xe&&(F=Oh);h=Le(h,g);k=f;do{switch(k.tag){case 3:m=h;k.effectTag|=4096;k.expirationTime=b;var A=Ih(k,m,b);Ug(k,A);break a;case 1:m=h;var u=k.type,B=k.stateNode;if(0===(k.effectTag&64)&&("function"===typeof u.getDerivedStateFromError||null!==B&&"function"===typeof B.componentDidCatch&&(null===La||!La.has(B)))){k.effectTag|=4096;k.expirationTime=b;var H=Jh(k,m,b);Ug(k,H);break a}}k=k.return}while(null!==k)}t=Sh(t)}catch(cj){b=cj;continue}break}while(1)}function Mh(a){a=gd.current;gd.current=
Tc;return null===a?Tc:a}function Vg(a,b){a<ta&&2<a&&(ta=a);null!==b&&a<Yb&&2<a&&(Yb=a,kd=b)}function Kc(a){a>Xb&&(Xb=a)}function tj(){for(;null!==t;)t=Th(t)}function rj(){for(;null!==t&&!yj();)t=Th(t)}function Th(a){var b=zj(a.alternate,a,P);a.memoizedProps=a.pendingProps;null===b&&(b=Sh(a));Uh.current=null;return b}function Sh(a){t=a;do{var b=t.alternate;a=t.return;if(0===(t.effectTag&2048)){b=hj(b,t,P);if(1===P||1!==t.childExpirationTime){for(var c=0,d=t.child;null!==d;){var e=d.expirationTime,
f=d.childExpirationTime;e>c&&(c=e);f>c&&(c=f);d=d.sibling}t.childExpirationTime=c}if(null!==b)return b;null!==a&&0===(a.effectTag&2048)&&(null===a.firstEffect&&(a.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==a.lastEffect&&(a.lastEffect.nextEffect=t.firstEffect),a.lastEffect=t.lastEffect),1<t.effectTag&&(null!==a.lastEffect?a.lastEffect.nextEffect=t:a.firstEffect=t,a.lastEffect=t))}else{b=lj(t);if(null!==b)return b.effectTag&=2047,b;null!==a&&(a.firstEffect=a.lastEffect=null,a.effectTag|=
2048)}b=t.sibling;if(null!==b)return b;t=a}while(null!==t);F===Xa&&(F=Xe);return null}function Ve(a){var b=a.expirationTime;a=a.childExpirationTime;return b>a?b:a}function ab(a){var b=Cc();Da(99,Aj.bind(null,a,b));return null}function Aj(a,b){do xb();while(null!==Zb);if((p&(ca|ma))!==H)throw Error(k(327));var c=a.finishedWork,d=a.finishedExpirationTime;if(null===c)return null;a.finishedWork=null;a.finishedExpirationTime=0;if(c===a.current)throw Error(k(177));a.callbackNode=null;a.callbackExpirationTime=
0;a.callbackPriority=90;a.nextKnownPendingLevel=0;var e=Ve(c);a.firstPendingTime=e;d<=a.lastSuspendedTime?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:d<=a.firstSuspendedTime&&(a.firstSuspendedTime=d-1);d<=a.lastPingedTime&&(a.lastPingedTime=0);d<=a.lastExpiredTime&&(a.lastExpiredTime=0);a===U&&(t=U=null,P=0);1<c.effectTag?null!==c.lastEffect?(c.lastEffect.nextEffect=c,e=c.firstEffect):e=c:e=c.firstEffect;if(null!==e){var f=p;p|=ma;Uh.current=null;Ze=tc;var g=kg();if(Xd(g)){if("selectionStart"in
g)var h={start:g.selectionStart,end:g.selectionEnd};else a:{h=(h=g.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&0!==m.rangeCount){h=m.anchorNode;var n=m.anchorOffset,q=m.focusNode;m=m.focusOffset;try{h.nodeType,q.nodeType}catch(sb){h=null;break a}var ba=0,w=-1,y=-1,B=0,D=0,r=g,z=null;b:for(;;){for(var v;;){r!==h||0!==n&&3!==r.nodeType||(w=ba+n);r!==q||0!==m&&3!==r.nodeType||(y=ba+m);3===r.nodeType&&(ba+=r.nodeValue.length);if(null===(v=r.firstChild))break;z=r;
r=v}for(;;){if(r===g)break b;z===h&&++B===n&&(w=ba);z===q&&++D===m&&(y=ba);if(null!==(v=r.nextSibling))break;r=z;z=r.parentNode}r=v}h=-1===w||-1===y?null:{start:w,end:y}}else h=null}h=h||{start:0,end:0}}else h=null;$e={activeElementDetached:null,focusedElem:g,selectionRange:h};tc=!1;l=e;do try{Bj()}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=e;do try{for(g=a,h=b;null!==l;){var x=l.effectTag;x&16&&Wb(l.stateNode,"");if(x&128){var A=l.alternate;if(null!==A){var u=
A.ref;null!==u&&("function"===typeof u?u(null):u.current=null)}}switch(x&1038){case 2:Gh(l);l.effectTag&=-3;break;case 6:Gh(l);l.effectTag&=-3;Qe(l.alternate,l);break;case 1024:l.effectTag&=-1025;break;case 1028:l.effectTag&=-1025;Qe(l.alternate,l);break;case 4:Qe(l.alternate,l);break;case 8:n=l,Dh(g,n,h),Eh(n)}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);u=$e;A=kg();x=u.focusedElem;h=u.selectionRange;if(A!==x&&x&&x.ownerDocument&&jg(x.ownerDocument.documentElement,
x)){null!==h&&Xd(x)&&(A=h.start,u=h.end,void 0===u&&(u=A),"selectionStart"in x?(x.selectionStart=A,x.selectionEnd=Math.min(u,x.value.length)):(u=(A=x.ownerDocument||document)&&A.defaultView||window,u.getSelection&&(u=u.getSelection(),n=x.textContent.length,g=Math.min(h.start,n),h=void 0===h.end?g:Math.min(h.end,n),!u.extend&&g>h&&(n=h,h=g,g=n),n=ig(x,g),q=ig(x,h),n&&q&&(1!==u.rangeCount||u.anchorNode!==n.node||u.anchorOffset!==n.offset||u.focusNode!==q.node||u.focusOffset!==q.offset)&&(A=A.createRange(),
A.setStart(n.node,n.offset),u.removeAllRanges(),g>h?(u.addRange(A),u.extend(q.node,q.offset)):(A.setEnd(q.node,q.offset),u.addRange(A))))));A=[];for(u=x;u=u.parentNode;)1===u.nodeType&&A.push({element:u,left:u.scrollLeft,top:u.scrollTop});"function"===typeof x.focus&&x.focus();for(x=0;x<A.length;x++)u=A[x],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}tc=!!Ze;$e=Ze=null;a.current=c;l=e;do try{for(x=a;null!==l;){var F=l.effectTag;F&36&&oj(x,l.alternate,l);if(F&128){A=void 0;var E=l.ref;if(null!==
E){var G=l.stateNode;switch(l.tag){case 5:A=G;break;default:A=G}"function"===typeof E?E(A):E.current=A}}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=null;Cj();p=f}else a.current=c;if(ld)ld=!1,Zb=a,$b=b;else for(l=e;null!==l;)b=l.nextEffect,l.nextEffect=null,l=b;b=a.firstPendingTime;0===b&&(La=null);1073741823===b?a===af?ac++:(ac=0,af=a):ac=0;"function"===typeof bf&&bf(c.stateNode,d);V(a);if(cd)throw cd=!1,a=Se,Se=null,a;if((p&Ye)!==H)return null;
ha();return null}function Bj(){for(;null!==l;){var a=l.effectTag;0!==(a&256)&&nj(l.alternate,l);0===(a&512)||ld||(ld=!0,Ng(97,function(){xb();return null}));l=l.nextEffect}}function xb(){if(90!==$b){var a=97<$b?97:$b;$b=90;return Da(a,Dj)}}function Dj(){if(null===Zb)return!1;var a=Zb;Zb=null;if((p&(ca|ma))!==H)throw Error(k(331));var b=p;p|=ma;for(a=a.current.firstEffect;null!==a;){try{var c=a;if(0!==(c.effectTag&512))switch(c.tag){case 0:case 11:case 15:case 22:Ah(5,c),Bh(5,c)}}catch(d){if(null===
a)throw Error(k(330));Za(a,d)}c=a.nextEffect;a.nextEffect=null;a=c}p=b;ha();return!0}function Vh(a,b,c){b=Le(c,b);b=Ih(a,b,1073741823);Fa(a,b);a=ed(a,1073741823);null!==a&&V(a)}function Za(a,b){if(3===a.tag)Vh(a,a,b);else for(var c=a.return;null!==c;){if(3===c.tag){Vh(c,a,b);break}else if(1===c.tag){var d=c.stateNode;if("function"===typeof c.type.getDerivedStateFromError||"function"===typeof d.componentDidCatch&&(null===La||!La.has(d))){a=Le(b,a);a=Jh(c,a,1073741823);Fa(c,a);c=ed(c,1073741823);null!==
c&&V(c);break}}c=c.return}}function xj(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);U===a&&P===c?F===bd||F===ad&&1073741823===ta&&Y()-Re<Ph?$a(a,P):jd=!0:Kh(a,c)&&(b=a.lastPingedTime,0!==b&&b<c||(a.lastPingedTime=c,V(a)))}function qj(a,b){var c=a.stateNode;null!==c&&c.delete(b);b=0;0===b&&(b=ka(),b=Va(b,a,null));a=ed(a,b);null!==a&&V(a)}function Ej(a){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=
b.inject(a);bf=function(a,e){try{b.onCommitFiberRoot(c,a,void 0,64===(a.current.effectTag&64))}catch(f){}};Ne=function(a){try{b.onCommitFiberUnmount(c,a)}catch(e){}}}catch(d){}return!0}function Fj(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=
null;this.childExpirationTime=this.expirationTime=0;this.alternate=null}function Ge(a){a=a.prototype;return!(!a||!a.isReactComponent)}function Gj(a){if("function"===typeof a)return Ge(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===zd)return 11;if(a===Ad)return 14}return 2}function Sa(a,b){var c=a.alternate;null===c?(c=la(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.effectTag=0,c.nextEffect=null,c.firstEffect=
null,c.lastEffect=null);c.childExpirationTime=a.childExpirationTime;c.expirationTime=a.expirationTime;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{expirationTime:b.expirationTime,firstContext:b.firstContext,responders:b.responders};c.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}function Oc(a,b,c,d,e,f){var g=2;d=a;if("function"===typeof a)Ge(a)&&(g=1);else if("string"===typeof a)g=
5;else a:switch(a){case Ma:return Ha(c.children,e,f,b);case Hj:g=8;e|=7;break;case Af:g=8;e|=1;break;case kc:return a=la(12,c,b,e|8),a.elementType=kc,a.type=kc,a.expirationTime=f,a;case lc:return a=la(13,c,b,e),a.type=lc,a.elementType=lc,a.expirationTime=f,a;case yd:return a=la(19,c,b,e),a.elementType=yd,a.expirationTime=f,a;default:if("object"===typeof a&&null!==a)switch(a.$$typeof){case Cf:g=10;break a;case Bf:g=9;break a;case zd:g=11;break a;case Ad:g=14;break a;case Ef:g=16;d=null;break a;case Df:g=
22;break a}throw Error(k(130,null==a?a:typeof a,""));}b=la(g,c,b,e);b.elementType=a;b.type=d;b.expirationTime=f;return b}function Ha(a,b,c,d){a=la(7,a,d,b);a.expirationTime=c;return a}function qe(a,b,c){a=la(6,a,null,b);a.expirationTime=c;return a}function re(a,b,c){b=la(4,null!==a.children?a.children:[],a.key,b);b.expirationTime=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}function Ij(a,b,c){this.tag=b;this.current=null;this.containerInfo=
a;this.pingCache=this.pendingChildren=null;this.finishedExpirationTime=0;this.finishedWork=null;this.timeoutHandle=-1;this.pendingContext=this.context=null;this.hydrate=c;this.callbackNode=null;this.callbackPriority=90;this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Kh(a,b){var c=a.firstSuspendedTime;a=a.lastSuspendedTime;return 0!==c&&c>=b&&a<=b}function Ya(a,b){var c=a.firstSuspendedTime,d=a.lastSuspendedTime;
c<b&&(a.firstSuspendedTime=b);if(d>b||0===c)a.lastSuspendedTime=b;b<=a.lastPingedTime&&(a.lastPingedTime=0);b<=a.lastExpiredTime&&(a.lastExpiredTime=0)}function yh(a,b){b>a.firstPendingTime&&(a.firstPendingTime=b);var c=a.firstSuspendedTime;0!==c&&(b>=c?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:b>=a.lastSuspendedTime&&(a.lastSuspendedTime=b+1),b>a.nextKnownPendingLevel&&(a.nextKnownPendingLevel=b))}function Ue(a,b){var c=a.lastExpiredTime;if(0===c||c>b)a.lastExpiredTime=b}
function md(a,b,c,d){var e=b.current,f=ka(),g=Vb.suspense;f=Va(f,e,g);a:if(c){c=c._reactInternalFiber;b:{if(Na(c)!==c||1!==c.tag)throw Error(k(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break b;case 1:if(N(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break b}}h=h.return}while(null!==h);throw Error(k(171));}if(1===c.tag){var m=c.type;if(N(m)){c=Gg(c,m,h);break a}}c=h}else c=Ca;null===b.context?b.context=c:b.pendingContext=c;b=Ea(f,g);b.payload={element:a};d=void 0===
d?null:d;null!==d&&(b.callback=d);Fa(e,b);Ja(e,f);return f}function cf(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function Wh(a,b){a=a.memoizedState;null!==a&&null!==a.dehydrated&&a.retryTime<b&&(a.retryTime=b)}function df(a,b){Wh(a,b);(a=a.alternate)&&Wh(a,b)}function ef(a,b,c){c=null!=c&&!0===c.hydrate;var d=new Ij(a,b,c),e=la(3,null,null,2===b?7:1===b?3:0);d.current=e;e.stateNode=d;ne(e);a[Lb]=d.current;c&&0!==b&&
xi(a,9===a.nodeType?a:a.ownerDocument);this._internalRoot=d}function bc(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||" react-mount-point-unstable "!==a.nodeValue))}function Jj(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute("data-reactroot")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new ef(a,0,b?{hydrate:!0}:void 0)}function nd(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f._internalRoot;
if("function"===typeof e){var h=e;e=function(){var a=cf(g);h.call(a)}}md(b,g,a,e)}else{f=c._reactRootContainer=Jj(c,d);g=f._internalRoot;if("function"===typeof e){var m=e;e=function(){var a=cf(g);m.call(a)}}Rh(function(){md(b,g,a,e)})}return cf(g)}function Kj(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:gb,key:null==d?null:""+d,children:a,containerInfo:b,implementation:c}}function Xh(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;
if(!bc(b))throw Error(k(200));return Kj(a,b,null,c)}if(!ea)throw Error(k(227));var ki=function(a,b,c,d,e,f,g,h,m){var n=Array.prototype.slice.call(arguments,3);try{b.apply(c,n)}catch(C){this.onError(C)}},yb=!1,gc=null,hc=!1,pd=null,li={onError:function(a){yb=!0;gc=a}},td=null,rf=null,mf=null,ic=null,cb={},jc=[],qd={},db={},rd={},wa=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),M=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.assign,
sd=null,eb=null,fb=null,ee=function(a,b){return a(b)},eg=function(a,b,c,d,e){return a(b,c,d,e)},vd=function(){},vf=ee,Oa=!1,wd=!1,Z=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Scheduler,Lj=Z.unstable_cancelCallback,ff=Z.unstable_now,$f=Z.unstable_scheduleCallback,Mj=Z.unstable_shouldYield,Yh=Z.unstable_requestPaint,Pd=Z.unstable_runWithPriority,Nj=Z.unstable_getCurrentPriorityLevel,Oj=Z.unstable_ImmediatePriority,Zh=Z.unstable_UserBlockingPriority,ag=Z.unstable_NormalPriority,Pj=Z.unstable_LowPriority,
Qj=Z.unstable_IdlePriority,oi=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wf=Object.prototype.hasOwnProperty,yf={},xf={},E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){E[a]=
new L(a,0,!1,a,null,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var b=a[0];E[b]=new L(b,1,!1,a[1],null,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){E[a]=new L(a,2,!1,a.toLowerCase(),null,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){E[a]=new L(a,2,!1,a,null,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){E[a]=
new L(a,3,!1,a.toLowerCase(),null,!1)});["checked","multiple","muted","selected"].forEach(function(a){E[a]=new L(a,3,!0,a,null,!1)});["capture","download"].forEach(function(a){E[a]=new L(a,4,!1,a,null,!1)});["cols","rows","size","span"].forEach(function(a){E[a]=new L(a,6,!1,a,null,!1)});["rowSpan","start"].forEach(function(a){E[a]=new L(a,5,!1,a.toLowerCase(),null,!1)});var gf=/[\-:]([a-z])/g,hf=function(a){return a[1].toUpperCase()};"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var b=
a.replace(gf,hf);E[b]=new L(b,1,!1,a,null,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/1999/xlink",!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1)});["tabIndex","crossOrigin"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!1)});E.xlinkHref=new L("xlinkHref",1,
!1,"xlink:href","http://www.w3.org/1999/xlink",!0);["src","href","action","formAction"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!0)});var da=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;da.hasOwnProperty("ReactCurrentDispatcher")||(da.ReactCurrentDispatcher={current:null});da.hasOwnProperty("ReactCurrentBatchConfig")||(da.ReactCurrentBatchConfig={suspense:null});var si=/^(.*)[\\\/]/,Q="function"===typeof Symbol&&Symbol.for,Pc=Q?Symbol.for("react.element"):60103,gb=Q?Symbol.for("react.portal"):
60106,Ma=Q?Symbol.for("react.fragment"):60107,Af=Q?Symbol.for("react.strict_mode"):60108,kc=Q?Symbol.for("react.profiler"):60114,Cf=Q?Symbol.for("react.provider"):60109,Bf=Q?Symbol.for("react.context"):60110,Hj=Q?Symbol.for("react.concurrent_mode"):60111,zd=Q?Symbol.for("react.forward_ref"):60112,lc=Q?Symbol.for("react.suspense"):60113,yd=Q?Symbol.for("react.suspense_list"):60120,Ad=Q?Symbol.for("react.memo"):60115,Ef=Q?Symbol.for("react.lazy"):60116,Df=Q?Symbol.for("react.block"):60121,zf="function"===
typeof Symbol&&Symbol.iterator,od,xh=function(a){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if("http://www.w3.org/2000/svg"!==a.namespaceURI||"innerHTML"in a)a.innerHTML=b;else{od=od||document.createElement("div");od.innerHTML="<svg>"+b.valueOf().toString()+"</svg>";for(b=od.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}}),Wb=function(a,
b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b},ib={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Id={},Of={};wa&&(Of=document.createElement("div").style,"AnimationEvent"in window||(delete ib.animationend.animation,delete ib.animationiteration.animation,delete ib.animationstart.animation),"TransitionEvent"in
window||delete ib.transitionend.transition);var $h=oc("animationend"),ai=oc("animationiteration"),bi=oc("animationstart"),ci=oc("transitionend"),Db="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pf=new ("function"===typeof WeakMap?WeakMap:Map),Ab=null,wi=function(a){if(a){var b=a._dispatchListeners,c=a._dispatchInstances;
if(Array.isArray(b))for(var d=0;d<b.length&&!a.isPropagationStopped();d++)lf(a,b[d],c[d]);else b&&lf(a,b,c);a._dispatchListeners=null;a._dispatchInstances=null;a.isPersistent()||a.constructor.release(a)}},qc=[],Rd=!1,fa=[],xa=null,ya=null,za=null,Eb=new Map,Fb=new Map,Jb=[],Nd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),
yi="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" "),dg={},cg=new Map,Td=new Map,Rj=["abort","abort",$h,"animationEnd",ai,"animationIteration",bi,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata",
"loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",ci,"transitionEnd","waiting","waiting"];Sd("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),
0);Sd("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);Sd(Rj,2);(function(a,b){for(var c=0;c<a.length;c++)Td.set(a[c],b)})("change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),0);var Hi=Zh,Gi=Pd,tc=!0,Kb={animationIterationCount:!0,
borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,
strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sj=["Webkit","ms","Moz","O"];Object.keys(Kb).forEach(function(a){Sj.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);Kb[b]=Kb[a]})});var Ii=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),ng="$",og="/$",$d="$?",Zd="$!",Ze=null,$e=null,We="function"===typeof setTimeout?setTimeout:void 0,vj="function"===
typeof clearTimeout?clearTimeout:void 0,jf=Math.random().toString(36).slice(2),Aa="__reactInternalInstance$"+jf,vc="__reactEventHandlers$"+jf,Lb="__reactContainere$"+jf,Ba=null,ce=null,wc=null;M(R.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():"unknown"!==typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=xc)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():"unknown"!==
typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=xc)},persist:function(){this.isPersistent=xc},isPersistent:yc,destructor:function(){var a=this.constructor.Interface,b;for(b in a)this[b]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null;this.isPropagationStopped=this.isDefaultPrevented=yc;this._dispatchInstances=this._dispatchListeners=null}});R.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||
Date.now()},defaultPrevented:null,isTrusted:null};R.extend=function(a){function b(){return c.apply(this,arguments)}var c=this,d=function(){};d.prototype=c.prototype;d=new d;M(d,b.prototype);b.prototype=d;b.prototype.constructor=b;b.Interface=M({},c.Interface,a);b.extend=c.extend;sg(b);return b};sg(R);var Tj=R.extend({data:null}),Uj=R.extend({data:null}),Ni=[9,13,27,32],de=wa&&"CompositionEvent"in window,cc=null;wa&&"documentMode"in document&&(cc=document.documentMode);var Vj=wa&&"TextEvent"in window&&
!cc,xg=wa&&(!de||cc&&8<cc&&11>=cc),wg=String.fromCharCode(32),ua={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},
dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},vg=!1,mb=!1,Wj={eventTypes:ua,extractEvents:function(a,b,c,d,e){var f;if(de)b:{switch(a){case "compositionstart":var g=ua.compositionStart;break b;case "compositionend":g=ua.compositionEnd;break b;case "compositionupdate":g=
ua.compositionUpdate;break b}g=void 0}else mb?tg(a,c)&&(g=ua.compositionEnd):"keydown"===a&&229===c.keyCode&&(g=ua.compositionStart);g?(xg&&"ko"!==c.locale&&(mb||g!==ua.compositionStart?g===ua.compositionEnd&&mb&&(f=rg()):(Ba=d,ce="value"in Ba?Ba.value:Ba.textContent,mb=!0)),e=Tj.getPooled(g,b,c,d),f?e.data=f:(f=ug(c),null!==f&&(e.data=f)),lb(e),f=e):f=null;(a=Vj?Oi(a,c):Pi(a,c))?(b=Uj.getPooled(ua.beforeInput,b,c,d),b.data=a,lb(b)):b=null;return null===f?b:null===b?f:[f,b]}},Qi={color:!0,date:!0,
datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},Ag={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}},Mb=null,Nb=null,kf=!1;wa&&(kf=Tf("input")&&(!document.documentMode||9<document.documentMode));var Xj={eventTypes:Ag,_isInputEventSupported:kf,extractEvents:function(a,b,c,d,e){e=b?Pa(b):window;var f=
e.nodeName&&e.nodeName.toLowerCase();if("select"===f||"input"===f&&"file"===e.type)var g=Si;else if(yg(e))if(kf)g=Wi;else{g=Ui;var h=Ti}else(f=e.nodeName)&&"input"===f.toLowerCase()&&("checkbox"===e.type||"radio"===e.type)&&(g=Vi);if(g&&(g=g(a,b)))return zg(g,c,d);h&&h(a,e,b);"blur"===a&&(a=e._wrapperState)&&a.controlled&&"number"===e.type&&Ed(e,"number",e.value)}},dc=R.extend({view:null,detail:null}),Yi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},di=0,ei=0,fi=!1,gi=!1,ec=dc.extend({screenX:null,
screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:fe,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)},movementX:function(a){if("movementX"in a)return a.movementX;var b=di;di=a.screenX;return fi?"mousemove"===a.type?a.screenX-b:0:(fi=!0,0)},movementY:function(a){if("movementY"in a)return a.movementY;var b=ei;ei=a.screenY;return gi?"mousemove"===
a.type?a.screenY-b:0:(gi=!0,0)}}),hi=ec.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),fc={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout",
"pointerover"]}},Yj={eventTypes:fc,extractEvents:function(a,b,c,d,e){var f="mouseover"===a||"pointerover"===a,g="mouseout"===a||"pointerout"===a;if(f&&0===(e&32)&&(c.relatedTarget||c.fromElement)||!g&&!f)return null;f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window;if(g){if(g=b,b=(b=c.relatedTarget||c.toElement)?Bb(b):null,null!==b){var h=Na(b);if(b!==h||5!==b.tag&&6!==b.tag)b=null}}else g=null;if(g===b)return null;if("mouseout"===a||"mouseover"===a){var m=ec;var n=fc.mouseLeave;
var l=fc.mouseEnter;var k="mouse"}else if("pointerout"===a||"pointerover"===a)m=hi,n=fc.pointerLeave,l=fc.pointerEnter,k="pointer";a=null==g?f:Pa(g);f=null==b?f:Pa(b);n=m.getPooled(n,g,c,d);n.type=k+"leave";n.target=a;n.relatedTarget=f;c=m.getPooled(l,b,c,d);c.type=k+"enter";c.target=f;c.relatedTarget=a;d=g;k=b;if(d&&k)a:{m=d;l=k;g=0;for(a=m;a;a=pa(a))g++;a=0;for(b=l;b;b=pa(b))a++;for(;0<g-a;)m=pa(m),g--;for(;0<a-g;)l=pa(l),a--;for(;g--;){if(m===l||m===l.alternate)break a;m=pa(m);l=pa(l)}m=null}else m=
null;l=m;for(m=[];d&&d!==l;){g=d.alternate;if(null!==g&&g===l)break;m.push(d);d=pa(d)}for(d=[];k&&k!==l;){g=k.alternate;if(null!==g&&g===l)break;d.push(k);k=pa(k)}for(k=0;k<m.length;k++)be(m[k],"bubbled",n);for(k=d.length;0<k--;)be(d[k],"captured",c);return 0===(e&64)?[n]:[n,c]}},Qa="function"===typeof Object.is?Object.is:Zi,$i=Object.prototype.hasOwnProperty,Zj=wa&&"documentMode"in document&&11>=document.documentMode,Eg={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},
dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},nb=null,he=null,Pb=null,ge=!1,ak={eventTypes:Eg,extractEvents:function(a,b,c,d,e,f){e=f||(d.window===d?d.document:9===d.nodeType?d:d.ownerDocument);if(!(f=!e)){a:{e=Jd(e);f=rd.onSelect;for(var g=0;g<f.length;g++)if(!e.has(f[g])){e=!1;break a}e=!0}f=!e}if(f)return null;e=b?Pa(b):window;switch(a){case "focus":if(yg(e)||"true"===e.contentEditable)nb=e,he=b,Pb=null;break;case "blur":Pb=he=nb=null;
break;case "mousedown":ge=!0;break;case "contextmenu":case "mouseup":case "dragend":return ge=!1,Dg(c,d);case "selectionchange":if(Zj)break;case "keydown":case "keyup":return Dg(c,d)}return null}},bk=R.extend({animationName:null,elapsedTime:null,pseudoElement:null}),ck=R.extend({clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),dk=dc.extend({relatedTarget:null}),ek={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",
Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",
224:"Meta"},gk=dc.extend({key:function(a){if(a.key){var b=ek[a.key]||a.key;if("Unidentified"!==b)return b}return"keypress"===a.type?(a=Ac(a),13===a?"Enter":String.fromCharCode(a)):"keydown"===a.type||"keyup"===a.type?fk[a.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:fe,charCode:function(a){return"keypress"===a.type?Ac(a):0},keyCode:function(a){return"keydown"===a.type||"keyup"===a.type?a.keyCode:0},which:function(a){return"keypress"===
a.type?Ac(a):"keydown"===a.type||"keyup"===a.type?a.keyCode:0}}),hk=ec.extend({dataTransfer:null}),ik=dc.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:fe}),jk=R.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),kk=ec.extend({deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?
-a.wheelDelta:0},deltaZ:null,deltaMode:null}),lk={eventTypes:dg,extractEvents:function(a,b,c,d,e){e=cg.get(a);if(!e)return null;switch(a){case "keypress":if(0===Ac(c))return null;case "keydown":case "keyup":a=gk;break;case "blur":case "focus":a=dk;break;case "click":if(2===c.button)return null;case "auxclick":case "dblclick":case "mousedown":case "mousemove":case "mouseup":case "mouseout":case "mouseover":case "contextmenu":a=ec;break;case "drag":case "dragend":case "dragenter":case "dragexit":case "dragleave":case "dragover":case "dragstart":case "drop":a=
hk;break;case "touchcancel":case "touchend":case "touchmove":case "touchstart":a=ik;break;case $h:case ai:case bi:a=bk;break;case ci:a=jk;break;case "scroll":a=dc;break;case "wheel":a=kk;break;case "copy":case "cut":case "paste":a=ck;break;case "gotpointercapture":case "lostpointercapture":case "pointercancel":case "pointerdown":case "pointermove":case "pointerout":case "pointerover":case "pointerup":a=hi;break;default:a=R}b=a.getPooled(e,b,c,d);lb(b);return b}};(function(a){if(ic)throw Error(k(101));
ic=Array.prototype.slice.call(a);nf()})("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" "));(function(a,b,c){td=a;rf=b;mf=c})(ae,Hb,Pa);pf({SimpleEventPlugin:lk,EnterLeaveEventPlugin:Yj,ChangeEventPlugin:Xj,SelectEventPlugin:ak,BeforeInputEventPlugin:Wj});var ie=[],ob=-1,Ca={},B={current:Ca},G={current:!1},Ra=Ca,bj=Pd,je=$f,Rg=Lj,aj=Nj,Dc=Oj,Ig=Zh,Jg=ag,Kg=Pj,Lg=Qj,Qg={},yj=Mj,Cj=void 0!==Yh?Yh:function(){},qa=null,
Ec=null,ke=!1,ii=ff(),Y=1E4>ii?ff:function(){return ff()-ii},Ic={current:null},Hc=null,qb=null,Gc=null,Tg=0,Jc=2,Ga=!1,Vb=da.ReactCurrentBatchConfig,$g=(new ea.Component).refs,Mc={isMounted:function(a){return(a=a._reactInternalFiber)?Na(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;d=Va(d,a,e);e=Ea(d,e);e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueReplaceState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;
d=Va(d,a,e);e=Ea(d,e);e.tag=1;e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueForceUpdate:function(a,b){a=a._reactInternalFiber;var c=ka(),d=Vb.suspense;c=Va(c,a,d);d=Ea(c,d);d.tag=Jc;void 0!==b&&null!==b&&(d.callback=b);Fa(a,d);Ja(a,c)}},Qc=Array.isArray,wb=ah(!0),Fe=ah(!1),Sb={},ja={current:Sb},Ub={current:Sb},Tb={current:Sb},D={current:0},Sc=da.ReactCurrentDispatcher,X=da.ReactCurrentBatchConfig,Ia=0,z=null,K=null,J=null,Uc=!1,Tc={readContext:W,useCallback:S,useContext:S,
useEffect:S,useImperativeHandle:S,useLayoutEffect:S,useMemo:S,useReducer:S,useRef:S,useState:S,useDebugValue:S,useResponder:S,useDeferredValue:S,useTransition:S},dj={readContext:W,useCallback:ih,useContext:W,useEffect:eh,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ze(4,2,gh.bind(null,b,a),c)},useLayoutEffect:function(a,b){return ze(4,2,a,b)},useMemo:function(a,b){var c=ub();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=
ub();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a=d.queue={pending:null,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};a=a.dispatch=ch.bind(null,z,a);return[d.memoizedState,a]},useRef:function(a){var b=ub();a={current:a};return b.memoizedState=a},useState:xe,useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=xe(a),d=c[0],e=c[1];eh(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=
xe(!1),c=b[0];b=b[1];return[ih(Ce.bind(null,b,a),[b,a]),c]}},ej={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Vc,useRef:dh,useState:function(a){return Vc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Vc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Vc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,
b,a),[b,a]),c]}},fj={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Wc,useRef:dh,useState:function(a){return Wc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Wc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Wc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,b,a),[b,a]),c]}},ra=null,Ka=null,Wa=
!1,gj=da.ReactCurrentOwner,ia=!1,Je={dehydrated:null,retryTime:0};var jj=function(a,b,c,d){for(c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};var wh=function(a){};var ij=function(a,b,c,d,e){var f=a.memoizedProps;if(f!==d){var g=b.stateNode;Ta(ja.current);a=null;switch(c){case "input":f=
Cd(g,f);d=Cd(g,d);a=[];break;case "option":f=Fd(g,f);d=Fd(g,d);a=[];break;case "select":f=M({},f,{value:void 0});d=M({},d,{value:void 0});a=[];break;case "textarea":f=Gd(g,f);d=Gd(g,d);a=[];break;default:"function"!==typeof f.onClick&&"function"===typeof d.onClick&&(g.onclick=uc)}Ud(c,d);var h,m;c=null;for(h in f)if(!d.hasOwnProperty(h)&&f.hasOwnProperty(h)&&null!=f[h])if("style"===h)for(m in g=f[h],g)g.hasOwnProperty(m)&&(c||(c={}),c[m]="");else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==
h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(db.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in d){var k=d[h];g=null!=f?f[h]:void 0;if(d.hasOwnProperty(h)&&k!==g&&(null!=k||null!=g))if("style"===h)if(g){for(m in g)!g.hasOwnProperty(m)||k&&k.hasOwnProperty(m)||(c||(c={}),c[m]="");for(m in k)k.hasOwnProperty(m)&&g[m]!==k[m]&&(c||(c={}),c[m]=k[m])}else c||(a||(a=[]),a.push(h,c)),c=k;else"dangerouslySetInnerHTML"===h?(k=k?k.__html:void 0,g=g?g.__html:void 0,null!=k&&g!==k&&(a=a||
[]).push(h,k)):"children"===h?g===k||"string"!==typeof k&&"number"!==typeof k||(a=a||[]).push(h,""+k):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(db.hasOwnProperty(h)?(null!=k&&oa(e,h),a||g===k||(a=[])):(a=a||[]).push(h,k))}c&&(a=a||[]).push("style",c);e=a;if(b.updateQueue=e)b.effectTag|=4}};var kj=function(a,b,c,d){c!==d&&(b.effectTag|=4)};var pj="function"===typeof WeakSet?WeakSet:Set,wj="function"===typeof WeakMap?WeakMap:Map,sj=Math.ceil,gd=da.ReactCurrentDispatcher,
Uh=da.ReactCurrentOwner,H=0,Ye=8,ca=16,ma=32,Xa=0,hd=1,Oh=2,ad=3,bd=4,Xe=5,p=H,U=null,t=null,P=0,F=Xa,id=null,ta=1073741823,Yb=1073741823,kd=null,Xb=0,jd=!1,Re=0,Ph=500,l=null,cd=!1,Se=null,La=null,ld=!1,Zb=null,$b=90,bb=null,ac=0,af=null,dd=0,Ja=function(a,b){if(50<ac)throw ac=0,af=null,Error(k(185));a=ed(a,b);if(null!==a){var c=Cc();1073741823===b?(p&Ye)!==H&&(p&(ca|ma))===H?Te(a):(V(a),p===H&&ha()):V(a);(p&4)===H||98!==c&&99!==c||(null===bb?bb=new Map([[a,b]]):(c=bb.get(a),(void 0===c||c>b)&&bb.set(a,
b)))}};var zj=function(a,b,c){var d=b.expirationTime;if(null!==a){var e=b.pendingProps;if(a.memoizedProps!==e||G.current)ia=!0;else{if(d<c){ia=!1;switch(b.tag){case 3:sh(b);Ee();break;case 5:bh(b);if(b.mode&4&&1!==c&&e.hidden)return b.expirationTime=b.childExpirationTime=1,null;break;case 1:N(b.type)&&Bc(b);break;case 4:se(b,b.stateNode.containerInfo);break;case 10:d=b.memoizedProps.value;e=b.type._context;y(Ic,e._currentValue);e._currentValue=d;break;case 13:if(null!==b.memoizedState){d=b.child.childExpirationTime;
if(0!==d&&d>=c)return th(a,b,c);y(D,D.current&1);b=sa(a,b,c);return null!==b?b.sibling:null}y(D,D.current&1);break;case 19:d=b.childExpirationTime>=c;if(0!==(a.effectTag&64)){if(d)return vh(a,b,c);b.effectTag|=64}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null);y(D,D.current);if(!d)return null}return sa(a,b,c)}ia=!1}}else ia=!1;b.expirationTime=0;switch(b.tag){case 2:d=b.type;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;e=pb(b,B.current);rb(b,c);e=we(null,
b,d,a,e,c);b.effectTag|=1;if("object"===typeof e&&null!==e&&"function"===typeof e.render&&void 0===e.$$typeof){b.tag=1;b.memoizedState=null;b.updateQueue=null;if(N(d)){var f=!0;Bc(b)}else f=!1;b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null;ne(b);var g=d.getDerivedStateFromProps;"function"===typeof g&&Lc(b,d,g,a);e.updater=Mc;b.stateNode=e;e._reactInternalFiber=b;pe(b,d,a,c);b=Ie(null,b,d,!0,f,c)}else b.tag=0,T(null,b,e,c),b=b.child;return b;case 16:a:{e=b.elementType;null!==a&&(a.alternate=
null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;ri(e);if(1!==e._status)throw e._result;e=e._result;b.type=e;f=b.tag=Gj(e);a=aa(e,a);switch(f){case 0:b=He(null,b,e,a,c);break a;case 1:b=rh(null,b,e,a,c);break a;case 11:b=nh(null,b,e,a,c);break a;case 14:b=oh(null,b,e,aa(e.type,a),d,c);break a}throw Error(k(306,e,""));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),He(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),rh(a,b,d,e,c);
case 3:sh(b);d=b.updateQueue;if(null===a||null===d)throw Error(k(282));d=b.pendingProps;e=b.memoizedState;e=null!==e?e.element:null;oe(a,b);Qb(b,d,null,c);d=b.memoizedState.element;if(d===e)Ee(),b=sa(a,b,c);else{if(e=b.stateNode.hydrate)Ka=kb(b.stateNode.containerInfo.firstChild),ra=b,e=Wa=!0;if(e)for(c=Fe(b,null,d,c),b.child=c;c;)c.effectTag=c.effectTag&-3|1024,c=c.sibling;else T(a,b,d,c),Ee();b=b.child}return b;case 5:return bh(b),null===a&&De(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:
null,g=e.children,Yd(d,e)?g=null:null!==f&&Yd(d,f)&&(b.effectTag|=16),qh(a,b),b.mode&4&&1!==c&&e.hidden?(b.expirationTime=b.childExpirationTime=1,b=null):(T(a,b,g,c),b=b.child),b;case 6:return null===a&&De(b),null;case 13:return th(a,b,c);case 4:return se(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=wb(b,null,d,c):T(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),nh(a,b,d,e,c);case 7:return T(a,b,b.pendingProps,c),b.child;case 8:return T(a,
b,b.pendingProps.children,c),b.child;case 12:return T(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;g=b.memoizedProps;f=e.value;var h=b.type._context;y(Ic,h._currentValue);h._currentValue=f;if(null!==g)if(h=g.value,f=Qa(h,f)?0:("function"===typeof d._calculateChangedBits?d._calculateChangedBits(h,f):1073741823)|0,0===f){if(g.children===e.children&&!G.current){b=sa(a,b,c);break a}}else for(h=b.child,null!==h&&(h.return=b);null!==h;){var m=h.dependencies;if(null!==
m){g=h.child;for(var l=m.firstContext;null!==l;){if(l.context===d&&0!==(l.observedBits&f)){1===h.tag&&(l=Ea(c,null),l.tag=Jc,Fa(h,l));h.expirationTime<c&&(h.expirationTime=c);l=h.alternate;null!==l&&l.expirationTime<c&&(l.expirationTime=c);Sg(h.return,c);m.expirationTime<c&&(m.expirationTime=c);break}l=l.next}}else g=10===h.tag?h.type===b.type?null:h.child:h.child;if(null!==g)g.return=h;else for(g=h;null!==g;){if(g===b){g=null;break}h=g.sibling;if(null!==h){h.return=g.return;g=h;break}g=g.return}h=
g}T(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,f=b.pendingProps,d=f.children,rb(b,c),e=W(e,f.unstable_observedBits),d=d(e),b.effectTag|=1,T(a,b,d,c),b.child;case 14:return e=b.type,f=aa(e,b.pendingProps),f=aa(e.type,f),oh(a,b,e,f,d,c);case 15:return ph(a,b,b.type,b.pendingProps,d,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),b.tag=1,N(d)?(a=!0,Bc(b)):a=!1,rb(b,c),Yg(b,d,e),pe(b,d,e,c),Ie(null,
b,d,!0,a,c);case 19:return vh(a,b,c)}throw Error(k(156,b.tag));};var bf=null,Ne=null,la=function(a,b,c,d){return new Fj(a,b,c,d)};ef.prototype.render=function(a){md(a,this._internalRoot,null,null)};ef.prototype.unmount=function(){var a=this._internalRoot,b=a.containerInfo;md(null,a,null,function(){b[Lb]=null})};var Di=function(a){if(13===a.tag){var b=Fc(ka(),150,100);Ja(a,b);df(a,b)}};var Yf=function(a){13===a.tag&&(Ja(a,3),df(a,3))};var Bi=function(a){if(13===a.tag){var b=ka();b=Va(b,a,null);Ja(a,
b);df(a,b)}};sd=function(a,b,c){switch(b){case "input":Dd(a,c);b=c.name;if("radio"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll("input[name="+JSON.stringify(""+b)+'][type="radio"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=ae(d);if(!e)throw Error(k(90));Gf(d);Dd(d,e)}}}break;case "textarea":Lf(a,c);break;case "select":b=c.value,null!=b&&hb(a,!!c.multiple,b,!1)}};(function(a,b,c,d){ee=a;eg=b;vd=c;vf=d})(Qh,function(a,b,c,d,e){var f=p;p|=4;
try{return Da(98,a.bind(null,b,c,d,e))}finally{p=f,p===H&&ha()}},function(){(p&(1|ca|ma))===H&&(uj(),xb())},function(a,b){var c=p;p|=2;try{return a(b)}finally{p=c,p===H&&ha()}});var mk={Events:[Hb,Pa,ae,pf,qd,lb,function(a){Kd(a,Ki)},sf,tf,sc,pc,xb,{current:!1}]};(function(a){var b=a.findFiberByHostInstance;return Ej(M({},a,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:da.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Sf(a);
return null===a?null:a.stateNode},findFiberByHostInstance:function(a){return b?b(a):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:Bb,bundleType:0,version:"16.13.1",rendererPackageName:"react-dom"});I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mk;I.createPortal=Xh;I.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternalFiber;if(void 0===
b){if("function"===typeof a.render)throw Error(k(188));throw Error(k(268,Object.keys(a)));}a=Sf(b);a=null===a?null:a.stateNode;return a};I.flushSync=function(a,b){if((p&(ca|ma))!==H)throw Error(k(187));var c=p;p|=1;try{return Da(99,a.bind(null,b))}finally{p=c,ha()}};I.hydrate=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!0,c)};I.render=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!1,c)};I.unmountComponentAtNode=function(a){if(!bc(a))throw Error(k(40));return a._reactRootContainer?
(Rh(function(){nd(null,null,a,!1,function(){a._reactRootContainer=null;a[Lb]=null})}),!0):!1};I.unstable_batchedUpdates=Qh;I.unstable_createPortal=function(a,b){return Xh(a,b,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)};I.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!bc(c))throw Error(k(200));if(null==a||void 0===a._reactInternalFiber)throw Error(k(38));return nd(a,b,c,!1,d)};I.version="16.13.1"});
</script>
    <script>const e = React.createElement;

function pathToString(path) {
  if (path[0] === '/') {
    return '/' + path.slice(1).join('/');
  } else {
    return path.join('/');
  }
}

function findCommonPath(files) {
  if (!files || !files.length) {
    return [];
  }

  function isPrefix(arr, prefix) {
    if (arr.length < prefix.length) {
      return false;
    }
    for (let i = prefix.length - 1; i >= 0; --i) {
      if (arr[i] !== prefix[i]) {
        return false;
      }
    }
    return true;
  }

  let commonPath = files[0].path.slice(0, -1);
  while (commonPath.length) {
    if (files.every(file => isPrefix(file.path, commonPath))) {
      break;
    }
    commonPath.pop();
  }
  return commonPath;
}

function findFolders(files) {
  if (!files || !files.length) {
    return [];
  }

  let folders = files.filter(file => file.path.length > 1).map(file => file.path[0]);
  folders = [...new Set(folders)]; // unique
  folders.sort();

  folders = folders.map(folder => {
    let filesInFolder = files
      .filter(file => file.path[0] === folder)
      .map(file => ({
        ...file,
        path: file.path.slice(1),
        parent: [...file.parent, file.path[0]],
      }));

    const children = findFolders(filesInFolder); // recursion

    return {
      is_folder: true,
      path: [folder],
      parent: files[0].parent,
      children,
      covered: children.reduce((sum, file) => sum + file.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.coverable, 0),
      prevRun: {
        covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
        coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
      }
    };
  });

  return [
    ...folders,
    ...files.filter(file => file.path.length === 1),
  ];
}

class App extends React.Component {
  constructor(...args) {
    super(...args);

    this.state = {
      current: [],
    };
  }

  componentDidMount() {
    this.updateStateFromLocation();
    window.addEventListener("hashchange", () => this.updateStateFromLocation(), false);
  }

  updateStateFromLocation() {
    if (window.location.hash.length > 1) {
      const current = window.location.hash.substr(1).split('/');
      this.setState({current});
    } else {
      this.setState({current: []});
    }
  }

  getCurrentPath() {
    let file = this.props.root;
    let path = [file];
    for (let p of this.state.current) {
      file = file.children.find(file => file.path[0] === p);
      if (!file) {
        return path;
      }
      path.push(file);
    }
    return path;
  }

  render() {
    const path = this.getCurrentPath();
    const file = path[path.length - 1];

    let w = null;
    if (file.is_folder) {
      w = e(FilesList, {
        folder: file,
        onSelectFile: this.selectFile.bind(this),
        onBack: path.length > 1 ? this.back.bind(this) : null,
      });
    } else {
      w = e(DisplayFile, {
        file,
        onBack: this.back.bind(this),
      });
    }

    return e('div', {className: 'app'}, w);
  }

  selectFile(file) {
    this.setState(({current}) => {
      return {current: [...current, file.path[0]]};
    }, () => this.updateHash());
  }

  back(file) {
    this.setState(({current}) => {
      return {current: current.slice(0, current.length - 1)};
    }, () => this.updateHash());
  }

  updateHash() {
    if (!this.state.current || !this.state.current.length) {
      window.location = '#';
    } else {
      window.location = '#' + this.state.current.join('/');
    }
  }
}

function FilesList({folder, onSelectFile, onBack}) {
  let files = folder.children;
  return e('div', {className: 'display-folder'},
    e(FileHeader, {file: folder, onBack}),
    e('table', {className: 'files-list'},
      e('thead', {className: 'files-list__head'},
        e('tr', null,
          e('th', null, "Path"),
          e('th', null, "Coverage")
        )
      ),
      e('tbody', {className: 'files-list__body'},
        files.map(file => e(File, {file, onClick: onSelectFile}))
      )
    )
  );
}

function File({file, onClick}) {
  const coverage = file.coverable ? file.covered / file.coverable * 100 : -1;
  const coverageDelta = file.prevRun &&
    (file.covered / file.coverable * 100 - file.prevRun.covered / file.prevRun.coverable * 100);

  return e('tr', {
      className: 'files-list__file'
        + (coverage >= 0 && coverage < 50 ? ' files-list__file_low': '')
        + (coverage >= 50 && coverage < 80 ? ' files-list__file_medium': '')
        + (coverage >= 80 ? ' files-list__file_high': '')
        + (file.is_folder ? ' files-list__file_folder': ''),
      onClick: () => onClick(file),
    },
    e('td', null, pathToString(file.path)),
    e('td', null,
      file.covered + ' / ' + file.coverable +
      (coverage >= 0 ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e('span', {title: 'Change from the previous run'},
        (coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : ''))
    )
  );
}

function DisplayFile({file, onBack}) {
  return e('div', {className: 'display-file'},
    e(FileHeader, {file, onBack}),
    e(FileContent, {file})
  );
}

function FileHeader({file, onBack}) {
  const coverage = file.covered / file.coverable * 100;
  const coverageDelta = file.prevRun && (coverage - file.prevRun.covered / file.prevRun.coverable * 100);

  return e('div', {className: 'file-header'},
    onBack ? e('a', {className: 'file-header__back', onClick: onBack}, 'Back') : null,
    e('div', {className: 'file-header__name'}, pathToString([...file.parent, ...file.path])),
    e('div', {className: 'file-header__stat'},
      'Covered: ' + file.covered + ' of ' + file.coverable +
      (file.coverable ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e('span', {title: 'Change from the previous run'},
        (coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : ''))
    )
  );
}

function FileContent({file}) {
  return e('div', {className: 'file-content'},
    file.content.split(/\r?\n/).map((line, index) => {
      const trace = file.traces.find(trace => trace.line === index + 1);
      const covered = trace && trace.stats.Line;
      const uncovered = trace && !trace.stats.Line;
      return e('pre', {
          className: 'code-line'
            + (covered ? ' code-line_covered' : '')
            + (uncovered ? ' code-line_uncovered' : ''),
          title: trace ? JSON.stringify(trace.stats, null, 2) : null,
        }, line);
    })
  );
}

(function(){
  const commonPath = findCommonPath(data.files);
  const prevFilesMap = new Map();

  previousData && previousData.files.forEach((file) => {
    const path = file.path.slice(commonPath.length).join('/');
    prevFilesMap.set(path, file);
  });

  const files = data.files.map((file) => {
    const path = file.path.slice(commonPath.length);
    const { covered = 0, coverable = 0 } = prevFilesMap.get(path.join('/')) || {};
    return {
      ...file,
      path,
      parent: commonPath,
      prevRun: { covered, coverable },
    };
  });

  const children = findFolders(files);

  const root = {
    is_folder: true,
    children,
    path: commonPath,
    parent: [],
    covered: children.reduce((sum, file) => sum + file.covered, 0),
    coverable: children.reduce((sum, file) => sum + file.coverable, 0),
    prevRun: {
      covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
    }
  };

  ReactDOM.render(e(App, {root, prevFilesMap}), document.getElementById('root'));
}());
</script>
</body>
</html>